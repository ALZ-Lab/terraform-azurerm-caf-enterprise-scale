{
  "root_module": {
    "child_modules": [
      {
        "resources": [
          {
            "address": "module.settings.azurerm_resource_group.example",
            "mode": "managed",
            "type": "azurerm_resource_group",
            "name": "example",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "location": "northeurope",
              "managed_by": null,
              "name": "rg-identity",
              "tags": null,
              "timeouts": null
            },
            "sensitive_values": {}
          },
          {
            "address": "module.settings.azurerm_user_assigned_identity.example",
            "mode": "managed",
            "type": "azurerm_user_assigned_identity",
            "name": "example",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 1,
            "values": {
              "location": "northeurope",
              "name": "id-identity",
              "resource_group_name": "rg-identity",
              "tags": null,
              "timeouts": null
            },
            "sensitive_values": {}
          }
        ],
        "address": "module.settings"
      },
      {
        "resources": [
          {
            "address": "module.test_core.azurerm_management_group.level_1[\"/providers/Microsoft.Management/managementGroups/root-id-1\"]",
            "mode": "managed",
            "type": "azurerm_management_group",
            "name": "level_1",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "display_name": "root-name",
              "name": "root-id-1",
              "parent_management_group_id": "/providers/Microsoft.Management/managementGroups/dac8feee-8768-4fbd-9cf9-9d96d4718018",
              "timeouts": null
            },
            "sensitive_values": {
              "subscription_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_management_group.level_2[\"/providers/Microsoft.Management/managementGroups/root-id-1-decommissioned\"]",
            "mode": "managed",
            "type": "azurerm_management_group",
            "name": "level_2",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1-decommissioned",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "display_name": "Decommissioned",
              "name": "root-id-1-decommissioned",
              "parent_management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "timeouts": null
            },
            "sensitive_values": {
              "subscription_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_management_group.level_2[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones\"]",
            "mode": "managed",
            "type": "azurerm_management_group",
            "name": "level_2",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "display_name": "Landing Zones",
              "name": "root-id-1-landing-zones",
              "parent_management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "timeouts": null
            },
            "sensitive_values": {
              "subscription_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_management_group.level_2[\"/providers/Microsoft.Management/managementGroups/root-id-1-platform\"]",
            "mode": "managed",
            "type": "azurerm_management_group",
            "name": "level_2",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1-platform",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "display_name": "Platform",
              "name": "root-id-1-platform",
              "parent_management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "timeouts": null
            },
            "sensitive_values": {
              "subscription_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_management_group.level_2[\"/providers/Microsoft.Management/managementGroups/root-id-1-sandboxes\"]",
            "mode": "managed",
            "type": "azurerm_management_group",
            "name": "level_2",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1-sandboxes",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "display_name": "Sandboxes",
              "name": "root-id-1-sandboxes",
              "parent_management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "timeouts": null
            },
            "sensitive_values": {
              "subscription_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_management_group.level_3[\"/providers/Microsoft.Management/managementGroups/root-id-1-connectivity\"]",
            "mode": "managed",
            "type": "azurerm_management_group",
            "name": "level_3",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1-connectivity",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "display_name": "Connectivity",
              "name": "root-id-1-connectivity",
              "parent_management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1-platform",
              "timeouts": null
            },
            "sensitive_values": {
              "subscription_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_management_group.level_3[\"/providers/Microsoft.Management/managementGroups/root-id-1-identity\"]",
            "mode": "managed",
            "type": "azurerm_management_group",
            "name": "level_3",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1-identity",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "display_name": "Identity",
              "name": "root-id-1-identity",
              "parent_management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1-platform",
              "timeouts": null
            },
            "sensitive_values": {
              "subscription_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_management_group.level_3[\"/providers/Microsoft.Management/managementGroups/root-id-1-management\"]",
            "mode": "managed",
            "type": "azurerm_management_group",
            "name": "level_3",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1-management",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "display_name": "Management",
              "name": "root-id-1-management",
              "parent_management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1-platform",
              "timeouts": null
            },
            "sensitive_values": {
              "subscription_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_management_group_policy_assignment.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1-connectivity/providers/Microsoft.Authorization/policyAssignments/Enable-DDoS-VNET\"]",
            "mode": "managed",
            "type": "azurerm_management_group_policy_assignment",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1-connectivity/providers/Microsoft.Authorization/policyAssignments/Enable-DDoS-VNET",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Protect your virtual networks against volumetric and protocol attacks with Azure DDoS Network Protection. For more information, visit https://aka.ms/ddosprotectiondocs.",
              "display_name": "Virtual networks should be protected by Azure DDoS Network Protection",
              "enforce": false,
              "identity": [
                {
                  "identity_ids": null,
                  "type": "SystemAssigned"
                }
              ],
              "location": "northeurope",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1-connectivity",
              "name": "Enable-DDoS-VNET",
              "non_compliance_message": [
                {
                  "content": "This resource should be compliant with the assigned policy.",
                  "policy_definition_reference_id": null
                }
              ],
              "not_scopes": [],
              "overrides": [],
              "parameters": "{\"ddosPlan\":{\"value\":\"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/root-id-1-ddos/providers/Microsoft.Network/ddosProtectionPlans/root-id-1-ddos-northeurope\"},\"effect\":{\"value\":\"Modify\"}}",
              "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/94de2ad3-e0c1-4caf-ad78-5d47bbc83d3d",
              "resource_selectors": [],
              "timeouts": null
            },
            "sensitive_values": {
              "identity": [
                {}
              ],
              "non_compliance_message": [
                {}
              ],
              "not_scopes": [],
              "overrides": [],
              "resource_selectors": []
            }
          },
          {
            "address": "module.test_core.azurerm_management_group_policy_assignment.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1-decommissioned/providers/Microsoft.Authorization/policyAssignments/Enforce-ALZ-Decomm\"]",
            "mode": "managed",
            "type": "azurerm_management_group_policy_assignment",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1-decommissioned/providers/Microsoft.Authorization/policyAssignments/Enforce-ALZ-Decomm",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "This initiative will help enforce and govern subscriptions that are placed within the decommissioned Management Group as part of your Subscription decommissioning process. See https://aka.ms/alz/policies for more information.",
              "display_name": "Enforce ALZ Decommissioned Guardrails",
              "enforce": true,
              "identity": [
                {
                  "identity_ids": null,
                  "type": "SystemAssigned"
                }
              ],
              "location": "northeurope",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1-decommissioned",
              "name": "Enforce-ALZ-Decomm",
              "non_compliance_message": [
                {
                  "content": "This resource must be compliant with the assigned policy.",
                  "policy_definition_reference_id": null
                }
              ],
              "not_scopes": [],
              "overrides": [],
              "parameters": "{\"listOfResourceTypesAllowed\":{\"value\":[\"microsoft.consumption/tags\",\"microsoft.authorization/roleassignments\",\"microsoft.authorization/roledefinitions\",\"microsoft.authorization/policyassignments\",\"microsoft.authorization/locks\",\"microsoft.authorization/policydefinitions\",\"microsoft.authorization/policysetdefinitions\",\"microsoft.resources/tags\",\"microsoft.authorization/roleeligibilityschedules\",\"microsoft.authorization/roleeligibilityscheduleinstances\",\"microsoft.authorization/roleassignmentschedules\",\"microsoft.authorization/roleassignmentscheduleinstances\"]}}",
              "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Enforce-ALZ-Decomm",
              "resource_selectors": [],
              "timeouts": null
            },
            "sensitive_values": {
              "identity": [
                {}
              ],
              "non_compliance_message": [
                {}
              ],
              "not_scopes": [],
              "overrides": [],
              "resource_selectors": []
            }
          },
          {
            "address": "module.test_core.azurerm_management_group_policy_assignment.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1-identity/providers/Microsoft.Authorization/policyAssignments/Deny-MgmtPorts-Internet\"]",
            "mode": "managed",
            "type": "azurerm_management_group_policy_assignment",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1-identity/providers/Microsoft.Authorization/policyAssignments/Deny-MgmtPorts-Internet",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "This policy denies any network security rule that allows management port access from the Internet",
              "display_name": "Management port access from the Internet should be blocked",
              "enforce": true,
              "identity": [],
              "location": "northeurope",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1-identity",
              "name": "Deny-MgmtPorts-Internet",
              "non_compliance_message": [
                {
                  "content": "Management port access from the Internet must be blocked.",
                  "policy_definition_reference_id": null
                }
              ],
              "not_scopes": [],
              "overrides": [],
              "parameters": null,
              "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-MgmtPorts-From-Internet",
              "resource_selectors": [],
              "timeouts": null
            },
            "sensitive_values": {
              "identity": [],
              "non_compliance_message": [
                {}
              ],
              "not_scopes": [],
              "overrides": [],
              "resource_selectors": []
            }
          },
          {
            "address": "module.test_core.azurerm_management_group_policy_assignment.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1-identity/providers/Microsoft.Authorization/policyAssignments/Deny-Public-IP\"]",
            "mode": "managed",
            "type": "azurerm_management_group_policy_assignment",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1-identity/providers/Microsoft.Authorization/policyAssignments/Deny-Public-IP",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "This policy denies creation of Public IPs under the assigned scope.",
              "display_name": "Deny the creation of public IP",
              "enforce": false,
              "identity": [],
              "location": "northeurope",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1-identity",
              "name": "Deny-Public-IP",
              "non_compliance_message": [
                {
                  "content": "Public IPs should not be created under this scope.",
                  "policy_definition_reference_id": null
                }
              ],
              "not_scopes": [],
              "overrides": [],
              "parameters": "{\"effect\":{\"value\":\"Deny\"},\"listOfResourceTypesNotAllowed\":{\"value\":[\"Microsoft.Network/publicIPAddresses\"]}}",
              "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/6c112d4e-5bc7-47ae-a041-ea2d9dccd749",
              "resource_selectors": [],
              "timeouts": null
            },
            "sensitive_values": {
              "identity": [],
              "non_compliance_message": [
                {}
              ],
              "not_scopes": [],
              "overrides": [],
              "resource_selectors": []
            }
          },
          {
            "address": "module.test_core.azurerm_management_group_policy_assignment.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1-identity/providers/Microsoft.Authorization/policyAssignments/Deny-Subnet-Without-Nsg\"]",
            "mode": "managed",
            "type": "azurerm_management_group_policy_assignment",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1-identity/providers/Microsoft.Authorization/policyAssignments/Deny-Subnet-Without-Nsg",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "This policy denies the creation of a subnet without a Network Security Group to protect traffic across subnets.",
              "display_name": "Subnets should have a Network Security Group",
              "enforce": false,
              "identity": [],
              "location": "northeurope",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1-identity",
              "name": "Deny-Subnet-Without-Nsg",
              "non_compliance_message": [
                {
                  "content": "Subnets should have a Network Security Group.",
                  "policy_definition_reference_id": null
                }
              ],
              "not_scopes": [],
              "overrides": [],
              "parameters": "{\"effect\":{\"value\":\"Deny\"}}",
              "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-Subnet-Without-Nsg",
              "resource_selectors": [],
              "timeouts": null
            },
            "sensitive_values": {
              "identity": [],
              "non_compliance_message": [
                {}
              ],
              "not_scopes": [],
              "overrides": [],
              "resource_selectors": []
            }
          },
          {
            "address": "module.test_core.azurerm_management_group_policy_assignment.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1-identity/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-Backup\"]",
            "mode": "managed",
            "type": "azurerm_management_group_policy_assignment",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1-identity/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-Backup",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Enforce backup for all virtual machines by deploying a recovery services vault in the same location and resource group as the virtual machine. Doing this is useful when different application teams in your organization are allocated separate resource groups and need to manage their own backups and restores. You can optionally exclude virtual machines containing a specified tag to control the scope of assignment. See https://aka.ms/AzureVMAppCentricBackupExcludeTag.",
              "display_name": "Configure backup on virtual machines without a given tag to a new recovery services vault with a default policy",
              "enforce": false,
              "identity": [
                {
                  "identity_ids": null,
                  "type": "SystemAssigned"
                }
              ],
              "location": "northeurope",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1-identity",
              "name": "Deploy-VM-Backup",
              "non_compliance_message": [
                {
                  "content": "Backup on virtual machines without a given tag should be configured to a new recovery services vault with a default policy.",
                  "policy_definition_reference_id": null
                }
              ],
              "not_scopes": [],
              "overrides": [],
              "parameters": "{\"effect\":{\"value\":\"deployIfNotExists\"},\"exclusionTagName\":{\"value\":\"\"},\"exclusionTagValue\":{\"value\":[]}}",
              "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/98d0b9f8-fd90-49c9-88e2-d3baf3b0dd86",
              "resource_selectors": [],
              "timeouts": null
            },
            "sensitive_values": {
              "identity": [
                {}
              ],
              "non_compliance_message": [
                {}
              ],
              "not_scopes": [],
              "overrides": [],
              "resource_selectors": []
            }
          },
          {
            "address": "module.test_core.azurerm_management_group_policy_assignment.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Audit-AppGW-WAF\"]",
            "mode": "managed",
            "type": "azurerm_management_group_policy_assignment",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Audit-AppGW-WAF",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Assign the WAF should be enabled for Application Gateway audit policy.",
              "display_name": "Web Application Firewall (WAF) should be enabled for Application Gateway",
              "enforce": true,
              "identity": [],
              "location": "northeurope",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones",
              "name": "Audit-AppGW-WAF",
              "non_compliance_message": [
                {
                  "content": "Web Application Firewall (WAF) must be enabled for Application Gateway.",
                  "policy_definition_reference_id": null
                }
              ],
              "not_scopes": [],
              "overrides": [],
              "parameters": "{\"effect\":{\"value\":\"Audit\"}}",
              "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/564feb30-bf6a-4854-b4bb-0d2d2d1e6c66",
              "resource_selectors": [],
              "timeouts": null
            },
            "sensitive_values": {
              "identity": [],
              "non_compliance_message": [
                {}
              ],
              "not_scopes": [],
              "overrides": [],
              "resource_selectors": []
            }
          },
          {
            "address": "module.test_core.azurerm_management_group_policy_assignment.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deny-IP-forwarding\"]",
            "mode": "managed",
            "type": "azurerm_management_group_policy_assignment",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deny-IP-forwarding",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "This policy denies the network interfaces which enabled IP forwarding. The setting of IP forwarding disables Azure's check of the source and destination for a network interface. This should be reviewed by the network security team.",
              "display_name": "Network interfaces should disable IP forwarding",
              "enforce": true,
              "identity": [],
              "location": "northeurope",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones",
              "name": "Deny-IP-forwarding",
              "non_compliance_message": [
                {
                  "content": "Network interfaces must disable IP forwarding.",
                  "policy_definition_reference_id": null
                }
              ],
              "not_scopes": [],
              "overrides": [],
              "parameters": null,
              "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/88c0b9da-ce96-4b03-9635-f29a937e2900",
              "resource_selectors": [],
              "timeouts": null
            },
            "sensitive_values": {
              "identity": [],
              "non_compliance_message": [
                {}
              ],
              "not_scopes": [],
              "overrides": [],
              "resource_selectors": []
            }
          },
          {
            "address": "module.test_core.azurerm_management_group_policy_assignment.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deny-MgmtPorts-Internet\"]",
            "mode": "managed",
            "type": "azurerm_management_group_policy_assignment",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deny-MgmtPorts-Internet",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "This policy denies any network security rule that allows management port access from the Internet",
              "display_name": "Management port access from the Internet should be blocked",
              "enforce": true,
              "identity": [],
              "location": "northeurope",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones",
              "name": "Deny-MgmtPorts-Internet",
              "non_compliance_message": [
                {
                  "content": "Management port access from the Internet must be blocked.",
                  "policy_definition_reference_id": null
                }
              ],
              "not_scopes": [],
              "overrides": [],
              "parameters": null,
              "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-MgmtPorts-From-Internet",
              "resource_selectors": [],
              "timeouts": null
            },
            "sensitive_values": {
              "identity": [],
              "non_compliance_message": [
                {}
              ],
              "not_scopes": [],
              "overrides": [],
              "resource_selectors": []
            }
          },
          {
            "address": "module.test_core.azurerm_management_group_policy_assignment.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deny-Priv-Esc-AKS\"]",
            "mode": "managed",
            "type": "azurerm_management_group_policy_assignment",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deny-Priv-Esc-AKS",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Do not allow containers to run with privilege escalation to root in a Kubernetes cluster. This recommendation is part of CIS 5.2.5 which is intended to improve the security of your Kubernetes environments. This policy is generally available for Kubernetes Service (AKS), and preview for AKS Engine and Azure Arc enabled Kubernetes. For more information, see https://aka.ms/kubepolicydoc.",
              "display_name": "Kubernetes clusters should not allow container privilege escalation",
              "enforce": true,
              "identity": [],
              "location": "northeurope",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones",
              "name": "Deny-Priv-Esc-AKS",
              "non_compliance_message": [],
              "not_scopes": [],
              "overrides": [],
              "parameters": "{\"effect\":{\"value\":\"deny\"}}",
              "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/1c6e92c9-99f0-4e55-9cf2-0c234dc48f99",
              "resource_selectors": [],
              "timeouts": null
            },
            "sensitive_values": {
              "identity": [],
              "non_compliance_message": [],
              "not_scopes": [],
              "overrides": [],
              "resource_selectors": []
            }
          },
          {
            "address": "module.test_core.azurerm_management_group_policy_assignment.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deny-Privileged-AKS\"]",
            "mode": "managed",
            "type": "azurerm_management_group_policy_assignment",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deny-Privileged-AKS",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Do not allow privileged containers creation in a Kubernetes cluster. This recommendation is part of CIS 5.2.1 which is intended to improve the security of your Kubernetes environments. This policy is generally available for Kubernetes Service (AKS), and preview for AKS Engine and Azure Arc enabled Kubernetes. For more information, see https://aka.ms/kubepolicydoc.",
              "display_name": "Kubernetes cluster should not allow privileged containers",
              "enforce": true,
              "identity": [],
              "location": "northeurope",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones",
              "name": "Deny-Privileged-AKS",
              "non_compliance_message": [],
              "not_scopes": [],
              "overrides": [],
              "parameters": "{\"effect\":{\"value\":\"deny\"}}",
              "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/95edb821-ddaf-4404-9732-666045e056b4",
              "resource_selectors": [],
              "timeouts": null
            },
            "sensitive_values": {
              "identity": [],
              "non_compliance_message": [],
              "not_scopes": [],
              "overrides": [],
              "resource_selectors": []
            }
          },
          {
            "address": "module.test_core.azurerm_management_group_policy_assignment.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deny-Storage-http\"]",
            "mode": "managed",
            "type": "azurerm_management_group_policy_assignment",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deny-Storage-http",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Audit requirement of Secure transfer in your storage account. Secure transfer is an option that forces your storage account to accept requests only from secure connections (HTTPS). Use of HTTPS ensures authentication between the server and the service and protects data in transit from network layer attacks such as man-in-the-middle, eavesdropping, and session-hijacking",
              "display_name": "Secure transfer to storage accounts should be enabled",
              "enforce": true,
              "identity": [],
              "location": "northeurope",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones",
              "name": "Deny-Storage-http",
              "non_compliance_message": [
                {
                  "content": "Secure transfer to storage accounts must be enabled.",
                  "policy_definition_reference_id": null
                }
              ],
              "not_scopes": [],
              "overrides": [],
              "parameters": "{\"effect\":{\"value\":\"Deny\"}}",
              "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/404c3081-a854-4457-ae30-26a93ef643f9",
              "resource_selectors": [],
              "timeouts": null
            },
            "sensitive_values": {
              "identity": [],
              "non_compliance_message": [
                {}
              ],
              "not_scopes": [],
              "overrides": [],
              "resource_selectors": []
            }
          },
          {
            "address": "module.test_core.azurerm_management_group_policy_assignment.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deny-Subnet-Without-Nsg\"]",
            "mode": "managed",
            "type": "azurerm_management_group_policy_assignment",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deny-Subnet-Without-Nsg",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "This policy denies the creation of a subnet without a Network Security Group to protect traffic across subnets.",
              "display_name": "Subnets should have a Network Security Group",
              "enforce": true,
              "identity": [],
              "location": "northeurope",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones",
              "name": "Deny-Subnet-Without-Nsg",
              "non_compliance_message": [
                {
                  "content": "Subnets must have a Network Security Group.",
                  "policy_definition_reference_id": null
                }
              ],
              "not_scopes": [],
              "overrides": [],
              "parameters": null,
              "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-Subnet-Without-Nsg",
              "resource_selectors": [],
              "timeouts": null
            },
            "sensitive_values": {
              "identity": [],
              "non_compliance_message": [
                {}
              ],
              "not_scopes": [],
              "overrides": [],
              "resource_selectors": []
            }
          },
          {
            "address": "module.test_core.azurerm_management_group_policy_assignment.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-AKS-Policy\"]",
            "mode": "managed",
            "type": "azurerm_management_group_policy_assignment",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-AKS-Policy",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Use Azure Policy Add-on to manage and report on the compliance state of your Azure Kubernetes Service (AKS) clusters. For more information, see https://aka.ms/akspolicydoc.",
              "display_name": "Deploy Azure Policy Add-on to Azure Kubernetes Service clusters",
              "enforce": true,
              "identity": [
                {
                  "identity_ids": null,
                  "type": "SystemAssigned"
                }
              ],
              "location": "northeurope",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones",
              "name": "Deploy-AKS-Policy",
              "non_compliance_message": [
                {
                  "content": "This resource must be compliant with the assigned policy.",
                  "policy_definition_reference_id": null
                }
              ],
              "not_scopes": [],
              "overrides": [],
              "parameters": null,
              "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/a8eff44f-8c92-45c3-a3fb-9880802d67a7",
              "resource_selectors": [],
              "timeouts": null
            },
            "sensitive_values": {
              "identity": [
                {}
              ],
              "non_compliance_message": [
                {}
              ],
              "not_scopes": [],
              "overrides": [],
              "resource_selectors": []
            }
          },
          {
            "address": "module.test_core.azurerm_management_group_policy_assignment.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-AzSqlDb-Auditing\"]",
            "mode": "managed",
            "type": "azurerm_management_group_policy_assignment",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-AzSqlDb-Auditing",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "To ensure the operations performed against your SQL assets are captured, SQL servers should have auditing enabled. If auditing is not enabled, this policy will configure auditing events to flow to the specified Log Analytics workspace.",
              "display_name": "Configure SQL servers to have auditing enabled to Log Analytics workspace",
              "enforce": true,
              "identity": [
                {
                  "identity_ids": null,
                  "type": "SystemAssigned"
                }
              ],
              "location": "northeurope",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones",
              "name": "Deploy-AzSqlDb-Auditing",
              "non_compliance_message": [
                {
                  "content": "SQL servers must have auditing enabled to Log Analytics workspace.",
                  "policy_definition_reference_id": null
                }
              ],
              "not_scopes": [],
              "overrides": [],
              "parameters": "{\"logAnalyticsWorkspaceId\":{\"value\":\"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/root-id-1-mgmt/providers/microsoft.operationalinsights/workspaces/root-id-1-la\"}}",
              "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/25da7dfb-0666-4a15-a8f5-402127efd8bb",
              "resource_selectors": [],
              "timeouts": null
            },
            "sensitive_values": {
              "identity": [
                {}
              ],
              "non_compliance_message": [
                {}
              ],
              "not_scopes": [],
              "overrides": [],
              "resource_selectors": []
            }
          },
          {
            "address": "module.test_core.azurerm_management_group_policy_assignment.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-MDFC-DefSQL-AMA\"]",
            "mode": "managed",
            "type": "azurerm_management_group_policy_assignment",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-MDFC-DefSQL-AMA",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Microsoft Defender for SQL collects events from the agents and uses them to provide security alerts and tailored hardening tasks (recommendations).",
              "display_name": "Enable Defender for SQL on SQL VMs and Arc-enabled SQL Servers",
              "enforce": true,
              "identity": [
                {
                  "identity_ids": null,
                  "type": "SystemAssigned"
                }
              ],
              "location": "northeurope",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones",
              "name": "Deploy-MDFC-DefSQL-AMA",
              "non_compliance_message": [
                {
                  "content": "Microsoft Defender for SQL must be deployed.",
                  "policy_definition_reference_id": null
                }
              ],
              "not_scopes": [],
              "overrides": [],
              "parameters": "{\"bringYourOwnDcr\":{\"value\":true},\"bringYourOwnUserAssignedManagedIdentity\":{\"value\":true},\"dcrResourceId\":{\"value\":\"\"},\"enableCollectionOfSqlQueriesForSecurityResearch\":{\"value\":false},\"userAssignedIdentityResourceId\":{\"value\":\"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/root-id-1-mgmt/providers/Microsoft.ManagedIdentity/userAssignedIdentities/root-id-1-uami\"},\"userWorkspaceResourceId\":{\"value\":\"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/root-id-1-mgmt/providers/Microsoft.OperationalInsights/workspaces/root-id-1-la\"},\"workspaceRegion\":{\"value\":\"northeurope\"}}",
              "policy_definition_id": "/providers/Microsoft.Authorization/policySetDefinitions/de01d381-bae9-4670-8870-786f89f49e26",
              "resource_selectors": [],
              "timeouts": null
            },
            "sensitive_values": {
              "identity": [
                {}
              ],
              "non_compliance_message": [
                {}
              ],
              "not_scopes": [],
              "overrides": [],
              "resource_selectors": []
            }
          },
          {
            "address": "module.test_core.azurerm_management_group_policy_assignment.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-SQL-TDE\"]",
            "mode": "managed",
            "type": "azurerm_management_group_policy_assignment",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-SQL-TDE",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "This policy ensures that Transparent Data Encryption is enabled on SQL Servers.",
              "display_name": "Deploy TDE on SQL servers",
              "enforce": true,
              "identity": [
                {
                  "identity_ids": null,
                  "type": "SystemAssigned"
                }
              ],
              "location": "northeurope",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones",
              "name": "Deploy-SQL-TDE",
              "non_compliance_message": [
                {
                  "content": "TDE must be deployed on SQL servers.",
                  "policy_definition_reference_id": null
                }
              ],
              "not_scopes": [],
              "overrides": [],
              "parameters": null,
              "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/86a912f6-9a06-4e26-b447-11b16ba8659f",
              "resource_selectors": [],
              "timeouts": null
            },
            "sensitive_values": {
              "identity": [
                {}
              ],
              "non_compliance_message": [
                {}
              ],
              "not_scopes": [],
              "overrides": [],
              "resource_selectors": []
            }
          },
          {
            "address": "module.test_core.azurerm_management_group_policy_assignment.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-SQL-Threat\"]",
            "mode": "managed",
            "type": "azurerm_management_group_policy_assignment",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-SQL-Threat",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "This policy ensures that Threat Detection is enabled on SQL Servers.",
              "display_name": "Deploy Threat Detection on SQL servers",
              "enforce": true,
              "identity": [
                {
                  "identity_ids": null,
                  "type": "SystemAssigned"
                }
              ],
              "location": "northeurope",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones",
              "name": "Deploy-SQL-Threat",
              "non_compliance_message": [
                {
                  "content": "Threat Detection must be deployed on SQL servers.",
                  "policy_definition_reference_id": null
                }
              ],
              "not_scopes": [],
              "overrides": [],
              "parameters": null,
              "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/36d49e87-48c4-4f2e-beed-ba4ed02b71f5",
              "resource_selectors": [],
              "timeouts": null
            },
            "sensitive_values": {
              "identity": [
                {}
              ],
              "non_compliance_message": [
                {}
              ],
              "not_scopes": [],
              "overrides": [],
              "resource_selectors": []
            }
          },
          {
            "address": "module.test_core.azurerm_management_group_policy_assignment.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-Backup\"]",
            "mode": "managed",
            "type": "azurerm_management_group_policy_assignment",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-Backup",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Enforce backup for all virtual machines by deploying a recovery services vault in the same location and resource group as the virtual machine. Doing this is useful when different application teams in your organization are allocated separate resource groups and need to manage their own backups and restores. You can optionally exclude virtual machines containing a specified tag to control the scope of assignment. See https://aka.ms/AzureVMAppCentricBackupExcludeTag.",
              "display_name": "Configure backup on virtual machines without a given tag to a new recovery services vault with a default policy",
              "enforce": true,
              "identity": [
                {
                  "identity_ids": null,
                  "type": "SystemAssigned"
                }
              ],
              "location": "northeurope",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones",
              "name": "Deploy-VM-Backup",
              "non_compliance_message": [
                {
                  "content": "Backup on virtual machines without a given tag must be configured to a new recovery services vault with a default policy.",
                  "policy_definition_reference_id": null
                }
              ],
              "not_scopes": [],
              "overrides": [],
              "parameters": null,
              "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/98d0b9f8-fd90-49c9-88e2-d3baf3b0dd86",
              "resource_selectors": [],
              "timeouts": null
            },
            "sensitive_values": {
              "identity": [
                {}
              ],
              "non_compliance_message": [
                {}
              ],
              "not_scopes": [],
              "overrides": [],
              "resource_selectors": []
            }
          },
          {
            "address": "module.test_core.azurerm_management_group_policy_assignment.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-ChangeTrack\"]",
            "mode": "managed",
            "type": "azurerm_management_group_policy_assignment",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-ChangeTrack",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Enable ChangeTracking and Inventory for virtual machines. Takes Data Collection Rule ID as parameter and asks for an option to input applicable locations and user-assigned identity for Azure Monitor Agent.",
              "display_name": "Enable ChangeTracking and Inventory for virtual machines",
              "enforce": true,
              "identity": [
                {
                  "identity_ids": null,
                  "type": "SystemAssigned"
                }
              ],
              "location": "northeurope",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones",
              "name": "Deploy-VM-ChangeTrack",
              "non_compliance_message": [
                {
                  "content": "Change Tracking must be enabled for Virtual Machines.",
                  "policy_definition_reference_id": null
                }
              ],
              "not_scopes": [],
              "overrides": [],
              "parameters": "{\"bringYourOwnUserAssignedManagedIdentity\":{\"value\":true},\"dcrResourceId\":{\"value\":\"\"},\"effect\":{\"value\":\"DeployIfNotExists\"},\"restrictBringYourOwnUserAssignedIdentityToSubscription\":{\"value\":false},\"userAssignedIdentityResourceId\":{\"value\":\"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/root-id-1-mgmt/providers/Microsoft.ManagedIdentity/userAssignedIdentities/root-id-1-uami\"}}",
              "policy_definition_id": "/providers/Microsoft.Authorization/policySetDefinitions/92a36f05-ebc9-4bba-9128-b47ad2ea3354",
              "resource_selectors": [],
              "timeouts": null
            },
            "sensitive_values": {
              "identity": [
                {}
              ],
              "non_compliance_message": [
                {}
              ],
              "not_scopes": [],
              "overrides": [],
              "resource_selectors": []
            }
          },
          {
            "address": "module.test_core.azurerm_management_group_policy_assignment.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-Monitoring\"]",
            "mode": "managed",
            "type": "azurerm_management_group_policy_assignment",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-Monitoring",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Enable Azure Monitor for the virtual machines (VMs) in the specified scope (management group, subscription or resource group). Takes Log Analytics workspace as parameter.",
              "display_name": "Enable Azure Monitor for VMs",
              "enforce": true,
              "identity": [
                {
                  "identity_ids": null,
                  "type": "SystemAssigned"
                }
              ],
              "location": "northeurope",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones",
              "name": "Deploy-VM-Monitoring",
              "non_compliance_message": [
                {
                  "content": "Azure Monitor must be enabled for Virtual Machines.",
                  "policy_definition_reference_id": null
                }
              ],
              "not_scopes": [],
              "overrides": [],
              "parameters": "{\"bringYourOwnUserAssignedManagedIdentity\":{\"value\":true},\"dcrResourceId\":{\"value\":\"\"},\"enableProcessesAndDependencies\":{\"value\":true},\"restrictBringYourOwnUserAssignedIdentityToSubscription\":{\"value\":false},\"scopeToSupportedImages\":{\"value\":false},\"userAssignedIdentityResourceId\":{\"value\":\"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/root-id-1-mgmt/providers/Microsoft.ManagedIdentity/userAssignedIdentities/root-id-1-uami\"}}",
              "policy_definition_id": "/providers/Microsoft.Authorization/policySetDefinitions/924bfe3a-762f-40e7-86dd-5c8b95eb09e6",
              "resource_selectors": [],
              "timeouts": null
            },
            "sensitive_values": {
              "identity": [
                {}
              ],
              "non_compliance_message": [
                {}
              ],
              "not_scopes": [],
              "overrides": [],
              "resource_selectors": []
            }
          },
          {
            "address": "module.test_core.azurerm_management_group_policy_assignment.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-VMSS-ChangeTrack\"]",
            "mode": "managed",
            "type": "azurerm_management_group_policy_assignment",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-VMSS-ChangeTrack",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Enable ChangeTracking and Inventory for virtual machine scale sets. Takes Data Collection Rule ID as parameter and asks for an option to input applicable locations and user-assigned identity for Azure Monitor Agent.",
              "display_name": "Enable ChangeTracking and Inventory for virtual machine scale sets",
              "enforce": true,
              "identity": [
                {
                  "identity_ids": null,
                  "type": "SystemAssigned"
                }
              ],
              "location": "northeurope",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones",
              "name": "Deploy-VMSS-ChangeTrack",
              "non_compliance_message": [
                {
                  "content": "Change Tracking must be enabled for Virtual Machines Scales Sets.",
                  "policy_definition_reference_id": null
                }
              ],
              "not_scopes": [],
              "overrides": [],
              "parameters": "{\"bringYourOwnUserAssignedManagedIdentity\":{\"value\":true},\"dcrResourceId\":{\"value\":\"\"},\"effect\":{\"value\":\"DeployIfNotExists\"},\"restrictBringYourOwnUserAssignedIdentityToSubscription\":{\"value\":false},\"userAssignedIdentityResourceId\":{\"value\":\"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/root-id-1-mgmt/providers/Microsoft.ManagedIdentity/userAssignedIdentities/root-id-1-uami\"}}",
              "policy_definition_id": "/providers/Microsoft.Authorization/policySetDefinitions/c4a70814-96be-461c-889f-2b27429120dc",
              "resource_selectors": [],
              "timeouts": null
            },
            "sensitive_values": {
              "identity": [
                {}
              ],
              "non_compliance_message": [
                {}
              ],
              "not_scopes": [],
              "overrides": [],
              "resource_selectors": []
            }
          },
          {
            "address": "module.test_core.azurerm_management_group_policy_assignment.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-VMSS-Monitoring\"]",
            "mode": "managed",
            "type": "azurerm_management_group_policy_assignment",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-VMSS-Monitoring",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Enable Azure Monitor for the Virtual Machine Scale Sets in the specified scope (Management group, Subscription or resource group). Takes Log Analytics workspace as parameter. Note: if your scale set upgradePolicy is set to Manual, you need to apply the extension to the all VMs in the set by calling upgrade on them. In CLI this would be az vmss update-instances.",
              "display_name": "Enable Azure Monitor for Virtual Machine Scale Sets",
              "enforce": true,
              "identity": [
                {
                  "identity_ids": null,
                  "type": "SystemAssigned"
                }
              ],
              "location": "northeurope",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones",
              "name": "Deploy-VMSS-Monitoring",
              "non_compliance_message": [
                {
                  "content": "Azure Monitor must be enabled for Virtual Machines Scales Sets.",
                  "policy_definition_reference_id": null
                }
              ],
              "not_scopes": [],
              "overrides": [],
              "parameters": "{\"bringYourOwnUserAssignedManagedIdentity\":{\"value\":true},\"dcrResourceId\":{\"value\":\"\"},\"enableProcessesAndDependencies\":{\"value\":true},\"restrictBringYourOwnUserAssignedIdentityToSubscription\":{\"value\":false},\"scopeToSupportedImages\":{\"value\":false},\"userAssignedIdentityResourceId\":{\"value\":\"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/root-id-1-mgmt/providers/Microsoft.ManagedIdentity/userAssignedIdentities/root-id-1-uami\"}}",
              "policy_definition_id": "/providers/Microsoft.Authorization/policySetDefinitions/f5bf694c-cca7-4033-b883-3a23327d5485",
              "resource_selectors": [],
              "timeouts": null
            },
            "sensitive_values": {
              "identity": [
                {}
              ],
              "non_compliance_message": [
                {}
              ],
              "not_scopes": [],
              "overrides": [],
              "resource_selectors": []
            }
          },
          {
            "address": "module.test_core.azurerm_management_group_policy_assignment.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-vmArc-ChangeTrack\"]",
            "mode": "managed",
            "type": "azurerm_management_group_policy_assignment",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-vmArc-ChangeTrack",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Enable ChangeTracking and Inventory for Arc-enabled virtual machines. Takes Data Collection Rule ID as parameter and asks for an option to input applicable locations.",
              "display_name": "Enable ChangeTracking and Inventory for Arc-enabled virtual machines",
              "enforce": true,
              "identity": [
                {
                  "identity_ids": null,
                  "type": "SystemAssigned"
                }
              ],
              "location": "northeurope",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones",
              "name": "Deploy-vmArc-ChangeTrack",
              "non_compliance_message": [
                {
                  "content": "Change Tracking must be enabled for Arc-enabled Virtual Machines.",
                  "policy_definition_reference_id": null
                }
              ],
              "not_scopes": [],
              "overrides": [],
              "parameters": "{\"dcrResourceId\":{\"value\":\"\"},\"effect\":{\"value\":\"DeployIfNotExists\"}}",
              "policy_definition_id": "/providers/Microsoft.Authorization/policySetDefinitions/53448c70-089b-4f52-8f38-89196d7f2de1",
              "resource_selectors": [],
              "timeouts": null
            },
            "sensitive_values": {
              "identity": [
                {}
              ],
              "non_compliance_message": [
                {}
              ],
              "not_scopes": [],
              "overrides": [],
              "resource_selectors": []
            }
          },
          {
            "address": "module.test_core.azurerm_management_group_policy_assignment.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Enable-AUM-CheckUpdates\"]",
            "mode": "managed",
            "type": "azurerm_management_group_policy_assignment",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Enable-AUM-CheckUpdates",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Configure auto-assessment (every 24 hours) for OS updates. You can control the scope of assignment according to machine subscription, resource group, location or tag. Learn more about this for Windows: https://aka.ms/computevm-windowspatchassessmentmode, for Linux: https://aka.ms/computevm-linuxpatchassessmentmode.",
              "display_name": "Configure periodic checking for missing system updates on azure virtual machines and Arc-enabled virtual machines.",
              "enforce": true,
              "identity": [
                {
                  "identity_ids": null,
                  "type": "SystemAssigned"
                }
              ],
              "location": "northeurope",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones",
              "name": "Enable-AUM-CheckUpdates",
              "non_compliance_message": [
                {
                  "content": "Periodic checking of missing updates must be enabled.",
                  "policy_definition_reference_id": null
                }
              ],
              "not_scopes": [],
              "overrides": [],
              "parameters": "{\"assessmentMode\":{\"value\":\"AutomaticByPlatform\"},\"locations\":{\"value\":[]},\"tagOperator\":{\"value\":\"Any\"},\"tagValues\":{\"value\":{}}}",
              "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Deploy-AUM-CheckUpdates",
              "resource_selectors": [],
              "timeouts": null
            },
            "sensitive_values": {
              "identity": [
                {}
              ],
              "non_compliance_message": [
                {}
              ],
              "not_scopes": [],
              "overrides": [],
              "resource_selectors": []
            }
          },
          {
            "address": "module.test_core.azurerm_management_group_policy_assignment.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Enable-DDoS-VNET\"]",
            "mode": "managed",
            "type": "azurerm_management_group_policy_assignment",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Enable-DDoS-VNET",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Protect your virtual networks against volumetric and protocol attacks with Azure DDoS Network Protection. For more information, visit https://aka.ms/ddosprotectiondocs.",
              "display_name": "Virtual networks should be protected by Azure DDoS Network Protection",
              "enforce": false,
              "identity": [
                {
                  "identity_ids": null,
                  "type": "SystemAssigned"
                }
              ],
              "location": "northeurope",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones",
              "name": "Enable-DDoS-VNET",
              "non_compliance_message": [
                {
                  "content": "This resource should be compliant with the assigned policy.",
                  "policy_definition_reference_id": null
                }
              ],
              "not_scopes": [],
              "overrides": [],
              "parameters": "{\"ddosPlan\":{\"value\":\"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/root-id-1-ddos/providers/Microsoft.Network/ddosProtectionPlans/root-id-1-ddos-northeurope\"},\"effect\":{\"value\":\"Modify\"}}",
              "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/94de2ad3-e0c1-4caf-ad78-5d47bbc83d3d",
              "resource_selectors": [],
              "timeouts": null
            },
            "sensitive_values": {
              "identity": [
                {}
              ],
              "non_compliance_message": [
                {}
              ],
              "not_scopes": [],
              "overrides": [],
              "resource_selectors": []
            }
          },
          {
            "address": "module.test_core.azurerm_management_group_policy_assignment.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Enforce-AKS-HTTPS\"]",
            "mode": "managed",
            "type": "azurerm_management_group_policy_assignment",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Enforce-AKS-HTTPS",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Use of HTTPS ensures authentication and protects data in transit from network layer eavesdropping attacks. This capability is currently generally available for Kubernetes Service (AKS), and in preview for AKS Engine and Azure Arc enabled Kubernetes. For more info, visit https://aka.ms/kubepolicydoc",
              "display_name": "Kubernetes clusters should be accessible only over HTTPS",
              "enforce": true,
              "identity": [],
              "location": "northeurope",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones",
              "name": "Enforce-AKS-HTTPS",
              "non_compliance_message": [],
              "not_scopes": [],
              "overrides": [],
              "parameters": "{\"effect\":{\"value\":\"deny\"}}",
              "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/1a5b4dca-0b6f-4cf5-907c-56316bc1bf3d",
              "resource_selectors": [],
              "timeouts": null
            },
            "sensitive_values": {
              "identity": [],
              "non_compliance_message": [],
              "not_scopes": [],
              "overrides": [],
              "resource_selectors": []
            }
          },
          {
            "address": "module.test_core.azurerm_management_group_policy_assignment.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-KeyVault\"]",
            "mode": "managed",
            "type": "azurerm_management_group_policy_assignment",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-KeyVault",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "This initiative assignment enables recommended ALZ guardrails for Azure Key Vault.",
              "display_name": "Enforce recommended guardrails for Azure Key Vault",
              "enforce": true,
              "identity": [],
              "location": "northeurope",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones",
              "name": "Enforce-GR-KeyVault",
              "non_compliance_message": [
                {
                  "content": "This resource must be compliant with the assigned policy.",
                  "policy_definition_reference_id": null
                }
              ],
              "not_scopes": [],
              "overrides": [],
              "parameters": null,
              "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-KeyVault",
              "resource_selectors": [],
              "timeouts": null
            },
            "sensitive_values": {
              "identity": [],
              "non_compliance_message": [
                {}
              ],
              "not_scopes": [],
              "overrides": [],
              "resource_selectors": []
            }
          },
          {
            "address": "module.test_core.azurerm_management_group_policy_assignment.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Enforce-TLS-SSL-H224\"]",
            "mode": "managed",
            "type": "azurerm_management_group_policy_assignment",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Enforce-TLS-SSL-H224",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Choose either Deploy if not exist and append in combination with audit or Select Deny in the Policy effect. Deny polices shift left. Deploy if not exist and append enforce but can be changed, and because missing existence condition require then the combination of Audit.",
              "display_name": "Deny or Deploy and append TLS requirements and SSL enforcement on resources without Encryption in transit",
              "enforce": true,
              "identity": [
                {
                  "identity_ids": null,
                  "type": "SystemAssigned"
                }
              ],
              "location": "northeurope",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones",
              "name": "Enforce-TLS-SSL-H224",
              "non_compliance_message": [
                {
                  "content": "TLS and SSL must be enabled for on resources without encryption in transit.",
                  "policy_definition_reference_id": null
                }
              ],
              "not_scopes": [],
              "overrides": [],
              "parameters": null,
              "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Enforce-EncryptTransit_20240509",
              "resource_selectors": [],
              "timeouts": null
            },
            "sensitive_values": {
              "identity": [
                {}
              ],
              "non_compliance_message": [
                {}
              ],
              "not_scopes": [],
              "overrides": [],
              "resource_selectors": []
            }
          },
          {
            "address": "module.test_core.azurerm_management_group_policy_assignment.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1-management/providers/Microsoft.Authorization/policyAssignments/Deploy-Log-Analytics\"]",
            "mode": "managed",
            "type": "azurerm_management_group_policy_assignment",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1-management/providers/Microsoft.Authorization/policyAssignments/Deploy-Log-Analytics",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Deploy resource group containing Log Analytics workspace and linked automation account to centralize logs and monitoring. The automation account is aprerequisite for solutions like Updates and Change Tracking.",
              "display_name": "Configure Log Analytics workspace and automation account to centralize logs and monitoring",
              "enforce": false,
              "identity": [
                {
                  "identity_ids": null,
                  "type": "SystemAssigned"
                }
              ],
              "location": "northeurope",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1-management",
              "name": "Deploy-Log-Analytics",
              "non_compliance_message": [
                {
                  "content": "Log Analytics workspace and automation account should be configured to centralize logs and monitoring.",
                  "policy_definition_reference_id": null
                }
              ],
              "not_scopes": [],
              "overrides": [],
              "parameters": "{\"automationAccountName\":{\"value\":\"root-id-1-automation\"},\"automationRegion\":{\"value\":\"northeurope\"},\"dataRetention\":{\"value\":\"30\"},\"rgName\":{\"value\":\"root-id-1-mgmt\"},\"sku\":{\"value\":\"pergb2018\"},\"workspaceName\":{\"value\":\"root-id-1-la\"},\"workspaceRegion\":{\"value\":\"northeurope\"}}",
              "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/8e3e61b3-0b32-22d5-4edf-55f87fdb5955",
              "resource_selectors": [],
              "timeouts": null
            },
            "sensitive_values": {
              "identity": [
                {}
              ],
              "non_compliance_message": [
                {}
              ],
              "not_scopes": [],
              "overrides": [],
              "resource_selectors": []
            }
          },
          {
            "address": "module.test_core.azurerm_management_group_policy_assignment.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/policyAssignments/DenyAction-DeleteUAMIAMA\"]",
            "mode": "managed",
            "type": "azurerm_management_group_policy_assignment",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/policyAssignments/DenyAction-DeleteUAMIAMA",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "This policy provides a safeguard against accidental removal of the User Assigned Managed Identity used by AMA by blocking delete calls using deny action effect.",
              "display_name": "Do not allow deletion of the User Assigned Managed Identity used by AMA",
              "enforce": true,
              "identity": [],
              "location": "northeurope",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1-platform",
              "name": "DenyAction-DeleteUAMIAMA",
              "non_compliance_message": [
                {
                  "content": "This resource must be compliant with the assigned policy.",
                  "policy_definition_reference_id": null
                }
              ],
              "not_scopes": [],
              "overrides": [],
              "parameters": "{\"effect\":{\"value\":\"DenyAction\"},\"resourceName\":{\"value\":\"defaultString3\"},\"resourceType\":{\"value\":\"defaultString4\"}}",
              "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/DenyAction-DeleteResources",
              "resource_selectors": [],
              "timeouts": null
            },
            "sensitive_values": {
              "identity": [],
              "non_compliance_message": [
                {}
              ],
              "not_scopes": [],
              "overrides": [],
              "resource_selectors": []
            }
          },
          {
            "address": "module.test_core.azurerm_management_group_policy_assignment.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/policyAssignments/Deploy-MDFC-DefSQL-AMA\"]",
            "mode": "managed",
            "type": "azurerm_management_group_policy_assignment",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/policyAssignments/Deploy-MDFC-DefSQL-AMA",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Microsoft Defender for SQL collects events from the agents and uses them to provide security alerts and tailored hardening tasks (recommendations).",
              "display_name": "Enable Defender for SQL on SQL VMs and Arc-enabled SQL Servers",
              "enforce": true,
              "identity": [
                {
                  "identity_ids": null,
                  "type": "SystemAssigned"
                }
              ],
              "location": "northeurope",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1-platform",
              "name": "Deploy-MDFC-DefSQL-AMA",
              "non_compliance_message": [
                {
                  "content": "Microsoft Defender for SQL must be deployed.",
                  "policy_definition_reference_id": null
                }
              ],
              "not_scopes": [],
              "overrides": [],
              "parameters": "{\"bringYourOwnDcr\":{\"value\":true},\"bringYourOwnUserAssignedManagedIdentity\":{\"value\":true},\"dcrResourceId\":{\"value\":\"\"},\"enableCollectionOfSqlQueriesForSecurityResearch\":{\"value\":false},\"userAssignedIdentityResourceId\":{\"value\":\"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/root-id-1-mgmt/providers/Microsoft.ManagedIdentity/userAssignedIdentities/root-id-1-uami\"},\"userWorkspaceResourceId\":{\"value\":\"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/root-id-1-mgmt/providers/Microsoft.OperationalInsights/workspaces/root-id-1-la\"},\"workspaceRegion\":{\"value\":\"northeurope\"}}",
              "policy_definition_id": "/providers/Microsoft.Authorization/policySetDefinitions/de01d381-bae9-4670-8870-786f89f49e26",
              "resource_selectors": [],
              "timeouts": null
            },
            "sensitive_values": {
              "identity": [
                {}
              ],
              "non_compliance_message": [
                {}
              ],
              "not_scopes": [],
              "overrides": [],
              "resource_selectors": []
            }
          },
          {
            "address": "module.test_core.azurerm_management_group_policy_assignment.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-ChangeTrack\"]",
            "mode": "managed",
            "type": "azurerm_management_group_policy_assignment",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-ChangeTrack",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Enable ChangeTracking and Inventory for virtual machines. Takes Data Collection Rule ID as parameter and asks for an option to input applicable locations and user-assigned identity for Azure Monitor Agent.",
              "display_name": "Enable ChangeTracking and Inventory for virtual machines",
              "enforce": true,
              "identity": [
                {
                  "identity_ids": null,
                  "type": "SystemAssigned"
                }
              ],
              "location": "northeurope",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1-platform",
              "name": "Deploy-VM-ChangeTrack",
              "non_compliance_message": [
                {
                  "content": "Change Tracking must be enabled for Virtual Machines.",
                  "policy_definition_reference_id": null
                }
              ],
              "not_scopes": [],
              "overrides": [],
              "parameters": "{\"bringYourOwnUserAssignedManagedIdentity\":{\"value\":true},\"dcrResourceId\":{\"value\":\"\"},\"effect\":{\"value\":\"DeployIfNotExists\"},\"restrictBringYourOwnUserAssignedIdentityToSubscription\":{\"value\":false},\"userAssignedIdentityResourceId\":{\"value\":\"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/root-id-1-mgmt/providers/Microsoft.ManagedIdentity/userAssignedIdentities/root-id-1-uami\"}}",
              "policy_definition_id": "/providers/Microsoft.Authorization/policySetDefinitions/92a36f05-ebc9-4bba-9128-b47ad2ea3354",
              "resource_selectors": [],
              "timeouts": null
            },
            "sensitive_values": {
              "identity": [
                {}
              ],
              "non_compliance_message": [
                {}
              ],
              "not_scopes": [],
              "overrides": [],
              "resource_selectors": []
            }
          },
          {
            "address": "module.test_core.azurerm_management_group_policy_assignment.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-Monitoring\"]",
            "mode": "managed",
            "type": "azurerm_management_group_policy_assignment",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-Monitoring",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Enable Azure Monitor for the virtual machines (VMs) in the specified scope (management group, subscription or resource group). Takes Log Analytics workspace as parameter.",
              "display_name": "Enable Azure Monitor for VMs",
              "enforce": true,
              "identity": [
                {
                  "identity_ids": null,
                  "type": "SystemAssigned"
                }
              ],
              "location": "northeurope",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1-platform",
              "name": "Deploy-VM-Monitoring",
              "non_compliance_message": [
                {
                  "content": "Azure Monitor must be enabled for Virtual Machines.",
                  "policy_definition_reference_id": null
                }
              ],
              "not_scopes": [],
              "overrides": [],
              "parameters": "{\"bringYourOwnUserAssignedManagedIdentity\":{\"value\":true},\"dcrResourceId\":{\"value\":\"\"},\"enableProcessesAndDependencies\":{\"value\":true},\"restrictBringYourOwnUserAssignedIdentityToSubscription\":{\"value\":false},\"scopeToSupportedImages\":{\"value\":false},\"userAssignedIdentityResourceId\":{\"value\":\"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/root-id-1-mgmt/providers/Microsoft.ManagedIdentity/userAssignedIdentities/root-id-1-uami\"}}",
              "policy_definition_id": "/providers/Microsoft.Authorization/policySetDefinitions/924bfe3a-762f-40e7-86dd-5c8b95eb09e6",
              "resource_selectors": [],
              "timeouts": null
            },
            "sensitive_values": {
              "identity": [
                {}
              ],
              "non_compliance_message": [
                {}
              ],
              "not_scopes": [],
              "overrides": [],
              "resource_selectors": []
            }
          },
          {
            "address": "module.test_core.azurerm_management_group_policy_assignment.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/policyAssignments/Deploy-VMSS-ChangeTrack\"]",
            "mode": "managed",
            "type": "azurerm_management_group_policy_assignment",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/policyAssignments/Deploy-VMSS-ChangeTrack",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Enable ChangeTracking and Inventory for virtual machine scale sets. Takes Data Collection Rule ID as parameter and asks for an option to input applicable locations and user-assigned identity for Azure Monitor Agent.",
              "display_name": "Enable ChangeTracking and Inventory for virtual machine scale sets",
              "enforce": true,
              "identity": [
                {
                  "identity_ids": null,
                  "type": "SystemAssigned"
                }
              ],
              "location": "northeurope",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1-platform",
              "name": "Deploy-VMSS-ChangeTrack",
              "non_compliance_message": [
                {
                  "content": "Change Tracking must be enabled for Virtual Machines Scales Sets.",
                  "policy_definition_reference_id": null
                }
              ],
              "not_scopes": [],
              "overrides": [],
              "parameters": "{\"bringYourOwnUserAssignedManagedIdentity\":{\"value\":true},\"dcrResourceId\":{\"value\":\"\"},\"effect\":{\"value\":\"DeployIfNotExists\"},\"restrictBringYourOwnUserAssignedIdentityToSubscription\":{\"value\":false},\"userAssignedIdentityResourceId\":{\"value\":\"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/root-id-1-mgmt/providers/Microsoft.ManagedIdentity/userAssignedIdentities/root-id-1-uami\"}}",
              "policy_definition_id": "/providers/Microsoft.Authorization/policySetDefinitions/c4a70814-96be-461c-889f-2b27429120dc",
              "resource_selectors": [],
              "timeouts": null
            },
            "sensitive_values": {
              "identity": [
                {}
              ],
              "non_compliance_message": [
                {}
              ],
              "not_scopes": [],
              "overrides": [],
              "resource_selectors": []
            }
          },
          {
            "address": "module.test_core.azurerm_management_group_policy_assignment.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/policyAssignments/Deploy-VMSS-Monitoring\"]",
            "mode": "managed",
            "type": "azurerm_management_group_policy_assignment",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/policyAssignments/Deploy-VMSS-Monitoring",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Enable Azure Monitor for the Virtual Machine Scale Sets in the specified scope (Management group, Subscription or resource group). Takes Log Analytics workspace as parameter. Note: if your scale set upgradePolicy is set to Manual, you need to apply the extension to the all VMs in the set by calling upgrade on them. In CLI this would be az vmss update-instances.",
              "display_name": "Enable Azure Monitor for Virtual Machine Scale Sets",
              "enforce": true,
              "identity": [
                {
                  "identity_ids": null,
                  "type": "SystemAssigned"
                }
              ],
              "location": "northeurope",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1-platform",
              "name": "Deploy-VMSS-Monitoring",
              "non_compliance_message": [
                {
                  "content": "Azure Monitor must be enabled for Virtual Machines Scales Sets.",
                  "policy_definition_reference_id": null
                }
              ],
              "not_scopes": [],
              "overrides": [],
              "parameters": "{\"bringYourOwnUserAssignedManagedIdentity\":{\"value\":true},\"dcrResourceId\":{\"value\":\"\"},\"enableProcessesAndDependencies\":{\"value\":true},\"restrictBringYourOwnUserAssignedIdentityToSubscription\":{\"value\":false},\"scopeToSupportedImages\":{\"value\":false},\"userAssignedIdentityResourceId\":{\"value\":\"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/root-id-1-mgmt/providers/Microsoft.ManagedIdentity/userAssignedIdentities/root-id-1-uami\"}}",
              "policy_definition_id": "/providers/Microsoft.Authorization/policySetDefinitions/f5bf694c-cca7-4033-b883-3a23327d5485",
              "resource_selectors": [],
              "timeouts": null
            },
            "sensitive_values": {
              "identity": [
                {}
              ],
              "non_compliance_message": [
                {}
              ],
              "not_scopes": [],
              "overrides": [],
              "resource_selectors": []
            }
          },
          {
            "address": "module.test_core.azurerm_management_group_policy_assignment.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/policyAssignments/Deploy-vmArc-ChangeTrack\"]",
            "mode": "managed",
            "type": "azurerm_management_group_policy_assignment",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/policyAssignments/Deploy-vmArc-ChangeTrack",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Enable ChangeTracking and Inventory for Arc-enabled virtual machines. Takes Data Collection Rule ID as parameter and asks for an option to input applicable locations.",
              "display_name": "Enable ChangeTracking and Inventory for Arc-enabled virtual machines",
              "enforce": true,
              "identity": [
                {
                  "identity_ids": null,
                  "type": "SystemAssigned"
                }
              ],
              "location": "northeurope",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1-platform",
              "name": "Deploy-vmArc-ChangeTrack",
              "non_compliance_message": [
                {
                  "content": "Change Tracking must be enabled for Arc-enabled Virtual Machines.",
                  "policy_definition_reference_id": null
                }
              ],
              "not_scopes": [],
              "overrides": [],
              "parameters": "{\"dcrResourceId\":{\"value\":\"\"},\"effect\":{\"value\":\"DeployIfNotExists\"}}",
              "policy_definition_id": "/providers/Microsoft.Authorization/policySetDefinitions/53448c70-089b-4f52-8f38-89196d7f2de1",
              "resource_selectors": [],
              "timeouts": null
            },
            "sensitive_values": {
              "identity": [
                {}
              ],
              "non_compliance_message": [
                {}
              ],
              "not_scopes": [],
              "overrides": [],
              "resource_selectors": []
            }
          },
          {
            "address": "module.test_core.azurerm_management_group_policy_assignment.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/policyAssignments/Enable-AUM-CheckUpdates\"]",
            "mode": "managed",
            "type": "azurerm_management_group_policy_assignment",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/policyAssignments/Enable-AUM-CheckUpdates",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Configure auto-assessment (every 24 hours) for OS updates. You can control the scope of assignment according to machine subscription, resource group, location or tag. Learn more about this for Windows: https://aka.ms/computevm-windowspatchassessmentmode, for Linux: https://aka.ms/computevm-linuxpatchassessmentmode.",
              "display_name": "Configure periodic checking for missing system updates on azure virtual machines and Arc-enabled virtual machines.",
              "enforce": true,
              "identity": [
                {
                  "identity_ids": null,
                  "type": "SystemAssigned"
                }
              ],
              "location": "northeurope",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1-platform",
              "name": "Enable-AUM-CheckUpdates",
              "non_compliance_message": [
                {
                  "content": "Periodic checking of missing updates must be enabled.",
                  "policy_definition_reference_id": null
                }
              ],
              "not_scopes": [],
              "overrides": [],
              "parameters": "{\"assessmentMode\":{\"value\":\"AutomaticByPlatform\"},\"locations\":{\"value\":[]},\"tagOperator\":{\"value\":\"Any\"},\"tagValues\":{\"value\":{}}}",
              "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Deploy-AUM-CheckUpdates",
              "resource_selectors": [],
              "timeouts": null
            },
            "sensitive_values": {
              "identity": [
                {}
              ],
              "non_compliance_message": [
                {}
              ],
              "not_scopes": [],
              "overrides": [],
              "resource_selectors": []
            }
          },
          {
            "address": "module.test_core.azurerm_management_group_policy_assignment.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-KeyVault\"]",
            "mode": "managed",
            "type": "azurerm_management_group_policy_assignment",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-KeyVault",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "This initiative assignment enables recommended ALZ guardrails for Azure Key Vault.",
              "display_name": "Enforce recommended guardrails for Azure Key Vault",
              "enforce": true,
              "identity": [],
              "location": "northeurope",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1-platform",
              "name": "Enforce-GR-KeyVault",
              "non_compliance_message": [
                {
                  "content": "This resource must be compliant with the assigned policy.",
                  "policy_definition_reference_id": null
                }
              ],
              "not_scopes": [],
              "overrides": [],
              "parameters": null,
              "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-KeyVault",
              "resource_selectors": [],
              "timeouts": null
            },
            "sensitive_values": {
              "identity": [],
              "non_compliance_message": [
                {}
              ],
              "not_scopes": [],
              "overrides": [],
              "resource_selectors": []
            }
          },
          {
            "address": "module.test_core.azurerm_management_group_policy_assignment.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1-sandboxes/providers/Microsoft.Authorization/policyAssignments/Enforce-ALZ-Sandbox\"]",
            "mode": "managed",
            "type": "azurerm_management_group_policy_assignment",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1-sandboxes/providers/Microsoft.Authorization/policyAssignments/Enforce-ALZ-Sandbox",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "This initiative will help enforce and govern subscriptions that are placed within the Sandbox Management Group. See https://aka.ms/alz/policies for more information.",
              "display_name": "Enforce ALZ Sandbox Guardrails",
              "enforce": true,
              "identity": [],
              "location": "northeurope",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1-sandboxes",
              "name": "Enforce-ALZ-Sandbox",
              "non_compliance_message": [
                {
                  "content": "ALZ Sandbox Guardrails must be enforced.",
                  "policy_definition_reference_id": null
                }
              ],
              "not_scopes": [],
              "overrides": [],
              "parameters": "{\"listOfResourceTypesNotAllowed\":{\"value\":[\"microsoft.network/expressroutecircuits\",\"microsoft.network/expressroutegateways\",\"microsoft.network/expressrouteports\",\"microsoft.network/virtualwans\",\"microsoft.network/virtualhubs\",\"microsoft.network/vpngateways\",\"microsoft.network/p2svpngateways\",\"microsoft.network/vpnsites\",\"microsoft.network/virtualnetworkgateways\"]}}",
              "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Enforce-ALZ-Sandbox",
              "resource_selectors": [],
              "timeouts": null
            },
            "sensitive_values": {
              "identity": [],
              "non_compliance_message": [
                {}
              ],
              "not_scopes": [],
              "overrides": [],
              "resource_selectors": []
            }
          },
          {
            "address": "module.test_core.azurerm_management_group_policy_assignment.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyAssignments/Audit-ResourceRGLocation\"]",
            "mode": "managed",
            "type": "azurerm_management_group_policy_assignment",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyAssignments/Audit-ResourceRGLocation",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Resource Group and Resource locations should match.",
              "display_name": "Resource Group and Resource locations should match",
              "enforce": true,
              "identity": [],
              "location": "northeurope",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "name": "Audit-ResourceRGLocation",
              "non_compliance_message": [
                {
                  "content": "Resources must be deployed in the same region as the Resource Group.",
                  "policy_definition_reference_id": null
                }
              ],
              "not_scopes": [],
              "overrides": [],
              "parameters": null,
              "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/0a914e76-4921-4c19-b460-a2d36003525a",
              "resource_selectors": [],
              "timeouts": null
            },
            "sensitive_values": {
              "identity": [],
              "non_compliance_message": [
                {}
              ],
              "not_scopes": [],
              "overrides": [],
              "resource_selectors": []
            }
          },
          {
            "address": "module.test_core.azurerm_management_group_policy_assignment.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyAssignments/Audit-TrustedLaunch\"]",
            "mode": "managed",
            "type": "azurerm_management_group_policy_assignment",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyAssignments/Audit-TrustedLaunch",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Trusted Launch improves security of a Virtual Machine which requires VM SKU, OS Disk & OS Image to support it (Gen 2). To learn more about Trusted Launch, visit https://aka.ms/trustedlaunch.",
              "display_name": "Audit virtual machines for Trusted Launch support",
              "enforce": true,
              "identity": [],
              "location": "northeurope",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "name": "Audit-TrustedLaunch",
              "non_compliance_message": [
                {
                  "content": "Trust Launch must be used on supported virtual machines for enhanced security.",
                  "policy_definition_reference_id": null
                }
              ],
              "not_scopes": [],
              "overrides": [],
              "parameters": "{\"effect\":{\"value\":\"Audit\"}}",
              "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Audit-TrustedLaunch",
              "resource_selectors": [],
              "timeouts": null
            },
            "sensitive_values": {
              "identity": [],
              "non_compliance_message": [
                {}
              ],
              "not_scopes": [],
              "overrides": [],
              "resource_selectors": []
            }
          },
          {
            "address": "module.test_core.azurerm_management_group_policy_assignment.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyAssignments/Audit-UnusedResources\"]",
            "mode": "managed",
            "type": "azurerm_management_group_policy_assignment",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyAssignments/Audit-UnusedResources",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "This Policy initiative is a group of Policy definitions that help optimize cost by detecting unused but chargeable resources. Leverage this Policy initiative as a cost control to reveal orphaned resources that are driving cost.",
              "display_name": "Unused resources driving cost should be avoided",
              "enforce": true,
              "identity": [],
              "location": "northeurope",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "name": "Audit-UnusedResources",
              "non_compliance_message": [
                {
                  "content": "Unused resources driving cost must be avoided.",
                  "policy_definition_reference_id": null
                }
              ],
              "not_scopes": [],
              "overrides": [],
              "parameters": "{\"EffectDisks\":{\"value\":\"Audit\"},\"EffectPublicIpAddresses\":{\"value\":\"Audit\"},\"EffectServerFarms\":{\"value\":\"Audit\"}}",
              "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Audit-UnusedResourcesCostOptimization",
              "resource_selectors": [],
              "timeouts": null
            },
            "sensitive_values": {
              "identity": [],
              "non_compliance_message": [
                {}
              ],
              "not_scopes": [],
              "overrides": [],
              "resource_selectors": []
            }
          },
          {
            "address": "module.test_core.azurerm_management_group_policy_assignment.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyAssignments/Audit-ZoneResiliency\"]",
            "mode": "managed",
            "type": "azurerm_management_group_policy_assignment",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyAssignments/Audit-ZoneResiliency",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Resources should be Zone Resilient.",
              "display_name": "Resources should be Zone Resilient",
              "enforce": true,
              "identity": [],
              "location": "northeurope",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "name": "Audit-ZoneResiliency",
              "non_compliance_message": [
                {
                  "content": "Resources must be Zone Resilient.",
                  "policy_definition_reference_id": null
                }
              ],
              "not_scopes": [],
              "overrides": [],
              "parameters": "{\"allow\":{\"value\":\"Both\"},\"effect\":{\"value\":\"Audit\"}}",
              "policy_definition_id": "/providers/Microsoft.Authorization/policySetDefinitions/130fb88f-0fc9-4678-bfe1-31022d71c7d5",
              "resource_selectors": [],
              "timeouts": null
            },
            "sensitive_values": {
              "identity": [],
              "non_compliance_message": [
                {}
              ],
              "not_scopes": [],
              "overrides": [],
              "resource_selectors": []
            }
          },
          {
            "address": "module.test_core.azurerm_management_group_policy_assignment.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyAssignments/Deny-Classic-Resources\"]",
            "mode": "managed",
            "type": "azurerm_management_group_policy_assignment",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyAssignments/Deny-Classic-Resources",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Denies deployment of classic resource types under the assigned scope.",
              "display_name": "Deny the deployment of classic resources",
              "enforce": true,
              "identity": [],
              "location": "northeurope",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "name": "Deny-Classic-Resources",
              "non_compliance_message": [
                {
                  "content": "Classic resources must not be deployed.",
                  "policy_definition_reference_id": null
                }
              ],
              "not_scopes": [],
              "overrides": [],
              "parameters": "{\"effect\":{\"value\":\"Deny\"},\"listOfResourceTypesNotAllowed\":{\"value\":[\"Microsoft.ClassicCompute/capabilities\",\"Microsoft.ClassicCompute/checkDomainNameAvailability\",\"Microsoft.ClassicCompute/domainNames\",\"Microsoft.ClassicCompute/domainNames/capabilities\",\"Microsoft.ClassicCompute/domainNames/internalLoadBalancers\",\"Microsoft.ClassicCompute/domainNames/serviceCertificates\",\"Microsoft.ClassicCompute/domainNames/slots\",\"Microsoft.ClassicCompute/domainNames/slots/roles\",\"Microsoft.ClassicCompute/domainNames/slots/roles/metricDefinitions\",\"Microsoft.ClassicCompute/domainNames/slots/roles/metrics\",\"Microsoft.ClassicCompute/moveSubscriptionResources\",\"Microsoft.ClassicCompute/operatingSystemFamilies\",\"Microsoft.ClassicCompute/operatingSystems\",\"Microsoft.ClassicCompute/operations\",\"Microsoft.ClassicCompute/operationStatuses\",\"Microsoft.ClassicCompute/quotas\",\"Microsoft.ClassicCompute/resourceTypes\",\"Microsoft.ClassicCompute/validateSubscriptionMoveAvailability\",\"Microsoft.ClassicCompute/virtualMachines\",\"Microsoft.ClassicCompute/virtualMachines/diagnosticSettings\",\"Microsoft.ClassicCompute/virtualMachines/metricDefinitions\",\"Microsoft.ClassicCompute/virtualMachines/metrics\",\"Microsoft.ClassicInfrastructureMigrate/classicInfrastructureResources\",\"Microsoft.ClassicNetwork/capabilities\",\"Microsoft.ClassicNetwork/expressRouteCrossConnections\",\"Microsoft.ClassicNetwork/expressRouteCrossConnections/peerings\",\"Microsoft.ClassicNetwork/gatewaySupportedDevices\",\"Microsoft.ClassicNetwork/networkSecurityGroups\",\"Microsoft.ClassicNetwork/operations\",\"Microsoft.ClassicNetwork/quotas\",\"Microsoft.ClassicNetwork/reservedIps\",\"Microsoft.ClassicNetwork/virtualNetworks\",\"Microsoft.ClassicNetwork/virtualNetworks/remoteVirtualNetworkPeeringProxies\",\"Microsoft.ClassicNetwork/virtualNetworks/virtualNetworkPeerings\",\"Microsoft.ClassicStorage/capabilities\",\"Microsoft.ClassicStorage/checkStorageAccountAvailability\",\"Microsoft.ClassicStorage/disks\",\"Microsoft.ClassicStorage/images\",\"Microsoft.ClassicStorage/operations\",\"Microsoft.ClassicStorage/osImages\",\"Microsoft.ClassicStorage/osPlatformImages\",\"Microsoft.ClassicStorage/publicImages\",\"Microsoft.ClassicStorage/quotas\",\"Microsoft.ClassicStorage/storageAccounts\",\"Microsoft.ClassicStorage/storageAccounts/blobServices\",\"Microsoft.ClassicStorage/storageAccounts/fileServices\",\"Microsoft.ClassicStorage/storageAccounts/metricDefinitions\",\"Microsoft.ClassicStorage/storageAccounts/metrics\",\"Microsoft.ClassicStorage/storageAccounts/queueServices\",\"Microsoft.ClassicStorage/storageAccounts/services\",\"Microsoft.ClassicStorage/storageAccounts/services/diagnosticSettings\",\"Microsoft.ClassicStorage/storageAccounts/services/metricDefinitions\",\"Microsoft.ClassicStorage/storageAccounts/services/metrics\",\"Microsoft.ClassicStorage/storageAccounts/tableServices\",\"Microsoft.ClassicStorage/storageAccounts/vmImages\",\"Microsoft.ClassicStorage/vmImages\",\"Microsoft.ClassicSubscription/operations\"]}}",
              "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/6c112d4e-5bc7-47ae-a041-ea2d9dccd749",
              "resource_selectors": [],
              "timeouts": null
            },
            "sensitive_values": {
              "identity": [],
              "non_compliance_message": [
                {}
              ],
              "not_scopes": [],
              "overrides": [],
              "resource_selectors": []
            }
          },
          {
            "address": "module.test_core.azurerm_management_group_policy_assignment.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyAssignments/Deny-UnmanagedDisk\"]",
            "mode": "managed",
            "type": "azurerm_management_group_policy_assignment",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyAssignments/Deny-UnmanagedDisk",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Deny virtual machines that do not use managed disk. It checks the managed disk property on virtual machine OS Disk fields.",
              "display_name": "Deny virtual machines and virtual machine scale sets that do not use managed disk",
              "enforce": true,
              "identity": [],
              "location": "northeurope",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "name": "Deny-UnmanagedDisk",
              "non_compliance_message": [
                {
                  "content": "Virtual machines and virtual machine scales sets must use a managed disk.",
                  "policy_definition_reference_id": null
                }
              ],
              "not_scopes": [],
              "overrides": [
                {
                  "selectors": [],
                  "value": "Deny"
                }
              ],
              "parameters": null,
              "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/06a78e20-9358-41c9-923c-fb736d382a4d",
              "resource_selectors": [],
              "timeouts": null
            },
            "sensitive_values": {
              "identity": [],
              "non_compliance_message": [
                {}
              ],
              "not_scopes": [],
              "overrides": [
                {
                  "selectors": []
                }
              ],
              "resource_selectors": []
            }
          },
          {
            "address": "module.test_core.azurerm_management_group_policy_assignment.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyAssignments/Deploy-ASC-Monitoring\"]",
            "mode": "managed",
            "type": "azurerm_management_group_policy_assignment",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyAssignments/Deploy-ASC-Monitoring",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Microsoft Cloud Security Benchmark policy initiative.",
              "display_name": "Microsoft Cloud Security Benchmark",
              "enforce": true,
              "identity": [
                {
                  "identity_ids": null,
                  "type": "SystemAssigned"
                }
              ],
              "location": "northeurope",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "name": "Deploy-ASC-Monitoring",
              "non_compliance_message": [
                {
                  "content": "Microsoft Cloud Security Benchmark must be met.",
                  "policy_definition_reference_id": null
                }
              ],
              "not_scopes": [],
              "overrides": [],
              "parameters": null,
              "policy_definition_id": "/providers/Microsoft.Authorization/policySetDefinitions/1f3afdf9-d0c9-4c3d-847f-89da613e70a8",
              "resource_selectors": [],
              "timeouts": null
            },
            "sensitive_values": {
              "identity": [
                {}
              ],
              "non_compliance_message": [
                {}
              ],
              "not_scopes": [],
              "overrides": [],
              "resource_selectors": []
            }
          },
          {
            "address": "module.test_core.azurerm_management_group_policy_assignment.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyAssignments/Deploy-AzActivity-Log\"]",
            "mode": "managed",
            "type": "azurerm_management_group_policy_assignment",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyAssignments/Deploy-AzActivity-Log",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Deploys the diagnostic settings for Azure Activity to stream subscriptions audit logs to a Log Analytics workspace to monitor subscription-level events",
              "display_name": "Configure Azure Activity logs to stream to specified Log Analytics workspace",
              "enforce": true,
              "identity": [
                {
                  "identity_ids": null,
                  "type": "SystemAssigned"
                }
              ],
              "location": "northeurope",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "name": "Deploy-AzActivity-Log",
              "non_compliance_message": [
                {
                  "content": "Azure Activity logs must be configured to stream to specified Log Analytics workspace.",
                  "policy_definition_reference_id": null
                }
              ],
              "not_scopes": [],
              "overrides": [],
              "parameters": "{\"logAnalytics\":{\"value\":\"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/root-id-1-mgmt/providers/Microsoft.OperationalInsights/workspaces/root-id-1-la\"},\"logsEnabled\":{\"value\":\"True\"}}",
              "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/2465583e-4e78-4c15-b6be-a36cbc7c8b0f",
              "resource_selectors": [],
              "timeouts": null
            },
            "sensitive_values": {
              "identity": [
                {}
              ],
              "non_compliance_message": [
                {}
              ],
              "not_scopes": [],
              "overrides": [],
              "resource_selectors": []
            }
          },
          {
            "address": "module.test_core.azurerm_management_group_policy_assignment.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyAssignments/Deploy-Diag-Logs\"]",
            "mode": "managed",
            "type": "azurerm_management_group_policy_assignment",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyAssignments/Deploy-Diag-Logs",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Resource logs should be enabled to track activities and events that take place on your resources and give you visibility and insights into any changes that occur. This initiative deploys diagnostic setting using the allLogs category group to route logs to an Event Hub for all supported resources.",
              "display_name": "Enable allLogs category group resource logging for supported resources to Log Analytics",
              "enforce": true,
              "identity": [
                {
                  "identity_ids": null,
                  "type": "SystemAssigned"
                }
              ],
              "location": "northeurope",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "name": "Deploy-Diag-Logs",
              "non_compliance_message": [
                {
                  "content": "Diagnostic settings must be deployed to Azure services to forward logs to Log Analytics.",
                  "policy_definition_reference_id": null
                }
              ],
              "not_scopes": [],
              "overrides": [],
              "parameters": "{\"logAnalytics\":{\"value\":\"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/root-id-1-mgmt/providers/Microsoft.OperationalInsights/workspaces/root-id-1-la\"}}",
              "policy_definition_id": "/providers/Microsoft.Authorization/policySetDefinitions/0884adba-2312-4468-abeb-5422caed1038",
              "resource_selectors": [],
              "timeouts": null
            },
            "sensitive_values": {
              "identity": [
                {}
              ],
              "non_compliance_message": [
                {}
              ],
              "not_scopes": [],
              "overrides": [],
              "resource_selectors": []
            }
          },
          {
            "address": "module.test_core.azurerm_management_group_policy_assignment.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyAssignments/Deploy-MDEndpoints\"]",
            "mode": "managed",
            "type": "azurerm_management_group_policy_assignment",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyAssignments/Deploy-MDEndpoints",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Deploy Microsoft Defender for Endpoint agent on applicable images.",
              "display_name": "[Preview]: Deploy Microsoft Defender for Endpoint agent",
              "enforce": true,
              "identity": [
                {
                  "identity_ids": null,
                  "type": "SystemAssigned"
                }
              ],
              "location": "northeurope",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "name": "Deploy-MDEndpoints",
              "non_compliance_message": [
                {
                  "content": "Microsoft Defender for Endpoint agent must be deployed on applicable images.",
                  "policy_definition_reference_id": null
                }
              ],
              "not_scopes": [],
              "overrides": [],
              "parameters": "{\"microsoftDefenderForEndpointLinuxArcAgentDeployEffect\":{\"value\":\"DeployIfNotExists\"},\"microsoftDefenderForEndpointLinuxVmAgentDeployEffect\":{\"value\":\"DeployIfNotExists\"},\"microsoftDefenderForEndpointWindowsArcAgentDeployEffect\":{\"value\":\"DeployIfNotExists\"},\"microsoftDefenderForEndpointWindowsVmAgentDeployEffect\":{\"value\":\"DeployIfNotExists\"}}",
              "policy_definition_id": "/providers/Microsoft.Authorization/policySetDefinitions/e20d08c5-6d64-656d-6465-ce9e37fd0ebc",
              "resource_selectors": [],
              "timeouts": null
            },
            "sensitive_values": {
              "identity": [
                {}
              ],
              "non_compliance_message": [
                {}
              ],
              "not_scopes": [],
              "overrides": [],
              "resource_selectors": []
            }
          },
          {
            "address": "module.test_core.azurerm_management_group_policy_assignment.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyAssignments/Deploy-MDEndpointsAMA\"]",
            "mode": "managed",
            "type": "azurerm_management_group_policy_assignment",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyAssignments/Deploy-MDEndpointsAMA",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Configure the multiple Microsoft Defender for Endpoint integration settings with Microsoft Defender for Cloud (WDATP, WDATP_EXCLUDE_LINUX_PUBLIC_PREVIEW, WDATP_UNIFIED_SOLUTION etc.). See: https://learn.microsoft.com/azure/defender-for-cloud/integration-defender-for-endpoint for more information.",
              "display_name": "Configure multiple Microsoft Defender for Endpoint integration settings with Microsoft Defender for Cloud",
              "enforce": true,
              "identity": [
                {
                  "identity_ids": null,
                  "type": "SystemAssigned"
                }
              ],
              "location": "northeurope",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "name": "Deploy-MDEndpointsAMA",
              "non_compliance_message": [
                {
                  "content": "Microsoft Defender for Endpoint must be deployed.",
                  "policy_definition_reference_id": null
                }
              ],
              "not_scopes": [],
              "overrides": [],
              "parameters": null,
              "policy_definition_id": "/providers/Microsoft.Authorization/policySetDefinitions/77b391e3-2d5d-40c3-83bf-65c846b3c6a3",
              "resource_selectors": [],
              "timeouts": null
            },
            "sensitive_values": {
              "identity": [
                {}
              ],
              "non_compliance_message": [
                {}
              ],
              "not_scopes": [],
              "overrides": [],
              "resource_selectors": []
            }
          },
          {
            "address": "module.test_core.azurerm_management_group_policy_assignment.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyAssignments/Deploy-MDFC-Config-H224\"]",
            "mode": "managed",
            "type": "azurerm_management_group_policy_assignment",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyAssignments/Deploy-MDFC-Config-H224",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Deploy Microsoft Defender for Cloud and Security Contacts",
              "display_name": "Deploy Microsoft Defender for Cloud configuration",
              "enforce": true,
              "identity": [
                {
                  "identity_ids": null,
                  "type": "SystemAssigned"
                }
              ],
              "location": "northeurope",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "name": "Deploy-MDFC-Config-H224",
              "non_compliance_message": [
                {
                  "content": "Microsoft Defender for Cloud and Security Contacts must be deployed.",
                  "policy_definition_reference_id": null
                }
              ],
              "not_scopes": [],
              "overrides": [],
              "parameters": "{\"ascExportResourceGroupLocation\":{\"value\":\"northeurope\"},\"ascExportResourceGroupName\":{\"value\":\"root-id-1-asc-export\"},\"emailSecurityContact\":{\"value\":\"security_contact@replace_me\"},\"enableAscForAppServices\":{\"value\":\"Disabled\"},\"enableAscForArm\":{\"value\":\"Disabled\"},\"enableAscForContainers\":{\"value\":\"Disabled\"},\"enableAscForCosmosDbs\":{\"value\":\"Disabled\"},\"enableAscForCspm\":{\"value\":\"Disabled\"},\"enableAscForKeyVault\":{\"value\":\"Disabled\"},\"enableAscForOssDb\":{\"value\":\"Disabled\"},\"enableAscForServers\":{\"value\":\"Disabled\"},\"enableAscForServersVulnerabilityAssessments\":{\"value\":\"Disabled\"},\"enableAscForSql\":{\"value\":\"Disabled\"},\"enableAscForSqlOnVm\":{\"value\":\"Disabled\"},\"enableAscForStorage\":{\"value\":\"Disabled\"},\"logAnalytics\":{\"value\":\"/subscriptions/00000000-0000-0000-0000-000000000000/resourcegroups/root-id-1-mgmt/providers/Microsoft.OperationalInsights/workspaces/root-id-1-la\"}}",
              "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Deploy-MDFC-Config_20240319",
              "resource_selectors": [],
              "timeouts": null
            },
            "sensitive_values": {
              "identity": [
                {}
              ],
              "non_compliance_message": [
                {}
              ],
              "not_scopes": [],
              "overrides": [],
              "resource_selectors": []
            }
          },
          {
            "address": "module.test_core.azurerm_management_group_policy_assignment.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyAssignments/Deploy-MDFC-OssDb\"]",
            "mode": "managed",
            "type": "azurerm_management_group_policy_assignment",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyAssignments/Deploy-MDFC-OssDb",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Enable Advanced Threat Protection on your non-Basic tier open-source relational databases to detect anomalous activities indicating unusual and potentially harmful attempts to access or exploit databases. See https://aka.ms/AzDforOpenSourceDBsDocu.",
              "display_name": "Configure Advanced Threat Protection to be enabled on open-source relational databases",
              "enforce": true,
              "identity": [
                {
                  "identity_ids": null,
                  "type": "SystemAssigned"
                }
              ],
              "location": "northeurope",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "name": "Deploy-MDFC-OssDb",
              "non_compliance_message": [
                {
                  "content": "Advanced Threat Protection must be enabled on open-source relational databases.",
                  "policy_definition_reference_id": null
                }
              ],
              "not_scopes": [],
              "overrides": [],
              "parameters": null,
              "policy_definition_id": "/providers/Microsoft.Authorization/policySetDefinitions/e77fc0b3-f7e9-4c58-bc13-cb753ed8e46e",
              "resource_selectors": [],
              "timeouts": null
            },
            "sensitive_values": {
              "identity": [
                {}
              ],
              "non_compliance_message": [
                {}
              ],
              "not_scopes": [],
              "overrides": [],
              "resource_selectors": []
            }
          },
          {
            "address": "module.test_core.azurerm_management_group_policy_assignment.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyAssignments/Deploy-MDFC-SqlAtp\"]",
            "mode": "managed",
            "type": "azurerm_management_group_policy_assignment",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyAssignments/Deploy-MDFC-SqlAtp",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Enable Azure Defender on your SQL Servers and SQL Managed Instances to detect anomalous activities indicating unusual and potentially harmful attempts to access or exploit databases.",
              "display_name": "Configure Azure Defender to be enabled on SQL Servers and SQL Managed Instances",
              "enforce": true,
              "identity": [
                {
                  "identity_ids": null,
                  "type": "SystemAssigned"
                }
              ],
              "location": "northeurope",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "name": "Deploy-MDFC-SqlAtp",
              "non_compliance_message": [
                {
                  "content": "Azure Defender must be enabled on SQL Servers and SQL Managed Instances.",
                  "policy_definition_reference_id": null
                }
              ],
              "not_scopes": [],
              "overrides": [],
              "parameters": null,
              "policy_definition_id": "/providers/Microsoft.Authorization/policySetDefinitions/9cb3cc7a-b39b-4b82-bc89-e5a5d9ff7b97",
              "resource_selectors": [],
              "timeouts": null
            },
            "sensitive_values": {
              "identity": [
                {}
              ],
              "non_compliance_message": [
                {}
              ],
              "not_scopes": [],
              "overrides": [],
              "resource_selectors": []
            }
          },
          {
            "address": "module.test_core.azurerm_management_group_policy_assignment.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyAssignments/Enforce-ACSB\"]",
            "mode": "managed",
            "type": "azurerm_management_group_policy_assignment",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyAssignments/Enforce-ACSB",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "This initiative assignment enables Azure Compute Security Baseline compliance auditing for Windows and Linux virtual machines.",
              "display_name": "Enforce Azure Compute Security Baseline compliance auditing",
              "enforce": true,
              "identity": [
                {
                  "identity_ids": null,
                  "type": "SystemAssigned"
                }
              ],
              "location": "northeurope",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "name": "Enforce-ACSB",
              "non_compliance_message": [
                {
                  "content": "Azure Compute Security Baseline compliance auditing must be enforced.",
                  "policy_definition_reference_id": null
                }
              ],
              "not_scopes": [],
              "overrides": [],
              "parameters": null,
              "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Enforce-ACSB",
              "resource_selectors": [],
              "timeouts": null
            },
            "sensitive_values": {
              "identity": [
                {}
              ],
              "non_compliance_message": [
                {}
              ],
              "not_scopes": [],
              "overrides": [],
              "resource_selectors": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Append-AppService-httpsonly\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Append-AppService-httpsonly",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Appends the AppService sites object to ensure that  HTTPS only is enabled for  server/service authentication and protects data in transit from network layer eavesdropping attacks. Please note Append does not enforce compliance use then deny.",
              "display_name": "AppService append enable https only setting to enforce https setting.",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"App Service\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.0\"}",
              "mode": "All",
              "name": "Append-AppService-httpsonly",
              "parameters": "{\"effect\":{\"allowedValues\":[\"Append\",\"Disabled\"],\"defaultValue\":\"Append\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Web/sites\",\"field\":\"type\"},{\"field\":\"Microsoft.Web/sites/httpsOnly\",\"notequals\":true}]},\"then\":{\"details\":[{\"field\":\"Microsoft.Web/sites/httpsOnly\",\"value\":true}],\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Append-AppService-latestTLS\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Append-AppService-latestTLS",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Append the AppService sites object to ensure that min Tls version is set to required minimum TLS version. Please note Append does not enforce compliance use then deny.",
              "display_name": "AppService append sites with minimum TLS version to enforce.",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"App Service\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.1.0\"}",
              "mode": "All",
              "name": "Append-AppService-latestTLS",
              "parameters": "{\"effect\":{\"allowedValues\":[\"Append\",\"Disabled\"],\"defaultValue\":\"Append\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"minTlsVersion\":{\"allowedValues\":[\"1.2\",\"1.0\",\"1.1\"],\"defaultValue\":\"1.2\",\"metadata\":{\"description\":\"Select version  minimum TLS version for a  Web App config to enforce\",\"displayName\":\"Select version minimum TLS Web App config\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"exists\":\"true\",\"field\":\"Microsoft.Web/sites/config/minTlsVersion\"},{\"field\":\"Microsoft.Web/sites/config/minTlsVersion\",\"notEquals\":\"[parameters('minTlsVersion')]\"}]},\"then\":{\"details\":[{\"field\":\"Microsoft.Web/sites/config/minTlsVersion\",\"value\":\"[parameters('minTlsVersion')]\"}],\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Append-KV-SoftDelete\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Append-KV-SoftDelete",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "This policy enables you to ensure when a Key Vault is created with out soft delete enabled it will be added.",
              "display_name": "KeyVault SoftDelete should be enabled",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Key Vault\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Append-KV-SoftDelete",
              "parameters": null,
              "policy_rule": "{\"if\":{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.KeyVault/vaults\",\"field\":\"type\"},{\"field\":\"Microsoft.KeyVault/vaults/enableSoftDelete\",\"notEquals\":true}]}]},\"then\":{\"details\":[{\"field\":\"Microsoft.KeyVault/vaults/enableSoftDelete\",\"value\":true}],\"effect\":\"append\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Append-Redis-disableNonSslPort\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Append-Redis-disableNonSslPort",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Azure Cache for Redis Append and the enforcement that enableNonSslPort is disabled. Enables secure server to client by enforce  minimal Tls Version to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.",
              "display_name": "Azure Cache for Redis Append and the enforcement that enableNonSslPort is disabled.",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Cache\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.1\"}",
              "mode": "Indexed",
              "name": "Append-Redis-disableNonSslPort",
              "parameters": "{\"effect\":{\"allowedValues\":[\"Append\",\"Disabled\"],\"defaultValue\":\"Append\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy minimum TLS version Azure Cache for Redis\",\"displayName\":\"Effect Azure Cache for Redis\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Cache/redis\",\"field\":\"type\"},{\"anyOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Cache/Redis/enableNonSslPort\"}]}]},\"then\":{\"details\":[{\"field\":\"Microsoft.Cache/Redis/enableNonSslPort\",\"value\":false}],\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Append-Redis-sslEnforcement\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Append-Redis-sslEnforcement",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Append a specific min TLS version requirement and enforce SSL on Azure Cache for Redis. Enables secure server to client by enforce  minimal Tls Version to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.",
              "display_name": "Azure Cache for Redis Append a specific min TLS version requirement and enforce TLS.",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Cache\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Append-Redis-sslEnforcement",
              "parameters": "{\"effect\":{\"allowedValues\":[\"Append\",\"Disabled\"],\"defaultValue\":\"Append\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy minimum TLS version Azure Cache for Redis\",\"displayName\":\"Effect Azure Cache for Redis\"},\"type\":\"String\"},\"minimumTlsVersion\":{\"allowedValues\":[\"1.2\",\"1.1\",\"1.0\"],\"defaultValue\":\"1.2\",\"metadata\":{\"description\":\"Select version minimum TLS version Azure Cache for Redis to enforce\",\"displayName\":\"Select version for Redis server\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Cache/redis\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.Cache/Redis/minimumTlsVersion\",\"notequals\":\"[parameters('minimumTlsVersion')]\"}]}]},\"then\":{\"details\":[{\"field\":\"Microsoft.Cache/Redis/minimumTlsVersion\",\"value\":\"[parameters('minimumTlsVersion')]\"}],\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Audit-AzureHybridBenefit\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Audit-AzureHybridBenefit",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Optimize cost by enabling Azure Hybrid Benefit. Leverage this Policy definition as a cost control to reveal Virtual Machines not using AHUB.",
              "display_name": "Audit AHUB for eligible VMs",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Cost Optimization\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.0\"}",
              "mode": "All",
              "name": "Audit-AzureHybridBenefit",
              "parameters": "{\"effect\":{\"allowedValues\":[\"Audit\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"field\":\"type\",\"in\":[\"Microsoft.Compute/virtualMachines\",\"Microsoft.Compute/virtualMachineScaleSets\"]},{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServer\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"2008-R2-SP1*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"2012-*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"2016-*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"2019-*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"2022-*\"}]},{\"field\":\"Microsoft.Compute/licenseType\",\"notEquals\":\"Windows_Server\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Audit-Disks-UnusedResourcesCostOptimization\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Audit-Disks-UnusedResourcesCostOptimization",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Optimize cost by detecting unused but chargeable resources. Leverage this Policy definition as a cost control to reveal orphaned Disks that are driving cost.",
              "display_name": "Unused Disks driving cost should be avoided",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Cost Optimization\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.0\"}",
              "mode": "All",
              "name": "Audit-Disks-UnusedResourcesCostOptimization",
              "parameters": "{\"effect\":{\"allowedValues\":[\"Audit\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Compute/disks\",\"field\":\"type\"},{\"equals\":\"Unattached\",\"field\":\"Microsoft.Compute/disks/diskState\"},{\"allof\":[{\"field\":\"name\",\"notlike\":\"*-ASRReplica\"},{\"field\":\"name\",\"notlike\":\"ms-asr-*\"},{\"field\":\"name\",\"notlike\":\"asrseeddisk-*\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Audit-MachineLearning-PrivateEndpointId\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Audit-MachineLearning-PrivateEndpointId",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Audit private endpoints that are created in other subscriptions and/or tenants for Azure Machine Learning.",
              "display_name": "Control private endpoint connections to Azure Machine Learning",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\"],\"category\":\"Machine Learning\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Audit-MachineLearning-PrivateEndpointId",
              "parameters": "{\"effect\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.MachineLearningServices/workspaces/privateEndpointConnections\",\"field\":\"type\"},{\"equals\":\"Approved\",\"field\":\"Microsoft.MachineLearningServices/workspaces/privateEndpointConnections/privateLinkServiceConnectionState.status\"},{\"anyOf\":[{\"exists\":false,\"field\":\"Microsoft.MachineLearningServices/workspaces/privateEndpointConnections/privateEndpoint.id\"},{\"notEquals\":\"[subscription().subscriptionId]\",\"value\":\"[split(concat(field('Microsoft.MachineLearningServices/workspaces/privateEndpointConnections/privateEndpoint.id'), '//'), '/')[2]]\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Audit-PrivateLinkDnsZones\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Audit-PrivateLinkDnsZones",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "This policy audits or denies, depending on assignment effect, the creation of a Private Link Private DNS Zones in the current scope, used in combination with policies that create centralized private DNS in connectivity subscription",
              "display_name": "Audit or Deny the creation of Private Link Private DNS Zones",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Network\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.2\"}",
              "mode": "Indexed",
              "name": "Audit-PrivateLinkDnsZones",
              "parameters": "{\"effect\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"privateLinkDnsZones\":{\"defaultValue\":[\"privatelink.adf.azure.com\",\"privatelink.afs.azure.net\",\"privatelink.agentsvc.azure-automation.net\",\"privatelink.analysis.windows.net\",\"privatelink.api.azureml.ms\",\"privatelink.azconfig.io\",\"privatelink.azure-api.net\",\"privatelink.azure-automation.net\",\"privatelink.azurecr.io\",\"privatelink.azure-devices.net\",\"privatelink.azure-devices-provisioning.net\",\"privatelink.azuredatabricks.net\",\"privatelink.azurehdinsight.net\",\"privatelink.azurehealthcareapis.com\",\"privatelink.azurestaticapps.net\",\"privatelink.azuresynapse.net\",\"privatelink.azurewebsites.net\",\"privatelink.batch.azure.com\",\"privatelink.blob.core.windows.net\",\"privatelink.cassandra.cosmos.azure.com\",\"privatelink.cognitiveservices.azure.com\",\"privatelink.database.windows.net\",\"privatelink.datafactory.azure.net\",\"privatelink.dev.azuresynapse.net\",\"privatelink.dfs.core.windows.net\",\"privatelink.dicom.azurehealthcareapis.com\",\"privatelink.digitaltwins.azure.net\",\"privatelink.directline.botframework.com\",\"privatelink.documents.azure.com\",\"privatelink.eventgrid.azure.net\",\"privatelink.file.core.windows.net\",\"privatelink.gremlin.cosmos.azure.com\",\"privatelink.guestconfiguration.azure.com\",\"privatelink.his.arc.azure.com\",\"privatelink.kubernetesconfiguration.azure.com\",\"privatelink.managedhsm.azure.net\",\"privatelink.mariadb.database.azure.com\",\"privatelink.media.azure.net\",\"privatelink.mongo.cosmos.azure.com\",\"privatelink.monitor.azure.com\",\"privatelink.mysql.database.azure.com\",\"privatelink.notebooks.azure.net\",\"privatelink.ods.opinsights.azure.com\",\"privatelink.oms.opinsights.azure.com\",\"privatelink.pbidedicated.windows.net\",\"privatelink.postgres.database.azure.com\",\"privatelink.prod.migration.windowsazure.com\",\"privatelink.purview.azure.com\",\"privatelink.purviewstudio.azure.com\",\"privatelink.queue.core.windows.net\",\"privatelink.redis.cache.windows.net\",\"privatelink.redisenterprise.cache.azure.net\",\"privatelink.search.windows.net\",\"privatelink.service.signalr.net\",\"privatelink.servicebus.windows.net\",\"privatelink.siterecovery.windowsazure.com\",\"privatelink.sql.azuresynapse.net\",\"privatelink.table.core.windows.net\",\"privatelink.table.cosmos.azure.com\",\"privatelink.tip1.powerquery.microsoft.com\",\"privatelink.token.botframework.com\",\"privatelink.vaultcore.azure.net\",\"privatelink.web.core.windows.net\",\"privatelink.webpubsub.azure.com\"],\"metadata\":{\"description\":\"An array of Private Link Private DNS Zones to check for the existence of in the assigned scope.\",\"displayName\":\"Private Link Private DNS Zones\"},\"type\":\"Array\"}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateDnsZones\",\"field\":\"type\"},{\"field\":\"name\",\"in\":\"[parameters('privateLinkDnsZones')]\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Audit-PublicIpAddresses-UnusedResourcesCostOptimization\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Audit-PublicIpAddresses-UnusedResourcesCostOptimization",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Optimize cost by detecting unused but chargeable resources. Leverage this Policy definition as a cost control to reveal orphaned Public IP addresses that are driving cost.",
              "display_name": "Unused Public IP addresses driving cost should be avoided",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Cost Optimization\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.1.0\"}",
              "mode": "All",
              "name": "Audit-PublicIpAddresses-UnusedResourcesCostOptimization",
              "parameters": "{\"effect\":{\"allowedValues\":[\"Audit\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"microsoft.network/publicIpAddresses\",\"field\":\"type\"},{\"equals\":\"Static\",\"field\":\"Microsoft.Network/publicIPAddresses/publicIPAllocationMethod\"},{\"anyOf\":[{\"exists\":false,\"field\":\"Microsoft.Network/publicIPAddresses/natGateway\"},{\"equals\":true,\"value\":\"[equals(length(field('Microsoft.Network/publicIPAddresses/natGateway')), 0)]\"}]},{\"anyOf\":[{\"exists\":false,\"field\":\"Microsoft.Network/publicIPAddresses/ipConfiguration\"},{\"equals\":true,\"value\":\"[equals(length(field('Microsoft.Network/publicIPAddresses/ipConfiguration')), 0)]\"}]},{\"anyOf\":[{\"exists\":false,\"field\":\"Microsoft.Network/publicIPAddresses/publicIPPrefix\"},{\"equals\":true,\"value\":\"[equals(length(field('Microsoft.Network/publicIPAddresses/publicIPPrefix')), 0)]\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Audit-ServerFarms-UnusedResourcesCostOptimization\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Audit-ServerFarms-UnusedResourcesCostOptimization",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Optimize cost by detecting unused but chargeable resources. Leverage this Policy definition as a cost control to reveal orphaned App Service plans that are driving cost.",
              "display_name": "Unused App Service plans driving cost should be avoided",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Cost Optimization\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.0\"}",
              "mode": "All",
              "name": "Audit-ServerFarms-UnusedResourcesCostOptimization",
              "parameters": "{\"effect\":{\"allowedValues\":[\"Audit\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Web/serverfarms\",\"field\":\"type\"},{\"field\":\"Microsoft.Web/serverFarms/sku.tier\",\"notEquals\":\"Free\"},{\"equals\":0,\"field\":\"Microsoft.Web/serverFarms/numberOfSites\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-AA-child-resources\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-AA-child-resources",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "This policy denies the creation of child resources on the Automation Account",
              "display_name": "No child resources in Automation Account",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureUSGovernment\"],\"category\":\"Automation\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Deny-AA-child-resources",
              "parameters": "{\"effect\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"field\":\"type\",\"in\":[\"Microsoft.Automation/automationAccounts/runbooks\",\"Microsoft.Automation/automationAccounts/variables\",\"Microsoft.Automation/automationAccounts/modules\",\"Microsoft.Automation/automationAccounts/credentials\",\"Microsoft.Automation/automationAccounts/connections\",\"Microsoft.Automation/automationAccounts/certificates\"]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-APIM-TLS\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-APIM-TLS",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Azure API Management service should use TLS version 1.2",
              "display_name": "API Management services should use TLS version 1.2",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"API Management\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.0\"}",
              "mode": "All",
              "name": "Deny-APIM-TLS",
              "parameters": "{\"effect\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.ApiManagement/service\",\"field\":\"type\"},{\"anyOf\":[{\"greater\":0,\"value\":\"[indexof(toLower(string(field('Microsoft.ApiManagement/service/customProperties'))), '\\\"microsoft.windowsazure.apimanagement.gateway.security.protocols.tls10\\\":\\\"true\\\"')]\"},{\"greater\":0,\"value\":\"[indexof(toLower(string(field('Microsoft.ApiManagement/service/customProperties'))), '\\\"microsoft.windowsazure.apimanagement.gateway.security.protocols.tls10\\\":true')]\"},{\"greater\":0,\"value\":\"[indexof(toLower(string(field('Microsoft.ApiManagement/service/customProperties'))), '\\\"microsoft.windowsazure.apimanagement.gateway.security.protocols.tls11\\\":\\\"true\\\"')]\"},{\"greater\":0,\"value\":\"[indexof(toLower(string(field('Microsoft.ApiManagement/service/customProperties'))), '\\\"microsoft.windowsazure.apimanagement.gateway.security.protocols.tls11\\\":true')]\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-AppGW-Without-WAF\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-AppGW-Without-WAF",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "This policy enables you to restrict that Application Gateways is always deployed with WAF enabled",
              "display_name": "Application Gateway should be deployed with WAF enabled",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Network\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Deny-AppGW-Without-WAF",
              "parameters": "{\"effect\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/applicationGateways\",\"field\":\"type\"},{\"field\":\"Microsoft.Network/applicationGateways/sku.name\",\"notequals\":\"WAF_v2\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-AppGw-Without-Tls\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-AppGw-Without-Tls",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "This policy enables you to restrict that Application Gateways is always deployed with predefined Microsoft policy that is using TLS version 1.2",
              "display_name": "Application Gateway should be deployed with predefined Microsoft policy that is using TLS version 1.2",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Network\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.0\"}",
              "mode": "All",
              "name": "Deny-AppGw-Without-Tls",
              "parameters": "{\"effect\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"predefinedPolicyName\":{\"defaultValue\":[\"AppGwSslPolicy20220101\",\"AppGwSslPolicy20170401S\",\"AppGwSslPolicy20220101S\"],\"metadata\":{\"description\":\"Predefined policy name\",\"displayName\":\"Predefined policy name\"},\"type\":\"array\"}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/applicationGateways\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.Network/applicationGateways/sslPolicy.policyType\",\"notEquals\":\"Predefined\"},{\"exists\":\"false\",\"field\":\"Microsoft.Network/applicationGateways/sslPolicy.policyType\"},{\"field\":\"Microsoft.Network/applicationGateways/sslPolicy.policyName\",\"notIn\":\"[parameters('predefinedPolicyName')]\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-AppService-without-BYOC\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-AppService-without-BYOC",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "App Service (including Logic apps and Function apps) must use certificates stored in Key Vault",
              "display_name": "App Service certificates must be stored in Key Vault",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"App Service\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.0\"}",
              "mode": "All",
              "name": "Deny-AppService-without-BYOC",
              "parameters": "{\"effect\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Web/certificates\",\"field\":\"type\"},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.Web/certificates/keyVaultId\"},{\"exists\":\"false\",\"field\":\"Microsoft.Web/certificates/keyVaultSecretName\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-AppServiceApiApp-http\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-AppServiceApiApp-http",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Use of HTTPS ensures server/service authentication and protects data in transit from network layer eavesdropping attacks.",
              "display_name": "API App should only be accessible over HTTPS",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"App Service\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Deny-AppServiceApiApp-http",
              "parameters": "{\"effect\":{\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Web/sites\",\"field\":\"type\"},{\"field\":\"kind\",\"like\":\"*api\"},{\"equals\":\"false\",\"field\":\"Microsoft.Web/sites/httpsOnly\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-AppServiceFunctionApp-http\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-AppServiceFunctionApp-http",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Use of HTTPS ensures server/service authentication and protects data in transit from network layer eavesdropping attacks.",
              "display_name": "Function App should only be accessible over HTTPS",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"App Service\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Deny-AppServiceFunctionApp-http",
              "parameters": "{\"effect\":{\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Web/sites\",\"field\":\"type\"},{\"field\":\"kind\",\"like\":\"functionapp*\"},{\"equals\":\"false\",\"field\":\"Microsoft.Web/sites/httpsOnly\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-AppServiceWebApp-http\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-AppServiceWebApp-http",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Use of HTTPS ensures server/service authentication and protects data in transit from network layer eavesdropping attacks.",
              "display_name": "Web Application should only be accessible over HTTPS",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"App Service\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Deny-AppServiceWebApp-http",
              "parameters": "{\"effect\":{\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Web/sites\",\"field\":\"type\"},{\"field\":\"kind\",\"like\":\"app*\"},{\"equals\":\"false\",\"field\":\"Microsoft.Web/sites/httpsOnly\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-AzFw-Without-Policy\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-AzFw-Without-Policy",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "This policy denies the creation of Azure Firewall without a default Firewall Policy.",
              "display_name": "Azure Firewall should have a default Firewall Policy",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Network\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.0\"}",
              "mode": "All",
              "name": "Deny-AzFw-Without-Policy",
              "parameters": "{\"effect\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/azureFirewalls\",\"field\":\"type\"},{\"exists\":\"false\",\"field\":\"Microsoft.Network/azureFirewalls/firewallPolicy.id\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-CognitiveServices-NetworkAcls\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-CognitiveServices-NetworkAcls",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Azure Cognitive Services should not allow adding individual IPs or virtual network rules to the service-level firewall. Enable this to restrict inbound network access and enforce the usage of private endpoints.",
              "display_name": "Network ACLs should be restricted for Cognitive Services",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Cognitive Services\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.0\"}",
              "mode": "All",
              "name": "Deny-CognitiveServices-NetworkAcls",
              "parameters": "{\"effect\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.CognitiveServices/accounts\",\"field\":\"type\"},{\"anyOf\":[{\"count\":{\"field\":\"Microsoft.CognitiveServices/accounts/networkAcls.ipRules[*]\"},\"greater\":0},{\"count\":{\"field\":\"Microsoft.CognitiveServices/accounts/networkAcls.virtualNetworkRules[*]\"},\"greater\":0}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-CognitiveServices-Resource-Kinds\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-CognitiveServices-Resource-Kinds",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Azure Cognitive Services should only create explicit allowed kinds.",
              "display_name": "Only explicit kinds for Cognitive Services should be allowed",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Cognitive Services\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.0\"}",
              "mode": "All",
              "name": "Deny-CognitiveServices-Resource-Kinds",
              "parameters": "{\"allowedKinds\":{\"allowedValues\":[\"AnomalyDetector\",\"ComputerVision\",\"CognitiveServices\",\"ContentModerator\",\"CustomVision.Training\",\"CustomVision.Prediction\",\"Face\",\"FormRecognizer\",\"ImmersiveReader\",\"LUIS\",\"Personalizer\",\"SpeechServices\",\"TextAnalytics\",\"TextTranslation\",\"OpenAI\"],\"defaultValue\":[\"AnomalyDetector\",\"ComputerVision\",\"CognitiveServices\",\"ContentModerator\",\"CustomVision.Training\",\"CustomVision.Prediction\",\"Face\",\"FormRecognizer\",\"ImmersiveReader\",\"LUIS\",\"Personalizer\",\"SpeechServices\",\"TextAnalytics\",\"TextTranslation\",\"OpenAI\"],\"metadata\":{\"description\":\"Select the allowed resource kinds to be used with Cognitive Services\",\"displayName\":\"Effect\"},\"type\":\"array\"},\"effect\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.CognitiveServices/accounts\",\"field\":\"type\"},{\"field\":\"kind\",\"notIn\":\"[parameters('allowedKinds')]\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-CognitiveServices-RestrictOutboundNetworkAccess\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-CognitiveServices-RestrictOutboundNetworkAccess",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Azure Cognitive Services allow restricting outbound network access. Enable this to limit outbound connectivity for the service.",
              "display_name": "Outbound network access should be restricted for Cognitive Services",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Cognitive Services\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.0\"}",
              "mode": "All",
              "name": "Deny-CognitiveServices-RestrictOutboundNetworkAccess",
              "parameters": "{\"effect\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.CognitiveServices/accounts\",\"field\":\"type\"},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.CognitiveServices/accounts/restrictOutboundNetworkAccess\"},{\"field\":\"Microsoft.CognitiveServices/accounts/restrictOutboundNetworkAccess\",\"notEquals\":true}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-Databricks-NoPublicIp\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-Databricks-NoPublicIp",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Denies the deployment of workspaces that do not use the noPublicIp feature to host Databricks clusters without public IPs.",
              "display_name": "Deny public IPs for Databricks cluster",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\"],\"category\":\"Databricks\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Deny-Databricks-NoPublicIp",
              "parameters": "{\"effect\":{\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Databricks/workspaces\",\"field\":\"type\"},{\"field\":\"Microsoft.DataBricks/workspaces/parameters.enableNoPublicIp.value\",\"notEquals\":true}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-Databricks-Sku\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-Databricks-Sku",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Enforces the use of Premium Databricks workspaces to make sure appropriate security features are available including Databricks Access Controls, Credential Passthrough and SCIM provisioning for Microsoft Entra ID.",
              "display_name": "Deny non-premium Databricks sku",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\"],\"category\":\"Databricks\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Deny-Databricks-Sku",
              "parameters": "{\"effect\":{\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Databricks/workspaces\",\"field\":\"type\"},{\"field\":\"Microsoft.DataBricks/workspaces/sku.name\",\"notEquals\":\"premium\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-Databricks-VirtualNetwork\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-Databricks-VirtualNetwork",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Enforces the use of vnet injection for Databricks workspaces.",
              "display_name": "Deny Databricks workspaces without Vnet injection",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\"],\"category\":\"Databricks\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Deny-Databricks-VirtualNetwork",
              "parameters": "{\"effect\":{\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Databricks/workspaces\",\"field\":\"type\"},{\"anyOf\":[{\"exists\":false,\"field\":\"Microsoft.DataBricks/workspaces/parameters.customVirtualNetworkId.value\"},{\"exists\":false,\"field\":\"Microsoft.DataBricks/workspaces/parameters.customPublicSubnetName.value\"},{\"exists\":false,\"field\":\"Microsoft.DataBricks/workspaces/parameters.customPrivateSubnetName.value\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-EH-Premium-CMK\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-EH-Premium-CMK",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Event Hub namespaces (Premium) should use a customer-managed key for encryption.",
              "display_name": "Event Hub namespaces (Premium) should use a customer-managed key for encryption",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Event Hub\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.0\"}",
              "mode": "All",
              "name": "Deny-EH-Premium-CMK",
              "parameters": "{\"effect\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.EventHub/namespaces\",\"field\":\"type\"},{\"equals\":\"Premium\",\"field\":\"Microsoft.EventHub/namespaces/sku.name\"},{\"not\":{\"equals\":\"Microsoft.Keyvault\",\"field\":\"Microsoft.EventHub/namespaces/encryption.keySource\"}}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-EH-minTLS\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-EH-minTLS",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Event Hub namespaces should use a valid TLS version.",
              "display_name": "Event Hub namespaces should use a valid TLS version",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Event Hub\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.0\"}",
              "mode": "All",
              "name": "Deny-EH-minTLS",
              "parameters": "{\"effect\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"minTlsVersion\":{\"defaultValue\":\"1.2\",\"metadata\":{\"description\":\"Minimum TLS version to be used by Event Hub\",\"displayName\":\"Minimum TLS Version\"},\"type\":\"string\"}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.EventHub/namespaces\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.EventHub/namespaces/minimumTlsVersion\",\"notEquals\":\"[parameters('minTlsVersion')]\"},{\"exists\":\"false\",\"field\":\"Microsoft.EventHub/namespaces/minimumTlsVersion\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-FileServices-InsecureAuth\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-FileServices-InsecureAuth",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "This policy denies the use of insecure authentication methods (NTLMv2) when using File Services on a storage account.",
              "display_name": "File Services with insecure authentication methods should be denied",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Storage\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.0\"}",
              "mode": "All",
              "name": "Deny-FileServices-InsecureAuth",
              "parameters": "{\"effect\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"The effect determines what happens when the policy rule is evaluated to match\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"notAllowedAuthMethods\":{\"allowedValues\":[\"NTLMv2\",\"Kerberos\"],\"defaultValue\":\"NTLMv2\",\"metadata\":{\"description\":\"The list of channelEncryption not allowed.\",\"displayName\":\"Authentication methods supported by server. Valid values are NTLMv2, Kerberos.\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"contains\":\"[parameters('notAllowedAuthMethods')]\",\"field\":\"Microsoft.Storage/storageAccounts/fileServices/protocolSettings.smb.authenticationMethods\"},{\"equals\":\"Microsoft.Storage/storageAccounts/fileServices\",\"field\":\"type\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-FileServices-InsecureKerberos\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-FileServices-InsecureKerberos",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "This policy denies the use of insecure Kerberos ticket encryption (RC4-HMAC) when using File Services on a storage account.",
              "display_name": "File Services with insecure Kerberos ticket encryption should be denied",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Storage\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.0\"}",
              "mode": "All",
              "name": "Deny-FileServices-InsecureKerberos",
              "parameters": "{\"effect\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"The effect determines what happens when the policy rule is evaluated to match\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"notAllowedKerberosTicketEncryption\":{\"allowedValues\":[\"RC4-HMAC\",\"AES-256\"],\"defaultValue\":\"RC4-HMAC\",\"metadata\":{\"description\":\"The list of kerberosTicketEncryption not allowed.\",\"displayName\":\"Kerberos ticket encryption supported by server. Valid values are RC4-HMAC, AES-256.\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Storage/storageAccounts/fileServices\",\"field\":\"type\"},{\"contains\":\"[parameters('notAllowedKerberosTicketEncryption')]\",\"field\":\"Microsoft.Storage/storageAccounts/fileServices/protocolSettings.smb.kerberosTicketEncryption\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-FileServices-InsecureSmbChannel\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-FileServices-InsecureSmbChannel",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "This policy denies the use of insecure channel encryption (AES-128-CCM) when using File Services on a storage account.",
              "display_name": "File Services with insecure SMB channel encryption should be denied",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Storage\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.0\"}",
              "mode": "All",
              "name": "Deny-FileServices-InsecureSmbChannel",
              "parameters": "{\"effect\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"The effect determines what happens when the policy rule is evaluated to match\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"notAllowedChannelEncryption\":{\"allowedValues\":[\"AES-128-CCM\",\"AES-128-GCM\",\"AES-256-GCM\"],\"defaultValue\":\"AES-128-CCM\",\"metadata\":{\"description\":\"The list of channelEncryption not allowed.\",\"displayName\":\"SMB channel encryption supported by server. Valid values are AES-128-CCM, AES-128-GCM, AES-256-GCM.\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Storage/storageAccounts/fileServices\",\"field\":\"type\"},{\"contains\":\"[parameters('notAllowedChannelEncryption')]\",\"field\":\"Microsoft.Storage/storageAccounts/fileServices/protocolSettings.smb.channelEncryption\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-FileServices-InsecureSmbVersions\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-FileServices-InsecureSmbVersions",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "This policy denies the use of insecure versions of SMB (2.1 & 3.0) when using File Services on a storage account.",
              "display_name": "File Services with insecure SMB versions should be denied",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Storage\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.0\"}",
              "mode": "All",
              "name": "Deny-FileServices-InsecureSmbVersions",
              "parameters": "{\"allowedSmbVersion\":{\"allowedValues\":[\"SMB2.1\",\"SMB3.0\",\"SMB3.1.1\"],\"defaultValue\":\"SMB3.1.1\",\"metadata\":{\"description\":\"The allowed SMB version for maximum security\",\"displayName\":\"Allowed SMB Version\"},\"type\":\"String\"},\"effect\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"The effect determines what happens when the policy rule is evaluated to match\",\"displayName\":\"Effect\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Storage/storageAccounts/fileServices\",\"field\":\"type\"},{\"not\":{\"contains\":\"[parameters('allowedSmbVersion')]\",\"field\":\"Microsoft.Storage/storageAccounts/fileServices/protocolSettings.smb.versions\"}}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-LogicApp-Public-Network\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-LogicApp-Public-Network",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Disabling public network access improves security by ensuring that the Logic App is not exposed on the public internet. Creating private endpoints can limit exposure of a Logic App. Learn more at: https://aka.ms/app-service-private-endpoint.",
              "display_name": "Logic apps should disable public network access",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Logic Apps\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.0\"}",
              "mode": "All",
              "name": "Deny-LogicApp-Public-Network",
              "parameters": "{\"effect\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Web/sites\",\"field\":\"type\"},{\"contains\":\"workflowapp\",\"field\":\"kind\"},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.Web/sites/publicNetworkAccess\"},{\"field\":\"Microsoft.Web/sites/publicNetworkAccess\",\"notEquals\":\"Disabled\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-LogicApps-Without-Https\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-LogicApps-Without-Https",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Use of HTTPS ensures server/service authentication and protects data in transit from network layer eavesdropping attacks.",
              "display_name": "Logic app should only be accessible over HTTPS",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Logic Apps\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.0\"}",
              "mode": "All",
              "name": "Deny-LogicApps-Without-Https",
              "parameters": "{\"effect\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Web/sites\",\"field\":\"type\"},{\"contains\":\"workflowapp\",\"field\":\"kind\"},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.Web/sites/httpsOnly\"},{\"equals\":\"false\",\"field\":\"Microsoft.Web/sites/httpsOnly\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-Aks\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-Aks",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Deny AKS cluster creation in Azure Machine Learning and enforce connecting to existing clusters.",
              "display_name": "Deny AKS cluster creation in Azure Machine Learning",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\"],\"category\":\"Machine Learning\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Deny-MachineLearning-Aks",
              "parameters": "{\"effect\":{\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.MachineLearningServices/workspaces/computes\",\"field\":\"type\"},{\"equals\":\"AKS\",\"field\":\"Microsoft.MachineLearningServices/workspaces/computes/computeType\"},{\"anyOf\":[{\"exists\":false,\"field\":\"Microsoft.MachineLearningServices/workspaces/computes/resourceId\"},{\"equals\":true,\"value\":\"[empty(field('Microsoft.MachineLearningServices/workspaces/computes/resourceId'))]\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-Compute-SubnetId\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-Compute-SubnetId",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Enforce subnet connectivity for Azure Machine Learning compute clusters and compute instances.",
              "display_name": "Enforce subnet connectivity for Azure Machine Learning compute clusters and compute instances",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\"],\"category\":\"Machine Learning\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Deny-MachineLearning-Compute-SubnetId",
              "parameters": "{\"effect\":{\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.MachineLearningServices/workspaces/computes\",\"field\":\"type\"},{\"field\":\"Microsoft.MachineLearningServices/workspaces/computes/computeType\",\"in\":[\"AmlCompute\",\"ComputeInstance\"]},{\"anyOf\":[{\"exists\":false,\"field\":\"Microsoft.MachineLearningServices/workspaces/computes/subnet.id\"},{\"equals\":true,\"value\":\"[empty(field('Microsoft.MachineLearningServices/workspaces/computes/subnet.id'))]\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-Compute-VmSize\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-Compute-VmSize",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Limit allowed vm sizes for Azure Machine Learning compute clusters and compute instances.",
              "display_name": "Limit allowed vm sizes for Azure Machine Learning compute clusters and compute instances",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\"],\"category\":\"Budget\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Deny-MachineLearning-Compute-VmSize",
              "parameters": "{\"allowedVmSizes\":{\"defaultValue\":[\"Standard_D1_v2\",\"Standard_D2_v2\",\"Standard_D3_v2\",\"Standard_D4_v2\",\"Standard_D11_v2\",\"Standard_D12_v2\",\"Standard_D13_v2\",\"Standard_D14_v2\",\"Standard_DS1_v2\",\"Standard_DS2_v2\",\"Standard_DS3_v2\",\"Standard_DS4_v2\",\"Standard_DS5_v2\",\"Standard_DS11_v2\",\"Standard_DS12_v2\",\"Standard_DS13_v2\",\"Standard_DS14_v2\",\"Standard_M8-2ms\",\"Standard_M8-4ms\",\"Standard_M8ms\",\"Standard_M16-4ms\",\"Standard_M16-8ms\",\"Standard_M16ms\",\"Standard_M32-8ms\",\"Standard_M32-16ms\",\"Standard_M32ls\",\"Standard_M32ms\",\"Standard_M32ts\",\"Standard_M64-16ms\",\"Standard_M64-32ms\",\"Standard_M64ls\",\"Standard_M64ms\",\"Standard_M64s\",\"Standard_M128-32ms\",\"Standard_M128-64ms\",\"Standard_M128ms\",\"Standard_M128s\",\"Standard_M64\",\"Standard_M64m\",\"Standard_M128\",\"Standard_M128m\",\"Standard_D1\",\"Standard_D2\",\"Standard_D3\",\"Standard_D4\",\"Standard_D11\",\"Standard_D12\",\"Standard_D13\",\"Standard_D14\",\"Standard_DS15_v2\",\"Standard_NV6\",\"Standard_NV12\",\"Standard_NV24\",\"Standard_F2s_v2\",\"Standard_F4s_v2\",\"Standard_F8s_v2\",\"Standard_F16s_v2\",\"Standard_F32s_v2\",\"Standard_F64s_v2\",\"Standard_F72s_v2\",\"Standard_NC6s_v3\",\"Standard_NC12s_v3\",\"Standard_NC24rs_v3\",\"Standard_NC24s_v3\",\"Standard_NC6\",\"Standard_NC12\",\"Standard_NC24\",\"Standard_NC24r\",\"Standard_ND6s\",\"Standard_ND12s\",\"Standard_ND24rs\",\"Standard_ND24s\",\"Standard_NC6s_v2\",\"Standard_NC12s_v2\",\"Standard_NC24rs_v2\",\"Standard_NC24s_v2\",\"Standard_ND40rs_v2\",\"Standard_NV12s_v3\",\"Standard_NV24s_v3\",\"Standard_NV48s_v3\"],\"metadata\":{\"description\":\"Specifies the allowed VM Sizes for Aml Compute Clusters and Instances\",\"displayName\":\"Allowed VM Sizes for Aml Compute Clusters and Instances\"},\"type\":\"Array\"},\"effect\":{\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.MachineLearningServices/workspaces/computes\",\"field\":\"type\"},{\"field\":\"Microsoft.MachineLearningServices/workspaces/computes/computeType\",\"in\":[\"AmlCompute\",\"ComputeInstance\"]},{\"field\":\"Microsoft.MachineLearningServices/workspaces/computes/vmSize\",\"notIn\":\"[parameters('allowedVmSizes')]\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-ComputeCluster-RemoteLoginPortPublicAccess\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-ComputeCluster-RemoteLoginPortPublicAccess",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Deny public access of Azure Machine Learning clusters via SSH.",
              "display_name": "Deny public access of Azure Machine Learning clusters via SSH",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\"],\"category\":\"Machine Learning\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.1.0\"}",
              "mode": "All",
              "name": "Deny-MachineLearning-ComputeCluster-RemoteLoginPortPublicAccess",
              "parameters": "{\"effect\":{\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.MachineLearningServices/workspaces/computes\",\"field\":\"type\"},{\"equals\":\"AmlCompute\",\"field\":\"Microsoft.MachineLearningServices/workspaces/computes/computeType\"},{\"anyOf\":[{\"exists\":false,\"field\":\"Microsoft.MachineLearningServices/workspaces/computes/remoteLoginPortPublicAccess\"},{\"field\":\"Microsoft.MachineLearningServices/workspaces/computes/remoteLoginPortPublicAccess\",\"notEquals\":\"Disabled\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-ComputeCluster-Scale\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-ComputeCluster-Scale",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Enforce scale settings for Azure Machine Learning compute clusters.",
              "display_name": "Enforce scale settings for Azure Machine Learning compute clusters",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\"],\"category\":\"Budget\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Deny-MachineLearning-ComputeCluster-Scale",
              "parameters": "{\"effect\":{\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"maxNodeCount\":{\"defaultValue\":10,\"metadata\":{\"description\":\"Specifies the maximum node count of AML Clusters\",\"displayName\":\"Maximum Node Count\"},\"type\":\"Integer\"},\"maxNodeIdleTimeInSecondsBeforeScaleDown\":{\"defaultValue\":900,\"metadata\":{\"description\":\"Specifies the maximum node idle time in seconds before scaledown\",\"displayName\":\"Maximum Node Idle Time in Seconds Before Scaledown\"},\"type\":\"Integer\"},\"minNodeCount\":{\"defaultValue\":0,\"metadata\":{\"description\":\"Specifies the minimum node count of AML Clusters\",\"displayName\":\"Minimum Node Count\"},\"type\":\"Integer\"}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.MachineLearningServices/workspaces/computes\",\"field\":\"type\"},{\"equals\":\"AmlCompute\",\"field\":\"Microsoft.MachineLearningServices/workspaces/computes/computeType\"},{\"anyOf\":[{\"field\":\"Microsoft.MachineLearningServices/workspaces/computes/scaleSettings.maxNodeCount\",\"greater\":\"[parameters('maxNodeCount')]\"},{\"field\":\"Microsoft.MachineLearningServices/workspaces/computes/scaleSettings.minNodeCount\",\"greater\":\"[parameters('minNodeCount')]\"},{\"greater\":\"[parameters('maxNodeIdleTimeInSecondsBeforeScaleDown')]\",\"value\":\"[int(last(split(replace(replace(replace(replace(replace(replace(replace(field('Microsoft.MachineLearningServices/workspaces/computes/scaleSettings.nodeIdleTimeBeforeScaleDown'), 'P', '/'), 'Y', '/'), 'M', '/'), 'D', '/'), 'T', '/'), 'H', '/'), 'S', ''), '/')))]\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-HbiWorkspace\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-HbiWorkspace",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Enforces high business impact Azure Machine Learning workspaces.",
              "display_name": "Enforces high business impact Azure Machine Learning Workspaces",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\"],\"category\":\"Machine Learning\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Deny-MachineLearning-HbiWorkspace",
              "parameters": "{\"effect\":{\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.MachineLearningServices/workspaces\",\"field\":\"type\"},{\"anyOf\":[{\"exists\":false,\"field\":\"Microsoft.MachineLearningServices/workspaces/hbiWorkspace\"},{\"field\":\"Microsoft.MachineLearningServices/workspaces/hbiWorkspace\",\"notEquals\":true}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-PublicAccessWhenBehindVnet\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-PublicAccessWhenBehindVnet",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Deny public access behind vnet to Azure Machine Learning workspaces.",
              "display_name": "Deny public access behind vnet to Azure Machine Learning workspace",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\"],\"category\":\"Machine Learning\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.1\"}",
              "mode": "Indexed",
              "name": "Deny-MachineLearning-PublicAccessWhenBehindVnet",
              "parameters": "{\"effect\":{\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.MachineLearningServices/workspaces\",\"field\":\"type\"},{\"anyOf\":[{\"exists\":false,\"field\":\"Microsoft.MachineLearningServices/workspaces/allowPublicAccessWhenBehindVnet\"},{\"field\":\"Microsoft.MachineLearningServices/workspaces/allowPublicAccessWhenBehindVnet\",\"notEquals\":false}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-PublicNetworkAccess\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-PublicNetworkAccess",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Denies public network access for Azure Machine Learning workspaces. Superseded by https://www.azadvertizer.net/azpolicyadvertizer/438c38d2-3772-465a-a9cc-7a6666a275ce.html",
              "display_name": "[Deprecated] Azure Machine Learning should have disabled public network access",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\"],\"category\":\"Machine Learning\",\"deprecated\":true,\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"supersededBy\":\"438c38d2-3772-465a-a9cc-7a6666a275ce\",\"version\":\"1.0.0-deprecated\"}",
              "mode": "Indexed",
              "name": "Deny-MachineLearning-PublicNetworkAccess",
              "parameters": "{\"effect\":{\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.MachineLearningServices/workspaces\",\"field\":\"type\"},{\"field\":\"Microsoft.MachineLearningServices/workspaces/publicNetworkAccess\",\"notEquals\":\"Disabled\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-MgmtPorts-From-Internet\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-MgmtPorts-From-Internet",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "This policy denies any network security rule that allows management port access from the Internet, by default blocking SSH/RDP ports.",
              "display_name": "Management port access from the Internet should be blocked",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Network\",\"replacesPolicy\":\"Deny-RDP-From-Internet\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"2.1.1\"}",
              "mode": "All",
              "name": "Deny-MgmtPorts-From-Internet",
              "parameters": "{\"effect\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"ports\":{\"defaultValue\":[\"22\",\"3389\"],\"metadata\":{\"description\":\"Ports to be blocked\",\"displayName\":\"Ports\"},\"type\":\"Array\"}}",
              "policy_rule": "{\"if\":{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.Network/networkSecurityGroups/securityRules\",\"field\":\"type\"},{\"allOf\":[{\"equals\":\"Allow\",\"field\":\"Microsoft.Network/networkSecurityGroups/securityRules/access\"},{\"equals\":\"Inbound\",\"field\":\"Microsoft.Network/networkSecurityGroups/securityRules/direction\"},{\"anyOf\":[{\"equals\":\"*\",\"field\":\"Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange\"},{\"field\":\"Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange\",\"in\":\"[parameters('ports')]\"},{\"count\":{\"value\":\"[parameters('ports')]\",\"where\":{\"equals\":\"true\",\"value\":\"[if(and(not(empty(field('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange'))), contains(field('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange'),'-')), and(lessOrEquals(int(first(split(field('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange'), '-'))),int(current())),greaterOrEquals(int(last(split(field('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange'), '-'))),int(current()))), 'false')]\"}},\"greater\":0},{\"count\":{\"name\":\"ports\",\"value\":\"[parameters('ports')]\",\"where\":{\"count\":{\"field\":\"Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]\",\"where\":{\"equals\":\"true\",\"value\":\"[if(and(not(empty(current('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]'))), contains(current('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]'),'-')), and(lessOrEquals(int(first(split(current('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]'), '-'))),int(current('ports'))),greaterOrEquals(int(last(split(current('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]'), '-'))),int(current('ports')))) , 'false')]\"}},\"greater\":0}},\"greater\":0},{\"not\":{\"field\":\"Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]\",\"notEquals\":\"*\"}},{\"not\":{\"field\":\"Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]\",\"notIn\":\"[parameters('ports')]\"}}]},{\"anyOf\":[{\"equals\":\"*\",\"field\":\"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix\"},{\"equals\":\"Internet\",\"field\":\"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix\"},{\"not\":{\"field\":\"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefixes[*]\",\"notEquals\":\"*\"}},{\"not\":{\"field\":\"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefixes[*]\",\"notEquals\":\"Internet\"}}]}]}]},{\"allOf\":[{\"equals\":\"Microsoft.Network/networkSecurityGroups\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/networkSecurityGroups/securityRules[*]\",\"where\":{\"allOf\":[{\"equals\":\"Allow\",\"field\":\"Microsoft.Network/networkSecurityGroups/securityRules[*].access\"},{\"equals\":\"Inbound\",\"field\":\"Microsoft.Network/networkSecurityGroups/securityRules[*].direction\"},{\"anyOf\":[{\"equals\":\"*\",\"field\":\"Microsoft.Network/networkSecurityGroups/securityRules[*].destinationPortRange\"},{\"field\":\"Microsoft.Network/networkSecurityGroups/securityRules[*].destinationPortRange\",\"in\":\"[parameters('ports')]\"},{\"count\":{\"name\":\"ports\",\"value\":\"[parameters('ports')]\",\"where\":{\"equals\":\"true\",\"value\":\"[if(and(not(empty(current('Microsoft.Network/networkSecurityGroups/securityRules[*].destinationPortRange'))), contains(current('Microsoft.Network/networkSecurityGroups/securityRules[*].destinationPortRange'),'-')), and(lessOrEquals(int(first(split(current('Microsoft.Network/networkSecurityGroups/securityRules[*].destinationPortRange'), '-'))),int(current('ports'))),greaterOrEquals(int(last(split(current('Microsoft.Network/networkSecurityGroups/securityRules[*].destinationPortRange'), '-'))),int(current('ports')))), 'false')]\"}},\"greater\":0},{\"count\":{\"name\":\"ports\",\"value\":\"[parameters('ports')]\",\"where\":{\"count\":{\"field\":\"Microsoft.Network/networkSecurityGroups/securityRules[*].destinationPortRanges[*]\",\"where\":{\"equals\":\"true\",\"value\":\"[if(and(not(empty(current('Microsoft.Network/networkSecurityGroups/securityRules[*].destinationPortRanges[*]'))), contains(current('Microsoft.Network/networkSecurityGroups/securityRules[*].destinationPortRanges[*]'),'-')), and(lessOrEquals(int(first(split(current('Microsoft.Network/networkSecurityGroups/securityRules[*].destinationPortRanges[*]'), '-'))),int(current('ports'))),greaterOrEquals(int(last(split(current('Microsoft.Network/networkSecurityGroups/securityRules[*].destinationPortRanges[*]'), '-'))),int(current('ports')))) , 'false')]\"}},\"greater\":0}},\"greater\":0},{\"not\":{\"field\":\"Microsoft.Network/networkSecurityGroups/securityRules[*].destinationPortRanges[*]\",\"notEquals\":\"*\"}},{\"not\":{\"field\":\"Microsoft.Network/networkSecurityGroups/securityRules[*].destinationPortRanges[*]\",\"notIn\":\"[parameters('ports')]\"}}]},{\"anyOf\":[{\"equals\":\"*\",\"field\":\"Microsoft.Network/networkSecurityGroups/securityRules[*].sourceAddressPrefix\"},{\"equals\":\"Internet\",\"field\":\"Microsoft.Network/networkSecurityGroups/securityRules[*].sourceAddressPrefix\"},{\"not\":{\"field\":\"Microsoft.Network/networkSecurityGroups/securityRules[*].sourceAddressPrefixes[*]\",\"notEquals\":\"*\"}},{\"not\":{\"field\":\"Microsoft.Network/networkSecurityGroups/securityRules[*].sourceAddressPrefixes[*]\",\"notEquals\":\"Internet\"}}]}]}},\"greater\":0}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-MySql-http\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-MySql-http",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Azure Database for MySQL supports connecting your Azure Database for MySQL server to client applications using Secure Sockets Layer (SSL). Enforcing SSL connections between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.",
              "display_name": "MySQL database servers enforce SSL connections.",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"SQL\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Deny-MySql-http",
              "parameters": "{\"effect\":{\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"minimalTlsVersion\":{\"allowedValues\":[\"TLS1_2\",\"TLS1_0\",\"TLS1_1\",\"TLSEnforcementDisabled\"],\"defaultValue\":\"TLS1_2\",\"metadata\":{\"description\":\"Select version  minimum TLS version Azure Database for MySQL server to enforce\",\"displayName\":\"Select version minimum TLS for MySQL server\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.DBforMySQL/servers\",\"field\":\"type\"},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.DBforMySQL/servers/sslEnforcement\"},{\"field\":\"Microsoft.DBforMySQL/servers/sslEnforcement\",\"notEquals\":\"Enabled\"},{\"field\":\"Microsoft.DBforMySQL/servers/minimalTlsVersion\",\"notequals\":\"[parameters('minimalTlsVersion')]\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-PostgreSql-http\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-PostgreSql-http",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Azure Database for PostgreSQL supports connecting your Azure Database for PostgreSQL server to client applications using Secure Sockets Layer (SSL). Enforcing SSL connections between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.",
              "display_name": "PostgreSQL database servers enforce SSL connection.",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"SQL\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.1\"}",
              "mode": "Indexed",
              "name": "Deny-PostgreSql-http",
              "parameters": "{\"effect\":{\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"minimalTlsVersion\":{\"allowedValues\":[\"TLS1_2\",\"TLS1_0\",\"TLS1_1\",\"TLSEnforcementDisabled\"],\"defaultValue\":\"TLS1_2\",\"metadata\":{\"description\":\"Select version  minimum TLS version Azure Database for PostgreSQL server to enforce\",\"displayName\":\"Select version minimum TLS for PostgreSQL server\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.DBforPostgreSQL/servers\",\"field\":\"type\"},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.DBforPostgreSQL/servers/sslEnforcement\"},{\"field\":\"Microsoft.DBforPostgreSQL/servers/sslEnforcement\",\"notEquals\":\"Enabled\"},{\"field\":\"Microsoft.DBforPostgreSQL/servers/minimalTlsVersion\",\"notequals\":\"[parameters('minimalTlsVersion')]\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-Private-DNS-Zones\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-Private-DNS-Zones",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "This policy denies the creation of a private DNS in the current scope, used in combination with policies that create centralized private DNS in connectivity subscription",
              "display_name": "Deny the creation of private DNS",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Network\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Deny-Private-DNS-Zones",
              "parameters": "{\"effect\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Network/privateDnsZones\",\"field\":\"type\"},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-PublicEndpoint-MariaDB\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-PublicEndpoint-MariaDB",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "This policy denies the creation of Maria DB accounts with exposed public endpoints. Superseded by https://www.azadvertizer.net/azpolicyadvertizer/fdccbe47-f3e3-4213-ad5d-ea459b2fa077.html",
              "display_name": "[Deprecated] Public network access should be disabled for MariaDB",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"SQL\",\"deprecated\":true,\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"supersededBy\":\"fdccbe47-f3e3-4213-ad5d-ea459b2fa077\",\"version\":\"1.0.0-deprecated\"}",
              "mode": "Indexed",
              "name": "Deny-PublicEndpoint-MariaDB",
              "parameters": "{\"effect\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.DBforMariaDB/servers\",\"field\":\"type\"},{\"field\":\"Microsoft.DBforMariaDB/servers/publicNetworkAccess\",\"notequals\":\"Disabled\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-PublicIP\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-PublicIP",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "[Deprecated] This policy denies creation of Public IPs under the assigned scope. Superseded by https://www.azadvertizer.net/azpolicyadvertizer/6c112d4e-5bc7-47ae-a041-ea2d9dccd749.html using appropriate assignment parameters.",
              "display_name": "[Deprecated] Deny the creation of public IP",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Network\",\"deprecated\":true,\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"supersededBy\":\"6c112d4e-5bc7-47ae-a041-ea2d9dccd749\",\"version\":\"1.0.0-deprecated\"}",
              "mode": "Indexed",
              "name": "Deny-PublicIP",
              "parameters": "{\"effect\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Network/publicIPAddresses\",\"field\":\"type\"},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-RDP-From-Internet\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-RDP-From-Internet",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "This policy denies any network security rule that allows RDP access from Internet. This policy is superseded by https://www.azadvertizer.net/azpolicyadvertizer/Deny-MgmtPorts-From-Internet.html",
              "display_name": "[Deprecated] RDP access from the Internet should be blocked",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Network\",\"deprecated\":true,\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"supersededBy\":\"Deny-MgmtPorts-From-Internet\",\"version\":\"1.0.1-deprecated\"}",
              "mode": "All",
              "name": "Deny-RDP-From-Internet",
              "parameters": "{\"effect\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/networkSecurityGroups/securityRules\",\"field\":\"type\"},{\"allOf\":[{\"equals\":\"Allow\",\"field\":\"Microsoft.Network/networkSecurityGroups/securityRules/access\"},{\"equals\":\"Inbound\",\"field\":\"Microsoft.Network/networkSecurityGroups/securityRules/direction\"},{\"anyOf\":[{\"equals\":\"*\",\"field\":\"Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange\"},{\"equals\":\"3389\",\"field\":\"Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange\"},{\"equals\":\"true\",\"value\":\"[if(and(not(empty(field('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange'))), contains(field('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange'),'-')), and(lessOrEquals(int(first(split(field('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange'), '-'))),3389),greaterOrEquals(int(last(split(field('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange'), '-'))),3389)), 'false')]\"},{\"count\":{\"field\":\"Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]\",\"where\":{\"equals\":\"true\",\"value\":\"[if(and(not(empty(first(field('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]')))), contains(first(field('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]')),'-')), and(lessOrEquals(int(first(split(first(field('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]')), '-'))),3389),greaterOrEquals(int(last(split(first(field('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]')), '-'))),3389)) , 'false')]\"}},\"greater\":0},{\"not\":{\"field\":\"Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]\",\"notEquals\":\"*\"}},{\"not\":{\"field\":\"Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]\",\"notEquals\":\"3389\"}}]},{\"anyOf\":[{\"equals\":\"*\",\"field\":\"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix\"},{\"equals\":\"Internet\",\"field\":\"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix\"},{\"not\":{\"field\":\"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefixes[*]\",\"notEquals\":\"*\"}},{\"not\":{\"field\":\"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefixes[*]\",\"notEquals\":\"Internet\"}}]}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-Redis-http\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-Redis-http",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Audit enabling of only connections via SSL to Azure Cache for Redis. Validate both minimum TLS version and enableNonSslPort is disabled. Use of secure connections ensures authentication between the server and the service and protects data in transit from network layer attacks such as man-in-the-middle, eavesdropping, and session-hijacking",
              "display_name": "Azure Cache for Redis only secure connections should be enabled",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Cache\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Deny-Redis-http",
              "parameters": "{\"effect\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"The effect determines what happens when the policy rule is evaluated to match\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"minimumTlsVersion\":{\"allowedValues\":[\"1.2\",\"1.1\",\"1.0\"],\"defaultValue\":\"1.2\",\"metadata\":{\"description\":\"Select minimum TLS version for Azure Cache for Redis.\",\"displayName\":\"Select minumum TLS version for Azure Cache for Redis.\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Cache/redis\",\"field\":\"type\"},{\"anyOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Cache/Redis/enableNonSslPort\"},{\"field\":\"Microsoft.Cache/Redis/minimumTlsVersion\",\"notequals\":\"[parameters('minimumTlsVersion')]\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-Service-Endpoints\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-Service-Endpoints",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "This Policy will deny/audit Service Endpoints on subnets. Service Endpoints allows the network traffic to bypass Network appliances, such as the Azure Firewall.",
              "display_name": "Deny or Audit service endpoints on subnets",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Network\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.0\"}",
              "mode": "All",
              "name": "Deny-Service-Endpoints",
              "parameters": "{\"effect\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/virtualNetworks/subnets\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/virtualNetworks/subnets/serviceEndpoints[*]\",\"where\":{\"exists\":true,\"field\":\"Microsoft.Network/virtualNetworks/subnets/serviceEndpoints[*].service\"}},\"greater\":0}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-Sql-minTLS\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-Sql-minTLS",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Setting minimal TLS version to 1.2 improves security by ensuring your Azure SQL Database can only be accessed from clients using TLS 1.2. Using versions of TLS less than 1.2 is not reccomended since they have well documented security vunerabilities.",
              "display_name": "Azure SQL Database should have the minimal TLS version set to the highest version",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"SQL\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Deny-Sql-minTLS",
              "parameters": "{\"effect\":{\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"minimalTlsVersion\":{\"allowedValues\":[\"1.2\",\"1.1\",\"1.0\"],\"defaultValue\":\"1.2\",\"metadata\":{\"description\":\"Select version minimum TLS version SQL servers to enforce\",\"displayName\":\"Select version for SQL server\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Sql/servers\",\"field\":\"type\"},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.Sql/servers/minimalTlsVersion\"},{\"field\":\"Microsoft.Sql/servers/minimalTlsVersion\",\"notequals\":\"[parameters('minimalTlsVersion')]\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-SqlMi-minTLS\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-SqlMi-minTLS",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Setting minimal TLS version to 1.2 improves security by ensuring your SQL Managed Instance can only be accessed from clients using TLS 1.2. Using versions of TLS less than 1.2 is not reccomended since they have well documented security vunerabilities.",
              "display_name": "SQL Managed Instance should have the minimal TLS version set to the highest version",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"SQL\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Deny-SqlMi-minTLS",
              "parameters": "{\"effect\":{\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"minimalTlsVersion\":{\"allowedValues\":[\"1.2\",\"1.1\",\"1.0\"],\"defaultValue\":\"1.2\",\"metadata\":{\"description\":\"Select version minimum TLS version SQL servers to enforce\",\"displayName\":\"Select version for SQL server\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Sql/managedInstances\",\"field\":\"type\"},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.Sql/managedInstances/minimalTlsVersion\"},{\"field\":\"Microsoft.Sql/managedInstances/minimalTlsVersion\",\"notequals\":\"[parameters('minimalTlsVersion')]\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-Storage-ContainerDeleteRetentionPolicy\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-Storage-ContainerDeleteRetentionPolicy",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Enforce container delete retention policies larger than seven days for storage account. Enable this for increased data loss protection.",
              "display_name": "Storage Accounts should use a container delete retention policy",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Storage\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.0\"}",
              "mode": "All",
              "name": "Deny-Storage-ContainerDeleteRetentionPolicy",
              "parameters": "{\"effect\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"minContainerDeleteRetentionInDays\":{\"defaultValue\":7,\"metadata\":{\"description\":\"Specifies the minimum number of days for the container delete retention policy\",\"displayName\":\"Minimum Container Delete Retention in Days\"},\"type\":\"Integer\"}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Storage/storageAccounts/blobServices\",\"field\":\"type\"},{\"anyOf\":[{\"exists\":false,\"field\":\"Microsoft.Storage/storageAccounts/blobServices/containerDeleteRetentionPolicy.enabled\"},{\"field\":\"Microsoft.Storage/storageAccounts/blobServices/containerDeleteRetentionPolicy.enabled\",\"notEquals\":true},{\"field\":\"Microsoft.Storage/storageAccounts/blobServices/containerDeleteRetentionPolicy.days\",\"less\":\"[parameters('minContainerDeleteRetentionInDays')]\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-Storage-CopyScope\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-Storage-CopyScope",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Azure Storage accounts should restrict the allowed copy scope. Enforce this for increased data exfiltration protection.",
              "display_name": "Allowed Copy scope should be restricted for Storage Accounts",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Storage\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.0\"}",
              "mode": "All",
              "name": "Deny-Storage-CopyScope",
              "parameters": "{\"allowedCopyScope\":{\"allowedValues\":[\"AAD\",\"PrivateLink\"],\"defaultValue\":\"AAD\",\"metadata\":{\"description\":\"Specify the allowed copy scope.\",\"displayName\":\"Allowed Copy Scope\"},\"type\":\"String\"},\"effect\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Storage/storageAccounts\",\"field\":\"type\"},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.Storage/storageAccounts/allowedCopyScope\"},{\"field\":\"Microsoft.Storage/storageAccounts/allowedCopyScope\",\"notEquals\":\"[parameters('allowedCopyScope')]\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-Storage-CorsRules\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-Storage-CorsRules",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Deny CORS rules for storage account for increased data exfiltration protection and endpoint protection.",
              "display_name": "Storage Accounts should restrict CORS rules",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Storage\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.0\"}",
              "mode": "All",
              "name": "Deny-Storage-CorsRules",
              "parameters": "{\"effect\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.Storage/storageAccounts/blobServices\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Storage/storageAccounts/blobServices/cors.corsRules[*]\"},\"greater\":0}]},{\"allOf\":[{\"equals\":\"Microsoft.Storage/storageAccounts/fileServices\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Storage/storageAccounts/fileServices/cors.corsRules[*]\"},\"greater\":0}]},{\"allOf\":[{\"equals\":\"Microsoft.Storage/storageAccounts/tableServices\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Storage/storageAccounts/tableServices/cors.corsRules[*]\"},\"greater\":0}]},{\"allOf\":[{\"equals\":\"Microsoft.Storage/storageAccounts/queueServices\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Storage/storageAccounts/queueServices/cors.corsRules[*]\"},\"greater\":0}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-Storage-LocalUser\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-Storage-LocalUser",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Azure Storage accounts should disable local users for features like SFTP. Enforce this for increased data exfiltration protection.",
              "display_name": "Local users should be restricted for Storage Accounts",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Storage\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.0\"}",
              "mode": "All",
              "name": "Deny-Storage-LocalUser",
              "parameters": "{\"effect\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Storage/storageAccounts\",\"field\":\"type\"},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.Storage/storageAccounts/isLocalUserEnabled\"},{\"field\":\"Microsoft.Storage/storageAccounts/isLocalUserEnabled\",\"notEquals\":false}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-Storage-NetworkAclsBypass\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-Storage-NetworkAclsBypass",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Azure Storage accounts should restrict the bypass option for service-level network ACLs. Enforce this for increased data exfiltration protection.",
              "display_name": "Network ACL bypass option should be restricted for Storage Accounts",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Storage\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.0\"}",
              "mode": "All",
              "name": "Deny-Storage-NetworkAclsBypass",
              "parameters": "{\"allowedBypassOptions\":{\"allowedValues\":[\"None\",\"Logging\",\"Metrics\",\"AzureServices\",\"Logging, Metrics\",\"Logging, AzureServices\",\"Metrics, AzureServices\",\"Logging, Metrics, AzureServices\",\"Logging, Metrics, AzureServices\"],\"defaultValue\":[\"Logging\",\"Metrics\",\"AzureServices\",\"Logging, Metrics\",\"Logging, AzureServices\",\"Metrics, AzureServices\",\"Logging, Metrics, AzureServices\",\"Logging, Metrics, AzureServices\"],\"metadata\":{\"description\":\"Specifies which options are allowed to bypass the vnet configuration\",\"displayName\":\"Allowed Bypass Options\"},\"type\":\"Array\"},\"effect\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Storage/storageAccounts\",\"field\":\"type\"},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.Storage/storageAccounts/networkAcls.bypass\"},{\"field\":\"Microsoft.Storage/storageAccounts/networkAcls.bypass\",\"notIn\":\"[parameters('allowedBypassOptions')]\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-Storage-NetworkAclsVirtualNetworkRules\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-Storage-NetworkAclsVirtualNetworkRules",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Azure Storage accounts should restrict the virtual network service-level network ACLs. Enforce this for increased data exfiltration protection.",
              "display_name": "Virtual network rules should be restricted for Storage Accounts",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Storage\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.0\"}",
              "mode": "All",
              "name": "Deny-Storage-NetworkAclsVirtualNetworkRules",
              "parameters": "{\"effect\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Storage/storageAccounts\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Storage/storageAccounts/networkAcls.virtualNetworkRules[*]\"},\"greater\":0}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-Storage-ResourceAccessRulesResourceId\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-Storage-ResourceAccessRulesResourceId",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Azure Storage accounts should restrict the resource access rule for service-level network ACLs to services from a specific Azure subscription. Enforce this for increased data exfiltration protection.",
              "display_name": "Resource Access Rules resource IDs should be restricted for Storage Accounts",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Storage\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.0\"}",
              "mode": "All",
              "name": "Deny-Storage-ResourceAccessRulesResourceId",
              "parameters": "{\"effect\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Storage/storageAccounts\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Storage/storageAccounts/networkAcls.resourceAccessRules[*]\"},\"greater\":0},{\"count\":{\"field\":\"Microsoft.Storage/storageAccounts/networkAcls.resourceAccessRules[*]\",\"where\":{\"equals\":\"*\",\"value\":\"[split(current('Microsoft.Storage/storageAccounts/networkAcls.resourceAccessRules[*].resourceId'), '/')[2]]\"}},\"greater\":0}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-Storage-ResourceAccessRulesTenantId\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-Storage-ResourceAccessRulesTenantId",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Azure Storage accounts should restrict the resource access rule for service-level network ACLs to service from the same AAD tenant. Enforce this for increased data exfiltration protection.",
              "display_name": "Resource Access Rules Tenants should be restricted for Storage Accounts",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Storage\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.0\"}",
              "mode": "All",
              "name": "Deny-Storage-ResourceAccessRulesTenantId",
              "parameters": "{\"effect\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Storage/storageAccounts\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Storage/storageAccounts/networkAcls.resourceAccessRules[*]\"},\"greater\":0},{\"field\":\"Microsoft.Storage/storageAccounts/networkAcls.resourceAccessRules[*].tenantId\",\"notEquals\":\"[subscription().tenantId]\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-Storage-SFTP\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-Storage-SFTP",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "This policy denies the creation of Storage Accounts with SFTP enabled for Blob Storage.",
              "display_name": "Storage Accounts with SFTP enabled should be denied",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Storage\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Deny-Storage-SFTP",
              "parameters": "{\"effect\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"The effect determines what happens when the policy rule is evaluated to match\",\"displayName\":\"Effect\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Storage/storageAccounts\",\"field\":\"type\"},{\"equals\":\"true\",\"field\":\"Microsoft.Storage/storageAccounts/isSftpEnabled\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-Storage-ServicesEncryption\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-Storage-ServicesEncryption",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Azure Storage accounts should enforce encryption for all storage services. Enforce this for increased encryption scope.",
              "display_name": "Encryption for storage services should be enforced for Storage Accounts",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Storage\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.0\"}",
              "mode": "All",
              "name": "Deny-Storage-ServicesEncryption",
              "parameters": "{\"effect\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Storage/storageAccounts\",\"field\":\"type\"},{\"anyOf\":[{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.Storage/storageAccounts/encryption.services.blob.enabled\"},{\"field\":\"Microsoft.Storage/storageAccounts/encryption.services.blob.enabled\",\"notEquals\":true}]},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.Storage/storageAccounts/encryption.services.file.enabled\"},{\"field\":\"Microsoft.Storage/storageAccounts/encryption.services.file.enabled\",\"notEquals\":true}]},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.Storage/storageAccounts/encryption.services.queue.keyType\"},{\"field\":\"Microsoft.Storage/storageAccounts/encryption.services.queue.keyType\",\"notEquals\":\"Account\"}]},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.Storage/storageAccounts/encryption.services.table.keyType\"},{\"field\":\"Microsoft.Storage/storageAccounts/encryption.services.table.keyType\",\"notEquals\":\"Account\"}]}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-Storage-minTLS\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-Storage-minTLS",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Audit requirement of Secure transfer in your storage account. This policy is superseded by https://www.azadvertizer.net/azpolicyadvertizer/fe83a0eb-a853-422d-aac2-1bffd182c5d0.html and https://www.azadvertizer.net/azpolicyadvertizer/404c3081-a854-4457-ae30-26a93ef643f9.html",
              "display_name": "[Deprecated] Storage Account set to minimum TLS and Secure transfer should be enabled",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Storage\",\"deprecated\":true,\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"supersededBy\":\"fe83a0eb-a853-422d-aac2-1bffd182c5d0,404c3081-a854-4457-ae30-26a93ef643f9\",\"version\":\"1.0.0-deprecated\"}",
              "mode": "All",
              "name": "Deny-Storage-minTLS",
              "parameters": "{\"effect\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"The effect determines what happens when the policy rule is evaluated to match\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"minimumTlsVersion\":{\"allowedValues\":[\"TLS1_2\",\"TLS1_1\",\"TLS1_0\"],\"defaultValue\":\"TLS1_2\",\"metadata\":{\"description\":\"Select version  minimum TLS version on Azure Storage Account to enforce\",\"displayName\":\"Storage Account select minimum TLS version\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Storage/storageAccounts\",\"field\":\"type\"},{\"anyOf\":[{\"allOf\":[{\"less\":\"2019-04-01\",\"value\":\"[requestContext().apiVersion]\"},{\"exists\":\"false\",\"field\":\"Microsoft.Storage/storageAccounts/supportsHttpsTrafficOnly\"}]},{\"equals\":\"false\",\"field\":\"Microsoft.Storage/storageAccounts/supportsHttpsTrafficOnly\"},{\"field\":\"Microsoft.Storage/storageAccounts/minimumTlsVersion\",\"notequals\":\"[parameters('minimumTlsVersion')]\"},{\"exists\":\"false\",\"field\":\"Microsoft.Storage/storageAccounts/minimumTlsVersion\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-StorageAccount-CustomDomain\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-StorageAccount-CustomDomain",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "This policy denies the creation of Storage Accounts with custom domains assigned as communication cannot be encrypted, and always uses HTTP.",
              "display_name": "Storage Accounts with custom domains assigned should be denied",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Storage\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.0\"}",
              "mode": "All",
              "name": "Deny-StorageAccount-CustomDomain",
              "parameters": "{\"effect\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"The effect determines what happens when the policy rule is evaluated to match\",\"displayName\":\"Effect\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Storage/storageAccounts\",\"field\":\"type\"},{\"anyOf\":[{\"exists\":\"true\",\"field\":\"Microsoft.Storage/storageAccounts/customDomain\"},{\"equals\":\"true\",\"field\":\"Microsoft.Storage/storageAccounts/customDomain.useSubDomainName\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-Subnet-Without-Nsg\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-Subnet-Without-Nsg",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "This policy denies the creation of a subnet without a Network Security Group. NSG help to protect traffic across subnet-level.",
              "display_name": "Subnets should have a Network Security Group",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Network\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"2.0.0\"}",
              "mode": "All",
              "name": "Deny-Subnet-Without-Nsg",
              "parameters": "{\"effect\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"excludedSubnets\":{\"defaultValue\":[\"GatewaySubnet\",\"AzureFirewallSubnet\",\"AzureFirewallManagementSubnet\"],\"metadata\":{\"description\":\"Array of subnet names that are excluded from this policy\",\"displayName\":\"Excluded Subnets\"},\"type\":\"Array\"}}",
              "policy_rule": "{\"if\":{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.Network/virtualNetworks\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/virtualNetworks/subnets[*]\",\"where\":{\"allOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.Network/virtualNetworks/subnets[*].networkSecurityGroup.id\"},{\"field\":\"Microsoft.Network/virtualNetworks/subnets[*].name\",\"notIn\":\"[parameters('excludedSubnets')]\"}]}},\"notEquals\":0}]},{\"allOf\":[{\"equals\":\"Microsoft.Network/virtualNetworks/subnets\",\"field\":\"type\"},{\"field\":\"name\",\"notIn\":\"[parameters('excludedSubnets')]\"},{\"exists\":\"false\",\"field\":\"Microsoft.Network/virtualNetworks/subnets/networkSecurityGroup.id\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-Subnet-Without-Penp\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-Subnet-Without-Penp",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "This policy denies the creation of a subnet without Private Endpoint Netwotk Policies enabled. This policy is intended for 'workload' subnets, not 'central infrastructure' (aka, 'hub') subnets.",
              "display_name": "Subnets without Private Endpoint Network Policies enabled should be denied",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Network\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.0\"}",
              "mode": "All",
              "name": "Deny-Subnet-Without-Penp",
              "parameters": "{\"effect\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"The effect determines what happens when the policy rule is evaluated to match\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"excludedSubnets\":{\"defaultValue\":[\"GatewaySubnet\",\"AzureFirewallSubnet\",\"AzureFirewallManagementSubnet\",\"AzureBastionSubnet\"],\"metadata\":{\"description\":\"Array of subnet names that are excluded from this policy\",\"displayName\":\"Excluded Subnets\"},\"type\":\"Array\"}}",
              "policy_rule": "{\"if\":{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.Network/virtualNetworks\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/virtualNetworks/subnets[*]\",\"where\":{\"allOf\":[{\"field\":\"Microsoft.Network/virtualNetworks/subnets[*].privateEndpointNetworkPolicies\",\"notEquals\":\"Enabled\"},{\"field\":\"Microsoft.Network/virtualNetworks/subnets[*].name\",\"notIn\":\"[parameters('excludedSubnets')]\"}]}},\"notEquals\":0}]},{\"allOf\":[{\"equals\":\"Microsoft.Network/virtualNetworks/subnets\",\"field\":\"type\"},{\"field\":\"name\",\"notIn\":\"[parameters('excludedSubnets')]\"},{\"field\":\"Microsoft.Network/virtualNetworks/subnets/privateEndpointNetworkPolicies\",\"notEquals\":\"Enabled\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-Subnet-Without-Udr\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-Subnet-Without-Udr",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "This policy denies the creation of a subnet without a User Defined Route (UDR).",
              "display_name": "Subnets should have a User Defined Route",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Network\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"2.0.0\"}",
              "mode": "All",
              "name": "Deny-Subnet-Without-Udr",
              "parameters": "{\"effect\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"excludedSubnets\":{\"defaultValue\":[\"AzureBastionSubnet\"],\"metadata\":{\"description\":\"Array of subnet names that are excluded from this policy\",\"displayName\":\"Excluded Subnets\"},\"type\":\"Array\"}}",
              "policy_rule": "{\"if\":{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.Network/virtualNetworks\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/virtualNetworks/subnets[*]\",\"where\":{\"allOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.Network/virtualNetworks/subnets[*].routeTable.id\"},{\"field\":\"Microsoft.Network/virtualNetworks/subnets[*].name\",\"notIn\":\"[parameters('excludedSubnets')]\"}]}},\"notEquals\":0}]},{\"allOf\":[{\"equals\":\"Microsoft.Network/virtualNetworks/subnets\",\"field\":\"type\"},{\"field\":\"name\",\"notIn\":\"[parameters('excludedSubnets')]\"},{\"exists\":\"false\",\"field\":\"Microsoft.Network/virtualNetworks/subnets/routeTable.id\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-UDR-With-Specific-NextHop\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-UDR-With-Specific-NextHop",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "This policy denies the creation of a User Defined Route with 'Next Hop Type' set to 'Internet' or 'VirtualNetworkGateway'.",
              "display_name": "User Defined Routes with 'Next Hop Type' set to 'Internet' or 'VirtualNetworkGateway' should be denied",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Network\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.0\"}",
              "mode": "All",
              "name": "Deny-UDR-With-Specific-NextHop",
              "parameters": "{\"effect\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"The effect determines what happens when the policy rule is evaluated to match\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"excludedDestinations\":{\"defaultValue\":[\"Internet\",\"VirtualNetworkGateway\"],\"metadata\":{\"description\":\"Array of route destinations that are to be denied\",\"displayName\":\"Excluded Destinations\"},\"type\":\"Array\"}}",
              "policy_rule": "{\"if\":{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.Network/routeTables\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/routeTables/routes[*]\",\"where\":{\"field\":\"Microsoft.Network/routeTables/routes[*].nextHopType\",\"in\":\"[parameters('excludedDestinations')]\"}},\"notEquals\":0}]},{\"allOf\":[{\"equals\":\"Microsoft.Network/routeTables/routes\",\"field\":\"type\"},{\"field\":\"Microsoft.Network/routeTables/routes/nextHopType\",\"in\":\"[parameters('excludedDestinations')]\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-VNET-Peer-Cross-Sub\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-VNET-Peer-Cross-Sub",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "This policy denies the creation of vNet Peerings outside of the same subscriptions under the assigned scope.",
              "display_name": "Deny vNet peering cross subscription.",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Network\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.1\"}",
              "mode": "All",
              "name": "Deny-VNET-Peer-Cross-Sub",
              "parameters": "{\"effect\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/virtualNetworks/virtualNetworkPeerings\",\"field\":\"type\"},{\"field\":\"Microsoft.Network/virtualNetworks/virtualNetworkPeerings/remoteVirtualNetwork.id\",\"notcontains\":\"[subscription().id]\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-VNET-Peering-To-Non-Approved-VNETs\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-VNET-Peering-To-Non-Approved-VNETs",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "This policy denies the creation of vNet Peerings to non-approved vNets under the assigned scope.",
              "display_name": "Deny vNet peering to non-approved vNets",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Network\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.0\"}",
              "mode": "All",
              "name": "Deny-VNET-Peering-To-Non-Approved-VNETs",
              "parameters": "{\"allowedVnets\":{\"defaultValue\":[],\"metadata\":{\"description\":\"Array of allowed vNets that can be peered with. Must be entered using their resource ID. Example: /subscriptions/{subId}/resourceGroups/{resourceGroupName}/providers/Microsoft.Network/virtualNetworks/{vnetName}\",\"displayName\":\"Allowed vNets to peer with\"},\"type\":\"Array\"},\"effect\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.Network/virtualNetworks/virtualNetworkPeerings\",\"field\":\"type\"},{\"not\":{\"field\":\"Microsoft.Network/virtualNetworks/virtualNetworkPeerings/remoteVirtualNetwork.id\",\"in\":\"[parameters('allowedVnets')]\"}}]},{\"allOf\":[{\"equals\":\"Microsoft.Network/virtualNetworks\",\"field\":\"type\"},{\"not\":{\"field\":\"Microsoft.Network/virtualNetworks/virtualNetworkPeerings[*].remoteVirtualNetwork.id\",\"in\":\"[parameters('allowedVnets')]\"}},{\"not\":{\"exists\":false,\"field\":\"Microsoft.Network/virtualNetworks/virtualNetworkPeerings[*].remoteVirtualNetwork.id\"}}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-VNet-Peering\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-VNet-Peering",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "This policy denies the creation of vNet Peerings under the assigned scope.",
              "display_name": "Deny vNet peering ",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Network\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.1\"}",
              "mode": "All",
              "name": "Deny-VNet-Peering",
              "parameters": "{\"effect\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Network/virtualNetworks/virtualNetworkPeerings\",\"field\":\"type\"},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/DenyAction-ActivityLogs\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/DenyAction-ActivityLogs",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "This is a DenyAction implementation policy on Activity Logs.",
              "display_name": "DenyAction implementation on Activity Logs",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"deprecated\":false,\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "DenyAction-ActivityLogs",
              "parameters": null,
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Resources/subscriptions/providers/diagnosticSettings\",\"field\":\"type\"},\"then\":{\"details\":{\"actionNames\":[\"delete\"]},\"effect\":\"denyAction\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/DenyAction-DeleteResources\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/DenyAction-DeleteResources",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "This policy enables you to specify the resource and resource type that your organization can protect from accidentals deletion by blocking delete calls using the deny action effect.",
              "display_name": "Do not allow deletion of specified resource and resource type",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"General\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.0\"}",
              "mode": "All",
              "name": "DenyAction-DeleteResources",
              "parameters": "{\"effect\":{\"allowedValues\":[\"DenyAction\",\"Disabled\"],\"defaultValue\":\"DenyAction\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"resourceName\":{\"metadata\":{\"description\":\"Provide the name of the resource that you want to protect from accidental deletion.\",\"displayName\":\"Resource Name\"},\"type\":\"String\"},\"resourceType\":{\"metadata\":{\"description\":\"Provide the resource type that you want to protect from accidental deletion.\",\"displayName\":\"Resource Type\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"[parameters('resourceType')]\",\"field\":\"type\"},{\"field\":\"name\",\"like\":\"[parameters('resourceName')]\"}]},\"then\":{\"details\":{\"actionNames\":[\"delete\"]},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/DenyAction-DiagnosticLogs\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/DenyAction-DiagnosticLogs",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "DenyAction implementation on Diagnostic Logs.",
              "display_name": "DenyAction implementation on Diagnostic Logs.",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"deprecated\":false,\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "DenyAction-DiagnosticLogs",
              "parameters": null,
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Insights/diagnosticSettings\",\"field\":\"type\"},\"then\":{\"details\":{\"actionNames\":[\"delete\"]},\"effect\":\"denyAction\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-ASC-SecurityContacts\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-ASC-SecurityContacts",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Deploy Microsoft Defender for Cloud Security Contacts",
              "display_name": "Deploy Microsoft Defender for Cloud Security Contacts",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Security Center\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.1.0\"}",
              "mode": "All",
              "name": "Deploy-ASC-SecurityContacts",
              "parameters": "{\"effect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"string\"},\"emailSecurityContact\":{\"metadata\":{\"description\":\"Provide email address for Azure Security Center contact details\",\"displayName\":\"Security contacts email address\"},\"type\":\"string\"},\"minimalSeverity\":{\"allowedValues\":[\"High\",\"Medium\",\"Low\"],\"defaultValue\":\"High\",\"metadata\":{\"description\":\"Defines the minimal alert severity which will be sent as email notifications\",\"displayName\":\"Minimal severity\"},\"type\":\"string\"}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Resources/subscriptions\",\"field\":\"type\"}]},\"then\":{\"details\":{\"deployment\":{\"location\":\"northeurope\",\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"emailSecurityContact\":{\"value\":\"[parameters('emailSecurityContact')]\"},\"minimalSeverity\":{\"value\":\"[parameters('minimalSeverity')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"emailSecurityContact\":{\"metadata\":{\"description\":\"Security contacts email address\"},\"type\":\"string\"},\"minimalSeverity\":{\"metadata\":{\"description\":\"Minimal severity level reported\"},\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-01-01-preview\",\"name\":\"default\",\"properties\":{\"alertNotifications\":{\"minimalSeverity\":\"[parameters('minimalSeverity')]\",\"state\":\"On\"},\"emails\":\"[parameters('emailSecurityContact')]\",\"notificationsByRole\":{\"roles\":[\"Owner\"],\"state\":\"On\"}},\"type\":\"Microsoft.Security/securityContacts\"}],\"variables\":{}}}},\"deploymentScope\":\"subscription\",\"existenceCondition\":{\"allOf\":[{\"contains\":\"[parameters('emailSecurityContact')]\",\"field\":\"Microsoft.Security/securityContacts/email\"},{\"contains\":\"[parameters('minimalSeverity')]\",\"field\":\"Microsoft.Security/securityContacts/alertNotifications.minimalSeverity\"},{\"equals\":\"Microsoft.Security/securityContacts\",\"field\":\"type\"},{\"equals\":\"On\",\"field\":\"Microsoft.Security/securityContacts/alertNotifications\"},{\"equals\":\"On\",\"field\":\"Microsoft.Security/securityContacts/alertsToAdmins\"}]},\"existenceScope\":\"subscription\",\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/fb1c8493-542b-48eb-b624-b4c8fea62acd\"],\"type\":\"Microsoft.Security/securityContacts\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Budget\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Budget",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Deploy a default budget on all subscriptions under the assigned scope",
              "display_name": "Deploy a default budget on all subscriptions under the assigned scope",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureUSGovernment\"],\"category\":\"Budget\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.1.0\"}",
              "mode": "All",
              "name": "Deploy-Budget",
              "parameters": "{\"amount\":{\"defaultValue\":\"1000\",\"metadata\":{\"description\":\"The total amount of cost or usage to track with the budget\"},\"type\":\"String\"},\"budgetName\":{\"defaultValue\":\"budget-set-by-policy\",\"metadata\":{\"description\":\"The name for the budget to be created\"},\"type\":\"String\"},\"contactEmails\":{\"defaultValue\":[],\"metadata\":{\"description\":\"The list of email addresses, in an array, to send the budget notification to when the threshold is exceeded.\"},\"type\":\"Array\"},\"contactGroups\":{\"defaultValue\":[],\"metadata\":{\"description\":\"The list of action groups, in an array, to send the budget notification to when the threshold is exceeded. It accepts array of strings.\"},\"type\":\"Array\"},\"contactRoles\":{\"defaultValue\":[\"Owner\",\"Contributor\"],\"metadata\":{\"description\":\"The list of contact RBAC roles, in an array, to send the budget notification to when the threshold is exceeded.\"},\"type\":\"Array\"},\"effect\":{\"allowedValues\":[\"DeployIfNotExists\",\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\"},\"type\":\"String\"},\"firstThreshold\":{\"defaultValue\":\"90\",\"metadata\":{\"description\":\"Threshold value associated with a notification. Notification is sent when the cost exceeded the threshold. It is always percent and has to be between 0 and 1000.\"},\"type\":\"String\"},\"secondThreshold\":{\"defaultValue\":\"100\",\"metadata\":{\"description\":\"Threshold value associated with a notification. Notification is sent when the cost exceeded the threshold. It is always percent and has to be between 0 and 1000.\"},\"type\":\"String\"},\"timeGrain\":{\"allowedValues\":[\"Monthly\",\"Quarterly\",\"Annually\",\"BillingMonth\",\"BillingQuarter\",\"BillingAnnual\"],\"defaultValue\":\"Monthly\",\"metadata\":{\"description\":\"The time covered by a budget. Tracking of the amount will be reset based on the time grain.\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Resources/subscriptions\",\"field\":\"type\"}]},\"then\":{\"details\":{\"deployment\":{\"location\":\"northeurope\",\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"amount\":{\"value\":\"[parameters('amount')]\"},\"budgetName\":{\"value\":\"[parameters('budgetName')]\"},\"contactEmails\":{\"value\":\"[parameters('contactEmails')]\"},\"contactGroups\":{\"value\":\"[parameters('contactGroups')]\"},\"contactRoles\":{\"value\":\"[parameters('contactRoles')]\"},\"firstThreshold\":{\"value\":\"[parameters('firstThreshold')]\"},\"secondThreshold\":{\"value\":\"[parameters('secondThreshold')]\"},\"timeGrain\":{\"value\":\"[parameters('timeGrain')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"amount\":{\"type\":\"String\"},\"budgetName\":{\"type\":\"String\"},\"contactEmails\":{\"type\":\"Array\"},\"contactGroups\":{\"type\":\"Array\"},\"contactRoles\":{\"type\":\"Array\"},\"firstThreshold\":{\"type\":\"String\"},\"secondThreshold\":{\"type\":\"String\"},\"startDate\":{\"defaultValue\":\"[concat(utcNow('MM'), '/01/', utcNow('yyyy'))]\",\"type\":\"String\"},\"timeGrain\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2019-10-01\",\"name\":\"[parameters('budgetName')]\",\"properties\":{\"amount\":\"[parameters('amount')]\",\"category\":\"Cost\",\"notifications\":{\"NotificationForExceededBudget1\":{\"contactEmails\":\"[parameters('contactEmails')]\",\"contactGroups\":\"[parameters('contactGroups')]\",\"contactRoles\":\"[parameters('contactRoles')]\",\"enabled\":true,\"operator\":\"GreaterThan\",\"threshold\":\"[parameters('firstThreshold')]\"},\"NotificationForExceededBudget2\":{\"contactEmails\":\"[parameters('contactEmails')]\",\"contactGroups\":\"[parameters('contactGroups')]\",\"contactRoles\":\"[parameters('contactRoles')]\",\"enabled\":true,\"operator\":\"GreaterThan\",\"threshold\":\"[parameters('secondThreshold')]\"}},\"timeGrain\":\"[parameters('timeGrain')]\",\"timePeriod\":{\"startDate\":\"[parameters('startDate')]\"}},\"type\":\"Microsoft.Consumption/budgets\"}]}}},\"deploymentScope\":\"subscription\",\"existenceCondition\":{\"allOf\":[{\"equals\":\"[parameters('amount')]\",\"field\":\"Microsoft.Consumption/budgets/amount\"},{\"equals\":\"[parameters('timeGrain')]\",\"field\":\"Microsoft.Consumption/budgets/timeGrain\"},{\"equals\":\"Cost\",\"field\":\"Microsoft.Consumption/budgets/category\"}]},\"existenceScope\":\"subscription\",\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"],\"type\":\"Microsoft.Consumption/budgets\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Custom-Route-Table\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Custom-Route-Table",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Deploys a route table with specific user defined routes when one does not exist. The route table deployed by the policy must be manually associated to subnet(s)",
              "display_name": "Deploy a route table with specific user defined routes",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Network\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Deploy-Custom-Route-Table",
              "parameters": "{\"disableBgpPropagation\":{\"defaultValue\":false,\"metadata\":{\"description\":\"Disable BGP Propagation\",\"displayName\":\"DisableBgpPropagation\"},\"type\":\"Boolean\"},\"effect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"requiredRoutes\":{\"metadata\":{\"description\":\"Routes that must exist in compliant route tables deployed by this policy\",\"displayName\":\"requiredRoutes\"},\"type\":\"Array\"},\"routeTableName\":{\"metadata\":{\"description\":\"Name of the route table automatically deployed by this policy\",\"displayName\":\"routeTableName\"},\"type\":\"String\"},\"vnetRegion\":{\"metadata\":{\"description\":\"Only VNets in this region will be evaluated against this policy\",\"displayName\":\"vnetRegion\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/virtualNetworks\",\"field\":\"type\"},{\"equals\":\"[parameters('vnetRegion')]\",\"field\":\"location\"}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"disableBgpPropagation\":{\"value\":\"[parameters('disableBgpPropagation')]\"},\"requiredRoutes\":{\"value\":\"[parameters('requiredRoutes')]\"},\"routeTableName\":{\"value\":\"[parameters('routeTableName')]\"},\"vnetRegion\":{\"value\":\"[parameters('vnetRegion')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"disableBgpPropagation\":{\"type\":\"bool\"},\"requiredRoutes\":{\"type\":\"array\"},\"routeTableName\":{\"type\":\"string\"},\"vnetRegion\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2021-04-01\",\"name\":\"routeTableDepl\",\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"disableBgpPropagation\":{\"value\":\"[parameters('disableBgpPropagation')]\"},\"requiredRoutes\":{\"value\":\"[parameters('requiredRoutes')]\"},\"routeTableName\":{\"value\":\"[parameters('routeTableName')]\"},\"vnetRegion\":{\"value\":\"[parameters('vnetRegion')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"disableBgpPropagation\":{\"type\":\"bool\"},\"requiredRoutes\":{\"type\":\"array\"},\"routeTableName\":{\"type\":\"string\"},\"vnetRegion\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2021-02-01\",\"location\":\"[[parameters('vnetRegion')]\",\"name\":\"[[parameters('routeTableName')]\",\"properties\":{\"copy\":\"[variables('copyLoop')]\",\"disableBgpRoutePropagation\":\"[[parameters('disableBgpPropagation')]\"},\"type\":\"Microsoft.Network/routeTables\"}]}},\"type\":\"Microsoft.Resources/deployments\"}],\"variables\":{\"copyLoop\":[{\"count\":\"[[length(parameters('requiredRoutes'))]\",\"input\":{\"name\":\"[[concat('route-',copyIndex('routes'))]\",\"properties\":{\"addressPrefix\":\"[[split(parameters('requiredRoutes')[copyIndex('routes')], ';')[0]]\",\"nextHopIpAddress\":\"[[if(equals(toLower(split(parameters('requiredRoutes')[copyIndex('routes')], ';')[1]),'virtualappliance'),split(parameters('requiredRoutes')[copyIndex('routes')], ';')[2], null())]\",\"nextHopType\":\"[[split(parameters('requiredRoutes')[copyIndex('routes')], ';')[1]]\"}},\"name\":\"routes\"}]}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"[parameters('routeTableName')]\",\"field\":\"name\"},{\"count\":{\"field\":\"Microsoft.Network/routeTables/routes[*]\",\"where\":{\"in\":\"[parameters('requiredRoutes')]\",\"value\":\"[concat(current('Microsoft.Network/routeTables/routes[*].addressPrefix'), ';', current('Microsoft.Network/routeTables/routes[*].nextHopType'), if(equals(toLower(current('Microsoft.Network/routeTables/routes[*].nextHopType')),'virtualappliance'), concat(';', current('Microsoft.Network/routeTables/routes[*].nextHopIpAddress')), ''))]\"}},\"equals\":\"[length(parameters('requiredRoutes'))]\"}]},\"roleDefinitionIds\":[\"/subscriptions/e867a45d-e513-44ac-931e-4741cef80b24/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/routeTables\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-DDoSProtection\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-DDoSProtection",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Deploys an Azure DDoS Network Protection",
              "display_name": "Deploy an Azure DDoS Network Protection",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Network\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.1\"}",
              "mode": "All",
              "name": "Deploy-DDoSProtection",
              "parameters": "{\"ddosName\":{\"metadata\":{\"description\":\"DDoSVnet\",\"displayName\":\"ddosName\"},\"type\":\"String\"},\"ddosRegion\":{\"metadata\":{\"description\":\"DDoSVnet location\",\"displayName\":\"ddosRegion\",\"strongType\":\"location\"},\"type\":\"String\"},\"effect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"rgName\":{\"metadata\":{\"description\":\"Provide name for resource group.\",\"displayName\":\"rgName\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Resources/subscriptions\",\"field\":\"type\"}]},\"then\":{\"details\":{\"deployment\":{\"location\":\"northeurope\",\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"ddosname\":{\"value\":\"[parameters('ddosname')]\"},\"ddosregion\":{\"value\":\"[parameters('ddosRegion')]\"},\"rgName\":{\"value\":\"[parameters('rgName')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"ddosRegion\":{\"type\":\"String\"},\"ddosname\":{\"type\":\"String\"},\"rgName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2018-05-01\",\"location\":\"[deployment().location]\",\"name\":\"[parameters('rgName')]\",\"properties\":{},\"type\":\"Microsoft.Resources/resourceGroups\"},{\"apiVersion\":\"2018-05-01\",\"dependsOn\":[\"[resourceId('Microsoft.Resources/resourceGroups/', parameters('rgName'))]\"],\"name\":\"ddosprotection\",\"properties\":{\"mode\":\"Incremental\",\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{},\"resources\":[{\"apiVersion\":\"2019-12-01\",\"location\":\"[parameters('ddosRegion')]\",\"name\":\"[parameters('ddosName')]\",\"properties\":{},\"type\":\"Microsoft.Network/ddosProtectionPlans\"}]}},\"resourceGroup\":\"[parameters('rgName')]\",\"type\":\"Microsoft.Resources/deployments\"}]}}},\"deploymentScope\":\"subscription\",\"existenceScope\":\"resourceGroup\",\"name\":\"[parameters('ddosName')]\",\"resourceGroupName\":\"[parameters('rgName')]\",\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/ddosProtectionPlans\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-AA\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-AA",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Deploys the diagnostic settings for Automation to stream to a Log Analytics workspace when any Automation which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.",
              "display_name": "[Deprecated]: Deploy Diagnostic Settings for Automation to Log Analytics workspace",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"deprecated\":true,\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.1.0-deprecated\"}",
              "mode": "Indexed",
              "name": "Deploy-Diagnostics-AA",
              "parameters": "{\"effect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"logAnalytics\":{\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"},\"type\":\"String\"},\"logsEnabled\":{\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"},\"type\":\"String\"},\"metricsEnabled\":{\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"},\"type\":\"String\"},\"profileName\":{\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Automation/automationAccounts\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"JobLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"JobStreams\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"DscNodeStatus\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AuditEvent\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Automation/automationAccounts/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ACI\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ACI",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Deploys the diagnostic settings for Container Instances to stream to a Log Analytics workspace when any ACR which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.",
              "display_name": "[Deprecated]: Deploy Diagnostic Settings for Container Instances to Log Analytics workspace",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"deprecated\":true,\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.1.0-deprecated\"}",
              "mode": "Indexed",
              "name": "Deploy-Diagnostics-ACI",
              "parameters": "{\"effect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"logAnalytics\":{\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"},\"type\":\"String\"},\"metricsEnabled\":{\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"},\"type\":\"String\"},\"profileName\":{\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.ContainerInstance/containerGroups\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.ContainerInstance/containerGroups/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ACR\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ACR",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Deploys the diagnostic settings for Container Registry to stream to a Log Analytics workspace when any ACR which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.",
              "display_name": "[Deprecated]: Deploy Diagnostic Settings for Container Registry to Log Analytics workspace",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"deprecated\":true,\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.1.0-deprecated\"}",
              "mode": "Indexed",
              "name": "Deploy-Diagnostics-ACR",
              "parameters": "{\"effect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"logAnalytics\":{\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"},\"type\":\"String\"},\"logsEnabled\":{\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"},\"type\":\"String\"},\"metricsEnabled\":{\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"},\"type\":\"String\"},\"profileName\":{\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.ContainerRegistry/registries\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"ContainerRegistryLoginEvents\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"ContainerRegistryRepositoryEvents\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.ContainerRegistry/registries/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-APIMgmt\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-APIMgmt",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Deploys the diagnostic settings for API Management to stream to a Log Analytics workspace when any API Management which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.",
              "display_name": "[Deprecated]: Deploy Diagnostic Settings for API Management to Log Analytics workspace",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"deprecated\":true,\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.2.0-deprecated\"}",
              "mode": "Indexed",
              "name": "Deploy-Diagnostics-APIMgmt",
              "parameters": "{\"effect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"logAnalytics\":{\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"},\"type\":\"String\"},\"logAnalyticsDestinationType\":{\"allowedValues\":[\"AzureDiagnostics\",\"Dedicated\"],\"defaultValue\":\"AzureDiagnostics\",\"metadata\":{\"description\":\"Select destination type for Log Analytics. Allowed values are 'Dedicated' (resource specific) and 'AzureDiagnostics'. Default is 'AzureDiagnostics'\",\"displayName\":\"Log Analytics destination type\"},\"type\":\"String\"},\"logsEnabled\":{\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"},\"type\":\"String\"},\"metricsEnabled\":{\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"},\"type\":\"String\"},\"profileName\":{\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.ApiManagement/service\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logAnalyticsDestinationType\":{\"value\":\"[parameters('logAnalyticsDestinationType')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logAnalyticsDestinationType\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logAnalyticsDestinationType\":\"[parameters('logAnalyticsDestinationType')]\",\"logs\":[{\"category\":\"GatewayLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"WebSocketConnectionLogs\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.ApiManagement/service/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-AVDScalingPlans\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-AVDScalingPlans",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Deploys the diagnostic settings for AVD Scaling Plans to stream to a Log Analytics workspace when any Scaling Plan which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.",
              "display_name": "[Deprecated]: Deploy Diagnostic Settings for AVD Scaling Plans to Log Analytics workspace",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\"],\"category\":\"Monitoring\",\"deprecated\":true,\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.1.0-deprecated\"}",
              "mode": "Indexed",
              "name": "Deploy-Diagnostics-AVDScalingPlans",
              "parameters": "{\"effect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"logAnalytics\":{\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"},\"type\":\"String\"},\"logsEnabled\":{\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"},\"type\":\"String\"},\"profileName\":{\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.DesktopVirtualization/scalingplans\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"Autoscale\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.DesktopVirtualization/scalingplans/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-AnalysisService\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-AnalysisService",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Deploys the diagnostic settings for Analysis Services to stream to a Log Analytics workspace when any Analysis Services which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.",
              "display_name": "[Deprecated]: Deploy Diagnostic Settings for Analysis Services to Log Analytics workspace",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"deprecated\":true,\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.1.0-deprecated\"}",
              "mode": "Indexed",
              "name": "Deploy-Diagnostics-AnalysisService",
              "parameters": "{\"effect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"logAnalytics\":{\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"},\"type\":\"String\"},\"logsEnabled\":{\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"},\"type\":\"String\"},\"metricsEnabled\":{\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"},\"type\":\"String\"},\"profileName\":{\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.AnalysisServices/servers\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"Engine\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Service\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.AnalysisServices/servers/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ApiForFHIR\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ApiForFHIR",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Deploys the diagnostic settings for Azure API for FHIR to stream to a Log Analytics workspace when any Azure API for FHIR which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.",
              "display_name": "[Deprecated]: Deploy Diagnostic Settings for Azure API for FHIR to Log Analytics workspace",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"deprecated\":true,\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.1.0-deprecated\"}",
              "mode": "Indexed",
              "name": "Deploy-Diagnostics-ApiForFHIR",
              "parameters": "{\"effect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"logAnalytics\":{\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"},\"type\":\"String\"},\"logsEnabled\":{\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"},\"type\":\"String\"},\"metricsEnabled\":{\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"},\"type\":\"String\"},\"profileName\":{\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.HealthcareApis/services\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"AuditLogs\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.HealthcareApis/services/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ApplicationGateway\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ApplicationGateway",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Deploys the diagnostic settings for Application Gateway to stream to a Log Analytics workspace when any Application Gateway which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.",
              "display_name": "[Deprecated]: Deploy Diagnostic Settings for Application Gateway to Log Analytics workspace",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"deprecated\":true,\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.1.0-deprecated\"}",
              "mode": "Indexed",
              "name": "Deploy-Diagnostics-ApplicationGateway",
              "parameters": "{\"effect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"logAnalytics\":{\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"},\"type\":\"String\"},\"logsEnabled\":{\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"},\"type\":\"String\"},\"metricsEnabled\":{\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"},\"type\":\"String\"},\"profileName\":{\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Network/applicationGateways\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"ApplicationGatewayAccessLog\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"ApplicationGatewayPerformanceLog\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"ApplicationGatewayFirewallLog\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Network/applicationGateways/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Bastion\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Bastion",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Deploys the diagnostic settings for Azure Bastion to stream to a Log Analytics workspace when any Azure Bastion which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.",
              "display_name": "[Deprecated]: Deploy Diagnostic Settings for Azure Bastion to Log Analytics workspace",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"deprecated\":true,\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.1.0-deprecated\"}",
              "mode": "Indexed",
              "name": "Deploy-Diagnostics-Bastion",
              "parameters": "{\"effect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"logAnalytics\":{\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"},\"type\":\"String\"},\"logsEnabled\":{\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"},\"type\":\"String\"},\"metricsEnabled\":{\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"},\"type\":\"String\"},\"profileName\":{\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Network/bastionHosts\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"BastionAuditLogs\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Network/bastionHosts/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-CDNEndpoints\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-CDNEndpoints",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Deploys the diagnostic settings for CDN Endpoint to stream to a Log Analytics workspace when any CDN Endpoint which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.",
              "display_name": "[Deprecated]: Deploy Diagnostic Settings for CDN Endpoint to Log Analytics workspace",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"deprecated\":true,\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.1.0-deprecated\"}",
              "mode": "Indexed",
              "name": "Deploy-Diagnostics-CDNEndpoints",
              "parameters": "{\"effect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"logAnalytics\":{\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"},\"type\":\"String\"},\"logsEnabled\":{\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"},\"type\":\"String\"},\"profileName\":{\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Cdn/profiles/endpoints\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('fullName')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"CoreAnalytics\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Cdn/profiles/endpoints/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-CognitiveServices\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-CognitiveServices",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Deploys the diagnostic settings for Cognitive Services to stream to a Log Analytics workspace when any Cognitive Services which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.",
              "display_name": "[Deprecated]: Deploy Diagnostic Settings for Cognitive Services to Log Analytics workspace",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"deprecated\":true,\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.1.0-deprecated\"}",
              "mode": "Indexed",
              "name": "Deploy-Diagnostics-CognitiveServices",
              "parameters": "{\"effect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"logAnalytics\":{\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"},\"type\":\"String\"},\"logsEnabled\":{\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"},\"type\":\"String\"},\"metricsEnabled\":{\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"},\"type\":\"String\"},\"profileName\":{\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.CognitiveServices/accounts\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"Audit\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"RequestResponse\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Trace\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.CognitiveServices/accounts/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-CosmosDB\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-CosmosDB",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Deploys the diagnostic settings for Cosmos DB to stream to a Log Analytics workspace when any Cosmos DB which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.",
              "display_name": "[Deprecated]: Deploy Diagnostic Settings for Cosmos DB to Log Analytics workspace",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"deprecated\":true,\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.2.0-deprecated\"}",
              "mode": "Indexed",
              "name": "Deploy-Diagnostics-CosmosDB",
              "parameters": "{\"effect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"logAnalytics\":{\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"},\"type\":\"String\"},\"logsEnabled\":{\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"},\"type\":\"String\"},\"metricsEnabled\":{\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"},\"type\":\"String\"},\"profileName\":{\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.DocumentDB/databaseAccounts\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"DataPlaneRequests\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"MongoRequests\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"QueryRuntimeStatistics\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"PartitionKeyStatistics\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"PartitionKeyRUConsumption\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"ControlPlaneRequests\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"CassandraRequests\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"GremlinRequests\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"TableApiRequests\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"Requests\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.DocumentDB/databaseAccounts/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-DLAnalytics\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-DLAnalytics",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Deploys the diagnostic settings for Data Lake Analytics to stream to a Log Analytics workspace when any Data Lake Analytics which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.",
              "display_name": "[Deprecated]: Deploy Diagnostic Settings for Data Lake Analytics to Log Analytics workspace",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"deprecated\":true,\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.1.0-deprecated\"}",
              "mode": "Indexed",
              "name": "Deploy-Diagnostics-DLAnalytics",
              "parameters": "{\"effect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"logAnalytics\":{\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"},\"type\":\"String\"},\"logsEnabled\":{\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"},\"type\":\"String\"},\"metricsEnabled\":{\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"},\"type\":\"String\"},\"profileName\":{\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.DataLakeAnalytics/accounts\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"Audit\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Requests\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.DataLakeAnalytics/accounts/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-DataExplorerCluster\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-DataExplorerCluster",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Deploys the diagnostic settings for Azure Data Explorer Cluster to stream to a Log Analytics workspace when any Azure Data Explorer Cluster which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.",
              "display_name": "[Deprecated]: Deploy Diagnostic Settings for Azure Data Explorer Cluster to Log Analytics workspace",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"deprecated\":true,\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.1.0-deprecated\"}",
              "mode": "Indexed",
              "name": "Deploy-Diagnostics-DataExplorerCluster",
              "parameters": "{\"effect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"logAnalytics\":{\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"},\"type\":\"String\"},\"logsEnabled\":{\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"},\"type\":\"String\"},\"metricsEnabled\":{\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"},\"type\":\"String\"},\"profileName\":{\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Kusto/Clusters\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"SucceededIngestion\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"FailedIngestion\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"IngestionBatching\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Command\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Query\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"TableUsageStatistics\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"TableDetails\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Kusto/Clusters/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-DataFactory\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-DataFactory",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Deploys the diagnostic settings for Data Factory to stream to a Log Analytics workspace when any Data Factory which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.",
              "display_name": "[Deprecated]: Deploy Diagnostic Settings for Data Factory to Log Analytics workspace",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"deprecated\":true,\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.2.0-deprecated\"}",
              "mode": "Indexed",
              "name": "Deploy-Diagnostics-DataFactory",
              "parameters": "{\"effect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"logAnalytics\":{\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"},\"type\":\"String\"},\"logsEnabled\":{\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"},\"type\":\"String\"},\"metricsEnabled\":{\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"},\"type\":\"String\"},\"profileName\":{\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.DataFactory/factories\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"ActivityRuns\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"PipelineRuns\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"TriggerRuns\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"SSISPackageEventMessages\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"SSISPackageExecutableStatistics\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"SSISPackageEventMessageContext\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"SSISPackageExecutionComponentPhases\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"SSISPackageExecutionDataStatistics\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"SSISIntegrationRuntimeLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"SandboxPipelineRuns\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"SandboxActivityRuns\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.DataFactory/factories/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Databricks\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Databricks",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Deploys the diagnostic settings for Databricks to stream to a Log Analytics workspace when any Databricks which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.",
              "display_name": "[Deprecated]: Deploy Diagnostic Settings for Databricks to Log Analytics workspace",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"deprecated\":true,\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.3.0-deprecated\"}",
              "mode": "Indexed",
              "name": "Deploy-Diagnostics-Databricks",
              "parameters": "{\"effect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"logAnalytics\":{\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"},\"type\":\"String\"},\"logsEnabled\":{\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"},\"type\":\"String\"},\"profileName\":{\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Databricks/workspaces\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"dbfs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"clusters\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"accounts\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"jobs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"notebook\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"ssh\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"workspace\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"secrets\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"sqlPermissions\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"instancePools\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"sqlanalytics\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"genie\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"globalInitScripts\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"iamRole\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"mlflowExperiment\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"featureStore\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"RemoteHistoryService\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"mlflowAcledArtifact\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"databrickssql\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"deltaPipelines\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"modelRegistry\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"repos\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"unityCatalog\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"gitCredentials\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"webTerminal\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"serverlessRealTimeInference\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"clusterLibraries\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"partnerHub\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"clamAVScan\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"capsule8Dataplane\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Databricks/workspaces/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-EventGridSub\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-EventGridSub",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Deploys the diagnostic settings for Event Grid subscriptions to stream to a Log Analytics workspace when any Event Grid subscriptions which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.",
              "display_name": "[Deprecated]: Deploy Diagnostic Settings for Event Grid subscriptions to Log Analytics workspace",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"deprecated\":true,\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.1.0-deprecated\"}",
              "mode": "Indexed",
              "name": "Deploy-Diagnostics-EventGridSub",
              "parameters": "{\"effect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"logAnalytics\":{\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"},\"type\":\"String\"},\"metricsEnabled\":{\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"},\"type\":\"String\"},\"profileName\":{\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.EventGrid/eventSubscriptions\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.EventGrid/eventSubscriptions/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-EventGridSystemTopic\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-EventGridSystemTopic",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Deploys the diagnostic settings for Event Grid System Topic to stream to a Log Analytics workspace when any Event Grid System Topic which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.",
              "display_name": "[Deprecated]: Deploy Diagnostic Settings for Event Grid System Topic to Log Analytics workspace",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"deprecated\":true,\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.1.0-deprecated\"}",
              "mode": "Indexed",
              "name": "Deploy-Diagnostics-EventGridSystemTopic",
              "parameters": "{\"effect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"logAnalytics\":{\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"},\"type\":\"String\"},\"logsEnabled\":{\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"},\"type\":\"String\"},\"metricsEnabled\":{\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"},\"type\":\"String\"},\"profileName\":{\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.EventGrid/systemTopics\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"DeliveryFailures\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.EventGrid/systemTopics/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-EventGridTopic\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-EventGridTopic",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Deploys the diagnostic settings for Event Grid Topic to stream to a Log Analytics workspace when any Event Grid Topic which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.",
              "display_name": "[Deprecated]: Deploy Diagnostic Settings for Event Grid Topic to Log Analytics workspace",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"deprecated\":true,\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.2.0-deprecated\"}",
              "mode": "Indexed",
              "name": "Deploy-Diagnostics-EventGridTopic",
              "parameters": "{\"effect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"logAnalytics\":{\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"},\"type\":\"String\"},\"logsEnabled\":{\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"},\"type\":\"String\"},\"metricsEnabled\":{\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"},\"type\":\"String\"},\"profileName\":{\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.EventGrid/topics\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"DeliveryFailures\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"PublishFailures\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"DataPlaneRequests\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.EventGrid/topics/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ExpressRoute\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ExpressRoute",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Deploys the diagnostic settings for ExpressRoute to stream to a Log Analytics workspace when any ExpressRoute which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.",
              "display_name": "[Deprecated]: Deploy Diagnostic Settings for ExpressRoute to Log Analytics workspace",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"deprecated\":true,\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.1.0-deprecated\"}",
              "mode": "Indexed",
              "name": "Deploy-Diagnostics-ExpressRoute",
              "parameters": "{\"effect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"logAnalytics\":{\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"},\"type\":\"String\"},\"logsEnabled\":{\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"},\"type\":\"String\"},\"metricsEnabled\":{\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"},\"type\":\"String\"},\"profileName\":{\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Network/expressRouteCircuits\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"PeeringRouteLog\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Network/expressRouteCircuits/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Firewall\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Firewall",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Deploys the diagnostic settings for Firewall to stream to a Log Analytics workspace when any Firewall which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.",
              "display_name": "[Deprecated]: Deploy Diagnostic Settings for Firewall to Log Analytics workspace",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"deprecated\":true,\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.2.0-deprecated\"}",
              "mode": "Indexed",
              "name": "Deploy-Diagnostics-Firewall",
              "parameters": "{\"effect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"logAnalytics\":{\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"},\"type\":\"String\"},\"logAnalyticsDestinationType\":{\"allowedValues\":[\"AzureDiagnostics\",\"Dedicated\"],\"defaultValue\":\"AzureDiagnostics\",\"metadata\":{\"description\":\"Select destination type for Log Analytics. Allowed values are 'Dedicated' (resource specific) and 'AzureDiagnostics'. Default is 'AzureDiagnostics'\",\"displayName\":\"Log Analytics destination type\"},\"type\":\"String\"},\"logsEnabled\":{\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"},\"type\":\"String\"},\"metricsEnabled\":{\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"},\"type\":\"String\"},\"profileName\":{\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Network/azureFirewalls\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logAnalyticsDestinationType\":{\"value\":\"[parameters('logAnalyticsDestinationType')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logAnalyticsDestinationType\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logAnalyticsDestinationType\":\"[parameters('logAnalyticsDestinationType')]\",\"logs\":[{\"category\":\"AzureFirewallApplicationRule\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AzureFirewallNetworkRule\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AzureFirewallDnsProxy\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AZFWNetworkRule\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AZFWApplicationRule\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AZFWNatRule\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AZFWThreatIntel\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AZFWIdpsSignature\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AZFWDnsQuery\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AZFWFqdnResolveFailure\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AZFWApplicationRuleAggregation\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AZFWNetworkRuleAggregation\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AZFWNatRuleAggregation\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AZFWFatFlow\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AZFWFlowTrace\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Network/azureFirewalls/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-FrontDoor\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-FrontDoor",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Deploys the diagnostic settings for Front Door to stream to a Log Analytics workspace when any Front Door which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.",
              "display_name": "[Deprecated]: Deploy Diagnostic Settings for Front Door to Log Analytics workspace",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"deprecated\":true,\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.1.0-deprecated\"}",
              "mode": "Indexed",
              "name": "Deploy-Diagnostics-FrontDoor",
              "parameters": "{\"effect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"logAnalytics\":{\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"},\"type\":\"String\"},\"logsEnabled\":{\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"},\"type\":\"String\"},\"metricsEnabled\":{\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"},\"type\":\"String\"},\"profileName\":{\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Network/frontDoors\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"FrontdoorAccessLog\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"FrontdoorWebApplicationFirewallLog\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Network/frontDoors/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Function\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Function",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Deploys the diagnostic settings for Azure Function App to stream to a Log Analytics workspace when any function app which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.",
              "display_name": "[Deprecated]: Deploy Diagnostic Settings for Azure Function App to Log Analytics workspace",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"deprecated\":true,\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.1.0-deprecated\"}",
              "mode": "Indexed",
              "name": "Deploy-Diagnostics-Function",
              "parameters": "{\"effect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"logAnalytics\":{\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"},\"type\":\"String\"},\"logsEnabled\":{\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"},\"type\":\"String\"},\"metricsEnabled\":{\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"},\"type\":\"String\"},\"profileName\":{\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Web/sites\",\"field\":\"type\"},{\"contains\":\"functionapp\",\"value\":\"[field('kind')]\"}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"FunctionAppLogs\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Web/sites/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-HDInsight\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-HDInsight",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Deploys the diagnostic settings for HDInsight to stream to a Log Analytics workspace when any HDInsight which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.",
              "display_name": "[Deprecated]: Deploy Diagnostic Settings for HDInsight to Log Analytics workspace",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"deprecated\":true,\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.1.0-deprecated\"}",
              "mode": "Indexed",
              "name": "Deploy-Diagnostics-HDInsight",
              "parameters": "{\"effect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"logAnalytics\":{\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"},\"type\":\"String\"},\"metricsEnabled\":{\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"},\"type\":\"String\"},\"profileName\":{\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.HDInsight/clusters\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.HDInsight/clusters/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-LoadBalancer\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-LoadBalancer",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Deploys the diagnostic settings for Load Balancer to stream to a Log Analytics workspace when any Load Balancer which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.",
              "display_name": "[Deprecated]: Deploy Diagnostic Settings for Load Balancer to Log Analytics workspace",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"deprecated\":true,\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.1.0-deprecated\"}",
              "mode": "Indexed",
              "name": "Deploy-Diagnostics-LoadBalancer",
              "parameters": "{\"effect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"logAnalytics\":{\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"},\"type\":\"String\"},\"logsEnabled\":{\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"},\"type\":\"String\"},\"metricsEnabled\":{\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"},\"type\":\"String\"},\"profileName\":{\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Network/loadBalancers\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"LoadBalancerAlertEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"LoadBalancerProbeHealthStatus\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Network/loadBalancers/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-LogAnalytics\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-LogAnalytics",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Deploys the diagnostic settings for Log Analytics workspaces to stream to a Log Analytics workspace when any Log Analytics workspace which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.",
              "display_name": "[Deprecated]: Deploy Diagnostic Settings for Log Analytics to Log Analytics workspace",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"deprecated\":true,\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.1.0-deprecated\"}",
              "mode": "Indexed",
              "name": "Deploy-Diagnostics-LogAnalytics",
              "parameters": "{\"effect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"logAnalytics\":{\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"},\"type\":\"String\"},\"logsEnabled\":{\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"},\"type\":\"String\"},\"metricsEnabled\":{\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"},\"type\":\"String\"},\"profileName\":{\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"equals\":\"microsoft.operationalinsights/workspaces\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"Audit\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"microsoft.operationalinsights/workspaces/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-LogicAppsISE\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-LogicAppsISE",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Deploys the diagnostic settings for Logic Apps integration service environment to stream to a Log Analytics workspace when any Logic Apps integration service environment which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.",
              "display_name": "[Deprecated]: Deploy Diagnostic Settings for Logic Apps integration service environment to Log Analytics workspace",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"deprecated\":true,\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.1.0-deprecated\"}",
              "mode": "Indexed",
              "name": "Deploy-Diagnostics-LogicAppsISE",
              "parameters": "{\"effect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"logAnalytics\":{\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"},\"type\":\"String\"},\"logsEnabled\":{\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"},\"type\":\"String\"},\"profileName\":{\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Logic/integrationAccounts\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"IntegrationAccountTrackingEvents\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Logic/integrationAccounts/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-MariaDB\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-MariaDB",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Deploys the diagnostic settings for MariaDB to stream to a Log Analytics workspace when any MariaDB  which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled. Deprecating due to service retirement, https://learn.microsoft.com/en-us/azure/mariadb/whats-happening-to-mariadb",
              "display_name": "[Deprecated] Diagnostic Settings for MariaDB to Log Analytics Workspace",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"deprecated\":true,\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.1.0-deprecated\"}",
              "mode": "Indexed",
              "name": "Deploy-Diagnostics-MariaDB",
              "parameters": "{\"effect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"logAnalytics\":{\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"},\"type\":\"String\"},\"logsEnabled\":{\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"},\"type\":\"String\"},\"metricsEnabled\":{\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"},\"type\":\"String\"},\"profileName\":{\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.DBforMariaDB/servers\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"MySqlSlowLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"MySqlAuditLogs\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.DBforMariaDB/servers/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-MediaService\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-MediaService",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Deploys the diagnostic settings for Azure Media Service to stream to a Log Analytics workspace when any Azure Media Service which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.",
              "display_name": "[Deprecated]: Deploy Diagnostic Settings for Azure Media Service to Log Analytics workspace",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"deprecated\":true,\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.1.0-deprecated\"}",
              "mode": "Indexed",
              "name": "Deploy-Diagnostics-MediaService",
              "parameters": "{\"effect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"logAnalytics\":{\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"},\"type\":\"String\"},\"logsEnabled\":{\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"},\"type\":\"String\"},\"metricsEnabled\":{\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"},\"type\":\"String\"},\"profileName\":{\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Media/mediaServices\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"KeyDeliveryRequests\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Media/mediaServices/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-MlWorkspace\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-MlWorkspace",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Deploys the diagnostic settings for Machine Learning workspace to stream to a Log Analytics workspace when any Machine Learning workspace which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.",
              "display_name": "[Deprecated]: Deploy Diagnostic Settings for Machine Learning workspace to Log Analytics workspace",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"deprecated\":true,\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.2.0-deprecated\"}",
              "mode": "Indexed",
              "name": "Deploy-Diagnostics-MlWorkspace",
              "parameters": "{\"effect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"logAnalytics\":{\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"},\"type\":\"String\"},\"logsEnabled\":{\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"},\"type\":\"String\"},\"metricsEnabled\":{\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"},\"type\":\"String\"},\"profileName\":{\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.MachineLearningServices/workspaces\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"AmlComputeClusterEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AmlComputeClusterNodeEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AmlComputeJobEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AmlComputeCpuGpuUtilization\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AmlRunStatusChangedEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"ModelsChangeEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"ModelsReadEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"ModelsActionEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"DeploymentReadEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"DeploymentEventACI\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"DeploymentEventAKS\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"InferencingOperationAKS\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"InferencingOperationACI\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"DataLabelChangeEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"DataLabelReadEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"ComputeInstanceEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"DataStoreChangeEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"DataStoreReadEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"DataSetChangeEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"DataSetReadEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"PipelineChangeEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"PipelineReadEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"RunEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"RunReadEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"EnvironmentChangeEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"EnvironmentReadEvent\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false}}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.MachineLearningServices/workspaces/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-MySQL\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-MySQL",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Deploys the diagnostic settings for Database for MySQL to stream to a Log Analytics workspace when any Database for MySQL which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.",
              "display_name": "[Deprecated]: Deploy Diagnostic Settings for Database for MySQL to Log Analytics workspace",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"deprecated\":true,\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.1.0-deprecated\"}",
              "mode": "Indexed",
              "name": "Deploy-Diagnostics-MySQL",
              "parameters": "{\"effect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"logAnalytics\":{\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"},\"type\":\"String\"},\"logsEnabled\":{\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"},\"type\":\"String\"},\"metricsEnabled\":{\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"},\"type\":\"String\"},\"profileName\":{\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.DBforMySQL/servers\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"MySqlSlowLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"MySqlAuditLogs\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.DBforMySQL/servers/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-NIC\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-NIC",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Deploys the diagnostic settings for Network Interfaces to stream to a Log Analytics workspace when any Network Interfaces which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.",
              "display_name": "[Deprecated]: Deploy Diagnostic Settings for Network Interfaces to Log Analytics workspace",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"deprecated\":true,\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.1.0-deprecated\"}",
              "mode": "Indexed",
              "name": "Deploy-Diagnostics-NIC",
              "parameters": "{\"effect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"logAnalytics\":{\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"},\"type\":\"String\"},\"metricsEnabled\":{\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"},\"type\":\"String\"},\"profileName\":{\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Network/networkInterfaces\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Network/networkInterfaces/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-NetworkSecurityGroups\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-NetworkSecurityGroups",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Deploys the diagnostic settings for Network Security Groups to stream to a Log Analytics workspace when any Network Security Groups which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.",
              "display_name": "[Deprecated]: Deploy Diagnostic Settings for Network Security Groups to Log Analytics workspace",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"deprecated\":true,\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.1.0-deprecated\"}",
              "mode": "Indexed",
              "name": "Deploy-Diagnostics-NetworkSecurityGroups",
              "parameters": "{\"effect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"logAnalytics\":{\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"},\"type\":\"String\"},\"logsEnabled\":{\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"},\"type\":\"String\"},\"profileName\":{\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Network/networkSecurityGroups\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"NetworkSecurityGroupEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"NetworkSecurityGroupRuleCounter\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Network/networkSecurityGroups/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-PostgreSQL\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-PostgreSQL",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Deploys the diagnostic settings for Database for PostgreSQL to stream to a Log Analytics workspace when any Database for PostgreSQL which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.",
              "display_name": "[Deprecated]: Deploy Diagnostic Settings for Database for PostgreSQL to Log Analytics workspace",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"deprecated\":true,\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"2.0.0-deprecated\"}",
              "mode": "Indexed",
              "name": "Deploy-Diagnostics-PostgreSQL",
              "parameters": "{\"effect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"logAnalytics\":{\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"},\"type\":\"String\"},\"logsEnabled\":{\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"},\"type\":\"String\"},\"metricsEnabled\":{\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"},\"type\":\"String\"},\"profileName\":{\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"anyOf\":[{\"equals\":\"Microsoft.DBforPostgreSQL/flexibleServers\",\"field\":\"type\"},{\"equals\":\"Microsoft.DBforPostgreSQL/servers\",\"field\":\"type\"}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"},\"resourceType\":{\"value\":\"[field('type')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"},\"resourceType\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2021-05-01-preview\",\"condition\":\"[startsWith(parameters('resourceType'),'Microsoft.DBforPostgreSQL/flexibleServers')]\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"PostgreSQLLogs\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.DBforPostgreSQL/flexibleServers/providers/diagnosticSettings\"},{\"apiVersion\":\"2021-05-01-preview\",\"condition\":\"[startsWith(parameters('resourceType'),'Microsoft.DBforPostgreSQL/servers')]\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"PostgreSQLLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"QueryStoreRuntimeStatistics\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"QueryStoreWaitStatistics\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.DBforPostgreSQL/servers/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-PowerBIEmbedded\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-PowerBIEmbedded",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Deploys the diagnostic settings for Power BI Embedded to stream to a Log Analytics workspace when any Power BI Embedded which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.",
              "display_name": "[Deprecated]: Deploy Diagnostic Settings for Power BI Embedded to Log Analytics workspace",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"deprecated\":true,\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.1.0-deprecated\"}",
              "mode": "Indexed",
              "name": "Deploy-Diagnostics-PowerBIEmbedded",
              "parameters": "{\"effect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"logAnalytics\":{\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"},\"type\":\"String\"},\"logsEnabled\":{\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"},\"type\":\"String\"},\"metricsEnabled\":{\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"},\"type\":\"String\"},\"profileName\":{\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.PowerBIDedicated/capacities\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"Engine\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.PowerBIDedicated/capacities/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-RedisCache\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-RedisCache",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Deploys the diagnostic settings for Redis Cache to stream to a Log Analytics workspace when any Redis Cache which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.",
              "display_name": "[Deprecated]: Deploy Diagnostic Settings for Redis Cache to Log Analytics workspace",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"deprecated\":true,\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.1.0-deprecated\"}",
              "mode": "Indexed",
              "name": "Deploy-Diagnostics-RedisCache",
              "parameters": "{\"effect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"logAnalytics\":{\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"},\"type\":\"String\"},\"metricsEnabled\":{\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"},\"type\":\"String\"},\"profileName\":{\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Cache/redis\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Cache/redis/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Relay\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Relay",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Deploys the diagnostic settings for Relay to stream to a Log Analytics workspace when any Relay which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.",
              "display_name": "[Deprecated]: Deploy Diagnostic Settings for Relay to Log Analytics workspace",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"deprecated\":true,\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.1.0-deprecated\"}",
              "mode": "Indexed",
              "name": "Deploy-Diagnostics-Relay",
              "parameters": "{\"effect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"logAnalytics\":{\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"},\"type\":\"String\"},\"logsEnabled\":{\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"},\"type\":\"String\"},\"metricsEnabled\":{\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"},\"type\":\"String\"},\"profileName\":{\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Relay/namespaces\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"HybridConnectionsEvent\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Relay/namespaces/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-SQLElasticPools\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-SQLElasticPools",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Deploys the diagnostic settings for SQL Elastic Pools to stream to a Log Analytics workspace when any SQL Elastic Pools which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.",
              "display_name": "[Deprecated]: Deploy Diagnostic Settings for SQL Elastic Pools to Log Analytics workspace",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"deprecated\":true,\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.1.0-deprecated\"}",
              "mode": "Indexed",
              "name": "Deploy-Diagnostics-SQLElasticPools",
              "parameters": "{\"effect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"logAnalytics\":{\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"},\"type\":\"String\"},\"metricsEnabled\":{\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"},\"type\":\"String\"},\"profileName\":{\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Sql/servers/elasticPools\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('fullName')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Sql/servers/elasticPools/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-SQLMI\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-SQLMI",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Deploys the diagnostic settings for SQL Managed Instances to stream to a Log Analytics workspace when any SQL Managed Instances which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.",
              "display_name": "[Deprecated]: Deploy Diagnostic Settings for SQL Managed Instances to Log Analytics workspace",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"deprecated\":true,\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.1.0-deprecated\"}",
              "mode": "Indexed",
              "name": "Deploy-Diagnostics-SQLMI",
              "parameters": "{\"effect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"logAnalytics\":{\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"},\"type\":\"String\"},\"logsEnabled\":{\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"},\"type\":\"String\"},\"profileName\":{\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Sql/managedInstances\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"ResourceUsageStats\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"SQLSecurityAuditEvents\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"DevOpsOperationsAudit\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Sql/managedInstances/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-SignalR\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-SignalR",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Deploys the diagnostic settings for SignalR to stream to a Log Analytics workspace when any SignalR which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.",
              "display_name": "[Deprecated]: Deploy Diagnostic Settings for SignalR to Log Analytics workspace",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"deprecated\":true,\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.1.0-deprecated\"}",
              "mode": "Indexed",
              "name": "Deploy-Diagnostics-SignalR",
              "parameters": "{\"effect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"logAnalytics\":{\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"},\"type\":\"String\"},\"logsEnabled\":{\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"},\"type\":\"String\"},\"metricsEnabled\":{\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"},\"type\":\"String\"},\"profileName\":{\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.SignalRService/SignalR\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"AllLogs\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.SignalRService/SignalR/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-TimeSeriesInsights\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-TimeSeriesInsights",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Deploys the diagnostic settings for Time Series Insights to stream to a Log Analytics workspace when any Time Series Insights which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.",
              "display_name": "[Deprecated]: Deploy Diagnostic Settings for Time Series Insights to Log Analytics workspace",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"deprecated\":true,\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.1.0-deprecated\"}",
              "mode": "Indexed",
              "name": "Deploy-Diagnostics-TimeSeriesInsights",
              "parameters": "{\"effect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"logAnalytics\":{\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"},\"type\":\"String\"},\"logsEnabled\":{\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"},\"type\":\"String\"},\"metricsEnabled\":{\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"},\"type\":\"String\"},\"profileName\":{\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.TimeSeriesInsights/environments\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"Ingress\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Management\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.TimeSeriesInsights/environments/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-TrafficManager\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-TrafficManager",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Deploys the diagnostic settings for Traffic Manager to stream to a Log Analytics workspace when any Traffic Manager which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.",
              "display_name": "[Deprecated]: Deploy Diagnostic Settings for Traffic Manager to Log Analytics workspace",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"deprecated\":true,\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.1.0-deprecated\"}",
              "mode": "Indexed",
              "name": "Deploy-Diagnostics-TrafficManager",
              "parameters": "{\"effect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"logAnalytics\":{\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"},\"type\":\"String\"},\"logsEnabled\":{\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"},\"type\":\"String\"},\"metricsEnabled\":{\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"},\"type\":\"String\"},\"profileName\":{\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Network/trafficManagerProfiles\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"ProbeHealthStatusEvents\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Network/trafficManagerProfiles/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-VM\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-VM",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Deploys the diagnostic settings for Virtual Machines to stream to a Log Analytics workspace when any Virtual Machines which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.",
              "display_name": "[Deprecated]: Deploy Diagnostic Settings for Virtual Machines to Log Analytics workspace",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"deprecated\":true,\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.1.0-deprecated\"}",
              "mode": "Indexed",
              "name": "Deploy-Diagnostics-VM",
              "parameters": "{\"effect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"logAnalytics\":{\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"},\"type\":\"String\"},\"metricsEnabled\":{\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"},\"type\":\"String\"},\"profileName\":{\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false}}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Compute/virtualMachines/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-VMSS\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-VMSS",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Deploys the diagnostic settings for Virtual Machine Scale Sets  to stream to a Log Analytics workspace when any Virtual Machine Scale Sets  which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.",
              "display_name": "[Deprecated]: Deploy Diagnostic Settings for Virtual Machine Scale Sets to Log Analytics workspace",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"deprecated\":true,\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.1.0-deprecated\"}",
              "mode": "Indexed",
              "name": "Deploy-Diagnostics-VMSS",
              "parameters": "{\"effect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"logAnalytics\":{\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"},\"type\":\"String\"},\"metricsEnabled\":{\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"},\"type\":\"String\"},\"profileName\":{\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Compute/virtualMachineScaleSets\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false}}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Compute/virtualMachineScaleSets/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-VNetGW\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-VNetGW",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Deploys the diagnostic settings for VPN Gateway to stream to a Log Analytics workspace when any VPN Gateway which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.",
              "display_name": "[Deprecated]: Deploy Diagnostic Settings for VPN Gateway to Log Analytics workspace",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"deprecated\":true,\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.1.1-deprecated\"}",
              "mode": "Indexed",
              "name": "Deploy-Diagnostics-VNetGW",
              "parameters": "{\"effect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"logAnalytics\":{\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"},\"type\":\"String\"},\"logsEnabled\":{\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"},\"type\":\"String\"},\"metricsEnabled\":{\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"},\"type\":\"String\"},\"profileName\":{\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Network/virtualNetworkGateways\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"GatewayDiagnosticLog\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"IKEDiagnosticLog\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"P2SDiagnosticLog\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"RouteDiagnosticLog\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"TunnelDiagnosticLog\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Network/virtualNetworkGateways/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-VWanS2SVPNGW\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-VWanS2SVPNGW",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Deploys the diagnostic settings for VWAN S2S VPN Gateway to stream to a Log Analytics workspace when any VWAN S2S VPN Gateway which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.",
              "display_name": "[Deprecated]: Deploy Diagnostic Settings for VWAN S2S VPN Gateway to Log Analytics workspace",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"deprecated\":true,\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.0-deprecated\"}",
              "mode": "Indexed",
              "name": "Deploy-Diagnostics-VWanS2SVPNGW",
              "parameters": "{\"effect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"logAnalytics\":{\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"},\"type\":\"String\"},\"logsEnabled\":{\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"},\"type\":\"String\"},\"metricsEnabled\":{\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"},\"type\":\"String\"},\"profileName\":{\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Network/vpnGateways\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"GatewayDiagnosticLog\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"IKEDiagnosticLog\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"RouteDiagnosticLog\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"TunnelDiagnosticLog\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Network/vpnGateways/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-VirtualNetwork\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-VirtualNetwork",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Deploys the diagnostic settings for Virtual Network to stream to a Log Analytics workspace when any Virtual Network which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.",
              "display_name": "[Deprecated]: Deploy Diagnostic Settings for Virtual Network to Log Analytics workspace",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"deprecated\":true,\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.1.0-deprecated\"}",
              "mode": "Indexed",
              "name": "Deploy-Diagnostics-VirtualNetwork",
              "parameters": "{\"effect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"logAnalytics\":{\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"},\"type\":\"String\"},\"logsEnabled\":{\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"},\"type\":\"String\"},\"metricsEnabled\":{\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"},\"type\":\"String\"},\"profileName\":{\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Network/virtualNetworks\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"VMProtectionAlerts\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false}}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Network/virtualNetworks/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-WVDAppGroup\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-WVDAppGroup",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Deploys the diagnostic settings for AVD Application group to stream to a Log Analytics workspace when any application group which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.",
              "display_name": "[Deprecated]: Deploy Diagnostic Settings for AVD Application group to Log Analytics workspace",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"deprecated\":true,\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.1.1-deprecated\"}",
              "mode": "Indexed",
              "name": "Deploy-Diagnostics-WVDAppGroup",
              "parameters": "{\"effect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"logAnalytics\":{\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"},\"type\":\"String\"},\"logsEnabled\":{\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"},\"type\":\"String\"},\"profileName\":{\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.DesktopVirtualization/applicationGroups\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"Checkpoint\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Error\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Management\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.DesktopVirtualization/applicationGroups/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-WVDHostPools\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-WVDHostPools",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Deploys the diagnostic settings for AVD Host Pools to stream to a Log Analytics workspace when any Host Pools which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.",
              "display_name": "[Deprecated]: Deploy Diagnostic Settings for AVD Host Pools to Log Analytics workspace",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"deprecated\":true,\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.3.0-deprecated\"}",
              "mode": "Indexed",
              "name": "Deploy-Diagnostics-WVDHostPools",
              "parameters": "{\"effect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"logAnalytics\":{\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"},\"type\":\"String\"},\"logsEnabled\":{\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"},\"type\":\"String\"},\"profileName\":{\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.DesktopVirtualization/hostpools\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"Checkpoint\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Error\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Management\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Connection\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"HostRegistration\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AgentHealthStatus\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"NetworkData\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"SessionHostManagement\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"ConnectionGraphicsData\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.DesktopVirtualization/hostpools/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-WVDWorkspace\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-WVDWorkspace",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Deploys the diagnostic settings for AVD Workspace to stream to a Log Analytics workspace when any Workspace which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.",
              "display_name": "[Deprecated]: Deploy Diagnostic Settings for AVD Workspace to Log Analytics workspace",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"deprecated\":true,\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.1.1-deprecated\"}",
              "mode": "Indexed",
              "name": "Deploy-Diagnostics-WVDWorkspace",
              "parameters": "{\"effect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"logAnalytics\":{\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"},\"type\":\"String\"},\"logsEnabled\":{\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"},\"type\":\"String\"},\"profileName\":{\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.DesktopVirtualization/workspaces\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"Checkpoint\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Error\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Management\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Feed\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.DesktopVirtualization/workspaces/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-WebServerFarm\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-WebServerFarm",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Deploys the diagnostic settings for App Service Plan to stream to a Log Analytics workspace when any App Service Plan which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.",
              "display_name": "[Deprecated]: Deploy Diagnostic Settings for App Service Plan to Log Analytics workspace",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"deprecated\":true,\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.1.0-deprecated\"}",
              "mode": "Indexed",
              "name": "Deploy-Diagnostics-WebServerFarm",
              "parameters": "{\"effect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"logAnalytics\":{\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"},\"type\":\"String\"},\"metricsEnabled\":{\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"},\"type\":\"String\"},\"profileName\":{\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Web/serverfarms\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Web/serverfarms/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Website\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Website",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Deploys the diagnostic settings for Web App to stream to a Log Analytics workspace when any Web App which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.",
              "display_name": "[Deprecated]: Deploy Diagnostic Settings for App Service to Log Analytics workspace",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"deprecated\":true,\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.2.0-deprecated\"}",
              "mode": "Indexed",
              "name": "Deploy-Diagnostics-Website",
              "parameters": "{\"effect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"logAnalytics\":{\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"},\"type\":\"String\"},\"logsEnabled\":{\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"},\"type\":\"String\"},\"metricsEnabled\":{\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"},\"type\":\"String\"},\"profileName\":{\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Web/sites\",\"field\":\"type\"},{\"notContains\":\"functionapp\",\"value\":\"[field('kind')]\"}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"},\"serverFarmId\":{\"value\":\"[field('Microsoft.Web/sites/serverFarmId')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{\"policy\":{\"type\":\"string\",\"value\":\"[concat(parameters('logAnalytics'), 'configured for diagnostic logs for ', ': ', parameters('resourceName'))]\"}},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"},\"serverFarmId\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":\"[if(startsWith(reference(parameters('serverFarmId'), '2021-03-01', 'Full').sku.tier, 'Premium'), variables('logs').premiumTierLogs, variables('logs').otherTierLogs)]\",\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Web/sites/providers/diagnosticSettings\"}],\"variables\":{\"logs\":{\"otherTierLogs\":[{\"category\":\"AppServiceHTTPLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AppServiceConsoleLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AppServiceAppLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AppServiceAuditLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AppServiceIPSecAuditLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AppServicePlatformLogs\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"premiumTierLogs\":[{\"category\":\"AppServiceAntivirusScanAuditLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AppServiceHTTPLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AppServiceConsoleLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AppServiceAppLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AppServiceFileAuditLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AppServiceAuditLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AppServiceIPSecAuditLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AppServicePlatformLogs\",\"enabled\":\"[parameters('logsEnabled')]\"}]}}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"[parameters('logsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"[parameters('metricsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-iotHub\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-iotHub",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Deploys the diagnostic settings for IoT Hub to stream to a Log Analytics workspace when any IoT Hub which is missing this diagnostic settings is created or updated. This policy is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.",
              "display_name": "[Deprecated]: Deploy Diagnostic Settings for IoT Hub to Log Analytics workspace",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"deprecated\":true,\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.1.0-deprecated\"}",
              "mode": "Indexed",
              "name": "Deploy-Diagnostics-iotHub",
              "parameters": "{\"effect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"logAnalytics\":{\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"},\"type\":\"String\"},\"logsEnabled\":{\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"},\"type\":\"String\"},\"metricsEnabled\":{\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"},\"type\":\"String\"},\"profileName\":{\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Devices/IotHubs\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"Connections\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"DeviceTelemetry\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"C2DCommands\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"DeviceIdentityOperations\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"FileUploadOperations\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Routes\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"D2CTwinOperations\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"C2DTwinOperations\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"TwinQueries\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"JobsOperations\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"DirectMethods\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"DistributedTracing\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Configurations\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"DeviceStreams\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Devices/IotHubs/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-FirewallPolicy\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-FirewallPolicy",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Deploys Azure Firewall Manager policy in subscription where the policy is assigned.",
              "display_name": "Deploy Azure Firewall Manager policy in the subscription",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Network\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.0\"}",
              "mode": "All",
              "name": "Deploy-FirewallPolicy",
              "parameters": "{\"effect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"fwPolicyRegion\":{\"metadata\":{\"description\":\"Select Azure region for Azure Firewall Policy\",\"displayName\":\"fwPolicyRegion\",\"strongType\":\"location\"},\"type\":\"String\"},\"fwpolicy\":{\"defaultValue\":{},\"metadata\":{\"description\":\"Object describing Azure Firewall Policy\",\"displayName\":\"fwpolicy\"},\"type\":\"Object\"},\"rgName\":{\"metadata\":{\"description\":\"Provide name for resource group.\",\"displayName\":\"rgName\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Resources/subscriptions\",\"field\":\"type\"}]},\"then\":{\"details\":{\"deployment\":{\"location\":\"northeurope\",\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"fwPolicy\":{\"value\":\"[parameters('fwPolicy')]\"},\"fwPolicyRegion\":{\"value\":\"[parameters('fwPolicyRegion')]\"},\"rgName\":{\"value\":\"[parameters('rgName')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"fwPolicy\":{\"type\":\"object\"},\"fwPolicyRegion\":{\"type\":\"String\"},\"rgName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2018-05-01\",\"location\":\"[deployment().location]\",\"name\":\"[parameters('rgName')]\",\"properties\":{},\"type\":\"Microsoft.Resources/resourceGroups\"},{\"apiVersion\":\"2018-05-01\",\"dependsOn\":[\"[resourceId('Microsoft.Resources/resourceGroups/', parameters('rgName'))]\"],\"name\":\"fwpolicies\",\"properties\":{\"mode\":\"Incremental\",\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{},\"resources\":[{\"apiVersion\":\"2019-09-01\",\"dependsOn\":[],\"location\":\"[parameters('fwpolicy').location]\",\"name\":\"[parameters('fwpolicy').firewallPolicyName]\",\"properties\":{},\"resources\":[{\"apiVersion\":\"2019-09-01\",\"dependsOn\":[\"[resourceId('Microsoft.Network/firewallPolicies',parameters('fwpolicy').firewallPolicyName)]\"],\"name\":\"[parameters('fwpolicy').ruleGroups.name]\",\"properties\":{\"priority\":\"[parameters('fwpolicy').ruleGroups.properties.priority]\",\"rules\":\"[parameters('fwpolicy').ruleGroups.properties.rules]\"},\"type\":\"ruleGroups\"}],\"tags\":{},\"type\":\"Microsoft.Network/firewallPolicies\"}],\"variables\":{}}},\"resourceGroup\":\"[parameters('rgName')]\",\"type\":\"Microsoft.Resources/deployments\"}]}}},\"deploymentScope\":\"subscription\",\"existenceScope\":\"resourceGroup\",\"resourceGroupName\":\"[parameters('rgName')]\",\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"],\"type\":\"Microsoft.Network/firewallPolicies\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-LogicApp-TLS\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-LogicApp-TLS",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Periodically, newer versions are released for TLS either due to security flaws, include additional functionality, and enhance speed. Upgrade to the latest TLS version for Function apps to take advantage of security fixes, if any, and/or new functionalities of the latest version.",
              "display_name": "Configure Logic apps to use the latest TLS version",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Logic Apps\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Deploy-LogicApp-TLS",
              "parameters": "{\"effect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Web/sites\",\"field\":\"type\"},{\"contains\":\"workflowapp\",\"field\":\"kind\"}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"siteName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"siteName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2021-02-01\",\"name\":\"[concat(parameters('siteName'), '/web')]\",\"properties\":{\"minTlsVersion\":\"1.2\"},\"type\":\"Microsoft.Web/sites/config\"}],\"variables\":{}}}},\"existenceCondition\":{\"equals\":\"1.2\",\"field\":\"Microsoft.Web/sites/config/minTlsVersion\"},\"name\":\"web\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/de139f84-1756-47ae-9be6-808fbbe84772\"],\"type\":\"Microsoft.Web/sites/config\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-MDFC-Arc-SQL-DCR-Association\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-MDFC-Arc-SQL-DCR-Association",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Policy is deprecated as the built-in policy now supports bringing your own UAMI and DCR. Superseded by https://www.azadvertizer.net/azpolicyadvertizer/2227e1f1-23dd-4c3a-85a9-7024a401d8b2.html",
              "display_name": "[Deprecated]: Configure Arc-enabled SQL Servers with DCR Association to Microsoft Defender for SQL user-defined DCR",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Security Center\",\"deprecated\":true,\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"supersededBy\":\"2227e1f1-23dd-4c3a-85a9-7024a401d8b2\",\"version\":\"1.0.0-deprecated\"}",
              "mode": "Indexed",
              "name": "Deploy-MDFC-Arc-SQL-DCR-Association",
              "parameters": "{\"dcrId\":{\"metadata\":{\"description\":\"Id of the Data Collection Rule.\",\"displayName\":\"Data Collection Rule Id\"},\"type\":\"String\"},\"dcrName\":{\"metadata\":{\"description\":\"Name of the Data Collection Rule.\",\"displayName\":\"Data Collection Rule Name\"},\"type\":\"String\"},\"dcrResourceGroup\":{\"metadata\":{\"description\":\"Resource Group of the Data Collection Rule.\",\"displayName\":\"Data Collection Rule Resource Group\"},\"type\":\"String\"},\"effect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"workspaceRegion\":{\"metadata\":{\"description\":\"Region of the Log Analytics workspace destination for the Data Collection Rule.\",\"displayName\":\"Workspace region\",\"strongType\":\"location\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.HybridCompute/machines\",\"field\":\"type\"},{\"equals\":\"Windows\",\"field\":\"Microsoft.HybridCompute/machines/osName\"},{\"equals\":\"true\",\"field\":\"Microsoft.HybridCompute/machines/mssqlDiscovered\"}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"dcrId\":{\"value\":\"[parameters('dcrId')]\"},\"dcrName\":{\"value\":\"[parameters('dcrName')]\"},\"dcrResourceGroup\":{\"value\":\"[parameters('dcrResourceGroup')]\"},\"resourceGroup\":{\"value\":\"[parameters('dcrResourceGroup')]\"},\"vmName\":{\"value\":\"[field('name')]\"},\"workspaceRegion\":{\"value\":\"[parameters('workspaceRegion')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"dcrId\":{\"type\":\"string\"},\"dcrName\":{\"type\":\"string\"},\"dcrResourceGroup\":{\"type\":\"string\"},\"resourceGroup\":{\"type\":\"string\"},\"vmName\":{\"type\":\"string\"},\"workspaceRegion\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2021-04-01\",\"name\":\"[variables('dcraName')]\",\"properties\":{\"dataCollectionRuleId\":\"[variables('dcrId')]\",\"description\":\"Configure association between Arc-enabled SQL Server and the Microsoft Defender for SQL user-defined DCR. Deleting this association will break the detection of security vulnerabilities for this Arc-enabled SQL Server.\"},\"type\":\"Microsoft.HybridCompute/machines/providers/dataCollectionRuleAssociations\"}],\"variables\":{\"dcrId\":\"[parameters('dcrId')]\",\"dcrName\":\"[parameters('dcrName')]\",\"dcraName\":\"[concat(parameters('vmName'),'/Microsoft.Insights/MicrosoftDefenderForSQL-RulesAssociation')]\",\"defaultRGName\":\"[parameters('resourceGroup')]\",\"locationCode\":\"[if(contains(variables('locationLongNameToShortMap'), parameters('workspaceRegion')), variables('locationLongNameToShortMap')[parameters('workspaceRegion')], parameters('workspaceRegion'))]\",\"locationLongNameToShortMap\":{\"australiacentral\":\"CAU\",\"australiaeast\":\"EAU\",\"australiasoutheast\":\"SEAU\",\"brazilsouth\":\"CQ\",\"canadacentral\":\"CCA\",\"canadaeast\":\"CCA\",\"centralindia\":\"CIN\",\"centralus\":\"CUS\",\"eastasia\":\"EA\",\"eastus\":\"EUS\",\"eastus2\":\"EUS2\",\"eastus2euap\":\"eus2p\",\"francecentral\":\"PAR\",\"germanywestcentral\":\"DEWC\",\"japaneast\":\"EJP\",\"jioindiawest\":\"CIN\",\"koreacentral\":\"SE\",\"koreasouth\":\"SE\",\"northcentralus\":\"NCUS\",\"northeurope\":\"NEU\",\"norwayeast\":\"NOE\",\"southafricanorth\":\"JNB\",\"southcentralus\":\"SCUS\",\"southeastasia\":\"SEA\",\"southindia\":\"CIN\",\"swedencentral\":\"SEC\",\"switzerlandnorth\":\"CHN\",\"switzerlandwest\":\"CHW\",\"uaenorth\":\"DXB\",\"uksouth\":\"SUK\",\"ukwest\":\"WUK\",\"westcentralus\":\"WCUS\",\"westeurope\":\"WEU\",\"westindia\":\"CIN\",\"westus\":\"WUS\",\"westus2\":\"WUS2\"},\"subscriptionId\":\"[subscription().subscriptionId]\"}}}},\"name\":\"MicrosoftDefenderForSQL-RulesAssociation\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/dataCollectionRuleAssociations\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-MDFC-Arc-Sql-DefenderSQL-DCR\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-MDFC-Arc-Sql-DefenderSQL-DCR",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Policy is deprecated as the built-in policy now supports bringing your own UAMI and DCR. Superseded by https://www.azadvertizer.net/azpolicyadvertizer/63d03cbd-47fd-4ee1-8a1c-9ddf07303de0.html",
              "display_name": "[Deprecated]: Configure Arc-enabled SQL Servers to auto install Microsoft Defender for SQL and DCR with a user-defined LAW",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Security Center\",\"deprecated\":true,\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"supersededBy\":\"63d03cbd-47fd-4ee1-8a1c-9ddf07303de0\",\"version\":\"1.0.0-deprecated\"}",
              "mode": "Indexed",
              "name": "Deploy-MDFC-Arc-Sql-DefenderSQL-DCR",
              "parameters": "{\"dcrId\":{\"metadata\":{\"description\":\"Id of the Data Collection Rule.\",\"displayName\":\"Data Collection Rule Id\"},\"type\":\"String\"},\"dcrName\":{\"metadata\":{\"description\":\"Name of the Data Collection Rule.\",\"displayName\":\"Data Collection Rule Name\"},\"type\":\"String\"},\"dcrResourceGroup\":{\"metadata\":{\"description\":\"Resource Group of the Data Collection Rule.\",\"displayName\":\"Data Collection Rule Resource Group\"},\"type\":\"String\"},\"effect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"enableCollectionOfSqlQueriesForSecurityResearch\":{\"allowedValues\":[true,false],\"defaultValue\":false,\"metadata\":{\"description\":\"Enable or disable the collection of SQL queries for security research.\",\"displayName\":\"Enable collection of SQL queries for security research\"},\"type\":\"Boolean\"},\"userWorkspaceResourceId\":{\"metadata\":{\"description\":\"Workspace resource Id of the Log Analytics workspace destination for the Data Collection Rule.\",\"displayName\":\"Workspace Resource Id\",\"strongType\":\"omsWorkspace\"},\"type\":\"String\"},\"workspaceRegion\":{\"metadata\":{\"description\":\"Region of the Log Analytics workspace destination for the Data Collection Rule.\",\"displayName\":\"Workspace region\",\"strongType\":\"location\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.HybridCompute/machines\",\"field\":\"type\"},{\"equals\":\"Windows\",\"field\":\"Microsoft.HybridCompute/machines/osName\"},{\"equals\":\"true\",\"field\":\"Microsoft.HybridCompute/machines/mssqlDiscovered\"}]},\"then\":{\"details\":{\"deployment\":{\"location\":\"eastus\",\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"dcrId\":{\"value\":\"[parameters('dcrId')]\"},\"dcrName\":{\"value\":\"[parameters('dcrName')]\"},\"dcrResourceGroup\":{\"value\":\"[parameters('dcrResourceGroup')]\"},\"enableCollectionOfSqlQueriesForSecurityResearch\":{\"value\":\"[parameters('enableCollectionOfSqlQueriesForSecurityResearch')]\"},\"resourceGroup\":{\"value\":\"[parameters('dcrResourceGroup')]\"},\"userWorkspaceResourceId\":{\"value\":\"[parameters('userWorkspaceResourceId')]\"},\"vmName\":{\"value\":\"[field('name')]\"},\"workspaceRegion\":{\"value\":\"[parameters('workspaceRegion')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"dcrId\":{\"type\":\"string\"},\"dcrName\":{\"type\":\"string\"},\"dcrResourceGroup\":{\"type\":\"string\"},\"enableCollectionOfSqlQueriesForSecurityResearch\":{\"type\":\"bool\"},\"resourceGroup\":{\"type\":\"string\"},\"userWorkspaceResourceId\":{\"type\":\"string\"},\"vmName\":{\"type\":\"string\"},\"workspaceRegion\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2022-09-01\",\"condition\":\"[empty(parameters('dcrResourceGroup'))]\",\"location\":\"[variables('defaultRGLocation')]\",\"name\":\"[variables('defaultRGName')]\",\"tags\":{\"createdBy\":\"MicrosoftDefenderForSQL\"},\"type\":\"Microsoft.Resources/resourceGroups\"},{\"apiVersion\":\"2022-09-01\",\"condition\":\"[empty(parameters('dcrId'))]\",\"dependsOn\":[\"[variables('defaultRGName')]\"],\"name\":\"[variables('deployDataCollectionRules')]\",\"properties\":{\"expressionEvaluationOptions\":{\"scope\":\"inner\"},\"mode\":\"Incremental\",\"parameters\":{\"dcrId\":{\"value\":\"[variables('dcrId')]\"},\"dcrName\":{\"value\":\"[variables('dcrName')]\"},\"defaultRGLocation\":{\"value\":\"[variables('defaultRGLocation')]\"},\"enableCollectionOfSqlQueriesForSecurityResearch\":{\"value\":\"[parameters('enableCollectionOfSqlQueriesForSecurityResearch')]\"},\"workspaceResourceId\":{\"value\":\"[parameters('userWorkspaceResourceId')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"dcrId\":{\"type\":\"string\"},\"dcrName\":{\"type\":\"string\"},\"defaultRGLocation\":{\"type\":\"string\"},\"enableCollectionOfSqlQueriesForSecurityResearch\":{\"type\":\"bool\"},\"workspaceResourceId\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2021-04-01\",\"location\":\"[parameters('defaultRGLocation')]\",\"name\":\"[parameters('dcrName')]\",\"properties\":{\"dataFlows\":[{\"destinations\":[\"LogAnalyticsDest\"],\"streams\":[\"Microsoft-DefenderForSqlAlerts\",\"Microsoft-DefenderForSqlLogins\",\"Microsoft-DefenderForSqlTelemetry\",\"Microsoft-DefenderForSqlScanEvents\",\"Microsoft-DefenderForSqlScanResults\"]}],\"dataSources\":{\"extensions\":[{\"extensionName\":\"MicrosoftDefenderForSQL\",\"extensionSettings\":{\"enableCollectionOfSqlQueriesForSecurityResearch\":\"[parameters('enableCollectionOfSqlQueriesForSecurityResearch')]\"},\"name\":\"MicrosoftDefenderForSQL\",\"streams\":[\"Microsoft-DefenderForSqlAlerts\",\"Microsoft-DefenderForSqlLogins\",\"Microsoft-DefenderForSqlTelemetry\",\"Microsoft-DefenderForSqlScanEvents\",\"Microsoft-DefenderForSqlScanResults\"]}]},\"description\":\"Data collection rule for Microsoft Defender for SQL. Deleting this rule will break the detection of security vulnerabilities.\",\"destinations\":{\"logAnalytics\":[{\"name\":\"LogAnalyticsDest\",\"workspaceResourceId\":\"[parameters('workspaceResourceId')]\"}]}},\"tags\":{\"createdBy\":\"MicrosoftDefenderForSQL\"},\"type\":\"Microsoft.Insights/dataCollectionRules\"}],\"variables\":{}}},\"resourceGroup\":\"[variables('defaultRGName')]\",\"type\":\"Microsoft.Resources/deployments\"},{\"apiVersion\":\"2022-09-01\",\"dependsOn\":[\"[variables('deployDataCollectionRules')]\"],\"name\":\"[variables('deployDataCollectionRulesAssociation')]\",\"properties\":{\"expressionEvaluationOptions\":{\"scope\":\"inner\"},\"mode\":\"Incremental\",\"parameters\":{\"dcrId\":{\"value\":\"[variables('dcrId')]\"},\"dcraName\":{\"value\":\"[variables('dcraName')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"dcrId\":{\"type\":\"string\"},\"dcraName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2021-04-01\",\"name\":\"[parameters('dcraName')]\",\"properties\":{\"dataCollectionRuleId\":\"[parameters('dcrId')]\",\"description\":\"Configure association between Arc-enabled SQL Server and the Microsoft Defender for SQL user-defined DCR. Deleting this association will break the detection of security vulnerabilities for this Arc-enabled SQL Server.\"},\"type\":\"Microsoft.HybridCompute/machines/providers/dataCollectionRuleAssociations\"}]}},\"resourceGroup\":\"[parameters('resourceGroup')]\",\"type\":\"Microsoft.Resources/deployments\"}],\"variables\":{\"dcrId\":\"[parameters('dcrId')]\",\"dcrName\":\"[parameters('dcrName')]\",\"dcraName\":\"[concat(parameters('vmName'),'/Microsoft.Insights/MicrosoftDefenderForSQL-RulesAssociation')]\",\"defaultRGLocation\":\"[parameters('workspaceRegion')]\",\"defaultRGName\":\"[parameters('resourceGroup')]\",\"deployDataCollectionRules\":\"[concat('deployDataCollectionRules-', uniqueString(deployment().name))]\",\"deployDataCollectionRulesAssociation\":\"[concat('deployDataCollectionRulesAssociation-', uniqueString(deployment().name))]\",\"locationCode\":\"[if(contains(variables('locationLongNameToShortMap'), parameters('workspaceRegion')), variables('locationLongNameToShortMap')[parameters('workspaceRegion')], parameters('workspaceRegion'))]\",\"locationLongNameToShortMap\":{\"australiacentral\":\"CAU\",\"australiaeast\":\"EAU\",\"australiasoutheast\":\"SEAU\",\"brazilsouth\":\"CQ\",\"canadacentral\":\"CCA\",\"canadaeast\":\"CCA\",\"centralindia\":\"CIN\",\"centralus\":\"CUS\",\"eastasia\":\"EA\",\"eastus\":\"EUS\",\"eastus2\":\"EUS2\",\"eastus2euap\":\"eus2p\",\"francecentral\":\"PAR\",\"germanywestcentral\":\"DEWC\",\"japaneast\":\"EJP\",\"jioindiawest\":\"CIN\",\"koreacentral\":\"SE\",\"koreasouth\":\"SE\",\"northcentralus\":\"NCUS\",\"northeurope\":\"NEU\",\"norwayeast\":\"NOE\",\"southafricanorth\":\"JNB\",\"southcentralus\":\"SCUS\",\"southeastasia\":\"SEA\",\"southindia\":\"CIN\",\"swedencentral\":\"SEC\",\"switzerlandnorth\":\"CHN\",\"switzerlandwest\":\"CHW\",\"uaenorth\":\"DXB\",\"uksouth\":\"SUK\",\"ukwest\":\"WUK\",\"westcentralus\":\"WCUS\",\"westeurope\":\"WEU\",\"westindia\":\"CIN\",\"westus\":\"WUS\",\"westus2\":\"WUS2\"},\"subscriptionId\":\"[subscription().subscriptionId]\"}}}},\"deploymentScope\":\"subscription\",\"existenceCondition\":{\"allOf\":[{\"equals\":\"[parameters('workspaceRegion')]\",\"field\":\"location\"},{\"equals\":\"[parameters('dcrName')]\",\"field\":\"name\"}]},\"existenceScope\":\"subscription\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"],\"type\":\"Microsoft.Insights/dataCollectionRules\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-MDFC-SQL-AMA\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-MDFC-SQL-AMA",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Policy is deprecated as the built-in policy now supports bringing your own UAMI and DCR. Superseded by https://www.azadvertizer.net/azpolicyadvertizer/f91991d1-5383-4c95-8ee5-5ac423dd8bb1.html",
              "display_name": "[Deprecated]: Configure SQL Virtual Machines to automatically install Azure Monitor Agent",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Security Center\",\"deprecated\":true,\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"supersededBy\":\"f91991d1-5383-4c95-8ee5-5ac423dd8bb1\",\"version\":\"1.0.0-deprecated\"}",
              "mode": "Indexed",
              "name": "Deploy-MDFC-SQL-AMA",
              "parameters": "{\"effect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"identityResourceGroup\":{\"defaultValue\":\"\",\"metadata\":{\"description\":\"The name of the resource group created by the policy.\",\"displayName\":\"Identity Resource Group\"},\"type\":\"String\"},\"userAssignedIdentityName\":{\"defaultValue\":\"\",\"metadata\":{\"description\":\"The name of the user assigned managed identity.\",\"displayName\":\"User Assigned Managed Identity Name\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},{\"field\":\"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\"like\":\"Windows*\"},{\"equals\":\"microsoftsqlserver\",\"field\":\"Microsoft.Compute/imagePublisher\"}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"identityResourceGroup\":{\"value\":\"[parameters('identityResourceGroup')]\"},\"location\":{\"value\":\"[field('location')]\"},\"userAssignedIdentityName\":{\"value\":\"[parameters('userAssignedIdentityName')]\"},\"userAssignedManagedIdentity\":{\"value\":\"[concat('/subscriptions/', subscription().subscriptionId, '/resourceGroups/', trim(parameters('identityResourceGroup')), '/providers/Microsoft.ManagedIdentity/userAssignedIdentities/', trim(parameters('userAssignedIdentityName')))]\"},\"vmName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"identityResourceGroup\":{\"type\":\"string\"},\"location\":{\"type\":\"string\"},\"userAssignedIdentityName\":{\"type\":\"string\"},\"userAssignedManagedIdentity\":{\"type\":\"string\"},\"vmName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2023-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('vmName'), '/', variables('extensionName'))]\",\"properties\":{\"autoUpgradeMinorVersion\":true,\"enableAutomaticUpgrade\":true,\"publisher\":\"[variables('extensionPublisher')]\",\"settings\":{\"authentication\":{\"managedIdentity\":{\"identifier-name\":\"mi_res_id\",\"identifier-value\":\"[parameters('userAssignedManagedIdentity')]\"}}},\"type\":\"[variables('extensionType')]\",\"typeHandlerVersion\":\"[variables('extensionTypeHandlerVersion')]\"},\"tags\":{\"createdBy\":\"MicrosoftDefenderForSQL\"},\"type\":\"Microsoft.Compute/virtualMachines/extensions\"}],\"variables\":{\"extensionName\":\"AzureMonitorWindowsAgent\",\"extensionPublisher\":\"Microsoft.Azure.Monitor\",\"extensionType\":\"AzureMonitorWindowsAgent\",\"extensionTypeHandlerVersion\":\"1.2\"}}}},\"evaluationDelay\":\"AfterProvisioning\",\"existenceCondition\":{\"allOf\":[{\"equals\":\"AzureMonitorWindowsAgent\",\"field\":\"Microsoft.Compute/virtualMachines/extensions/type\"},{\"equals\":\"Microsoft.Azure.Monitor\",\"field\":\"Microsoft.Compute/virtualMachines/extensions/publisher\"},{\"field\":\"Microsoft.Compute/virtualMachines/extensions/provisioningState\",\"in\":[\"Succeeded\",\"Provisioning succeeded\"]}]},\"name\":\"[concat(field('fullName'), '/AzureMonitorWindowsAgent')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c\"],\"type\":\"Microsoft.Compute/virtualMachines/extensions\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-MDFC-SQL-DefenderSQL\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-MDFC-SQL-DefenderSQL",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Policy is deprecated as the built-in policy now supports bringing your own UAMI and DCR. Superseded by https://www.azadvertizer.net/azpolicyadvertizer/ddca0ddc-4e9d-4bbb-92a1-f7c4dd7ef7ce.html",
              "display_name": "[Deprecated]: Configure SQL Virtual Machines to automatically install Microsoft Defender for SQL",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Security Center\",\"deprecated\":true,\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"supersededBy\":\"ddca0ddc-4e9d-4bbb-92a1-f7c4dd7ef7ce\",\"version\":\"1.0.0-deprecated\"}",
              "mode": "Indexed",
              "name": "Deploy-MDFC-SQL-DefenderSQL",
              "parameters": "{\"dcrId\":{\"metadata\":{\"description\":\"Id of the Data Collection Rule.\",\"displayName\":\"Data Collection Rule Id\"},\"type\":\"String\"},\"dcrName\":{\"metadata\":{\"description\":\"Name of the Data Collection Rule.\",\"displayName\":\"Data Collection Rule Name\"},\"type\":\"String\"},\"dcrResourceGroup\":{\"metadata\":{\"description\":\"Resource Group of the Data Collection Rule.\",\"displayName\":\"Data Collection Rule Resource Group\"},\"type\":\"String\"},\"effect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"workspaceRegion\":{\"metadata\":{\"description\":\"Region of the Log Analytics workspace destination for the Data Collection Rule.\",\"displayName\":\"Workspace region\",\"strongType\":\"location\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},{\"field\":\"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\"like\":\"Windows*\"},{\"equals\":\"microsoftsqlserver\",\"field\":\"Microsoft.Compute/imagePublisher\"}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"dcrId\":{\"value\":\"[parameters('dcrId')]\"},\"dcrName\":{\"value\":\"[parameters('dcrName')]\"},\"dcrResourceGroup\":{\"value\":\"[parameters('dcrResourceGroup')]\"},\"location\":{\"value\":\"[field('location')]\"},\"vmName\":{\"value\":\"[field('name')]\"},\"workspaceRegion\":{\"value\":\"[parameters('workspaceRegion')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"dcrId\":{\"type\":\"string\"},\"dcrName\":{\"type\":\"string\"},\"dcrResourceGroup\":{\"type\":\"string\"},\"location\":{\"type\":\"string\"},\"vmName\":{\"type\":\"string\"},\"workspaceRegion\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2023-03-01\",\"dependsOn\":[\"[extensionResourceId(concat('/subscriptions/', variables('subscriptionId'), '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Compute/virtualMachines/', parameters('vmName')), 'Microsoft.Insights/dataCollectionRuleAssociations','MicrosoftDefenderForSQL-RulesAssociation')]\"],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('vmName'), '/', 'MicrosoftDefenderForSQL')]\",\"properties\":{\"autoUpgradeMinorVersion\":true,\"enableAutomaticUpgrade\":true,\"publisher\":\"Microsoft.Azure.AzureDefenderForSQL\",\"type\":\"AdvancedThreatProtection.Windows\",\"typeHandlerVersion\":\"2.0\"},\"tags\":{\"createdBy\":\"MicrosoftDefenderForSQL\"},\"type\":\"Microsoft.Compute/virtualMachines/extensions\"},{\"apiVersion\":\"2021-04-01\",\"name\":\"[variables('dcraName')]\",\"properties\":{\"dataCollectionRuleId\":\"[variables('dcrId')]\",\"description\":\"Configure association between SQL Virtual Machine and the Microsoft Defender for SQL DCR. Deleting this association will break the detection of security vulnerabilities for this SQL Virtual Machine.\"},\"type\":\"Microsoft.Compute/virtualMachines/providers/dataCollectionRuleAssociations\"}],\"variables\":{\"actualLocation\":\"[if(empty(parameters('workspaceRegion')), parameters('location'), parameters('workspaceRegion'))]\",\"dcrId\":\"[parameters('dcrId')]\",\"dcrName\":\"[parameters('dcrName')]\",\"dcraName\":\"[concat(parameters('vmName'),'/Microsoft.Insights/MicrosoftDefenderForSQL-RulesAssociation')]\",\"defaultRGName\":\"[parameters('dcrResourceGroup')]\",\"locationCode\":\"[if(contains(variables('locationLongNameToShortMap'), variables('actualLocation')), variables('locationLongNameToShortMap')[variables('actualLocation')], variables('actualLocation'))]\",\"locationLongNameToShortMap\":{\"australiacentral\":\"CAU\",\"australiaeast\":\"EAU\",\"australiasoutheast\":\"SEAU\",\"brazilsouth\":\"CQ\",\"canadacentral\":\"CCA\",\"canadaeast\":\"CCA\",\"centralindia\":\"CIN\",\"centralus\":\"CUS\",\"eastasia\":\"EA\",\"eastus\":\"EUS\",\"eastus2\":\"EUS2\",\"eastus2euap\":\"eus2p\",\"francecentral\":\"PAR\",\"germanywestcentral\":\"DEWC\",\"japaneast\":\"EJP\",\"jioindiawest\":\"CIN\",\"koreacentral\":\"SE\",\"koreasouth\":\"SE\",\"northcentralus\":\"NCUS\",\"northeurope\":\"NEU\",\"norwayeast\":\"NOE\",\"southafricanorth\":\"JNB\",\"southcentralus\":\"SCUS\",\"southeastasia\":\"SEA\",\"southindia\":\"CIN\",\"swedencentral\":\"SEC\",\"switzerlandnorth\":\"CHN\",\"switzerlandwest\":\"CHW\",\"uaenorth\":\"DXB\",\"uksouth\":\"SUK\",\"ukwest\":\"WUK\",\"westcentralus\":\"WCUS\",\"westeurope\":\"WEU\",\"westindia\":\"CIN\",\"westus\":\"WUS\",\"westus2\":\"WUS2\"},\"subscriptionId\":\"[subscription().subscriptionId]\"}}}},\"evaluationDelay\":\"AfterProvisioning\",\"existenceCondition\":{\"allOf\":[{\"equals\":\"AdvancedThreatProtection.Windows\",\"field\":\"Microsoft.Compute/virtualMachines/extensions/type\"},{\"equals\":\"Microsoft.Azure.AzureDefenderForSQL\",\"field\":\"Microsoft.Compute/virtualMachines/extensions/publisher\"},{\"field\":\"Microsoft.Compute/virtualMachines/extensions/provisioningState\",\"in\":[\"Succeeded\",\"Provisioning succeeded\"]}]},\"name\":\"[concat(field('fullName'), '/MicrosoftDefenderForSQL')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Compute/virtualMachines/extensions\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-MDFC-SQL-DefenderSQL-DCR\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-MDFC-SQL-DefenderSQL-DCR",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Policy is deprecated as the built-in policy now supports bringing your own UAMI and DCR. Superseded by https://www.azadvertizer.net/azpolicyadvertizer/04754ef9-9ae3-4477-bf17-86ef50026304.html",
              "display_name": "[Deprecated]: Configure SQL Virtual Machines to auto install Microsoft Defender for SQL and DCR with a user-defined LAW",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Security Center\",\"deprecated\":true,\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"supersededBy\":\"04754ef9-9ae3-4477-bf17-86ef50026304\",\"version\":\"1.0.1-deprecated\"}",
              "mode": "Indexed",
              "name": "Deploy-MDFC-SQL-DefenderSQL-DCR",
              "parameters": "{\"dcrId\":{\"metadata\":{\"description\":\"Id of the Data Collection Rule.\",\"displayName\":\"Data Collection Rule Id\"},\"type\":\"String\"},\"dcrName\":{\"metadata\":{\"description\":\"Name of the Data Collection Rule.\",\"displayName\":\"Data Collection Rule Name\"},\"type\":\"String\"},\"dcrResourceGroup\":{\"metadata\":{\"description\":\"Resource Group of the Data Collection Rule.\",\"displayName\":\"Data Collection Rule Resource Group\"},\"type\":\"String\"},\"effect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"enableCollectionOfSqlQueriesForSecurityResearch\":{\"allowedValues\":[true,false],\"defaultValue\":false,\"metadata\":{\"description\":\"Enable or disable the collection of SQL queries for security research.\",\"displayName\":\"Enable collection of SQL queries for security research\"},\"type\":\"Boolean\"},\"userWorkspaceResourceId\":{\"metadata\":{\"description\":\"Workspace resource Id of the Log Analytics workspace destination for the Data Collection Rule.\",\"displayName\":\"Workspace Resource Id\",\"strongType\":\"omsWorkspace\"},\"type\":\"String\"},\"workspaceRegion\":{\"metadata\":{\"description\":\"Region of the Log Analytics workspace destination for the Data Collection Rule.\",\"displayName\":\"Workspace region\",\"strongType\":\"location\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},{\"field\":\"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\"like\":\"Windows*\"},{\"equals\":\"microsoftsqlserver\",\"field\":\"Microsoft.Compute/imagePublisher\"}]},\"then\":{\"details\":{\"deployment\":{\"location\":\"eastus\",\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"dcrId\":{\"value\":\"[parameters('dcrId')]\"},\"dcrName\":{\"value\":\"[parameters('dcrName')]\"},\"dcrResourceGroup\":{\"value\":\"[parameters('dcrResourceGroup')]\"},\"enableCollectionOfSqlQueriesForSecurityResearch\":{\"value\":\"[parameters('enableCollectionOfSqlQueriesForSecurityResearch')]\"},\"location\":{\"value\":\"[field('location')]\"},\"resourceGroup\":{\"value\":\"[resourceGroup().name]\"},\"userWorkspaceResourceId\":{\"value\":\"[parameters('userWorkspaceResourceId')]\"},\"vmName\":{\"value\":\"[field('name')]\"},\"workspaceRegion\":{\"value\":\"[parameters('workspaceRegion')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"dcrId\":{\"type\":\"string\"},\"dcrName\":{\"type\":\"string\"},\"dcrResourceGroup\":{\"type\":\"string\"},\"enableCollectionOfSqlQueriesForSecurityResearch\":{\"type\":\"bool\"},\"location\":{\"type\":\"string\"},\"resourceGroup\":{\"type\":\"string\"},\"userWorkspaceResourceId\":{\"type\":\"string\"},\"vmName\":{\"type\":\"string\"},\"workspaceRegion\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2022-09-01\",\"condition\":\"[empty(parameters('dcrResourceGroup'))]\",\"location\":\"[variables('defaultRGLocation')]\",\"name\":\"[variables('defaultRGName')]\",\"tags\":{\"createdBy\":\"MicrosoftDefenderForSQL\"},\"type\":\"Microsoft.Resources/resourceGroups\"},{\"apiVersion\":\"2022-09-01\",\"name\":\"[variables('deployDefenderForSQL')]\",\"properties\":{\"expressionEvaluationOptions\":{\"scope\":\"inner\"},\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[parameters('location')]\"},\"vmName\":{\"value\":\"[parameters('vmName')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"vmName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2023-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('vmName'), '/', 'MicrosoftDefenderForSQL')]\",\"properties\":{\"autoUpgradeMinorVersion\":true,\"enableAutomaticUpgrade\":true,\"publisher\":\"Microsoft.Azure.AzureDefenderForSQL\",\"type\":\"AdvancedThreatProtection.Windows\",\"typeHandlerVersion\":\"2.0\"},\"tags\":{\"createdBy\":\"MicrosoftDefenderForSQL\"},\"type\":\"Microsoft.Compute/virtualMachines/extensions\"}],\"variables\":{}}},\"resourceGroup\":\"[parameters('resourceGroup')]\",\"type\":\"Microsoft.Resources/deployments\"},{\"apiVersion\":\"2022-09-01\",\"condition\":\"[empty(parameters('dcrId'))]\",\"dependsOn\":[\"[variables('defaultRGName')]\"],\"name\":\"[variables('deployDataCollectionRules')]\",\"properties\":{\"expressionEvaluationOptions\":{\"scope\":\"inner\"},\"mode\":\"Incremental\",\"parameters\":{\"dcrId\":{\"value\":\"[variables('dcrId')]\"},\"dcrName\":{\"value\":\"[variables('dcrName')]\"},\"defaultRGLocation\":{\"value\":\"[variables('defaultRGLocation')]\"},\"enableCollectionOfSqlQueriesForSecurityResearch\":{\"value\":\"[parameters('enableCollectionOfSqlQueriesForSecurityResearch')]\"},\"workspaceResourceId\":{\"value\":\"[parameters('userWorkspaceResourceId')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"dcrId\":{\"type\":\"string\"},\"dcrName\":{\"type\":\"string\"},\"defaultRGLocation\":{\"type\":\"string\"},\"enableCollectionOfSqlQueriesForSecurityResearch\":{\"type\":\"bool\"},\"workspaceResourceId\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2021-04-01\",\"location\":\"[parameters('defaultRGLocation')]\",\"name\":\"[parameters('dcrName')]\",\"properties\":{\"dataFlows\":[{\"destinations\":[\"LogAnalyticsDest\"],\"streams\":[\"Microsoft-DefenderForSqlAlerts\",\"Microsoft-DefenderForSqlLogins\",\"Microsoft-DefenderForSqlTelemetry\",\"Microsoft-DefenderForSqlScanEvents\",\"Microsoft-DefenderForSqlScanResults\"]}],\"dataSources\":{\"extensions\":[{\"extensionName\":\"MicrosoftDefenderForSQL\",\"extensionSettings\":{\"enableCollectionOfSqlQueriesForSecurityResearch\":\"[parameters('enableCollectionOfSqlQueriesForSecurityResearch')]\"},\"name\":\"MicrosoftDefenderForSQL\",\"streams\":[\"Microsoft-DefenderForSqlAlerts\",\"Microsoft-DefenderForSqlLogins\",\"Microsoft-DefenderForSqlTelemetry\",\"Microsoft-DefenderForSqlScanEvents\",\"Microsoft-DefenderForSqlScanResults\"]}]},\"description\":\"Data collection rule for Microsoft Defender for SQL. Deleting this rule will break the detection of security vulnerabilities.\",\"destinations\":{\"logAnalytics\":[{\"name\":\"LogAnalyticsDest\",\"workspaceResourceId\":\"[parameters('workspaceResourceId')]\"}]}},\"tags\":{\"createdBy\":\"MicrosoftDefenderForSQL\"},\"type\":\"Microsoft.Insights/dataCollectionRules\"}],\"variables\":{}}},\"resourceGroup\":\"[variables('defaultRGName')]\",\"type\":\"Microsoft.Resources/deployments\"},{\"apiVersion\":\"2022-09-01\",\"dependsOn\":[\"[variables('deployDataCollectionRules')]\"],\"name\":\"[variables('deployDataCollectionRulesAssociation')]\",\"properties\":{\"expressionEvaluationOptions\":{\"scope\":\"inner\"},\"mode\":\"Incremental\",\"parameters\":{\"dcrId\":{\"value\":\"[variables('dcrId')]\"},\"dcraName\":{\"value\":\"[variables('dcraName')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"dcrId\":{\"type\":\"string\"},\"dcraName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2021-04-01\",\"name\":\"[parameters('dcraName')]\",\"properties\":{\"dataCollectionRuleId\":\"[parameters('dcrId')]\",\"description\":\"Configure association between SQL Virtual Machine and the Microsoft Defender for SQL user-defined DCR. Deleting this association will break the detection of security vulnerabilities for this SQL Virtual Machine.\"},\"type\":\"Microsoft.Compute/virtualMachines/providers/dataCollectionRuleAssociations\"}]}},\"resourceGroup\":\"[parameters('resourceGroup')]\",\"type\":\"Microsoft.Resources/deployments\"}],\"variables\":{\"dcrId\":\"[parameters('dcrId')]\",\"dcrName\":\"[parameters('dcrName')]\",\"dcraName\":\"[concat(parameters('vmName'),'/Microsoft.Insights/MicrosoftDefenderForSQL-RulesAssociation')]\",\"defaultRGLocation\":\"[parameters('workspaceRegion')]\",\"defaultRGName\":\"[parameters('dcrResourceGroup')]\",\"deployDataCollectionRules\":\"[concat('deployDataCollectionRules-', uniqueString(deployment().name))]\",\"deployDataCollectionRulesAssociation\":\"[concat('deployDataCollectionRulesAssociation-', uniqueString(deployment().name))]\",\"deployDefenderForSQL\":\"[concat('deployDefenderForSQL-', uniqueString(deployment().name))]\",\"locationCode\":\"[if(contains(variables('locationLongNameToShortMap'), parameters('workspaceRegion')), variables('locationLongNameToShortMap')[parameters('workspaceRegion')], parameters('workspaceRegion'))]\",\"locationLongNameToShortMap\":{\"australiacentral\":\"CAU\",\"australiaeast\":\"EAU\",\"australiasoutheast\":\"SEAU\",\"brazilsouth\":\"CQ\",\"canadacentral\":\"CCA\",\"canadaeast\":\"CCA\",\"centralindia\":\"CIN\",\"centralus\":\"CUS\",\"eastasia\":\"EA\",\"eastus\":\"EUS\",\"eastus2\":\"EUS2\",\"eastus2euap\":\"eus2p\",\"francecentral\":\"PAR\",\"germanywestcentral\":\"DEWC\",\"japaneast\":\"EJP\",\"jioindiawest\":\"CIN\",\"koreacentral\":\"SE\",\"koreasouth\":\"SE\",\"northcentralus\":\"NCUS\",\"northeurope\":\"NEU\",\"norwayeast\":\"NOE\",\"southafricanorth\":\"JNB\",\"southcentralus\":\"SCUS\",\"southeastasia\":\"SEA\",\"southindia\":\"CIN\",\"swedencentral\":\"SEC\",\"switzerlandnorth\":\"CHN\",\"switzerlandwest\":\"CHW\",\"uaenorth\":\"DXB\",\"uksouth\":\"SUK\",\"ukwest\":\"WUK\",\"westcentralus\":\"WCUS\",\"westeurope\":\"WEU\",\"westindia\":\"CIN\",\"westus\":\"WUS\",\"westus2\":\"WUS2\"},\"subscriptionId\":\"[subscription().subscriptionId]\"}}}},\"deploymentScope\":\"subscription\",\"evaluationDelay\":\"AfterProvisioning\",\"existenceCondition\":{\"allOf\":[{\"equals\":\"[parameters('workspaceRegion')]\",\"field\":\"location\"},{\"equals\":\"[parameters('dcrName')]\",\"field\":\"name\"}]},\"existenceScope\":\"subscription\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"],\"type\":\"Microsoft.Insights/dataCollectionRules\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-MySQL-sslEnforcement\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-MySQL-sslEnforcement",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Deploy a specific min TLS version requirement and enforce SSL on Azure Database for MySQL server. Enforce the Server to client applications using minimum version of Tls to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.",
              "display_name": "Azure Database for MySQL server deploy a specific min TLS version and enforce SSL.",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"SQL\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.1.0\"}",
              "mode": "Indexed",
              "name": "Deploy-MySQL-sslEnforcement",
              "parameters": "{\"effect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy minimum TLS version Azure Database for MySQL server\",\"displayName\":\"Effect minimum TLS version Azure Database for MySQL server\"},\"type\":\"String\"},\"minimalTlsVersion\":{\"allowedValues\":[\"TLS1_2\",\"TLS1_0\",\"TLS1_1\",\"TLSEnforcementDisabled\"],\"defaultValue\":\"TLS1_2\",\"metadata\":{\"description\":\"Select version  minimum TLS version Azure Database for MySQL server to enforce\",\"displayName\":\"Select version minimum TLS for MySQL server\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.DBforMySQL/servers\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.DBforMySQL/servers/sslEnforcement\",\"notEquals\":\"Enabled\"},{\"field\":\"Microsoft.DBforMySQL/servers/minimalTlsVersion\",\"notequals\":\"[parameters('minimalTlsVersion')]\"}]}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"minimalTlsVersion\":{\"value\":\"[parameters('minimalTlsVersion')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"minimalTlsVersion\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-12-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'))]\",\"properties\":{\"minimalTlsVersion\":\"[parameters('minimalTlsVersion')]\",\"sslEnforcement\":\"[if(equals(parameters('minimalTlsVersion'), 'TLSEnforcementDisabled'),'Disabled', 'Enabled')]\"},\"type\":\"Microsoft.DBforMySQL/servers\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"Enabled\",\"field\":\"Microsoft.DBforMySQL/servers/sslEnforcement\"},{\"equals\":\"[parameters('minimalTlsVersion')]\",\"field\":\"Microsoft.DBforMySQL/servers/minimalTlsVersion\"}]},\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"],\"type\":\"Microsoft.DBforMySQL/servers\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Nsg-FlowLogs\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Nsg-FlowLogs",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "[Deprecated] Deprecated by built-in policy. Deploys NSG flow logs and traffic analytics to a storageaccountid with a specified retention period. Superseded by https://www.azadvertizer.net/azpolicyadvertizer/e920df7f-9a64-4066-9b58-52684c02a091.html",
              "display_name": "[Deprecated] Deploys NSG flow logs and traffic analytics",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"deprecated\":true,\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"supersededBy\":\"e920df7f-9a64-4066-9b58-52684c02a091\",\"version\":\"1.0.0-deprecated\"}",
              "mode": "Indexed",
              "name": "Deploy-Nsg-FlowLogs",
              "parameters": "{\"effect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"flowAnalyticsEnabled\":{\"defaultValue\":false,\"metadata\":{\"displayName\":\"Enable Traffic Analytics\"},\"type\":\"Boolean\"},\"logAnalytics\":{\"defaultValue\":\"\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Resource ID of Log Analytics workspace\",\"strongType\":\"omsWorkspace\"},\"type\":\"String\"},\"retention\":{\"defaultValue\":5,\"metadata\":{\"displayName\":\"Retention\"},\"type\":\"Integer\"},\"storageAccountResourceId\":{\"metadata\":{\"displayName\":\"Storage Account Resource Id\",\"strongType\":\"Microsoft.Storage/storageAccounts\"},\"type\":\"String\"},\"trafficAnalyticsInterval\":{\"defaultValue\":60,\"metadata\":{\"displayName\":\"Traffic Analytics processing interval mins (10/60)\"},\"type\":\"Integer\"}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Network/networkSecurityGroups\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"flowAnalyticsEnabled\":{\"value\":\"[parameters('flowAnalyticsEnabled')]\"},\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"networkSecurityGroupName\":{\"value\":\"[field('name')]\"},\"resourceGroupName\":{\"value\":\"[resourceGroup().name]\"},\"retention\":{\"value\":\"[parameters('retention')]\"},\"storageAccountResourceId\":{\"value\":\"[parameters('storageAccountResourceId')]\"},\"trafficAnalyticsInterval\":{\"value\":\"[parameters('trafficAnalyticsInterval')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"flowAnalyticsEnabled\":{\"type\":\"bool\"},\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"networkSecurityGroupName\":{\"type\":\"String\"},\"resourceGroupName\":{\"type\":\"String\"},\"retention\":{\"type\":\"int\"},\"storageAccountResourceId\":{\"type\":\"String\"},\"trafficAnalyticsInterval\":{\"type\":\"int\"}},\"resources\":[{\"apiVersion\":\"2020-05-01\",\"location\":\"[parameters('location')]\",\"name\":\"[take(concat('NetworkWatcher_', toLower(parameters('location')),  '/', parameters('networkSecurityGroupName'), '-', parameters('resourceGroupName'), '-flowlog' ), 80)]\",\"properties\":{\"enabled\":true,\"flowAnalyticsConfiguration\":{\"networkWatcherFlowAnalyticsConfiguration\":{\"enabled\":\"[bool(parameters('flowAnalyticsEnabled'))]\",\"trafficAnalyticsInterval\":\"[parameters('trafficAnalyticsInterval')]\",\"workspaceId\":\"[if(not(empty(parameters('logAnalytics'))), reference(parameters('logAnalytics'), '2020-03-01-preview', 'Full').properties.customerId, json('null')) ]\",\"workspaceRegion\":\"[if(not(empty(parameters('logAnalytics'))), reference(parameters('logAnalytics'), '2020-03-01-preview', 'Full').location, json('null')) ]\",\"workspaceResourceId\":\"[if(not(empty(parameters('logAnalytics'))), parameters('logAnalytics'), json('null'))]\"}},\"format\":{\"type\":\"JSON\",\"version\":2},\"retentionPolicy\":{\"days\":\"[parameters('retention')]\",\"enabled\":true},\"storageId\":\"[parameters('storageAccountResourceId')]\",\"targetResourceId\":\"[resourceId(parameters('resourceGroupName'), 'Microsoft.Network/networkSecurityGroups', parameters('networkSecurityGroupName'))]\"},\"type\":\"Microsoft.Network/networkWatchers/flowLogs\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Network/networkWatchers/flowLogs/enabled\"},{\"equals\":\"[parameters('flowAnalyticsEnabled')]\",\"field\":\"Microsoft.Network/networkWatchers/flowLogs/flowAnalyticsConfiguration.networkWatcherFlowAnalyticsConfiguration.enabled\"}]},\"resourceGroupName\":\"NetworkWatcherRG\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Network/networkWatchers/flowLogs\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Nsg-FlowLogs-to-LA\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Nsg-FlowLogs-to-LA",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "[Deprecated] Deprecated by built-in policy. Deploys NSG flow logs and traffic analytics to Log Analytics with a specified retention period. Superseded by https://www.azadvertizer.net/azpolicyadvertizer/e920df7f-9a64-4066-9b58-52684c02a091.html",
              "display_name": "[Deprecated] Deploys NSG flow logs and traffic analytics to Log Analytics",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"deprecated\":true,\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"supersededBy\":\"e920df7f-9a64-4066-9b58-52684c02a091\",\"version\":\"1.1.0-deprecated\"}",
              "mode": "Indexed",
              "name": "Deploy-Nsg-FlowLogs-to-LA",
              "parameters": "{\"effect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"interval\":{\"defaultValue\":60,\"metadata\":{\"displayName\":\"Traffic Analytics processing interval mins (10/60)\"},\"type\":\"Integer\"},\"retention\":{\"defaultValue\":5,\"metadata\":{\"displayName\":\"Retention\"},\"type\":\"Integer\"},\"workspace\":{\"defaultValue\":\"\\u003cworkspace resource ID\\u003e\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Resource ID of Log Analytics workspace\",\"strongType\":\"omsWorkspace\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/networkSecurityGroups\",\"field\":\"type\"}]},\"then\":{\"details\":{\"deployment\":{\"location\":\"northeurope\",\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"interval\":{\"value\":\"[parameters('interval')]\"},\"location\":{\"value\":\"[field('location')]\"},\"networkSecurityGroup\":{\"value\":\"[field('id')]\"},\"retention\":{\"value\":\"[parameters('retention')]\"},\"workspace\":{\"value\":\"[parameters('workspace')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"interval\":{\"type\":\"int\"},\"location\":{\"type\":\"String\"},\"networkSecurityGroup\":{\"type\":\"String\"},\"retention\":{\"type\":\"int\"},\"time\":{\"defaultValue\":\"[utcNow()]\",\"type\":\"String\"},\"workspace\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2019-10-01\",\"name\":\"[concat(variables('resourceGroupName'), '.', variables('securityGroupName'))]\",\"properties\":{\"mode\":\"Incremental\",\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"resources\":[{\"apiVersion\":\"2019-06-01\",\"kind\":\"StorageV2\",\"location\":\"[parameters('location')]\",\"name\":\"[variables('storageAccountName')]\",\"properties\":{},\"sku\":{\"name\":\"Standard_LRS\",\"tier\":\"Standard\"},\"type\":\"Microsoft.Storage/storageAccounts\"}]}},\"resourceGroup\":\"[variables('resourceGroupName')]\",\"type\":\"Microsoft.Resources/deployments\"},{\"apiVersion\":\"2019-10-01\",\"dependsOn\":[\"[concat(variables('resourceGroupName'), '.', variables('securityGroupName'))]\"],\"name\":\"[concat('NetworkWatcherRG', '.', variables('securityGroupName'))]\",\"properties\":{\"mode\":\"Incremental\",\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"resources\":[{\"apiVersion\":\"2020-05-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat('NetworkWatcher_', toLower(parameters('location')))]\",\"properties\":{},\"resources\":[{\"apiVersion\":\"2019-11-01\",\"dependsOn\":[\"[concat('NetworkWatcher_', toLower(parameters('location')))]\"],\"location\":\"[parameters('location')]\",\"name\":\"[concat(variables('securityGroupName'), '-Network-flowlog')]\",\"properties\":{\"enabled\":true,\"flowAnalyticsConfiguration\":{\"networkWatcherFlowAnalyticsConfiguration\":{\"enabled\":true,\"trafficAnalyticsInterval\":\"[parameters('interval')]\",\"workspaceResourceId\":\"[parameters('workspace')]\"}},\"format\":{\"type\":\"JSON\",\"version\":2},\"retentionPolicy\":{\"days\":\"[parameters('retention')]\",\"enabled\":true},\"storageId\":\"[concat(subscription().id, '/resourceGroups/', variables('resourceGroupName'), '/providers/Microsoft.Storage/storageAccounts/', variables('storageAccountName'))]\",\"targetResourceId\":\"[parameters('networkSecurityGroup')]\"},\"type\":\"flowLogs\"}],\"type\":\"Microsoft.Network/networkWatchers\"}]}},\"resourceGroup\":\"NetworkWatcherRG\",\"type\":\"Microsoft.Resources/deployments\"}],\"variables\":{\"resourceGroupName\":\"[split(parameters('networkSecurityGroup'), '/')[4]]\",\"securityGroupName\":\"[split(parameters('networkSecurityGroup'), '/')[8]]\",\"storageAccountName\":\"[concat('es', uniqueString(variables('securityGroupName'), parameters('time')))]\"}}}},\"deploymentScope\":\"subscription\",\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Network/networkWatchers/flowLogs/enabled\"}]},\"existenceScope\":\"resourceGroup\",\"name\":\"[if(empty(coalesce(field('Microsoft.Network/networkSecurityGroups/flowLogs[*].id'))), 'null/null', concat(split(first(field('Microsoft.Network/networkSecurityGroups/flowLogs[*].id')), '/')[8], '/', split(first(field('Microsoft.Network/networkSecurityGroups/flowLogs[*].id')), '/')[10]))]\",\"resourceGroupName\":\"[if(empty(coalesce(field('Microsoft.Network/networkSecurityGroups/flowLogs'))), 'NetworkWatcherRG', split(first(field('Microsoft.Network/networkSecurityGroups/flowLogs[*].id')), '/')[4])]\",\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\",\"/providers/Microsoft.Authorization/roleDefinitions/81a9662b-bebf-436f-a333-f67b29880f12\",\"/providers/Microsoft.Authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\",\"/providers/Microsoft.Authorization/roleDefinitions/17d1049b-9a84-46fb-8f53-869881c3d3ab\",\"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"],\"type\":\"Microsoft.Network/networkWatchers/flowlogs\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-PostgreSQL-sslEnforcement\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-PostgreSQL-sslEnforcement",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Deploy a specific min TLS version requirement and enforce SSL on Azure Database for PostgreSQL server. Enables secure server to client by enforce  minimal Tls Version to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.",
              "display_name": "Azure Database for PostgreSQL server deploy a specific min TLS version requirement and enforce SSL ",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"SQL\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.1.0\"}",
              "mode": "Indexed",
              "name": "Deploy-PostgreSQL-sslEnforcement",
              "parameters": "{\"effect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy minimum TLS version Azure Database for PostgreSQL server\",\"displayName\":\"Effect Azure Database for PostgreSQL server\"},\"type\":\"String\"},\"minimalTlsVersion\":{\"allowedValues\":[\"TLS1_2\",\"TLS1_0\",\"TLS1_1\",\"TLSEnforcementDisabled\"],\"defaultValue\":\"TLS1_2\",\"metadata\":{\"description\":\"Select version minimum TLS version Azure Database for PostgreSQL server to enforce\",\"displayName\":\"Select version for PostgreSQL server\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.DBforPostgreSQL/servers\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.DBforPostgreSQL/servers/sslEnforcement\",\"notEquals\":\"Enabled\"},{\"field\":\"Microsoft.DBforPostgreSQL/servers/minimalTlsVersion\",\"notEquals\":\"[parameters('minimalTlsVersion')]\"}]}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"minimalTlsVersion\":{\"value\":\"[parameters('minimalTlsVersion')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"minimalTlsVersion\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-12-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'))]\",\"properties\":{\"minimalTlsVersion\":\"[parameters('minimalTlsVersion')]\",\"sslEnforcement\":\"[if(equals(parameters('minimalTlsVersion'), 'TLSEnforcementDisabled'),'Disabled', 'Enabled')]\"},\"type\":\"Microsoft.DBforPostgreSQL/servers\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"Enabled\",\"field\":\"Microsoft.DBforPostgreSQL/servers/sslEnforcement\"},{\"equals\":\"[parameters('minimalTlsVersion')]\",\"field\":\"Microsoft.DBforPostgreSQL/servers/minimalTlsVersion\"}]},\"name\":\"current\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"],\"type\":\"Microsoft.DBforPostgreSQL/servers\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Private-DNS-Generic\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Private-DNS-Generic",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Configure private DNS zone group to override the DNS resolution for PaaS services private endpoint. See https://aka.ms/pepdnszones for information on values to provide to parameters in this policy.",
              "display_name": "Deploy-Private-DNS-Generic",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Networking\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.0\"}",
              "mode": "All",
              "name": "Deploy-Private-DNS-Generic",
              "parameters": "{\"effect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"evaluationDelay\":{\"defaultValue\":\"PT10M\",\"metadata\":{\"description\":\"The delay in evaluation of the policy. Review delay options at https://learn.microsoft.com/en-us/azure/governance/policy/concepts/effect-deploy-if-not-exists\",\"displayName\":\"Evaluation Delay\"},\"type\":\"String\"},\"groupId\":{\"metadata\":{\"description\":\"The group ID of the PaaS private endpoint. Also referred to as subresource.\",\"displayName\":\"PaaS Private endpoint group ID (subresource)\"},\"type\":\"String\"},\"privateDnsZoneId\":{\"metadata\":{\"assignPermissions\":true,\"description\":\"The private DNS zone name required for specific Paas Services to resolve a private DNS Zone.\",\"displayName\":\"Private DNS Zone ID for Paas services\",\"strongType\":\"Microsoft.Network/privateDnsZones\"},\"type\":\"String\"},\"resourceType\":{\"metadata\":{\"description\":\"The PaaS endpoint resource type.\",\"displayName\":\"PaaS private endpoint resource type\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*]\",\"where\":{\"allOf\":[{\"contains\":\"[parameters('resourceType')]\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].privateLinkServiceId\"},{\"equals\":\"[parameters('groupId')]\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}]}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"PaaS-Service-Private-DNS-Zone-Config\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"evaluationDelay\":\"[parameters('evaluationDelay')]\",\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-SQL-minTLS\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-SQL-minTLS",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Deploys a specific min TLS version requirement and enforce SSL on SQL servers. Enables secure server to client by enforce  minimal Tls Version to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.",
              "display_name": "SQL servers deploys a specific min TLS version requirement.",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"SQL\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.1.0\"}",
              "mode": "Indexed",
              "name": "Deploy-SQL-minTLS",
              "parameters": "{\"effect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy minimum TLS version SQL servers\",\"displayName\":\"Effect SQL servers\"},\"type\":\"String\"},\"minimalTlsVersion\":{\"allowedValues\":[\"1.2\",\"1.1\",\"1.0\"],\"defaultValue\":\"1.2\",\"metadata\":{\"description\":\"Select version minimum TLS version SQL servers to enforce\",\"displayName\":\"Select version for SQL server\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Sql/servers\",\"field\":\"type\"},{\"field\":\"Microsoft.Sql/servers/minimalTlsVersion\",\"notequals\":\"[parameters('minimalTlsVersion')]\"}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"minimalTlsVersion\":{\"value\":\"[parameters('minimalTlsVersion')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"minimalTlsVersion\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2019-06-01-preview\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'))]\",\"properties\":{\"minimalTlsVersion\":\"[parameters('minimalTlsVersion')]\"},\"type\":\"Microsoft.Sql/servers\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"[parameters('minimalTlsVersion')]\",\"field\":\"Microsoft.Sql/servers/minimalTlsVersion\"}]},\"name\":\"current\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/6d8ee4ec-f05a-4a1d-8b00-a9b17e38b437\"],\"type\":\"Microsoft.Sql/servers\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Sql-AuditingSettings\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Sql-AuditingSettings",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Deploy auditing settings to SQL Database when it not exist in the deployment",
              "display_name": "Deploy SQL database auditing settings",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"SQL\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Deploy-Sql-AuditingSettings",
              "parameters": "{\"effect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Sql/servers/databases\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"sqlServerDataBaseName\":{\"value\":\"[field('name')]\"},\"sqlServerName\":{\"value\":\"[first(split(field('fullname'),'/'))]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"sqlServerDataBaseName\":{\"type\":\"String\"},\"sqlServerName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-03-01-preview\",\"name\":\"[concat( parameters('sqlServerName'),'/',parameters('sqlServerDataBaseName'),'/default')]\",\"properties\":{\"auditActionsAndGroups\":[\"BATCH_COMPLETED_GROUP\",\"DATABASE_OBJECT_CHANGE_GROUP\",\"SCHEMA_OBJECT_CHANGE_GROUP\",\"BACKUP_RESTORE_GROUP\",\"APPLICATION_ROLE_CHANGE_PASSWORD_GROUP\",\"DATABASE_PRINCIPAL_CHANGE_GROUP\",\"DATABASE_PRINCIPAL_IMPERSONATION_GROUP\",\"DATABASE_ROLE_MEMBER_CHANGE_GROUP\",\"USER_CHANGE_PASSWORD_GROUP\",\"DATABASE_OBJECT_OWNERSHIP_CHANGE_GROUP\",\"DATABASE_OBJECT_PERMISSION_CHANGE_GROUP\",\"DATABASE_PERMISSION_CHANGE_GROUP\",\"SCHEMA_OBJECT_PERMISSION_CHANGE_GROUP\",\"SUCCESSFUL_DATABASE_AUTHENTICATION_GROUP\",\"FAILED_DATABASE_AUTHENTICATION_GROUP\"],\"isAzureMonitorTargetEnabled\":true,\"state\":\"enabled\"},\"type\":\"Microsoft.Sql/servers/databases/auditingSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"enabled\",\"field\":\"Microsoft.Sql/servers/databases/auditingSettings/state\"},{\"equals\":\"true\",\"field\":\"Microsoft.Sql/servers/databases/auditingSettings/isAzureMonitorTargetEnabled\"}]},\"name\":\"default\",\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/056cd41c-7e88-42e1-933e-88ba6a50c9c3\"],\"type\":\"Microsoft.Sql/servers/databases/auditingSettings\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Sql-SecurityAlertPolicies\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Sql-SecurityAlertPolicies",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Deploy the security Alert Policies configuration with email admin accounts when it not exist in current configuration",
              "display_name": "Deploy SQL Database security Alert Policies configuration with email admin accounts",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"SQL\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.1.1\"}",
              "mode": "Indexed",
              "name": "Deploy-Sql-SecurityAlertPolicies",
              "parameters": "{\"effect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"emailAddresses\":{\"defaultValue\":[\"admin@contoso.com\",\"admin@fabrikam.com\"],\"type\":\"Array\"}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Sql/servers/databases\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"emailAddresses\":{\"value\":\"[parameters('emailAddresses')]\"},\"location\":{\"value\":\"[field('location')]\"},\"sqlServerDataBaseName\":{\"value\":\"[field('name')]\"},\"sqlServerName\":{\"value\":\"[first(split(field('fullname'),'/'))]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"emailAddresses\":{\"type\":\"Array\"},\"location\":{\"type\":\"String\"},\"sqlServerDataBaseName\":{\"type\":\"String\"},\"sqlServerName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2018-06-01-preview\",\"name\":\"[concat(parameters('sqlServerName'),'/',parameters('sqlServerDataBaseName'),'/default')]\",\"properties\":{\"disabledAlerts\":[\"\"],\"emailAccountAdmins\":true,\"emailAddresses\":\"[parameters('emailAddresses')]\",\"retentionDays\":0,\"state\":\"Enabled\",\"storageAccountAccessKey\":\"\",\"storageEndpoint\":null},\"type\":\"Microsoft.Sql/servers/databases/securityAlertPolicies\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"Enabled\",\"field\":\"Microsoft.Sql/servers/databases/securityAlertPolicies/state\"}]},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/056cd41c-7e88-42e1-933e-88ba6a50c9c3\"],\"type\":\"Microsoft.Sql/servers/databases/securityAlertPolicies\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Sql-Tde\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Sql-Tde",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Deploy the Transparent Data Encryption when it is not enabled in the deployment. Please use this policy instead https://www.azadvertizer.net/azpolicyadvertizer/86a912f6-9a06-4e26-b447-11b16ba8659f.html",
              "display_name": "[Deprecated] Deploy SQL Database Transparent Data Encryption",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"SQL\",\"deprecated\":true,\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"supersededBy\":\"86a912f6-9a06-4e26-b447-11b16ba8659f\",\"version\":\"1.1.1-deprecated\"}",
              "mode": "Indexed",
              "name": "Deploy-Sql-Tde",
              "parameters": "{\"effect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"excludedDatabases\":{\"defaultValue\":[\"master\",\"model\",\"tempdb\",\"msdb\",\"resource\"],\"metadata\":{\"description\":\"Array of databases that are excluded from this policy\",\"displayName\":\"Excluded Databases\"},\"type\":\"Array\"}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Sql/servers/databases\",\"field\":\"type\"},{\"field\":\"name\",\"notIn\":\"[parameters('excludedDatabases')]\"}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"sqlServerDataBaseName\":{\"value\":\"[field('name')]\"},\"sqlServerName\":{\"value\":\"[first(split(field('fullname'),'/'))]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"sqlServerDataBaseName\":{\"type\":\"String\"},\"sqlServerName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2014-04-01\",\"name\":\"[concat( parameters('sqlServerName'),'/',parameters('sqlServerDataBaseName'),'/current')]\",\"properties\":{\"status\":\"Enabled\"},\"type\":\"Microsoft.Sql/servers/databases/transparentDataEncryption\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"Enabled\",\"field\":\"Microsoft.Sql/transparentDataEncryption.status\"}]},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/056cd41c-7e88-42e1-933e-88ba6a50c9c3\"],\"type\":\"Microsoft.Sql/servers/databases/transparentDataEncryption\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Sql-vulnerabilityAssessments\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Sql-vulnerabilityAssessments",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Deploy SQL Database vulnerability Assessments when it not exist in the deployment. Superseded by https://www.azadvertizer.net/azpolicyadvertizer/Deploy-Sql-vulnerabilityAssessments_20230706.html",
              "display_name": "[Deprecated]: Deploy SQL Database vulnerability Assessments",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"SQL\",\"deprecated\":true,\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"supersededBy\":\"Deploy-Sql-vulnerabilityAssessments_20230706\",\"version\":\"1.0.1-deprecated\"}",
              "mode": "Indexed",
              "name": "Deploy-Sql-vulnerabilityAssessments",
              "parameters": "{\"effect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"vulnerabilityAssessmentsEmail\":{\"metadata\":{\"description\":\"The email address to send alerts. For multiple emails, format in the following 'email1@contoso.com;email2@contoso.com'\",\"displayName\":\"The email address to send alerts. For multiple emails, format in the following 'email1@contoso.com;email2@contoso.com'\"},\"type\":\"String\"},\"vulnerabilityAssessmentsStorageID\":{\"metadata\":{\"description\":\"The storage account ID to store assessments\",\"displayName\":\"The storage account ID to store assessments\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Sql/servers/databases\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"sqlServerDataBaseName\":{\"value\":\"[field('name')]\"},\"sqlServerName\":{\"value\":\"[first(split(field('fullname'),'/'))]\"},\"vulnerabilityAssessmentsEmail\":{\"value\":\"[parameters('vulnerabilityAssessmentsEmail')]\"},\"vulnerabilityAssessmentsStorageID\":{\"value\":\"[parameters('vulnerabilityAssessmentsStorageID')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"sqlServerDataBaseName\":{\"type\":\"String\"},\"sqlServerName\":{\"type\":\"String\"},\"vulnerabilityAssessmentsEmail\":{\"type\":\"String\"},\"vulnerabilityAssessmentsStorageID\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-03-01-preview\",\"name\":\"[concat(parameters('sqlServerName'),'/',parameters('sqlServerDataBaseName'),'/default')]\",\"properties\":{\"recurringScans\":{\"emailSubscriptionAdmins\":false,\"emails\":[\"[parameters('vulnerabilityAssessmentsEmail')]\"],\"isEnabled\":true},\"storageAccountAccessKey\":\"[listkeys(parameters('vulnerabilityAssessmentsStorageID'), providers('Microsoft.Storage', 'storageAccounts').apiVersions[0]).keys[0].value]\",\"storageContainerPath\":\"[concat('https://', last( split(parameters('vulnerabilityAssessmentsStorageID') ,  '/') ) , '.blob.core.windows.net/vulneraabilitylogs')]\"},\"type\":\"Microsoft.Sql/servers/databases/vulnerabilityAssessments\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"[parameters('vulnerabilityAssessmentsEmail')]\",\"field\":\"Microsoft.Sql/servers/databases/vulnerabilityAssessments/recurringScans.emails\"},{\"equals\":true,\"field\":\"Microsoft.Sql/servers/databases/vulnerabilityAssessments/recurringScans.isEnabled\"}]},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/056cd41c-7e88-42e1-933e-88ba6a50c9c3\",\"/providers/Microsoft.Authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/Microsoft.Authorization/roleDefinitions/17d1049b-9a84-46fb-8f53-869881c3d3ab\"],\"type\":\"Microsoft.Sql/servers/databases/vulnerabilityAssessments\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Sql-vulnerabilityAssessments_20230706\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Sql-vulnerabilityAssessments_20230706",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Deploy SQL Database Vulnerability Assessments when it does not exist in the deployment, and save results to the storage account specified in the parameters.",
              "display_name": "Deploy SQL Database Vulnerability Assessments",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"SQL\",\"replacesPolicy\":\"Deploy-Sql-vulnerabilityAssessments\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Deploy-Sql-vulnerabilityAssessments_20230706",
              "parameters": "{\"effect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"vulnerabilityAssessmentsEmail\":{\"metadata\":{\"description\":\"The email address(es) to send alerts.\",\"displayName\":\"The email address(es) to send alerts.\"},\"type\":\"Array\"},\"vulnerabilityAssessmentsStorageID\":{\"metadata\":{\"description\":\"The storage account ID to store assessments\",\"displayName\":\"The storage account ID to store assessments\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Sql/servers/databases\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"sqlServerDataBaseName\":{\"value\":\"[field('name')]\"},\"sqlServerName\":{\"value\":\"[first(split(field('fullname'),'/'))]\"},\"vulnerabilityAssessmentsEmail\":{\"value\":\"[parameters('vulnerabilityAssessmentsEmail')]\"},\"vulnerabilityAssessmentsStorageID\":{\"value\":\"[parameters('vulnerabilityAssessmentsStorageID')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"sqlServerDataBaseName\":{\"type\":\"String\"},\"sqlServerName\":{\"type\":\"String\"},\"vulnerabilityAssessmentsEmail\":{\"type\":\"Array\"},\"vulnerabilityAssessmentsStorageID\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-03-01-preview\",\"name\":\"[concat(parameters('sqlServerName'),'/',parameters('sqlServerDataBaseName'),'/default')]\",\"properties\":{\"recurringScans\":{\"emailSubscriptionAdmins\":false,\"emails\":\"[parameters('vulnerabilityAssessmentsEmail')]\",\"isEnabled\":true},\"storageAccountAccessKey\":\"[listkeys(parameters('vulnerabilityAssessmentsStorageID'), providers('Microsoft.Storage', 'storageAccounts').apiVersions[0]).keys[0].value]\",\"storageContainerPath\":\"[concat('https://', last( split(parameters('vulnerabilityAssessmentsStorageID') ,  '/') ) , '.blob.core.windows.net/vulneraabilitylogs')]\"},\"type\":\"Microsoft.Sql/servers/databases/vulnerabilityAssessments\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"count\":{\"field\":\"Microsoft.Sql/servers/databases/vulnerabilityAssessments/recurringScans.emails[*]\",\"where\":{\"notIn\":\"[parameters('vulnerabilityAssessmentsEmail')]\",\"value\":\"current(Microsoft.Sql/servers/databases/vulnerabilityAssessments/recurringScans.emails[*])\"}},\"greater\":0},{\"equals\":true,\"field\":\"Microsoft.Sql/servers/databases/vulnerabilityAssessments/recurringScans.isEnabled\"}]},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/056cd41c-7e88-42e1-933e-88ba6a50c9c3\",\"/providers/Microsoft.Authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/Microsoft.Authorization/roleDefinitions/17d1049b-9a84-46fb-8f53-869881c3d3ab\"],\"type\":\"Microsoft.Sql/servers/databases/vulnerabilityAssessments\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-SqlMi-minTLS\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-SqlMi-minTLS",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Deploy a specific min TLS version requirement and enforce SSL on SQL managed instances. Enables secure server to client by enforce  minimal Tls Version to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.",
              "display_name": "SQL managed instances deploy a specific min TLS version requirement.",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"SQL\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.2.0\"}",
              "mode": "Indexed",
              "name": "Deploy-SqlMi-minTLS",
              "parameters": "{\"effect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy minimum TLS version SQL servers\",\"displayName\":\"Effect SQL servers\"},\"type\":\"String\"},\"minimalTlsVersion\":{\"allowedValues\":[\"1.2\",\"1.1\",\"1.0\"],\"defaultValue\":\"1.2\",\"metadata\":{\"description\":\"Select version minimum TLS version SQL servers to enforce\",\"displayName\":\"Select version for SQL server\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Sql/managedInstances\",\"field\":\"type\"},{\"field\":\"Microsoft.Sql/managedInstances/minimalTlsVersion\",\"notequals\":\"[parameters('minimalTlsVersion')]\"}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"minimalTlsVersion\":{\"value\":\"[parameters('minimalTlsVersion')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"minimalTlsVersion\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2020-02-02-preview\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'))]\",\"properties\":{\"minimalTlsVersion\":\"[parameters('minimalTlsVersion')]\"},\"type\":\"Microsoft.Sql/managedInstances\"}],\"variables\":{}}}},\"evaluationDelay\":\"AfterProvisioningSuccess\",\"existenceCondition\":{\"allOf\":[{\"equals\":\"[parameters('minimalTlsVersion')]\",\"field\":\"Microsoft.Sql/managedInstances/minimalTlsVersion\"}]},\"name\":\"current\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/4939a1f6-9ae0-4e48-a1e0-f2cbe897382d\"],\"type\":\"Microsoft.Sql/managedInstances\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Storage-sslEnforcement\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Storage-sslEnforcement",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Deploy a specific min TLS version requirement and enforce SSL on Azure Storage. Enables secure server to client by enforce minimal Tls Version to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your Azure Storage.",
              "display_name": "Azure Storage deploy a specific min TLS version requirement and enforce SSL/HTTPS ",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Storage\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.2.0\"}",
              "mode": "Indexed",
              "name": "Deploy-Storage-sslEnforcement",
              "parameters": "{\"effect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy minimum TLS version Azure STorage\",\"displayName\":\"Effect Azure Storage\"},\"type\":\"String\"},\"minimumTlsVersion\":{\"allowedValues\":[\"TLS1_2\",\"TLS1_1\",\"TLS1_0\"],\"defaultValue\":\"TLS1_2\",\"metadata\":{\"description\":\"Select version minimum TLS version Azure STorage to enforce\",\"displayName\":\"Select TLS version for Azure Storage server\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Storage/storageAccounts\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.Storage/storageAccounts/supportsHttpsTrafficOnly\",\"notEquals\":\"true\"},{\"field\":\"Microsoft.Storage/storageAccounts/minimumTlsVersion\",\"notEquals\":\"[parameters('minimumTlsVersion')]\"}]}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"minimumTlsVersion\":{\"value\":\"[parameters('minimumTlsVersion')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"minimumTlsVersion\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2019-06-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'))]\",\"properties\":{\"minimumTlsVersion\":\"[parameters('minimumTlsVersion')]\",\"supportsHttpsTrafficOnly\":true},\"type\":\"Microsoft.Storage/storageAccounts\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Storage/storageAccounts/supportsHttpsTrafficOnly\"},{\"equals\":\"[parameters('minimumTlsVersion')]\",\"field\":\"Microsoft.Storage/storageAccounts/minimumTlsVersion\"}]},\"name\":\"current\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/17d1049b-9a84-46fb-8f53-869881c3d3ab\"],\"type\":\"Microsoft.Storage/storageAccounts\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-UserAssignedManagedIdentity-VMInsights\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-UserAssignedManagedIdentity-VMInsights",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Policy is deprecated as it's no longer required. User-Assigned Management Identity is now centralized and deployed by Azure Landing Zones to the Management Subscription.",
              "display_name": "[Deprecated]: Deploy User Assigned Managed Identity for VM Insights",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Managed Identity\",\"deprecated\":true,\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.0-deprecated\"}",
              "mode": "Indexed",
              "name": "Deploy-UserAssignedManagedIdentity-VMInsights",
              "parameters": "{\"bringYourOwnUserAssignedManagedIdentity\":{\"allowedValues\":[true,false],\"metadata\":{\"description\":\"Enable this to use your pre-created user-assigned managed identity. The pre-created identity MUST exist within the subscription otherwise the policy deployment will fail. If enabled, ensure that the User-Assigned Identity Name and Identity Resource Group Name parameters match the pre-created identity. If not enabled, the policy will create per subscription, per resource user-assigned managed identities in a new resource group named 'Built-In-Identity-RG'.\",\"displayName\":\"Bring Your Own User-Assigned Identity\"},\"type\":\"Boolean\"},\"builtInIdentityResourceGroupLocation\":{\"defaultValue\":\"eastus\",\"metadata\":{\"description\":\"The location of the resource group 'Built-In-Identity-RG' created by the policy. This parameter is only used when 'Bring Your Own User Assigned Identity' parameter is false.\",\"displayName\":\"Built-In-Identity-RG Location\"},\"type\":\"String\"},\"effect\":{\"allowedValues\":[\"AuditIfNotExists\",\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"The effect determines what happens when the policy rule is evaluated to match.\",\"displayName\":\"Policy Effect\"},\"type\":\"String\"},\"identityResourceGroup\":{\"defaultValue\":\"\",\"metadata\":{\"description\":\"The resource group in which the pre-created user-assigned managed identity resides.\",\"displayName\":\"User-Assigned Managed Identity Resource Group Name\"},\"type\":\"String\"},\"userAssignedIdentityName\":{\"defaultValue\":\"\",\"metadata\":{\"description\":\"The name of the pre-created user-assigned managed identity.\",\"displayName\":\"User-Assigned Managed Identity Name\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},{\"greaterOrEquals\":\"2018-10-01\",\"value\":\"[requestContext().apiVersion]\"}]},\"then\":{\"details\":{\"deployment\":{\"location\":\"eastus\",\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"bringYourOwnUserAssignedManagedIdentity\":{\"value\":\"[parameters('bringYourOwnUserAssignedManagedIdentity')]\"},\"builtInIdentityResourceGroupLocation\":{\"value\":\"[parameters('builtInIdentityResourceGroupLocation')]\"},\"identityResourceGroup\":{\"value\":\"[if(parameters('bringYourOwnUserAssignedManagedIdentity'), parameters('identityResourceGroup'), 'Built-In-Identity-RG')]\"},\"location\":{\"value\":\"[field('location')]\"},\"resourceId\":{\"value\":\"[field('id')]\"},\"uaName\":{\"value\":\"[if(parameters('bringYourOwnUserAssignedManagedIdentity'), parameters('userAssignedIdentityName'), 'Built-In-Identity')]\"},\"vmName\":{\"value\":\"[field('name')]\"},\"vmResourceGroup\":{\"value\":\"[resourceGroup().name]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json#\",\"contentVersion\":\"1.0.0.1\",\"parameters\":{\"bringYourOwnUserAssignedManagedIdentity\":{\"type\":\"bool\"},\"builtInIdentityResourceGroupLocation\":{\"type\":\"string\"},\"identityResourceGroup\":{\"type\":\"string\"},\"location\":{\"type\":\"string\"},\"resourceId\":{\"type\":\"string\"},\"uaName\":{\"type\":\"string\"},\"vmName\":{\"type\":\"string\"},\"vmResourceGroup\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-06-01\",\"location\":\"[parameters('builtInIdentityResourceGroupLocation')]\",\"name\":\"[parameters('identityResourceGroup')]\",\"type\":\"Microsoft.Resources/resourceGroups\"},{\"apiVersion\":\"2020-06-01\",\"condition\":\"[parameters('bringYourOwnUserAssignedManagedIdentity')]\",\"dependsOn\":[\"[resourceId('Microsoft.Resources/resourceGroups', parameters('identityResourceGroup'))]\"],\"name\":\"[variables('deployUALockName')]\",\"properties\":{\"expressionEvaluationOptions\":{\"scope\":\"inner\"},\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[parameters('location')]\"},\"uaName\":{\"value\":\"[parameters('uaName')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"uaName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2018-11-30\",\"location\":\"[parameters('location')]\",\"name\":\"[parameters('uaName')]\",\"type\":\"Microsoft.ManagedIdentity/userAssignedIdentities\"}],\"variables\":{}}},\"resourceGroup\":\"[parameters('identityResourceGroup')]\",\"type\":\"Microsoft.Resources/deployments\"},{\"apiVersion\":\"2020-06-01\",\"condition\":\"[not(parameters('bringYourOwnUserAssignedManagedIdentity'))]\",\"dependsOn\":[\"[resourceId('Microsoft.Resources/resourceGroups', parameters('identityResourceGroup'))]\"],\"name\":\"[variables('deployUAName')]\",\"properties\":{\"expressionEvaluationOptions\":{\"scope\":\"inner\"},\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[parameters('location')]\"},\"uaName\":{\"value\":\"[variables('uaNameWithLocation')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"uaName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2018-11-30\",\"location\":\"[parameters('location')]\",\"name\":\"[parameters('uaName')]\",\"type\":\"Microsoft.ManagedIdentity/userAssignedIdentities\"},{\"apiVersion\":\"2016-09-01\",\"dependsOn\":[\"[parameters('uaName')]\"],\"name\":\"[concat(parameters('uaName'), '/Microsoft.Authorization/', 'CanNotDeleteLock-', parameters('uaName'))]\",\"properties\":{\"level\":\"CanNotDelete\",\"notes\":\"Please do not delete this User-Assigned Identity since extensions enabled by Azure Policy are relying on their existence.\"},\"type\":\"Microsoft.ManagedIdentity/userAssignedIdentities/providers/locks\"}],\"variables\":{}}},\"resourceGroup\":\"[parameters('identityResourceGroup')]\",\"type\":\"Microsoft.Resources/deployments\"},{\"apiVersion\":\"2020-06-01\",\"dependsOn\":[\"[resourceId('Microsoft.Resources/resourceGroups', parameters('identityResourceGroup'))]\",\"[variables('deployUAName')]\"],\"location\":\"[parameters('location')]\",\"name\":\"[variables('deployGetResourceProperties')]\",\"properties\":{\"mode\":\"Incremental\",\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{\"resource\":{\"type\":\"object\",\"value\":\"[reference(parameters('resourceId'), '2019-07-01', 'Full')]\"}},\"resources\":[]}},\"type\":\"Microsoft.Resources/deployments\"},{\"apiVersion\":\"2020-06-01\",\"dependsOn\":[\"[resourceId('Microsoft.Resources/resourceGroups', parameters('identityResourceGroup'))]\",\"[variables('deployUAName')]\",\"[variables('deployGetResourceProperties')]\"],\"name\":\"[concat(variables('deployAssignUAName'))]\",\"properties\":{\"expressionEvaluationOptions\":{\"scope\":\"inner\"},\"mode\":\"Incremental\",\"parameters\":{\"identityType\":{\"value\":\"[if(contains(reference(variables('deployGetResourceProperties')).outputs.resource.value, 'identity'), reference(variables('deployGetResourceProperties')).outputs.resource.value.identity.type, '')]\"},\"location\":{\"value\":\"[parameters('location')]\"},\"uaId\":{\"value\":\"[if(parameters('bringYourOwnUserAssignedManagedIdentity'), variables('precreatedUaId'), variables('autocreatedUaId'))]\"},\"userAssignedIdentities\":{\"value\":\"[if(and(contains(reference(variables('deployGetResourceProperties')).outputs.resource.value, 'identity'), contains(reference(variables('deployGetResourceProperties')).outputs.resource.value.identity, 'userAssignedIdentities')), reference(variables('deployGetResourceProperties')).outputs.resource.value.identity.userAssignedIdentities, createObject())]\"},\"vmName\":{\"value\":\"[parameters('vmName')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"identityType\":{\"type\":\"string\"},\"location\":{\"type\":\"string\"},\"uaId\":{\"type\":\"string\"},\"userAssignedIdentities\":{\"type\":\"object\"},\"vmName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2019-07-01\",\"condition\":\"[not(variables('resourceWithSingleUAI'))]\",\"identity\":{\"type\":\"[variables('identityTypeValue')]\",\"userAssignedIdentities\":\"[variables('userAssignedIdentitiesValue')]\"},\"location\":\"[parameters('location')]\",\"name\":\"[parameters('vmName')]\",\"type\":\"Microsoft.Compute/virtualMachines\"}],\"variables\":{\"identityTypeValue\":\"[if(contains(parameters('identityType'), 'SystemAssigned'), 'SystemAssigned,UserAssigned', 'UserAssigned')]\",\"resourceWithSingleUAI\":\"[and(equals(parameters('identityType'), 'UserAssigned'), equals(string(length(parameters('userAssignedIdentities'))), '1'))]\",\"userAssignedIdentitiesValue\":\"[union(parameters('userAssignedIdentities'), createObject(parameters('uaId'), createObject()))]\"}}},\"resourceGroup\":\"[parameters('vmResourceGroup')]\",\"type\":\"Microsoft.Resources/deployments\"}],\"variables\":{\"autocreatedUaId\":\"[concat('/subscriptions/', subscription().subscriptionId, '/resourceGroups/', trim(parameters('identityResourceGroup')), '/providers/Microsoft.ManagedIdentity/userAssignedIdentities/', trim(parameters('uaName')), '-', parameters('location'))]\",\"deployAssignUAName\":\"[concat('deployAssignUA-', uniqueString(deployment().name))]\",\"deployGetResourceProperties\":\"[concat('deployGetResourceProperties-', uniqueString(deployment().name))]\",\"deployUALockName\":\"[concat('deployUALock-', uniqueString(deployment().name))]\",\"deployUAName\":\"[concat('deployUA-', uniqueString(deployment().name))]\",\"precreatedUaId\":\"[concat('/subscriptions/', subscription().subscriptionId, '/resourceGroups/', trim(parameters('identityResourceGroup')), '/providers/Microsoft.ManagedIdentity/userAssignedIdentities/', trim(parameters('uaName')))]\",\"uaNameWithLocation\":\"[concat(parameters('uaName'),'-', parameters('location'))]\"}}}},\"deploymentScope\":\"subscription\",\"evaluationDelay\":\"AfterProvisioning\",\"existenceCondition\":{\"anyOf\":[{\"allOf\":[{\"contains\":\"UserAssigned\",\"field\":\"identity.type\"},{\"containsKey\":\"[if(parameters('bringYourOwnUserAssignedManagedIdentity'), concat('/subscriptions/', subscription().subscriptionId, '/resourceGroups/', trim(parameters('identityResourceGroup')), '/providers/Microsoft.ManagedIdentity/userAssignedIdentities/', trim(parameters('userAssignedIdentityName'))), concat('/subscriptions/', subscription().subscriptionId, '/resourceGroups/Built-In-Identity-RG/providers/Microsoft.ManagedIdentity/userAssignedIdentities/Built-In-Identity-', field('location')))]\",\"field\":\"identity.userAssignedIdentities\"}]},{\"allOf\":[{\"equals\":\"UserAssigned\",\"field\":\"identity.type\"},{\"equals\":\"1\",\"value\":\"[string(length(field('identity.userAssignedIdentities')))]\"}]}]},\"name\":\"[field('name')]\",\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"],\"type\":\"Microsoft.Compute/virtualMachines\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-VNET-HubSpoke\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-VNET-HubSpoke",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "This policy deploys virtual network and peer to the hub",
              "display_name": "Deploy Virtual Network with peering to the hub",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Network\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.1.0\"}",
              "mode": "All",
              "name": "Deploy-VNET-HubSpoke",
              "parameters": "{\"dnsServers\":{\"defaultValue\":[],\"metadata\":{\"description\":\"Default domain servers for the vNET.\",\"displayName\":\"DNSServers\"},\"type\":\"Array\"},\"hubResourceId\":{\"metadata\":{\"description\":\"Resource ID for the HUB vNet\",\"displayName\":\"hubResourceId\"},\"type\":\"String\"},\"vNetCidrRange\":{\"metadata\":{\"description\":\"CIDR Range for the vNet\",\"displayName\":\"vNetCidrRange\"},\"type\":\"String\"},\"vNetLocation\":{\"metadata\":{\"description\":\"Location for the vNet\",\"displayName\":\"vNetLocation\"},\"type\":\"String\"},\"vNetName\":{\"metadata\":{\"description\":\"Name of the landing zone vNet\",\"displayName\":\"vNetName\"},\"type\":\"String\"},\"vNetPeerUseRemoteGateway\":{\"defaultValue\":false,\"metadata\":{\"description\":\"Enable gateway transit for the LZ network\",\"displayName\":\"vNetPeerUseRemoteGateway\"},\"type\":\"Boolean\"},\"vNetRgName\":{\"metadata\":{\"description\":\"Name of the landing zone vNet RG\",\"displayName\":\"vNetRgName\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Resources/subscriptions\",\"field\":\"type\"}]},\"then\":{\"details\":{\"ResourceGroupName\":\"[parameters('vNetRgName')]\",\"deployment\":{\"location\":\"northeurope\",\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"dnsServers\":{\"value\":\"[parameters('dnsServers')]\"},\"hubResourceId\":{\"value\":\"[parameters('hubResourceId')]\"},\"vNetCidrRange\":{\"value\":\"[parameters('vNetCidrRange')]\"},\"vNetLocation\":{\"value\":\"[parameters('vNetLocation')]\"},\"vNetName\":{\"value\":\"[parameters('vNetName')]\"},\"vNetPeerUseRemoteGateway\":{\"value\":\"[parameters('vNetPeerUseRemoteGateway')]\"},\"vNetRgName\":{\"value\":\"[parameters('vNetRgName')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"dnsServers\":{\"defaultValue\":[],\"type\":\"Array\"},\"hubResourceId\":{\"type\":\"String\"},\"vNetCidrRange\":{\"type\":\"String\"},\"vNetLocation\":{\"type\":\"String\"},\"vNetName\":{\"type\":\"String\"},\"vNetPeerUseRemoteGateway\":{\"defaultValue\":false,\"type\":\"bool\"},\"vNetRgName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2021-04-01\",\"dependsOn\":[],\"location\":\"[parameters('vNetLocation')]\",\"name\":\"[concat('alz-vnet-rg-', parameters('vNetLocation'), '-', substring(uniqueString(subscription().id),0,6))]\",\"properties\":{\"mode\":\"Incremental\",\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{},\"resources\":[{\"apiVersion\":\"2021-04-01\",\"location\":\"[parameters('vNetLocation')]\",\"name\":\"[parameters('vNetRgName')]\",\"properties\":{},\"type\":\"Microsoft.Resources/resourceGroups\"}],\"variables\":{}}},\"type\":\"Microsoft.Resources/deployments\"},{\"apiVersion\":\"2021-04-01\",\"dependsOn\":[\"[concat('alz-vnet-rg-', parameters('vNetLocation'), '-', substring(uniqueString(subscription().id),0,6))]\"],\"name\":\"[concat('alz-vnet-', parameters('vNetLocation'), '-', substring(uniqueString(subscription().id),0,6))]\",\"properties\":{\"mode\":\"Incremental\",\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{},\"resources\":[{\"apiVersion\":\"2021-02-01\",\"dependsOn\":[],\"location\":\"[parameters('vNetLocation')]\",\"name\":\"[parameters('vNetName')]\",\"properties\":{\"addressSpace\":{\"addressPrefixes\":[\"[parameters('vNetCidrRange')]\"]},\"dhcpOptions\":{\"dnsServers\":\"[parameters('dnsServers')]\"}},\"type\":\"Microsoft.Network/virtualNetworks\"},{\"apiVersion\":\"2021-02-01\",\"dependsOn\":[\"[parameters('vNetName')]\"],\"name\":\"[concat(parameters('vNetName'), '/peerToHub')]\",\"properties\":{\"allowForwardedTraffic\":true,\"allowGatewayTransit\":false,\"allowVirtualNetworkAccess\":true,\"remoteVirtualNetwork\":{\"id\":\"[parameters('hubResourceId')]\"},\"useRemoteGateways\":\"[parameters('vNetPeerUseRemoteGateway')]\"},\"type\":\"Microsoft.Network/virtualNetworks/virtualNetworkPeerings\"},{\"apiVersion\":\"2021-04-01\",\"dependsOn\":[\"[parameters('vNetName')]\"],\"name\":\"[concat('alz-hub-peering-', parameters('vNetLocation'), '-', substring(uniqueString(subscription().id),0,6))]\",\"properties\":{\"expressionEvaluationOptions\":{\"scope\":\"inner\"},\"mode\":\"Incremental\",\"parameters\":{\"hubName\":{\"value\":\"[split(parameters('hubResourceId'),'/')[8]]\"},\"remoteVirtualNetwork\":{\"value\":\"[concat(subscription().id,'/resourceGroups/',parameters('vNetRgName'), '/providers/','Microsoft.Network/virtualNetworks/', parameters('vNetName'))]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"hubName\":{\"defaultValue\":false,\"type\":\"String\"},\"remoteVirtualNetwork\":{\"defaultValue\":false,\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2021-02-01\",\"name\":\"[[concat(parameters('hubName'),'/',last(split(parameters('remoteVirtualNetwork'),'/')))]\",\"properties\":{\"allowForwardedTraffic\":true,\"allowGatewayTransit\":true,\"allowVirtualNetworkAccess\":true,\"remoteVirtualNetwork\":{\"id\":\"[[parameters('remoteVirtualNetwork')]\"},\"useRemoteGateways\":false},\"type\":\"Microsoft.Network/virtualNetworks/virtualNetworkPeerings\"}],\"variables\":{}}},\"resourceGroup\":\"[split(parameters('hubResourceId'),'/')[4]]\",\"subscriptionId\":\"[split(parameters('hubResourceId'),'/')[2]]\",\"type\":\"Microsoft.Resources/deployments\"}],\"variables\":{}}},\"resourceGroup\":\"[parameters('vNetRgName')]\",\"type\":\"Microsoft.Resources/deployments\"}],\"variables\":{}}}},\"deploymentScope\":\"subscription\",\"existenceCondition\":{\"allOf\":[{\"field\":\"name\",\"like\":\"[parameters('vNetName')]\"},{\"equals\":\"[parameters('vNetLocation')]\",\"field\":\"location\"}]},\"existenceScope\":\"resourceGroup\",\"name\":\"[parameters('vNetName')]\",\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"],\"type\":\"Microsoft.Network/virtualNetworks\"},\"effect\":\"deployIfNotExists\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Vm-autoShutdown\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Vm-autoShutdown",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Deploys an auto shutdown schedule to a virtual machine",
              "display_name": "Deploy Virtual Machine Auto Shutdown Schedule",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Compute\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Deploy-Vm-autoShutdown",
              "parameters": "{\"EnableNotification\":{\"allowedValues\":[\"Disabled\",\"Enabled\"],\"defaultValue\":\"Disabled\",\"metadata\":{\"description\":\"If notifications are enabled for this schedule (i.e. Enabled, Disabled).\",\"displayName\":\"Send Notification before auto-shutdown\"},\"type\":\"string\"},\"NotificationEmailRecipient\":{\"defaultValue\":\"\",\"metadata\":{\"description\":\"Email address to be used for notification\",\"displayName\":\"Email Address\"},\"type\":\"string\"},\"NotificationWebhookUrl\":{\"defaultValue\":\"\",\"metadata\":{\"description\":\"A notification will be posted to the specified webhook endpoint when the auto-shutdown is about to happen.\",\"displayName\":\"Webhook URL\"},\"type\":\"string\"},\"time\":{\"defaultValue\":\"0000\",\"metadata\":{\"description\":\"Daily Scheduled shutdown time. i.e. 2300 = 11:00 PM\",\"displayName\":\"Scheduled Shutdown Time\"},\"type\":\"String\"},\"timeZoneId\":{\"defaultValue\":\"UTC\",\"metadata\":{\"description\":\"The time zone ID (e.g. Pacific Standard time).\",\"displayName\":\"Time zone\"},\"type\":\"string\"}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"EnableNotification\":{\"value\":\"[parameters('EnableNotification')]\"},\"NotificationEmailRecipient\":{\"value\":\"[parameters('NotificationEmailRecipient')]\"},\"NotificationWebhookUrl\":{\"value\":\"[parameters('NotificationWebhookUrl')]\"},\"location\":{\"value\":\"[field('location')]\"},\"time\":{\"value\":\"[parameters('time')]\"},\"timeZoneId\":{\"value\":\"[parameters('timeZoneId')]\"},\"vmName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"EnableNotification\":{\"defaultValue\":\"\",\"metadata\":{\"description\":\"If notifications are enabled for this schedule (i.e. Enabled, Disabled).\"},\"type\":\"string\"},\"NotificationEmailRecipient\":{\"defaultValue\":\"\",\"metadata\":{\"description\":\"Email address to be used for notification\"},\"type\":\"string\"},\"NotificationWebhookUrl\":{\"defaultValue\":\"\",\"metadata\":{\"description\":\"A notification will be posted to the specified webhook endpoint when the auto-shutdown is about to happen.\"},\"type\":\"string\"},\"location\":{\"type\":\"string\"},\"time\":{\"defaultValue\":\"\",\"metadata\":{\"description\":\"Daily Scheduled shutdown time. i.e. 2300 = 11:00 PM\"},\"type\":\"string\"},\"timeZoneId\":{\"defaultValue\":\"\",\"metadata\":{\"description\":\"The time zone ID (e.g. Pacific Standard time).\"},\"type\":\"string\"},\"vmName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2018-09-15\",\"location\":\"[parameters('location')]\",\"name\":\"[concat('shutdown-computevm-',parameters('vmName'))]\",\"properties\":{\"dailyRecurrence\":{\"time\":\"[parameters('time')]\"},\"notificationSettings\":{\"emailRecipient\":\"[parameters('NotificationEmailRecipient')]\",\"notificationLocale\":\"en\",\"status\":\"[parameters('EnableNotification')]\",\"timeInMinutes\":30,\"webhookUrl\":\"[parameters('NotificationWebhookUrl')]\"},\"status\":\"Enabled\",\"targetResourceId\":\"[resourceId('Microsoft.Compute/virtualMachines', parameters('vmName'))]\",\"taskType\":\"ComputeVmShutdownTask\",\"timeZoneId\":\"[parameters('timeZoneId')]\"},\"type\":\"Microsoft.DevTestLab/schedules\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"ComputeVmShutdownTask\",\"field\":\"Microsoft.DevTestLab/schedules/taskType\"},{\"equals\":\"[concat(resourceGroup().id,'/providers/Microsoft.Compute/virtualMachines/',field('name'))]\",\"field\":\"Microsoft.DevTestLab/schedules/targetResourceId\"}]},\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c\"],\"type\":\"Microsoft.DevTestLab/schedules\"},\"effect\":\"deployIfNotExists\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Windows-DomainJoin\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Windows-DomainJoin",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Deploy Windows Domain Join Extension with keyvault configuration when the extension does not exist on a given windows Virtual Machine",
              "display_name": "Deploy Windows Domain Join Extension with keyvault configuration",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Guest Configuration\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Deploy-Windows-DomainJoin",
              "parameters": "{\"domainFQDN\":{\"metadata\":{\"displayName\":\"domainFQDN\"},\"type\":\"String\"},\"domainOUPath\":{\"metadata\":{\"displayName\":\"domainOUPath\"},\"type\":\"String\"},\"domainPassword\":{\"metadata\":{\"displayName\":\"domainPassword\"},\"type\":\"String\"},\"domainUsername\":{\"metadata\":{\"displayName\":\"domainUsername\"},\"type\":\"String\"},\"effect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"keyVaultResourceId\":{\"metadata\":{\"displayName\":\"keyVaultResourceId\"},\"type\":\"String\"}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServer\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"2008-R2-SP1\",\"2008-R2-SP1-smalldisk\",\"2008-R2-SP1-zhcn\",\"2012-Datacenter\",\"2012-datacenter-gensecond\",\"2012-Datacenter-smalldisk\",\"2012-datacenter-smalldisk-g2\",\"2012-Datacenter-zhcn\",\"2012-datacenter-zhcn-g2\",\"2012-R2-Datacenter\",\"2012-r2-datacenter-gensecond\",\"2012-R2-Datacenter-smalldisk\",\"2012-r2-datacenter-smalldisk-g2\",\"2012-R2-Datacenter-zhcn\",\"2012-r2-datacenter-zhcn-g2\",\"2016-Datacenter\",\"2016-datacenter-gensecond\",\"2016-datacenter-gs\",\"2016-Datacenter-Server-Core\",\"2016-datacenter-server-core-g2\",\"2016-Datacenter-Server-Core-smalldisk\",\"2016-datacenter-server-core-smalldisk-g2\",\"2016-Datacenter-smalldisk\",\"2016-datacenter-smalldisk-g2\",\"2016-Datacenter-with-Containers\",\"2016-datacenter-with-containers-g2\",\"2016-Datacenter-with-RDSH\",\"2016-Datacenter-zhcn\",\"2016-datacenter-zhcn-g2\",\"2019-Datacenter\",\"2019-Datacenter-Core\",\"2019-datacenter-core-g2\",\"2019-Datacenter-Core-smalldisk\",\"2019-datacenter-core-smalldisk-g2\",\"2019-Datacenter-Core-with-Containers\",\"2019-datacenter-core-with-containers-g2\",\"2019-Datacenter-Core-with-Containers-smalldisk\",\"2019-datacenter-core-with-containers-smalldisk-g2\",\"2019-datacenter-gensecond\",\"2019-datacenter-gs\",\"2019-Datacenter-smalldisk\",\"2019-datacenter-smalldisk-g2\",\"2019-Datacenter-with-Containers\",\"2019-datacenter-with-containers-g2\",\"2019-Datacenter-with-Containers-smalldisk\",\"2019-datacenter-with-containers-smalldisk-g2\",\"2019-Datacenter-zhcn\",\"2019-datacenter-zhcn-g2\",\"Datacenter-Core-1803-with-Containers-smalldisk\",\"datacenter-core-1803-with-containers-smalldisk-g2\",\"Datacenter-Core-1809-with-Containers-smalldisk\",\"datacenter-core-1809-with-containers-smalldisk-g2\",\"Datacenter-Core-1903-with-Containers-smalldisk\",\"datacenter-core-1903-with-containers-smalldisk-g2\",\"datacenter-core-1909-with-containers-smalldisk\",\"datacenter-core-1909-with-containers-smalldisk-g1\",\"datacenter-core-1909-with-containers-smalldisk-g2\"]}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"domainFQDN\":{\"value\":\"[parameters('domainFQDN')]\"},\"domainOUPath\":{\"value\":\"[parameters('domainOUPath')]\"},\"domainPassword\":{\"reference\":{\"keyVault\":{\"id\":\"[parameters('keyVaultResourceId')]\"},\"secretName\":\"[parameters('domainPassword')]\"}},\"domainUsername\":{\"reference\":{\"keyVault\":{\"id\":\"[parameters('keyVaultResourceId')]\"},\"secretName\":\"[parameters('domainUsername')]\"}},\"keyVaultResourceId\":{\"value\":\"[parameters('keyVaultResourceId')]\"},\"location\":{\"value\":\"[field('location')]\"},\"vmName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"domainFQDN\":{\"type\":\"String\"},\"domainOUPath\":{\"type\":\"String\"},\"domainPassword\":{\"type\":\"securestring\"},\"domainUsername\":{\"type\":\"String\"},\"keyVaultResourceId\":{\"type\":\"String\"},\"location\":{\"type\":\"String\"},\"vmName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2015-06-15\",\"location\":\"[resourceGroup().location]\",\"name\":\"[concat(variables('vmName'),'/joindomain')]\",\"properties\":{\"autoUpgradeMinorVersion\":true,\"protectedSettings\":{\"Password\":\"[parameters('domainPassword')]\"},\"publisher\":\"Microsoft.Compute\",\"settings\":{\"Name\":\"[parameters('domainFQDN')]\",\"OUPath\":\"[parameters('domainOUPath')]\",\"Options\":\"[variables('domainJoinOptions')]\",\"Restart\":\"true\",\"User\":\"[parameters('domainUserName')]\"},\"type\":\"JsonADDomainExtension\",\"typeHandlerVersion\":\"1.3\"},\"type\":\"Microsoft.Compute/virtualMachines/extensions\"}],\"variables\":{\"domainJoinOptions\":3,\"vmName\":\"[parameters('vmName')]\"}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"JsonADDomainExtension\",\"field\":\"Microsoft.Compute/virtualMachines/extensions/type\"},{\"equals\":\"Microsoft.Compute\",\"field\":\"Microsoft.Compute/virtualMachines/extensions/publisher\"}]},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c\"],\"type\":\"Microsoft.Compute/virtualMachines/extensions\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Modify-NSG\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Modify-NSG",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "This policy enforces the configuration of Network Security Groups (NSG).",
              "display_name": "Enforce specific configuration of Network Security Groups (NSG)",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Network\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.0\"}",
              "mode": "All",
              "name": "Modify-NSG",
              "parameters": "{\"effect\":{\"allowedValues\":[\"Modify\",\"Disabled\"],\"defaultValue\":\"Modify\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"nsgRuleAccess\":{\"allowedValues\":[\"Allow\",\"Deny\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"nsgRuleDescription\":{\"defaultValue\":\"Deny any outbound traffic to the Internet\",\"type\":\"string\"},\"nsgRuleDestinationAddressPrefix\":{\"defaultValue\":\"Internet\",\"type\":\"string\"},\"nsgRuleDestinationPortRange\":{\"defaultValue\":\"*\",\"type\":\"string\"},\"nsgRuleDirection\":{\"allowedValues\":[\"Inbound\",\"Outbound\"],\"defaultValue\":\"Outbound\",\"type\":\"string\"},\"nsgRuleName\":{\"defaultValue\":\"DenyAnyInternetOutbound\",\"type\":\"string\"},\"nsgRulePriority\":{\"defaultValue\":1000,\"type\":\"integer\"},\"nsgRuleProtocol\":{\"defaultValue\":\"*\",\"type\":\"string\"},\"nsgRuleSourceAddressPrefix\":{\"defaultValue\":\"*\",\"type\":\"string\"},\"nsgRuleSourcePortRange\":{\"defaultValue\":\"*\",\"type\":\"string\"}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/networkSecurityGroups\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/networkSecurityGroups/securityRules[*]\"},\"equals\":0}]},\"then\":{\"details\":{\"conflictEffect\":\"audit\",\"operations\":[{\"field\":\"Microsoft.Network/networkSecurityGroups/securityRules[*]\",\"operation\":\"add\",\"value\":{\"name\":\"[parameters('nsgRuleName')]\",\"properties\":{\"access\":\"[parameters('nsgRuleAccess')]\",\"description\":\"[parameters('nsgRuleDescription')]\",\"destinationAddressPrefix\":\"[parameters('nsgRuleDestinationAddressPrefix')]\",\"destinationPortRange\":\"[parameters('nsgRuleDestinationPortRange')]\",\"direction\":\"[parameters('nsgRuleDirection')]\",\"priority\":\"[parameters('nsgRulePriority')]\",\"protocol\":\"[parameters('nsgRuleProtocol')]\",\"sourceAddressPrefix\":\"[parameters('nsgRuleSourceAddressPrefix')]\",\"sourcePortRange\":\"[parameters('nsgRuleSourcePortRange')]\"}}}],\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"]},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Modify-UDR\"]",
            "mode": "managed",
            "type": "azurerm_policy_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Modify-UDR",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "This policy enforces the configuration of User-Defined Routes (UDR) within a subnet.",
              "display_name": "Enforce specific configuration of User-Defined Routes (UDR)",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Network\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.0\"}",
              "mode": "All",
              "name": "Modify-UDR",
              "parameters": "{\"addressPrefix\":{\"metadata\":{\"description\":\"The destination IP address range in CIDR notation that this Policy checks for within the UDR. Example: 0.0.0.0/0 to check for the presence of a default route.\",\"displayName\":\"Address Prefix\"},\"type\":\"string\"},\"effect\":{\"allowedValues\":[\"Modify\",\"Disabled\"],\"defaultValue\":\"Modify\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"nextHopIpAddress\":{\"metadata\":{\"description\":\"The IP address packets should be forwarded to.\",\"displayName\":\"Next Hop IP Address\"},\"type\":\"string\"},\"nextHopType\":{\"allowedValues\":[\"VnetLocal\",\"VirtualNetworkGateway\",\"Internet\",\"VirtualAppliance\",\"None\"],\"metadata\":{\"description\":\"The next hope type that the policy checks for within the inspected route. The value can be Virtual Network, Virtual Network Gateway, Internet, Virtual Appliance, or None.\",\"displayName\":\"Next Hop Type\"},\"type\":\"string\"}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/routeTables\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/routeTables/routes[*]\"},\"equals\":0}]},\"then\":{\"details\":{\"conflictEffect\":\"audit\",\"operations\":[{\"field\":\"Microsoft.Network/routeTables/routes[*]\",\"operation\":\"add\",\"value\":{\"name\":\"default\",\"properties\":{\"addressPrefix\":\"[parameters('addressPrefix')]\",\"nextHopIpAddress\":\"[parameters('nextHopIpAddress')]\",\"nextHopType\":\"[parameters('nextHopType')]\"}}}],\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"]},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "role_definition_ids": []
            }
          },
          {
            "address": "module.test_core.azurerm_policy_set_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Audit-TrustedLaunch\"]",
            "mode": "managed",
            "type": "azurerm_policy_set_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Audit-TrustedLaunch",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Trusted Launch improves security of a Virtual Machine which requires VM SKU, OS Disk & OS Image to support it (Gen 2). To learn more about Trusted Launch, visit https://aka.ms/trustedlaunch.",
              "display_name": "Audit virtual machines for Trusted Launch support",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Trusted Launch\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.0\"}",
              "name": "Audit-TrustedLaunch",
              "parameters": "{\"effect\":{\"allowedValues\":[\"Audit\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"}}",
              "policy_definition_group": [],
              "policy_definition_reference": [
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/b03bb370-5249-4ea4-9fce-2552e87e45fa",
                  "policy_group_names": null,
                  "reference_id": "AuditDisksOsTrustedLaunch"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/c95b54ad-0614-4633-ab29-104b01235cbf",
                  "policy_group_names": null,
                  "reference_id": "AuditTrustedLaunchEnabled"
                }
              ],
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "policy_definition_group": [],
              "policy_definition_reference": [
                {},
                {}
              ]
            }
          },
          {
            "address": "module.test_core.azurerm_policy_set_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Audit-UnusedResourcesCostOptimization\"]",
            "mode": "managed",
            "type": "azurerm_policy_set_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Audit-UnusedResourcesCostOptimization",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Optimize cost by detecting unused but chargeable resources. Leverage this Azure Policy Initiative as a cost control tool to reveal orphaned resources that are contributing cost.",
              "display_name": "Unused resources driving cost should be avoided",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Cost Optimization\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"2.0.0\"}",
              "name": "Audit-UnusedResourcesCostOptimization",
              "parameters": "{\"effectDisks\":{\"allowedValues\":[\"Audit\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy for Microsoft.Compute/disks\",\"displayName\":\"Disks Effect\"},\"type\":\"String\"},\"effectPublicIpAddresses\":{\"allowedValues\":[\"Audit\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy for Microsoft.Network/publicIpAddresses\",\"displayName\":\"PublicIpAddresses Effect\"},\"type\":\"String\"},\"effectServerFarms\":{\"allowedValues\":[\"Audit\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy for Microsoft.Web/serverfarms\",\"displayName\":\"ServerFarms Effect\"},\"type\":\"String\"}}",
              "policy_definition_group": [],
              "policy_definition_reference": [
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('effectDisks')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Audit-Disks-UnusedResourcesCostOptimization",
                  "policy_group_names": null,
                  "reference_id": "AuditDisksUnusedResourcesCostOptimization"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('effectPublicIpAddresses')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Audit-PublicIpAddresses-UnusedResourcesCostOptimization",
                  "policy_group_names": null,
                  "reference_id": "AuditPublicIpAddressesUnusedResourcesCostOptimization"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('effectServerFarms')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Audit-ServerFarms-UnusedResourcesCostOptimization",
                  "policy_group_names": null,
                  "reference_id": "AuditServerFarmsUnusedResourcesCostOptimization"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"Audit\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Audit-AzureHybridBenefit",
                  "policy_group_names": null,
                  "reference_id": "AuditAzureHybridBenefitUnusedResourcesCostOptimization"
                }
              ],
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "policy_definition_group": [],
              "policy_definition_reference": [
                {},
                {},
                {},
                {}
              ]
            }
          },
          {
            "address": "module.test_core.azurerm_policy_set_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Deny-PublicPaaSEndpoints\"]",
            "mode": "managed",
            "type": "azurerm_policy_set_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Deny-PublicPaaSEndpoints",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "This policy initiative is a group of policies that prevents creation of Azure PaaS services with exposed public endpoints",
              "display_name": "Public network access should be disabled for PaaS services",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\"],\"category\":\"Network\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"5.1.0\"}",
              "name": "Deny-PublicPaaSEndpoints",
              "parameters": "{\"ACRPublicIpDenyEffect\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"This policy denies the creation of Azure Container Registries with exposed public endpoints \",\"displayName\":\"Public network access on Azure Container Registry disabled\"},\"type\":\"String\"},\"AFSPublicIpDenyEffect\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"This policy denies the creation of Azure File Sync instances with exposed public endpoints \",\"displayName\":\"Public network access on Azure File Sync disabled\"},\"type\":\"String\"},\"AKSPublicIpDenyEffect\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"This policy denies  the creation of  Azure Kubernetes Service non-private clusters\",\"displayName\":\"Public network access on AKS API should be disabled\"},\"type\":\"String\"},\"ApiManPublicIpDenyEffect\":{\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"This policy denies creation of API Management services with exposed public endpoints\",\"displayName\":\"Public network access should be disabled for API Management services\"},\"type\":\"String\"},\"AppConfigPublicIpDenyEffect\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"This policy denies creation of App Configuration with exposed public endpoints\",\"displayName\":\"Public network access should be disabled for App Configuration\"},\"type\":\"String\"},\"AsPublicIpDenyEffect\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"This policy denies creation of App Service apps with exposed public endpoints\",\"displayName\":\"Public network access should be disabled for App Service apps\"},\"type\":\"String\"},\"AsePublicIpDenyEffect\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"This policy denies creation of App Service Environment apps with exposed public endpoints\",\"displayName\":\"Public network access should be disabled for App Service Environment apps\"},\"type\":\"String\"},\"AsrVaultDenyEffect\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"This policy denies creation of Azure Recovery Services vaults with exposed public endpoints\",\"displayName\":\"Azure Recovery Services vaults should disable public network access\"},\"type\":\"String\"},\"AutomationPublicIpDenyEffect\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"This policy denies creation of Automation accounts with exposed public endpoints. Bots should be set to 'isolated only' mode\",\"displayName\":\"Public network access should be disabled for Automation accounts\"},\"type\":\"String\"},\"BatchPublicIpDenyEffect\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"This policy denies creation of Azure Batch Instances with exposed public endpoints\",\"displayName\":\"Public network access should be disabled for Azure Batch Instances\"},\"type\":\"String\"},\"BotServicePublicIpDenyEffect\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"This policy denies creation of Bot Service with exposed public endpoints. Bots should be set to 'isolated only' mode\",\"displayName\":\"Public network access should be disabled for Bot Service\"},\"type\":\"String\"},\"ContainerAppsEnvironmentDenyEffect\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"This policy denies creation of Container Apps Environment with exposed public endpoints\",\"displayName\":\"Container Apps environment should disable public network access\"},\"type\":\"String\"},\"CosmosPublicIpDenyEffect\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"This policy denies that Cosmos database accounts  are created with out public network access is disabled.\",\"displayName\":\"Public network access should be disabled for CosmosDB\"},\"type\":\"String\"},\"FunctionAppSlotPublicIpDenyEffect\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"This policy denies creation of Function apps with exposed public endpoints\",\"displayName\":\"Public network access should be disabled for Function apps\"},\"type\":\"String\"},\"FunctionPublicIpDenyEffect\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"This policy denies creation of Function apps with exposed public endpoints\",\"displayName\":\"Public network access should be disabled for Function apps\"},\"type\":\"String\"},\"KeyVaultPublicIpDenyEffect\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"This policy denies creation of Key Vaults with IP Firewall exposed to all public endpoints\",\"displayName\":\"Public network access should be disabled for KeyVault\"},\"type\":\"String\"},\"MariaDbPublicIpDenyEffect\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"This policy denies creation of Azure MariaDB with exposed public endpoints\",\"displayName\":\"Public network access should be disabled for Azure MariaDB\"},\"type\":\"String\"},\"MlPublicIpDenyEffect\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"This policy denies creation of Azure Machine Learning with exposed public endpoints\",\"displayName\":\"Public network access should be disabled for Azure Machine Learning\"},\"type\":\"String\"},\"MySQLFlexPublicIpDenyEffect\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"This policy denies creation of MySql Flexible Server DB accounts with exposed public endpoints\",\"displayName\":\"Public network access should be disabled for MySQL Flexible Server\"},\"type\":\"String\"},\"PostgreSQLFlexPublicIpDenyEffect\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"This policy denies creation of PostgreSQL Flexible DB accounts with exposed public endpoints\",\"displayName\":\"Public network access should be disabled for PostgreSql Flexible Server\"},\"type\":\"String\"},\"RedisCachePublicIpDenyEffect\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"This policy denies creation of Azure Cache for Redis with exposed public endpoints\",\"displayName\":\"Public network access should be disabled for Azure Cache for Redis\"},\"type\":\"String\"},\"SqlServerPublicIpDenyEffect\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"This policy denies creation of Sql servers with exposed public endpoints\",\"displayName\":\"Public network access on Azure SQL Database should be disabled\"},\"type\":\"String\"},\"StoragePublicIpDenyEffect\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"This policy denies creation of storage accounts with IP Firewall exposed to all public endpoints\",\"displayName\":\"Public network access onStorage accounts should be disabled\"},\"type\":\"String\"},\"adfPublicNetworkAccess\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"adxPublicNetworkAccess\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"appSlotsPublicNetworkAccess\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"avdHostPoolPublicNetworkAccess\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"avdWorkspacePublicNetworkAccess\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"cognitiveSearchPublicNetworkAccess\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"cognitiveServicesNetworkAccess\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"cognitiveServicesPublicNetworkAccess\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"containerAppsPublicNetworkAccess\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"eventGridPublicNetworkAccess\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"eventGridTopicPublicNetworkAccess\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"eventHubNamespacesPublicNetworkAccess\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"grafanaPublicNetworkAccess\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"keyVaultManagedHsmDisablePublicNetwork\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"logicAppPublicNetworkAccessEffect\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"String\"},\"managedDiskPublicNetworkAccess\":{\"allowedValues\":[\"Audit\",\"Disabled\"],\"defaultValue\":\"Audit\",\"type\":\"string\"},\"mySqlPublicNetworkAccess\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"postgreSqlPublicNetworkAccess\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"This policy denies creation of PostgreSQL DB accounts with exposed public endpoints\",\"displayName\":\"Public network access should be disabled for PostgreSQL servers\"},\"type\":\"string\"},\"serviceBusDisablePublicNetworkAccess\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"sqlManagedPublicNetworkAccess\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"storageAccountsPublicAccess\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"synapsePublicNetworkAccess\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"}}",
              "policy_definition_group": [],
              "policy_definition_reference": [
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('CosmosPublicIpDenyEffect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/797b37f7-06b8-444c-b1ad-fc62867f335a",
                  "policy_group_names": null,
                  "reference_id": "CosmosDenyPaasPublicIP"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('KeyVaultPublicIpDenyEffect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/405c5871-3e91-4644-8a63-58e19d68ff5b",
                  "policy_group_names": null,
                  "reference_id": "KeyVaultDenyPaasPublicIP"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('SqlServerPublicIpDenyEffect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/1b8ca024-1d5c-4dec-8995-b1a932b41780",
                  "policy_group_names": null,
                  "reference_id": "SqlServerDenyPaasPublicIP"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('StoragePublicIpDenyEffect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/b2982f36-99f2-4db5-8eff-283140c09693",
                  "policy_group_names": null,
                  "reference_id": "StorageDenyPaasPublicIP"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('AKSPublicIpDenyEffect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/040732e8-d947-40b8-95d6-854c95024bf8",
                  "policy_group_names": null,
                  "reference_id": "AKSDenyPaasPublicIP"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('ACRPublicIpDenyEffect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/0fdf0491-d080-4575-b627-ad0e843cba0f",
                  "policy_group_names": null,
                  "reference_id": "ACRDenyPaasPublicIP"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('AFSPublicIpDenyEffect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/21a8cd35-125e-4d13-b82d-2e19b7208bb7",
                  "policy_group_names": null,
                  "reference_id": "AFSDenyPaasPublicIP"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('PostgreSQLFlexPublicIpDenyEffect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/5e1de0e3-42cb-4ebc-a86d-61d0c619ca48",
                  "policy_group_names": null,
                  "reference_id": "PostgreSQLFlexDenyPublicIP"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('postgreSqlPublicNetworkAccess')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/b52376f7-9612-48a1-81cd-1ffe4b61032c",
                  "policy_group_names": null,
                  "reference_id": "Deny-PostgreSql-Public-Network-Access"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('MySQLFlexPublicIpDenyEffect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/c9299215-ae47-4f50-9c54-8a392f68a052",
                  "policy_group_names": null,
                  "reference_id": "MySQLFlexDenyPublicIP"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('BatchPublicIpDenyEffect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/74c5a0ae-5e48-4738-b093-65e23a060488",
                  "policy_group_names": null,
                  "reference_id": "BatchDenyPublicIP"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('MariaDbPublicIpDenyEffect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/fdccbe47-f3e3-4213-ad5d-ea459b2fa077",
                  "policy_group_names": null,
                  "reference_id": "MariaDbDenyPublicIP"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('MlPublicIpDenyEffect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/438c38d2-3772-465a-a9cc-7a6666a275ce",
                  "policy_group_names": null,
                  "reference_id": "MlDenyPublicIP"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('RedisCachePublicIpDenyEffect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/470baccb-7e51-4549-8b1a-3e5be069f663",
                  "policy_group_names": null,
                  "reference_id": "RedisCacheDenyPublicIP"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('BotServicePublicIpDenyEffect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/5e8168db-69e3-4beb-9822-57cb59202a9d",
                  "policy_group_names": null,
                  "reference_id": "BotServiceDenyPublicIP"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('AutomationPublicIpDenyEffect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/955a914f-bf86-4f0e-acd5-e0766b0efcb6",
                  "policy_group_names": null,
                  "reference_id": "AutomationDenyPublicIP"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('AppConfigPublicIpDenyEffect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/3d9f5e4c-9947-4579-9539-2a7695fbc187",
                  "policy_group_names": null,
                  "reference_id": "AppConfigDenyPublicIP"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('FunctionPublicIpDenyEffect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/969ac98b-88a8-449f-883c-2e9adb123127",
                  "policy_group_names": null,
                  "reference_id": "FunctionDenyPublicIP"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('FunctionAppSlotPublicIpDenyEffect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/11c82d0c-db9f-4d7b-97c5-f3f9aa957da2",
                  "policy_group_names": null,
                  "reference_id": "FunctionAppSlotsDenyPublicIP"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('AsePublicIpDenyEffect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/2d048aca-6479-4923-88f5-e2ac295d9af3",
                  "policy_group_names": null,
                  "reference_id": "AseDenyPublicIP"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('AsPublicIpDenyEffect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/1b5ef780-c53c-4a64-87f3-bb9c8c8094ba",
                  "policy_group_names": null,
                  "reference_id": "AsDenyPublicIP"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('ApiManPublicIpDenyEffect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/df73bd95-24da-4a4f-96b9-4e8b94b402bd",
                  "policy_group_names": null,
                  "reference_id": "ApiManDenyPublicIP"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('ContainerAppsEnvironmentDenyEffect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/d074ddf8-01a5-4b5e-a2b8-964aed452c0a",
                  "policy_group_names": null,
                  "reference_id": "ContainerAppsEnvironmentDenyPublicIP"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('containerAppsPublicNetworkAccess')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/783ea2a8-b8fd-46be-896a-9ae79643a0b1",
                  "policy_group_names": null,
                  "reference_id": "Deny-ContainerApps-Public-Network-Access"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('AsrVaultDenyEffect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/9ebbbba3-4d65-4da9-bb67-b22cfaaff090",
                  "policy_group_names": null,
                  "reference_id": "AsrVaultDenyPublicIP"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('logicAppPublicNetworkAccessEffect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-LogicApp-Public-Network",
                  "policy_group_names": null,
                  "reference_id": "Deny-LogicApp-Public-Network-Access"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('appSlotsPublicNetworkAccess')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/701a595d-38fb-4a66-ae6d-fb3735217622",
                  "policy_group_names": null,
                  "reference_id": "Deny-AppSlots-Public"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('cognitiveSearchPublicNetworkAccess')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/ee980b6d-0eca-4501-8d54-f6290fd512c3",
                  "policy_group_names": null,
                  "reference_id": "Deny-CognitiveSearch-PublicEndpoint"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('managedDiskPublicNetworkAccess')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/8405fdab-1faf-48aa-b702-999c9c172094",
                  "policy_group_names": null,
                  "reference_id": "Deny-ManagedDisk-Public-Network-Access"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('adxPublicNetworkAccess')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/43bc7be6-5e69-4b0d-a2bb-e815557ca673",
                  "policy_group_names": null,
                  "reference_id": "Deny-ADX-Public-Network-Access"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('adfPublicNetworkAccess')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/1cf164be-6819-4a50-b8fa-4bcaa4f98fb6",
                  "policy_group_names": null,
                  "reference_id": "Deny-Adf-Public-Network-Access"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('eventGridPublicNetworkAccess')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/f8f774be-6aee-492a-9e29-486ef81f3a68",
                  "policy_group_names": null,
                  "reference_id": "Deny-EventGrid-Public-Network-Access"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('eventGridTopicPublicNetworkAccess')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/1adadefe-5f21-44f7-b931-a59b54ccdb45",
                  "policy_group_names": null,
                  "reference_id": "Deny-EventGrid-Topic-Public-Network-Access"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('eventHubNamespacesPublicNetworkAccess')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/0602787f-9896-402a-a6e1-39ee63ee435e",
                  "policy_group_names": null,
                  "reference_id": "Deny-EH-Public-Network-Access"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('keyVaultManagedHsmDisablePublicNetwork')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/19ea9d63-adee-4431-a95e-1913c6c1c75f",
                  "policy_group_names": null,
                  "reference_id": "Deny-KV-Hms-PublicNetwork"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('mySqlPublicNetworkAccess')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/d9844e8a-1437-4aeb-a32c-0c992f056095",
                  "policy_group_names": null,
                  "reference_id": "Deny-MySql-Public-Network-Access"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('cognitiveServicesPublicNetworkAccess')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/0725b4dd-7e76-479c-a735-68e7ee23d5ca",
                  "policy_group_names": null,
                  "reference_id": "Deny-Cognitive-Services-Public-Network-Access"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('cognitiveServicesNetworkAccess')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/037eea7a-bd0a-46c5-9a66-03aea78705d3",
                  "policy_group_names": null,
                  "reference_id": "Deny-Cognitive-Services-Network-Access"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('serviceBusDisablePublicNetworkAccess')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/cbd11fd3-3002-4907-b6c8-579f0e700e13",
                  "policy_group_names": null,
                  "reference_id": "Deny-Sb-PublicEndpoint"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('sqlManagedPublicNetworkAccess')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/9dfea752-dd46-4766-aed1-c355fa93fb91",
                  "policy_group_names": null,
                  "reference_id": "Deny-Sql-Managed-Public-Endpoint"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('storageAccountsPublicAccess')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/4fa4b6c0-31ca-4c0d-b10d-24b96f62a751",
                  "policy_group_names": null,
                  "reference_id": "Deny-Storage-Public-Access"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('synapsePublicNetworkAccess')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/38d8df46-cf4e-4073-8e03-48c24b29de0d",
                  "policy_group_names": null,
                  "reference_id": "Deny-Synapse-Public-Network-Access"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('avdWorkspacePublicNetworkAccess')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/87ac3038-c07a-4b92-860d-29e270a4f3cd",
                  "policy_group_names": null,
                  "reference_id": "Deny-Workspace-PublicNetworkAccess"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('avdHostPoolPublicNetworkAccess')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/c25dcf31-878f-4eba-98eb-0818fdc6a334",
                  "policy_group_names": null,
                  "reference_id": "Deny-Hostpool-PublicNetworkAccess"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('grafanaPublicNetworkAccess')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/e8775d5a-73b7-4977-a39b-833ef0114628",
                  "policy_group_names": null,
                  "reference_id": "Deny-Grafana-PublicNetworkAccess"
                }
              ],
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "policy_definition_group": [],
              "policy_definition_reference": [
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {}
              ]
            }
          },
          {
            "address": "module.test_core.azurerm_policy_set_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/DenyAction-DeleteProtection\"]",
            "mode": "managed",
            "type": "azurerm_policy_set_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/DenyAction-DeleteProtection",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Enforces DenyAction - Delete on Activity Log Settings and Diagnostic Settings.",
              "display_name": "DenyAction Delete - Activity Log Settings and Diagnostic Settings",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Monitoring\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.0\"}",
              "name": "DenyAction-DeleteProtection",
              "parameters": null,
              "policy_definition_group": [],
              "policy_definition_reference": [
                {
                  "parameter_values": "{}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/DenyAction-DiagnosticLogs",
                  "policy_group_names": null,
                  "reference_id": "DenyActionDelete-DiagnosticSettings"
                },
                {
                  "parameter_values": "{}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/DenyAction-ActivityLogs",
                  "policy_group_names": null,
                  "reference_id": "DenyActionDelete-ActivityLogSettings"
                }
              ],
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "policy_definition_group": [],
              "policy_definition_reference": [
                {},
                {}
              ]
            }
          },
          {
            "address": "module.test_core.azurerm_policy_set_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Deploy-AUM-CheckUpdates\"]",
            "mode": "managed",
            "type": "azurerm_policy_set_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Deploy-AUM-CheckUpdates",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Configure auto-assessment (every 24 hours) for OS updates. You can control the scope of assignment according to machine subscription, resource group, location or tag. Learn more about this for Windows: https://aka.ms/computevm-windowspatchassessmentmode, for Linux: https://aka.ms/computevm-linuxpatchassessmentmode.",
              "display_name": "Configure periodic checking for missing system updates on azure virtual machines and Arc-enabled virtual machines",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\"],\"category\":\"Security Center\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.0\"}",
              "name": "Deploy-AUM-CheckUpdates",
              "parameters": "{\"assessmentMode\":{\"allowedValues\":[\"ImageDefault\",\"AutomaticByPlatform\"],\"defaultValue\":\"AutomaticByPlatform\",\"metadata\":{\"description\":\"Assessment mode for the machines.\",\"displayName\":\"Assessment mode\"},\"type\":\"String\"},\"locations\":{\"defaultValue\":[],\"metadata\":{\"description\":\"The list of locations from which machines need to be targeted.\",\"displayName\":\"Machines locations\",\"strongType\":\"location\"},\"type\":\"Array\"},\"tagOperator\":{\"allowedValues\":[\"All\",\"Any\"],\"defaultValue\":\"Any\",\"metadata\":{\"description\":\"Matching condition for resource tags\",\"displayName\":\"Tag operator\"},\"type\":\"String\"},\"tagValues\":{\"defaultValue\":{},\"metadata\":{\"description\":\"The list of tags that need to matched for getting target machines.\",\"displayName\":\"Tags on machines\"},\"type\":\"Object\"}}",
              "policy_definition_group": [],
              "policy_definition_reference": [
                {
                  "parameter_values": "{\"assessmentMode\":{\"value\":\"[parameters('assessmentMode')]\"},\"locations\":{\"value\":\"[parameters('locations')]\"},\"osType\":{\"value\":\"Windows\"},\"tagOperator\":{\"value\":\"[parameters('tagOperator')]\"},\"tagValues\":{\"value\":\"[parameters('tagValues')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/59efceea-0c96-497e-a4a1-4eb2290dac15",
                  "policy_group_names": null,
                  "reference_id": "azureUpdateManagerVmCheckUpdateWindows"
                },
                {
                  "parameter_values": "{\"assessmentMode\":{\"value\":\"[parameters('assessmentMode')]\"},\"locations\":{\"value\":\"[parameters('locations')]\"},\"osType\":{\"value\":\"Linux\"},\"tagOperator\":{\"value\":\"[parameters('tagOperator')]\"},\"tagValues\":{\"value\":\"[parameters('tagValues')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/59efceea-0c96-497e-a4a1-4eb2290dac15",
                  "policy_group_names": null,
                  "reference_id": "azureUpdateManagerVmCheckUpdateLinux"
                },
                {
                  "parameter_values": "{\"assessmentMode\":{\"value\":\"[parameters('assessmentMode')]\"},\"locations\":{\"value\":\"[parameters('locations')]\"},\"osType\":{\"value\":\"Windows\"},\"tagOperator\":{\"value\":\"[parameters('tagOperator')]\"},\"tagValues\":{\"value\":\"[parameters('tagValues')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/bfea026e-043f-4ff4-9d1b-bf301ca7ff46",
                  "policy_group_names": null,
                  "reference_id": "azureUpdateManagerVmArcCheckUpdateWindows"
                },
                {
                  "parameter_values": "{\"assessmentMode\":{\"value\":\"[parameters('assessmentMode')]\"},\"locations\":{\"value\":\"[parameters('locations')]\"},\"osType\":{\"value\":\"Linux\"},\"tagOperator\":{\"value\":\"[parameters('tagOperator')]\"},\"tagValues\":{\"value\":\"[parameters('tagValues')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/bfea026e-043f-4ff4-9d1b-bf301ca7ff46",
                  "policy_group_names": null,
                  "reference_id": "azureUpdateManagerVmArcCheckUpdateLinux"
                }
              ],
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "policy_definition_group": [],
              "policy_definition_reference": [
                {},
                {},
                {},
                {}
              ]
            }
          },
          {
            "address": "module.test_core.azurerm_policy_set_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Deploy-Diagnostics-LogAnalytics\"]",
            "mode": "managed",
            "type": "azurerm_policy_set_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Deploy-Diagnostics-LogAnalytics",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "This policy set deploys the configurations of application Azure resources to forward diagnostic logs and metrics to an Azure Log Analytics workspace. This policy set is superseded by built-in initiative https://www.azadvertizer.net/azpolicyinitiativesadvertizer/0884adba-2312-4468-abeb-5422caed1038.html.",
              "display_name": "[Deprecated]: Deploy Diagnostic Settings to Azure Services",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\"],\"category\":\"Monitoring\",\"deprecated\":true,\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"2.2.0-deprecated\"}",
              "name": "Deploy-Diagnostics-LogAnalytics",
              "parameters": "{\"ACILogAnalyticsEffect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Container Instances to stream to a Log Analytics workspace when any ACR which is missing this diagnostic settings is created or updated. The Policy willset the diagnostic with all metrics enabled.\",\"displayName\":\"Deploy Diagnostic Settings for Container Instances to Log Analytics workspace\"},\"type\":\"String\"},\"ACRLogAnalyticsEffect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Container Registry to stream to a Log Analytics workspace when any ACR which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics  enabled.\",\"displayName\":\"Deploy Diagnostic Settings for Container Registry to Log Analytics workspace\"},\"type\":\"String\"},\"AKSLogAnalyticsEffect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Kubernetes Service to stream to a Log Analytics workspace when any Kubernetes Service which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled.\",\"displayName\":\"Deploy Diagnostic Settings for Kubernetes Service to Log Analytics workspace\"},\"type\":\"String\"},\"APIMgmtLogAnalyticsDestinationType\":{\"allowedValues\":[\"AzureDiagnostics\",\"Dedicated\"],\"defaultValue\":\"AzureDiagnostics\",\"metadata\":{\"description\":\"Destination table for the diagnostic setting for API Management to Log Analytics workspace, allowed values are 'Dedicated' (for resource-specific) and 'AzureDiagnostics'. Default value is 'AzureDiagnostics'\",\"displayName\":\"Destination table for the Diagnostic Setting for API Management to Log Analytics workspace\"},\"type\":\"String\"},\"APIMgmtLogAnalyticsEffect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for API Management to stream to a Log Analytics workspace when any API Management which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for API Management to Log Analytics workspace\"},\"type\":\"String\"},\"APIforFHIRLogAnalyticsEffect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Azure API for FHIR to stream to a Log Analytics workspace when any Azure API for FHIR which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Azure API for FHIR to Log Analytics workspace\"},\"type\":\"String\"},\"AVDScalingPlansLogAnalyticsEffect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for AVD Scaling Plans to stream to a Log Analytics workspace when any application groups which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for AVD Scaling Plans to Log Analytics workspace\"},\"type\":\"String\"},\"AnalysisServiceLogAnalyticsEffect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Analysis Services to stream to a Log Analytics workspace when any Analysis Services which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Analysis Services to Log Analytics workspace\"},\"type\":\"String\"},\"AppServiceLogAnalyticsEffect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for App Service Plan to stream to a Log Analytics workspace when any App Service Plan which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for App Service Plan to Log Analytics workspace\"},\"type\":\"String\"},\"AppServiceWebappLogAnalyticsEffect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Web App to stream to a Log Analytics workspace when any Web App which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for App Service to Log Analytics workspace\"},\"type\":\"String\"},\"ApplicationGatewayLogAnalyticsEffect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Application Gateway to stream to a Log Analytics workspace when any Application Gateway which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Application Gateway to Log Analytics workspace\"},\"type\":\"String\"},\"AutomationLogAnalyticsEffect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Automation to stream to a Log Analytics workspace when any Automation which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Automation to Log Analytics workspace\"},\"type\":\"String\"},\"BastionLogAnalyticsEffect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Azure Bastion to stream to a Log Analytics workspace when any Bastion which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Azure Bastion to Log Analytics workspace\"},\"type\":\"String\"},\"BatchLogAnalyticsEffect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Batch to stream to a Log Analytics workspace when any Batch which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Batch to Log Analytics workspace\"},\"type\":\"String\"},\"CDNEndpointsLogAnalyticsEffect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for CDN Endpoint to stream to a Log Analytics workspace when any CDN Endpoint which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for CDN Endpoint to Log Analytics workspace\"},\"type\":\"String\"},\"CognitiveServicesLogAnalyticsEffect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Cognitive Services to stream to a Log Analytics workspace when any Cognitive Services which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Cognitive Services to Log Analytics workspace\"},\"type\":\"String\"},\"CosmosLogAnalyticsEffect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Cosmos DB to stream to a Log Analytics workspace when any Cosmos DB which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Cosmos DB to Log Analytics workspace\"},\"type\":\"String\"},\"DataExplorerClusterLogAnalyticsEffect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Azure Data Explorer Cluster to stream to a Log Analytics workspace when any Azure Data Explorer Cluster which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Azure Data Explorer Cluster to Log Analytics workspace\"},\"type\":\"String\"},\"DataFactoryLogAnalyticsEffect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Data Factory to stream to a Log Analytics workspace when any Data Factory which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Data Factory to Log Analytics workspace\"},\"type\":\"String\"},\"DataLakeAnalyticsLogAnalyticsEffect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Data Lake Analytics to stream to a Log Analytics workspace when any Data Lake Analytics which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Data Lake Analytics to Log Analytics workspace\"},\"type\":\"String\"},\"DataLakeStoreLogAnalyticsEffect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Azure Data Lake Store to stream to a Log Analytics workspace when anyAzure Data Lake Store which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Azure Data Lake Store to Log Analytics workspace\"},\"type\":\"String\"},\"DatabricksLogAnalyticsEffect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Databricks to stream to a Log Analytics workspace when any Databricks which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Databricks to Log Analytics workspace\"},\"type\":\"String\"},\"EventGridSubLogAnalyticsEffect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Event Grid subscriptions to stream to a Log Analytics workspace when any Event Grid subscriptions which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Event Grid subscriptions to Log Analytics workspace\"},\"type\":\"String\"},\"EventGridTopicLogAnalyticsEffect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Event Grid Topic to stream to a Log Analytics workspace when any Event Grid Topic which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Event Grid Topic to Log Analytics workspace\"},\"type\":\"String\"},\"EventHubLogAnalyticsEffect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Event Hubs to stream to a Log Analytics workspace when any Event Hubs which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Event Hubs to Log Analytics workspace\"},\"type\":\"String\"},\"EventSystemTopicLogAnalyticsEffect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Event Grid System Topic to stream to a Log Analytics workspace when any Event Grid System Topic which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Event Grid System Topic to Log Analytics workspace\"},\"type\":\"String\"},\"ExpressRouteLogAnalyticsEffect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for ExpressRoute to stream to a Log Analytics workspace when any ExpressRoute which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for ExpressRoute to Log Analytics workspace\"},\"type\":\"String\"},\"FirewallLogAnalyticsDestinationType\":{\"allowedValues\":[\"AzureDiagnostics\",\"Dedicated\"],\"defaultValue\":\"AzureDiagnostics\",\"metadata\":{\"description\":\"Destination table for the diagnostic setting for Firewall to Log Analytics workspace, allowed values are 'Dedicated' (for resource-specific) and 'AzureDiagnostics'. Default value is 'AzureDiagnostics'\",\"displayName\":\"Destination table for the Diagnostic Setting for Firewall to Log Analytics workspace\"},\"type\":\"String\"},\"FirewallLogAnalyticsEffect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Firewall to stream to a Log Analytics workspace when any Firewall which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Firewall to Log Analytics workspace\"},\"type\":\"String\"},\"FrontDoorLogAnalyticsEffect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Front Door to stream to a Log Analytics workspace when any Front Door which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Front Door to Log Analytics workspace\"},\"type\":\"String\"},\"FunctionAppLogAnalyticsEffect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Azure Function App to stream to a Log Analytics workspace when any function app which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Azure Function App to Log Analytics workspace\"},\"type\":\"String\"},\"HDInsightLogAnalyticsEffect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for HDInsight to stream to a Log Analytics workspace when any HDInsight which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for HDInsight to Log Analytics workspace\"},\"type\":\"String\"},\"IotHubLogAnalyticsEffect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for IoT Hub to stream to a Log Analytics workspace when any IoT Hub which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for IoT Hub to Log Analytics workspace\"},\"type\":\"String\"},\"KeyVaultLogAnalyticsEffect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Key Vault to stream to a Log Analytics workspace when any Key Vault which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Key Vault to Log Analytics workspace\"},\"type\":\"String\"},\"LoadBalancerLogAnalyticsEffect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Load Balancer to stream to a Log Analytics workspace when any Load Balancer which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Load Balancer to Log Analytics workspace\"},\"type\":\"String\"},\"LogAnalyticsLogAnalyticsEffect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Log Analytics to stream to a Log Analytics workspace when any Log Analytics workspace which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category Audit enabled\",\"displayName\":\"Deploy Diagnostic Settings for Log Analytics to Log Analytics workspace\"},\"type\":\"String\"},\"LogicAppsISELogAnalyticsEffect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Logic Apps integration service environment to stream to a Log Analytics workspace when any Logic Apps integration service environment which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Logic Apps integration service environment to Log Analytics workspace\"},\"type\":\"String\"},\"LogicAppsWFLogAnalyticsEffect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Logic Apps Workflows to stream to a Log Analytics workspace when any Logic Apps Workflows which are missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Logic Apps Workflows to Log Analytics workspace\"},\"type\":\"String\"},\"MariaDBLogAnalyticsEffect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for MariaDB to stream to a Log Analytics workspace when any MariaDB  which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for MariaDB to Log Analytics workspace\"},\"type\":\"String\"},\"MediaServiceLogAnalyticsEffect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Azure Media Service to stream to a Log Analytics workspace when any Azure Media Service which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Azure Media Service to Log Analytics workspace\"},\"type\":\"String\"},\"MlWorkspaceLogAnalyticsEffect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Machine Learning workspace to stream to a Log Analytics workspace when any Machine Learning workspace which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Machine Learning workspace to Log Analytics workspace\"},\"type\":\"String\"},\"MySQLLogAnalyticsEffect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Database for MySQL to stream to a Log Analytics workspace when any Database for MySQL which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Database for MySQL to Log Analytics workspace\"},\"type\":\"String\"},\"NetworkNICLogAnalyticsEffect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Network Interfaces to stream to a Log Analytics workspace when any Network Interfaces which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Network Interfaces to Log Analytics workspace\"},\"type\":\"String\"},\"NetworkPublicIPNicLogAnalyticsEffect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Public IP addresses to stream to a Log Analytics workspace when any Public IP addresses which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Public IP addresses to Log Analytics workspace\"},\"type\":\"String\"},\"NetworkSecurityGroupsLogAnalyticsEffect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Network Security Groups to stream to a Log Analytics workspace when any Network Security Groups which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Network Security Groups to Log Analytics workspace\"},\"type\":\"String\"},\"PostgreSQLLogAnalyticsEffect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Database for PostgreSQL to stream to a Log Analytics workspace when any Database for PostgreSQL which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Database for PostgreSQL to Log Analytics workspace\"},\"type\":\"String\"},\"PowerBIEmbeddedLogAnalyticsEffect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Power BI Embedded to stream to a Log Analytics workspace when any Power BI Embedded which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Power BI Embedded to Log Analytics workspace\"},\"type\":\"String\"},\"RedisCacheLogAnalyticsEffect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Redis Cache to stream to a Log Analytics workspace when any Redis Cache which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Redis Cache to Log Analytics workspace\"},\"type\":\"String\"},\"RelayLogAnalyticsEffect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Relay to stream to a Log Analytics workspace when any Relay which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Relay to Log Analytics workspace\"},\"type\":\"String\"},\"SQLDBsLogAnalyticsEffect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for SQL Databases to stream to a Log Analytics workspace when any SQL Databases  which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for SQL Databases  to Log Analytics workspace\"},\"type\":\"String\"},\"SQLElasticPoolsLogAnalyticsEffect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for SQL Elastic Pools to stream to a Log Analytics workspace when any SQL Elastic Pools which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for SQL Elastic Pools to Log Analytics workspace\"},\"type\":\"String\"},\"SQLMLogAnalyticsEffect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for SQL Managed Instances to stream to a Log Analytics workspace when any SQL Managed Instances which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for SQL Managed Instances to Log Analytics workspace\"},\"type\":\"String\"},\"SearchServicesLogAnalyticsEffect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Search Services to stream to a Log Analytics workspace when any Search Services which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Search Services to Log Analytics workspace\"},\"type\":\"String\"},\"ServiceBusLogAnalyticsEffect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for ServiceBus to stream to a Log Analytics workspace when any ServiceBus which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Service Bus namespaces  to Log Analytics workspace\"},\"type\":\"String\"},\"SignalRLogAnalyticsEffect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for SignalR to stream to a Log Analytics workspace when any SignalR which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for SignalR to Log Analytics workspace\"},\"type\":\"String\"},\"StorageAccountsLogAnalyticsEffect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Storage Accounts to stream to a Log Analytics workspace when any storage account which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Storage Accounts to Log Analytics workspace\"},\"type\":\"String\"},\"StreamAnalyticsLogAnalyticsEffect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Stream Analytics to stream to a Log Analytics workspace when any Stream Analytics which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Stream Analytics to Log Analytics workspace\"},\"type\":\"String\"},\"TimeSeriesInsightsLogAnalyticsEffect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Time Series Insights to stream to a Log Analytics workspace when any Time Series Insights which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Time Series Insights to Log Analytics workspace\"},\"type\":\"String\"},\"TrafficManagerLogAnalyticsEffect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Traffic Manager to stream to a Log Analytics workspace when any Traffic Manager which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Traffic Manager to Log Analytics workspace\"},\"type\":\"String\"},\"VMSSLogAnalyticsEffect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Virtual Machine Scale Sets  to stream to a Log Analytics workspace when any Virtual Machine Scale Sets  which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Virtual Machine Scale Sets to Log Analytics workspace\"},\"type\":\"String\"},\"VNetGWLogAnalyticsEffect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for VPN Gateway to stream to a Log Analytics workspace when any VPN Gateway which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled.\",\"displayName\":\"Deploy Diagnostic Settings for VPN Gateway to Log Analytics workspace\"},\"type\":\"String\"},\"VWanS2SVPNGWLogAnalyticsEffect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for VWAN S2S VPN gateway to stream to a Log Analytics workspace when any storage account which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for VWAN S2S VPN gateway to Log Analytics workspace\"},\"type\":\"String\"},\"VirtualMachinesLogAnalyticsEffect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Virtual Machines to stream to a Log Analytics workspace when any Virtual Machines which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Virtual Machines to Log Analytics workspace\"},\"type\":\"String\"},\"VirtualNetworkLogAnalyticsEffect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Virtual Network to stream to a Log Analytics workspace when any Virtual Network which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Virtual Network to Log Analytics workspace\"},\"type\":\"String\"},\"WVDAppGroupsLogAnalyticsEffect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for AVD Application groups to stream to a Log Analytics workspace when any application groups which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for AVD Application Groups to Log Analytics workspace\"},\"type\":\"String\"},\"WVDHostPoolsLogAnalyticsEffect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for AVD Host pools to stream to a Log Analytics workspace when any host pool which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for AVD Host pools to Log Analytics workspace\"},\"type\":\"String\"},\"WVDWorkspaceLogAnalyticsEffect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for AVD Workspace to stream to a Log Analytics workspace when any Workspace which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for AVD Workspace to Log Analytics workspace\"},\"type\":\"String\"},\"logAnalytics\":{\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"},\"type\":\"String\"},\"profileName\":{\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"},\"type\":\"String\"}}",
              "policy_definition_group": [],
              "policy_definition_reference": [
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('StorageAccountsLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/59759c62-9a22-4cdf-ae64-074495983fef",
                  "policy_group_names": null,
                  "reference_id": "StorageAccountDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('StorageAccountsLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/b4fe1a3b-0715-4c6c-a5ea-ffc33cf823cb",
                  "policy_group_names": null,
                  "reference_id": "StorageAccountBlobServicesDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('StorageAccountsLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/25a70cc8-2bd4-47f1-90b6-1478e4662c96",
                  "policy_group_names": null,
                  "reference_id": "StorageAccountFileServicesDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('StorageAccountsLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/7bd000e3-37c7-4928-9f31-86c4b77c5c45",
                  "policy_group_names": null,
                  "reference_id": "StorageAccountQueueServicesDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('StorageAccountsLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/2fb86bf3-d221-43d1-96d1-2434af34eaa0",
                  "policy_group_names": null,
                  "reference_id": "StorageAccountTableServicesDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('AVDScalingPlansLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-AVDScalingPlans",
                  "policy_group_names": null,
                  "reference_id": "AVDScalingPlansDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('WVDAppGroupsLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-WVDAppGroup",
                  "policy_group_names": null,
                  "reference_id": "WVDAppGroupDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('WVDWorkspaceLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-WVDWorkspace",
                  "policy_group_names": null,
                  "reference_id": "WVDWorkspaceDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('WVDHostPoolsLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-WVDHostPools",
                  "policy_group_names": null,
                  "reference_id": "WVDHostPoolsDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('ACILogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ACI",
                  "policy_group_names": null,
                  "reference_id": "ACIDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('ACRLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ACR",
                  "policy_group_names": null,
                  "reference_id": "ACRDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"diagnosticsSettingNameToUse\":{\"value\":\"[parameters('profileName')]\"},\"effect\":{\"value\":\"[parameters('AKSLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/6c66c325-74c8-42fd-a286-a74b0e2939d8",
                  "policy_group_names": null,
                  "reference_id": "AKSDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('AnalysisServiceLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-AnalysisService",
                  "policy_group_names": null,
                  "reference_id": "AnalysisServiceDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('APIforFHIRLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ApiForFHIR",
                  "policy_group_names": null,
                  "reference_id": "APIforFHIRDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('APIMgmtLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logAnalyticsDestinationType\":{\"value\":\"[parameters('APIMgmtLogAnalyticsDestinationType')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-APIMgmt",
                  "policy_group_names": null,
                  "reference_id": "APIMgmtDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('ApplicationGatewayLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ApplicationGateway",
                  "policy_group_names": null,
                  "reference_id": "ApplicationGatewayDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('AutomationLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-AA",
                  "policy_group_names": null,
                  "reference_id": "AutomationDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('BastionLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Bastion",
                  "policy_group_names": null,
                  "reference_id": "BastionDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('BatchLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/c84e5349-db6d-4769-805e-e14037dab9b5",
                  "policy_group_names": null,
                  "reference_id": "BatchDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('CDNEndpointsLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-CDNEndpoints",
                  "policy_group_names": null,
                  "reference_id": "CDNEndpointsDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('CognitiveServicesLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-CognitiveServices",
                  "policy_group_names": null,
                  "reference_id": "CognitiveServicesDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('CosmosLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-CosmosDB",
                  "policy_group_names": null,
                  "reference_id": "CosmosDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('DatabricksLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Databricks",
                  "policy_group_names": null,
                  "reference_id": "DatabricksDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('DataExplorerClusterLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-DataExplorerCluster",
                  "policy_group_names": null,
                  "reference_id": "DataExplorerClusterDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('DataFactoryLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-DataFactory",
                  "policy_group_names": null,
                  "reference_id": "DataFactoryDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('DataLakeStoreLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/d56a5a7c-72d7-42bc-8ceb-3baf4c0eae03",
                  "policy_group_names": null,
                  "reference_id": "DataLakeStoreDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('DataLakeAnalyticsLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-DLAnalytics",
                  "policy_group_names": null,
                  "reference_id": "DataLakeAnalyticsDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('EventGridSubLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-EventGridSub",
                  "policy_group_names": null,
                  "reference_id": "EventGridSubDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('EventGridTopicLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-EventGridTopic",
                  "policy_group_names": null,
                  "reference_id": "EventGridTopicDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('EventHubLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/1f6e93e8-6b31-41b1-83f6-36e449a42579",
                  "policy_group_names": null,
                  "reference_id": "EventHubDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('EventSystemTopicLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-EventGridSystemTopic",
                  "policy_group_names": null,
                  "reference_id": "EventSystemTopicDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('ExpressRouteLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ExpressRoute",
                  "policy_group_names": null,
                  "reference_id": "ExpressRouteDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('FirewallLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logAnalyticsDestinationType\":{\"value\":\"[parameters('FirewallLogAnalyticsDestinationType')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Firewall",
                  "policy_group_names": null,
                  "reference_id": "FirewallDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('FrontDoorLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-FrontDoor",
                  "policy_group_names": null,
                  "reference_id": "FrontDoorDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('FunctionAppLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Function",
                  "policy_group_names": null,
                  "reference_id": "FunctionAppDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('HDInsightLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-HDInsight",
                  "policy_group_names": null,
                  "reference_id": "HDInsightDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('IotHubLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-iotHub",
                  "policy_group_names": null,
                  "reference_id": "IotHubDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('KeyVaultLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/bef3f64c-5290-43b7-85b0-9b254eef4c47",
                  "policy_group_names": null,
                  "reference_id": "KeyVaultDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('LoadBalancerLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-LoadBalancer",
                  "policy_group_names": null,
                  "reference_id": "LoadBalancerDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('LogAnalyticsLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-LogAnalytics",
                  "policy_group_names": null,
                  "reference_id": "LogAnalyticsDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('LogicAppsISELogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-LogicAppsISE",
                  "policy_group_names": null,
                  "reference_id": "LogicAppsISEDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('LogicAppsWFLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/b889a06c-ec72-4b03-910a-cb169ee18721",
                  "policy_group_names": null,
                  "reference_id": "LogicAppsWFDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('MariaDBLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-MariaDB",
                  "policy_group_names": null,
                  "reference_id": "MariaDBDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('MediaServiceLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-MediaService",
                  "policy_group_names": null,
                  "reference_id": "MediaServiceDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('MlWorkspaceLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-MlWorkspace",
                  "policy_group_names": null,
                  "reference_id": "MlWorkspaceDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('MySQLLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-MySQL",
                  "policy_group_names": null,
                  "reference_id": "MySQLDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('NetworkSecurityGroupsLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-NetworkSecurityGroups",
                  "policy_group_names": null,
                  "reference_id": "NetworkSecurityGroupsDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('NetworkNICLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-NIC",
                  "policy_group_names": null,
                  "reference_id": "NetworkNICDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('PostgreSQLLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-PostgreSQL",
                  "policy_group_names": null,
                  "reference_id": "PostgreSQLDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('PowerBIEmbeddedLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-PowerBIEmbedded",
                  "policy_group_names": null,
                  "reference_id": "PowerBIEmbeddedDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('NetworkPublicIPNicLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"metricsEnabled\":{\"value\":\"True\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/752154a7-1e0f-45c6-a880-ac75a7e4f648",
                  "policy_group_names": null,
                  "reference_id": "NetworkPublicIPNicDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/c717fb0c-d118-4c43-ab3d-ece30ac81fb3",
                  "policy_group_names": null,
                  "reference_id": "RecoveryVaultDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('RedisCacheLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-RedisCache",
                  "policy_group_names": null,
                  "reference_id": "RedisCacheDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('RelayLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Relay",
                  "policy_group_names": null,
                  "reference_id": "RelayDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('SearchServicesLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/08ba64b8-738f-4918-9686-730d2ed79c7d",
                  "policy_group_names": null,
                  "reference_id": "SearchServicesDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('ServiceBusLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/04d53d87-841c-4f23-8a5b-21564380b55e",
                  "policy_group_names": null,
                  "reference_id": "ServiceBusDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('SignalRLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-SignalR",
                  "policy_group_names": null,
                  "reference_id": "SignalRDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"diagnosticsSettingNameToUse\":{\"value\":\"[parameters('profileName')]\"},\"effect\":{\"value\":\"[parameters('SQLDBsLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/b79fa14e-238a-4c2d-b376-442ce508fc84",
                  "policy_group_names": null,
                  "reference_id": "SQLDatabaseDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('SQLElasticPoolsLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-SQLElasticPools",
                  "policy_group_names": null,
                  "reference_id": "SQLElasticPoolsDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('SQLMLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-SQLMI",
                  "policy_group_names": null,
                  "reference_id": "SQLMDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('StreamAnalyticsLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/237e0f7e-b0e8-4ec4-ad46-8c12cb66d673",
                  "policy_group_names": null,
                  "reference_id": "StreamAnalyticsDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('TimeSeriesInsightsLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-TimeSeriesInsights",
                  "policy_group_names": null,
                  "reference_id": "TimeSeriesInsightsDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('TrafficManagerLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-TrafficManager",
                  "policy_group_names": null,
                  "reference_id": "TrafficManagerDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('VirtualNetworkLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-VirtualNetwork",
                  "policy_group_names": null,
                  "reference_id": "VirtualNetworkDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('VirtualMachinesLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-VM",
                  "policy_group_names": null,
                  "reference_id": "VirtualMachinesDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('VMSSLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-VMSS",
                  "policy_group_names": null,
                  "reference_id": "VMSSDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('VNetGWLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-VNetGW",
                  "policy_group_names": null,
                  "reference_id": "VNetGWDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('AppServiceLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-WebServerFarm",
                  "policy_group_names": null,
                  "reference_id": "AppServiceDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('AppServiceWebappLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Website",
                  "policy_group_names": null,
                  "reference_id": "AppServiceWebappDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('VWanS2SVPNGWLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-VWanS2SVPNGW",
                  "policy_group_names": null,
                  "reference_id": "VWanS2SVPNGWDeployDiagnosticLogDeployLogAnalytics"
                }
              ],
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "policy_definition_group": [],
              "policy_definition_reference": [
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {}
              ]
            }
          },
          {
            "address": "module.test_core.azurerm_policy_set_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Deploy-MDFC-Config\"]",
            "mode": "managed",
            "type": "azurerm_policy_set_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Deploy-MDFC-Config",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Deploy Microsoft Defender for Cloud configuration. Superseded by https://www.azadvertizer.net/azpolicyinitiativesadvertizer/Deploy-MDFC-Config_20240319.html",
              "display_name": "[Deprecated]: Deploy Microsoft Defender for Cloud configuration",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\"],\"category\":\"Security Center\",\"deprecated\":true,\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"supersededBy\":\"Deploy-MDFC-Config_20240319\",\"version\":\"7.0.0-deprecated\"}",
              "name": "Deploy-MDFC-Config",
              "parameters": "{\"ascExportResourceGroupLocation\":{\"metadata\":{\"description\":\"The location where the resource group and the export to Log Analytics workspace configuration are created.\",\"displayName\":\"Resource Group location for the export to Log Analytics workspace configuration\"},\"type\":\"String\"},\"ascExportResourceGroupName\":{\"metadata\":{\"description\":\"The resource group name where the export to Log Analytics workspace configuration is created. If you enter a name for a resource group that doesn't exist, it'll be created in the subscription. Note that each resource group can only have one export to Log Analytics workspace configured.\",\"displayName\":\"Resource Group name for the export to Log Analytics workspace configuration\"},\"type\":\"String\"},\"emailSecurityContact\":{\"metadata\":{\"description\":\"Provide email address for Microsoft Defender for Cloud contact details\",\"displayName\":\"Security contacts email address\"},\"type\":\"string\"},\"enableAscForApis\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"enableAscForAppServices\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"enableAscForArm\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"enableAscForContainers\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"enableAscForCosmosDbs\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"enableAscForCspm\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"enableAscForDns\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"enableAscForKeyVault\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"enableAscForOssDb\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"enableAscForServers\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"enableAscForServersVulnerabilityAssessments\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"enableAscForSql\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"enableAscForSqlOnVm\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"enableAscForStorage\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"logAnalytics\":{\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Primary Log Analytics workspace\",\"strongType\":\"omsWorkspace\"},\"type\":\"String\"},\"minimalSeverity\":{\"allowedValues\":[\"High\",\"Medium\",\"Low\"],\"defaultValue\":\"High\",\"metadata\":{\"description\":\"Defines the minimal alert severity which will be sent as email notifications\",\"displayName\":\"Minimal severity\"},\"type\":\"string\"},\"vulnerabilityAssessmentProvider\":{\"allowedValues\":[\"default\",\"mdeTvm\"],\"defaultValue\":\"default\",\"metadata\":{\"description\":\"Select the vulnerability assessment solution to provision to machines.\",\"displayName\":\"Vulnerability assessment provider type\"},\"type\":\"String\"}}",
              "policy_definition_group": [],
              "policy_definition_reference": [
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('enableAscForOssDb')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/44433aa3-7ec2-4002-93ea-65c65ff0310a",
                  "policy_group_names": null,
                  "reference_id": "defenderForOssDb"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('enableAscForServers')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/8e86a5b6-b9bd-49d1-8e21-4bb8a0862222",
                  "policy_group_names": null,
                  "reference_id": "defenderForVM"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('enableAscForServersVulnerabilityAssessments')]\"},\"vaType\":{\"value\":\"[parameters('vulnerabilityAssessmentProvider')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/13ce0167-8ca6-4048-8e6b-f996402e3c1b",
                  "policy_group_names": null,
                  "reference_id": "defenderForVMVulnerabilityAssessment"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('enableAscForSqlOnVm')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/50ea7265-7d8c-429e-9a7d-ca1f410191c3",
                  "policy_group_names": null,
                  "reference_id": "defenderForSqlServerVirtualMachines"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('enableAscForAppServices')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/b40e7bcd-a1e5-47fe-b9cf-2f534d0bfb7d",
                  "policy_group_names": null,
                  "reference_id": "defenderForAppServices"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('enableAscForStorage')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/cfdc5972-75b3-4418-8ae1-7f5c36839390",
                  "policy_group_names": null,
                  "reference_id": "defenderForStorageAccountsV2"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('enableAscForContainers')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/c9ddb292-b203-4738-aead-18e2716e858f",
                  "policy_group_names": null,
                  "reference_id": "defenderforContainers"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('enableAscForContainers')]\"},\"logAnalyticsWorkspaceResourceId\":{\"value\":\"[parameters('logAnalytics')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/64def556-fbad-4622-930e-72d1d5589bf5",
                  "policy_group_names": null,
                  "reference_id": "defenderforKubernetes"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('enableAscForContainers')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/a8eff44f-8c92-45c3-a3fb-9880802d67a7",
                  "policy_group_names": null,
                  "reference_id": "azurePolicyForKubernetes"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('enableAscForKeyVault')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/1f725891-01c0-420a-9059-4fa46cb770b7",
                  "policy_group_names": null,
                  "reference_id": "defenderForKeyVaults"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('enableAscForDns')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/2370a3c1-4a25-4283-a91a-c9c1a145fb2f",
                  "policy_group_names": null,
                  "reference_id": "defenderForDns"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('enableAscForArm')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/b7021b2b-08fd-4dc0-9de7-3c6ece09faf9",
                  "policy_group_names": null,
                  "reference_id": "defenderForArm"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('enableAscForSql')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/b99b73e7-074b-4089-9395-b7236f094491",
                  "policy_group_names": null,
                  "reference_id": "defenderForSqlPaas"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('enableAscForCosmosDbs')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/82bf5b87-728b-4a74-ba4d-6123845cf542",
                  "policy_group_names": null,
                  "reference_id": "defenderForCosmosDbs"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('enableAscForApis')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/e54d2be9-5f2e-4d65-98e4-4f0e670b23d6",
                  "policy_group_names": null,
                  "reference_id": "defenderForApis"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('enableAscForCspm')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/689f7782-ef2c-4270-a6d0-7664869076bd",
                  "policy_group_names": null,
                  "reference_id": "defenderForCspm"
                },
                {
                  "parameter_values": "{\"emailSecurityContact\":{\"value\":\"[parameters('emailSecurityContact')]\"},\"minimalSeverity\":{\"value\":\"[parameters('minimalSeverity')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-ASC-SecurityContacts",
                  "policy_group_names": null,
                  "reference_id": "securityEmailContact"
                },
                {
                  "parameter_values": "{\"resourceGroupLocation\":{\"value\":\"[parameters('ascExportResourceGroupLocation')]\"},\"resourceGroupName\":{\"value\":\"[parameters('ascExportResourceGroupName')]\"},\"workspaceResourceId\":{\"value\":\"[parameters('logAnalytics')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/ffb6f416-7bd2-4488-8828-56585fef2be9",
                  "policy_group_names": null,
                  "reference_id": "ascExport"
                },
                {
                  "parameter_values": "{}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/766e621d-ba95-4e43-a6f2-e945db3d7888",
                  "policy_group_names": null,
                  "reference_id": "migrateToMdeTvm"
                }
              ],
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "policy_definition_group": [],
              "policy_definition_reference": [
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {}
              ]
            }
          },
          {
            "address": "module.test_core.azurerm_policy_set_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Deploy-MDFC-Config_20240319\"]",
            "mode": "managed",
            "type": "azurerm_policy_set_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Deploy-MDFC-Config_20240319",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Deploy Microsoft Defender for Cloud configuration",
              "display_name": "Deploy Microsoft Defender for Cloud configuration",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\"],\"category\":\"Security Center\",\"replacesPolicy\":\"Deploy-MDFC-Config\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.0\"}",
              "name": "Deploy-MDFC-Config_20240319",
              "parameters": "{\"ascExportResourceGroupLocation\":{\"metadata\":{\"description\":\"The location where the resource group and the export to Log Analytics workspace configuration are created.\",\"displayName\":\"Resource Group location for the export to Log Analytics workspace configuration\"},\"type\":\"String\"},\"ascExportResourceGroupName\":{\"metadata\":{\"description\":\"The resource group name where the export to Log Analytics workspace configuration is created. If you enter a name for a resource group that doesn't exist, it'll be created in the subscription. Note that each resource group can only have one export to Log Analytics workspace configured.\",\"displayName\":\"Resource Group name for the export to Log Analytics workspace configuration\"},\"type\":\"String\"},\"emailSecurityContact\":{\"metadata\":{\"description\":\"Provide email address for Microsoft Defender for Cloud contact details\",\"displayName\":\"Security contacts email address\"},\"type\":\"string\"},\"enableAscForAppServices\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"enableAscForArm\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"enableAscForContainers\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"enableAscForCosmosDbs\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"enableAscForCspm\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"enableAscForKeyVault\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"enableAscForOssDb\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"enableAscForServers\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"enableAscForServersVulnerabilityAssessments\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"enableAscForSql\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"enableAscForSqlOnVm\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"enableAscForStorage\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"logAnalytics\":{\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Primary Log Analytics workspace\",\"strongType\":\"omsWorkspace\"},\"type\":\"String\"},\"minimalSeverity\":{\"allowedValues\":[\"High\",\"Medium\",\"Low\"],\"defaultValue\":\"High\",\"metadata\":{\"description\":\"Defines the minimal alert severity which will be sent as email notifications\",\"displayName\":\"Minimal severity\"},\"type\":\"string\"},\"vulnerabilityAssessmentProvider\":{\"allowedValues\":[\"default\",\"mdeTvm\"],\"defaultValue\":\"mdeTvm\",\"metadata\":{\"description\":\"Select the vulnerability assessment solution to provision to machines.\",\"displayName\":\"Vulnerability assessment provider type\"},\"type\":\"String\"}}",
              "policy_definition_group": [],
              "policy_definition_reference": [
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('enableAscForOssDb')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/44433aa3-7ec2-4002-93ea-65c65ff0310a",
                  "policy_group_names": null,
                  "reference_id": "defenderForOssDb"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('enableAscForServers')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/8e86a5b6-b9bd-49d1-8e21-4bb8a0862222",
                  "policy_group_names": null,
                  "reference_id": "defenderForVM"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('enableAscForServersVulnerabilityAssessments')]\"},\"vaType\":{\"value\":\"[parameters('vulnerabilityAssessmentProvider')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/13ce0167-8ca6-4048-8e6b-f996402e3c1b",
                  "policy_group_names": null,
                  "reference_id": "defenderForVMVulnerabilityAssessment"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('enableAscForSqlOnVm')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/50ea7265-7d8c-429e-9a7d-ca1f410191c3",
                  "policy_group_names": null,
                  "reference_id": "defenderForSqlServerVirtualMachines"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('enableAscForAppServices')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/b40e7bcd-a1e5-47fe-b9cf-2f534d0bfb7d",
                  "policy_group_names": null,
                  "reference_id": "defenderForAppServices"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('enableAscForStorage')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/cfdc5972-75b3-4418-8ae1-7f5c36839390",
                  "policy_group_names": null,
                  "reference_id": "defenderForStorageAccountsV2"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('enableAscForContainers')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/c9ddb292-b203-4738-aead-18e2716e858f",
                  "policy_group_names": null,
                  "reference_id": "defenderforContainers"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('enableAscForContainers')]\"},\"logAnalyticsWorkspaceResourceId\":{\"value\":\"[parameters('logAnalytics')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/64def556-fbad-4622-930e-72d1d5589bf5",
                  "policy_group_names": null,
                  "reference_id": "defenderforKubernetes"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('enableAscForContainers')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/a8eff44f-8c92-45c3-a3fb-9880802d67a7",
                  "policy_group_names": null,
                  "reference_id": "azurePolicyForKubernetes"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('enableAscForKeyVault')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/1f725891-01c0-420a-9059-4fa46cb770b7",
                  "policy_group_names": null,
                  "reference_id": "defenderForKeyVaults"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('enableAscForArm')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/b7021b2b-08fd-4dc0-9de7-3c6ece09faf9",
                  "policy_group_names": null,
                  "reference_id": "defenderForArm"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('enableAscForSql')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/b99b73e7-074b-4089-9395-b7236f094491",
                  "policy_group_names": null,
                  "reference_id": "defenderForSqlPaas"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('enableAscForCosmosDbs')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/82bf5b87-728b-4a74-ba4d-6123845cf542",
                  "policy_group_names": null,
                  "reference_id": "defenderForCosmosDbs"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('enableAscForCspm')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/689f7782-ef2c-4270-a6d0-7664869076bd",
                  "policy_group_names": null,
                  "reference_id": "defenderForCspm"
                },
                {
                  "parameter_values": "{\"emailSecurityContact\":{\"value\":\"[parameters('emailSecurityContact')]\"},\"minimalSeverity\":{\"value\":\"[parameters('minimalSeverity')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-ASC-SecurityContacts",
                  "policy_group_names": null,
                  "reference_id": "securityEmailContact"
                },
                {
                  "parameter_values": "{\"resourceGroupLocation\":{\"value\":\"[parameters('ascExportResourceGroupLocation')]\"},\"resourceGroupName\":{\"value\":\"[parameters('ascExportResourceGroupName')]\"},\"workspaceResourceId\":{\"value\":\"[parameters('logAnalytics')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/ffb6f416-7bd2-4488-8828-56585fef2be9",
                  "policy_group_names": null,
                  "reference_id": "ascExport"
                },
                {
                  "parameter_values": "{}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/766e621d-ba95-4e43-a6f2-e945db3d7888",
                  "policy_group_names": null,
                  "reference_id": "migrateToMdeTvm"
                }
              ],
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "policy_definition_group": [],
              "policy_definition_reference": [
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {}
              ]
            }
          },
          {
            "address": "module.test_core.azurerm_policy_set_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Deploy-MDFC-DefenderSQL-AMA\"]",
            "mode": "managed",
            "type": "azurerm_policy_set_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Deploy-MDFC-DefenderSQL-AMA",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Initiative is deprecated as the built-in initiative now supports bringing your own UAMI and DCR. Superseded by https://www.azadvertizer.net/azpolicyinitiativesadvertizer/de01d381-bae9-4670-8870-786f89f49e26.html",
              "display_name": "[Deprecated]: Configure SQL VM and Arc-enabled SQL Servers to install Microsoft Defender for SQL and AMA with a user-defined LAW",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\"],\"category\":\"Security Center\",\"deprecated\":true,\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"supersededBy\":\"de01d381-bae9-4670-8870-786f89f49e26\",\"version\":\"1.0.1-deprecated\"}",
              "name": "Deploy-MDFC-DefenderSQL-AMA",
              "parameters": "{\"dcrId\":{\"metadata\":{\"description\":\"Id of the Data Collection Rule.\",\"displayName\":\"Data Collection Rule Id\"},\"type\":\"String\"},\"dcrName\":{\"metadata\":{\"description\":\"Name of the Data Collection Rule.\",\"displayName\":\"Data Collection Rule Name\"},\"type\":\"String\"},\"dcrResourceGroup\":{\"metadata\":{\"description\":\"Resource Group of the Data Collection Rule.\",\"displayName\":\"Data Collection Rule Resource Group\"},\"type\":\"String\"},\"effect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"enableCollectionOfSqlQueriesForSecurityResearch\":{\"allowedValues\":[true,false],\"defaultValue\":false,\"metadata\":{\"description\":\"Enable or disable the collection of SQL queries for security research.\",\"displayName\":\"Enable collection of SQL queries for security research\"},\"type\":\"Boolean\"},\"identityResourceGroup\":{\"defaultValue\":\"\",\"metadata\":{\"description\":\"The name of the resource group created by the policy.\",\"displayName\":\"Identity Resource Group\"},\"type\":\"String\"},\"userAssignedIdentityName\":{\"defaultValue\":\"\",\"metadata\":{\"description\":\"The name of the user assigned managed identity.\",\"displayName\":\"User Assigned Managed Identity Name\"},\"type\":\"String\"},\"userWorkspaceResourceId\":{\"metadata\":{\"description\":\"Workspace resource Id of the Log Analytics workspace destination for the Data Collection Rule.\",\"displayName\":\"Workspace Resource Id\",\"strongType\":\"omsWorkspace\"},\"type\":\"String\"},\"workspaceRegion\":{\"metadata\":{\"description\":\"Region of the Log Analytics workspace destination for the Data Collection Rule.\",\"displayName\":\"Workspace region\",\"strongType\":\"location\"},\"type\":\"String\"}}",
              "policy_definition_group": [],
              "policy_definition_reference": [
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/3592ff98-9787-443a-af59-4505d0fe0786",
                  "policy_group_names": null,
                  "reference_id": "defenderForSqlArcAma"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/65503269-6a54-4553-8a28-0065a8e6d929",
                  "policy_group_names": null,
                  "reference_id": "defenderForSqlArcMdsql"
                },
                {
                  "parameter_values": "{\"dcrId\":{\"value\":\"[parameters('dcrId')]\"},\"dcrName\":{\"value\":\"[parameters('dcrName')]\"},\"dcrResourceGroup\":{\"value\":\"[parameters('dcrResourceGroup')]\"},\"effect\":{\"value\":\"[parameters('effect')]\"},\"enableCollectionOfSqlQueriesForSecurityResearch\":{\"value\":\"[parameters('enableCollectionOfSqlQueriesForSecurityResearch')]\"},\"userWorkspaceResourceId\":{\"value\":\"[parameters('userWorkspaceResourceId')]\"},\"workspaceRegion\":{\"value\":\"[parameters('workspaceRegion')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-MDFC-Arc-Sql-DefenderSQL-DCR",
                  "policy_group_names": null,
                  "reference_id": "defenderForSqlArcMdsqlDcr"
                },
                {
                  "parameter_values": "{\"dcrId\":{\"value\":\"[parameters('dcrId')]\"},\"dcrName\":{\"value\":\"[parameters('dcrName')]\"},\"dcrResourceGroup\":{\"value\":\"[parameters('dcrResourceGroup')]\"},\"effect\":{\"value\":\"[parameters('effect')]\"},\"workspaceRegion\":{\"value\":\"[parameters('workspaceRegion')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-MDFC-Arc-SQL-DCR-Association",
                  "policy_group_names": null,
                  "reference_id": "defenderForSqlArcDcrAssociation"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"identityResourceGroup\":{\"value\":\"[parameters('identityResourceGroup')]\"},\"userAssignedIdentityName\":{\"value\":\"[parameters('userAssignedIdentityName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-MDFC-SQL-AMA",
                  "policy_group_names": null,
                  "reference_id": "defenderForSqlAma"
                },
                {
                  "parameter_values": "{\"dcrId\":{\"value\":\"[parameters('dcrId')]\"},\"dcrName\":{\"value\":\"[parameters('dcrName')]\"},\"dcrResourceGroup\":{\"value\":\"[parameters('dcrResourceGroup')]\"},\"effect\":{\"value\":\"[parameters('effect')]\"},\"workspaceRegion\":{\"value\":\"[parameters('workspaceRegion')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-MDFC-SQL-DefenderSQL",
                  "policy_group_names": null,
                  "reference_id": "defenderForSqlMdsql"
                },
                {
                  "parameter_values": "{\"dcrId\":{\"value\":\"[parameters('dcrId')]\"},\"dcrName\":{\"value\":\"[parameters('dcrName')]\"},\"dcrResourceGroup\":{\"value\":\"[parameters('dcrResourceGroup')]\"},\"effect\":{\"value\":\"Disabled\"},\"enableCollectionOfSqlQueriesForSecurityResearch\":{\"value\":\"[parameters('enableCollectionOfSqlQueriesForSecurityResearch')]\"},\"userWorkspaceResourceId\":{\"value\":\"[parameters('userWorkspaceResourceId')]\"},\"workspaceRegion\":{\"value\":\"[parameters('workspaceRegion')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-MDFC-SQL-DefenderSQL-DCR",
                  "policy_group_names": null,
                  "reference_id": "defenderForSqlMdsqlDcr"
                }
              ],
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "policy_definition_group": [],
              "policy_definition_reference": [
                {},
                {},
                {},
                {},
                {},
                {},
                {}
              ]
            }
          },
          {
            "address": "module.test_core.azurerm_policy_set_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Deploy-Private-DNS-Zones\"]",
            "mode": "managed",
            "type": "azurerm_policy_set_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Deploy-Private-DNS-Zones",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "This policy initiative is a group of policies that ensures private endpoints to Azure PaaS services are integrated with Azure Private DNS zones",
              "display_name": "Configure Azure PaaS services to use private DNS zones",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\"],\"category\":\"Network\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"2.2.0\"}",
              "name": "Deploy-Private-DNS-Zones",
              "parameters": "{\"azureAcrPrivateDnsZoneId\":{\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureAcrPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"},\"type\":\"string\"},\"azureAppPrivateDnsZoneId\":{\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureAppPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"},\"type\":\"string\"},\"azureAppServicesPrivateDnsZoneId\":{\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureAppServicesPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"},\"type\":\"string\"},\"azureArcGuestconfigurationPrivateDnsZoneId\":{\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureArcGuestconfigurationPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"},\"type\":\"string\"},\"azureArcHybridResourceProviderPrivateDnsZoneId\":{\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureArcHybridResourceProviderPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"},\"type\":\"string\"},\"azureArcKubernetesConfigurationPrivateDnsZoneId\":{\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureArcKubernetesConfigurationPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"},\"type\":\"string\"},\"azureAsrPrivateDnsZoneId\":{\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureAsrPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"},\"type\":\"string\"},\"azureAutomationDSCHybridPrivateDnsZoneId\":{\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureAutomationDSCHybridPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"},\"type\":\"string\"},\"azureAutomationWebhookPrivateDnsZoneId\":{\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureAutomationWebhookPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"},\"type\":\"string\"},\"azureBatchPrivateDnsZoneId\":{\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureBatchPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"},\"type\":\"string\"},\"azureBotServicePrivateDnsZoneId\":{\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureBotServicePrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"},\"type\":\"string\"},\"azureCognitiveSearchPrivateDnsZoneId\":{\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureCognitiveSearchPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"},\"type\":\"string\"},\"azureCognitiveServicesPrivateDnsZoneId\":{\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureCognitiveServicesPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"},\"type\":\"string\"},\"azureCosmosCassandraPrivateDnsZoneId\":{\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureCosmosCassandraPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"},\"type\":\"string\"},\"azureCosmosGremlinPrivateDnsZoneId\":{\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureCosmosGremlinPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"},\"type\":\"string\"},\"azureCosmosMongoPrivateDnsZoneId\":{\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureCosmosMongoPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"},\"type\":\"string\"},\"azureCosmosSQLPrivateDnsZoneId\":{\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureCosmosSQLPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"},\"type\":\"string\"},\"azureCosmosTablePrivateDnsZoneId\":{\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureCosmosTablePrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"},\"type\":\"string\"},\"azureDataFactoryPortalPrivateDnsZoneId\":{\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureDataFactoryPortalPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"},\"type\":\"string\"},\"azureDataFactoryPrivateDnsZoneId\":{\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureDataFactoryPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"},\"type\":\"string\"},\"azureDatabricksPrivateDnsZoneId\":{\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureDatabricksPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"},\"type\":\"string\"},\"azureDiskAccessPrivateDnsZoneId\":{\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureDiskAccessPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"},\"type\":\"string\"},\"azureEventGridDomainsPrivateDnsZoneId\":{\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureEventGridDomainsPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"},\"type\":\"string\"},\"azureEventGridTopicsPrivateDnsZoneId\":{\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureEventGridTopicsPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"},\"type\":\"string\"},\"azureEventHubNamespacePrivateDnsZoneId\":{\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureEventHubNamespacePrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"},\"type\":\"string\"},\"azureFilePrivateDnsZoneId\":{\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureFilePrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"},\"type\":\"string\"},\"azureHDInsightPrivateDnsZoneId\":{\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureHDInsightPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"},\"type\":\"string\"},\"azureIotCentralPrivateDnsZoneId\":{\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureIotCentralPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"},\"type\":\"string\"},\"azureIotDeviceupdatePrivateDnsZoneId\":{\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureIotDeviceupdatePrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"},\"type\":\"string\"},\"azureIotHubsPrivateDnsZoneId\":{\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureIotHubsPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"},\"type\":\"string\"},\"azureIotPrivateDnsZoneId\":{\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureIotPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"},\"type\":\"string\"},\"azureKeyVaultPrivateDnsZoneId\":{\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureKeyVaultPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"},\"type\":\"string\"},\"azureMachineLearningWorkspacePrivateDnsZoneId\":{\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureMachineLearningWorkspacePrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"},\"type\":\"string\"},\"azureMachineLearningWorkspaceSecondPrivateDnsZoneId\":{\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureMachineLearningWorkspaceSecondPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"},\"type\":\"string\"},\"azureManagedGrafanaWorkspacePrivateDnsZoneId\":{\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureManagedGrafanaWorkspacePrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"},\"type\":\"string\"},\"azureMediaServicesKeyPrivateDnsZoneId\":{\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureMediaServicesKeyPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"},\"type\":\"string\"},\"azureMediaServicesLivePrivateDnsZoneId\":{\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureMediaServicesLivePrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"},\"type\":\"string\"},\"azureMediaServicesStreamPrivateDnsZoneId\":{\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureMediaServicesStreamPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"},\"type\":\"string\"},\"azureMigratePrivateDnsZoneId\":{\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureMigratePrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"},\"type\":\"string\"},\"azureMonitorPrivateDnsZoneId1\":{\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureMonitorPrivateDnsZoneId1\",\"strongType\":\"Microsoft.Network/privateDnsZones\"},\"type\":\"string\"},\"azureMonitorPrivateDnsZoneId2\":{\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureMonitorPrivateDnsZoneId2\",\"strongType\":\"Microsoft.Network/privateDnsZones\"},\"type\":\"string\"},\"azureMonitorPrivateDnsZoneId3\":{\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureMonitorPrivateDnsZoneId3\",\"strongType\":\"Microsoft.Network/privateDnsZones\"},\"type\":\"string\"},\"azureMonitorPrivateDnsZoneId4\":{\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureMonitorPrivateDnsZoneId4\",\"strongType\":\"Microsoft.Network/privateDnsZones\"},\"type\":\"string\"},\"azureMonitorPrivateDnsZoneId5\":{\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureMonitorPrivateDnsZoneId5\",\"strongType\":\"Microsoft.Network/privateDnsZones\"},\"type\":\"string\"},\"azureRedisCachePrivateDnsZoneId\":{\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureRedisCachePrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"},\"type\":\"string\"},\"azureServiceBusNamespacePrivateDnsZoneId\":{\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureServiceBusNamespacePrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"},\"type\":\"string\"},\"azureSignalRPrivateDnsZoneId\":{\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureSignalRPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"},\"type\":\"string\"},\"azureSiteRecoveryBackupPrivateDnsZoneID\":{\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureSiteRecoveryBackupPrivateDnsZoneID\",\"strongType\":\"Microsoft.Network/privateDnsZones\"},\"type\":\"string\"},\"azureSiteRecoveryBlobPrivateDnsZoneID\":{\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureSiteRecoveryBlobPrivateDnsZoneID\",\"strongType\":\"Microsoft.Network/privateDnsZones\"},\"type\":\"string\"},\"azureSiteRecoveryQueuePrivateDnsZoneID\":{\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureSiteRecoveryQueuePrivateDnsZoneID\",\"strongType\":\"Microsoft.Network/privateDnsZones\"},\"type\":\"string\"},\"azureStorageBlobPrivateDnsZoneId\":{\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureStorageBlobPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"},\"type\":\"string\"},\"azureStorageBlobSecPrivateDnsZoneId\":{\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureStorageBlobSecPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"},\"type\":\"string\"},\"azureStorageDFSPrivateDnsZoneId\":{\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureStorageDFSPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"},\"type\":\"string\"},\"azureStorageDFSSecPrivateDnsZoneId\":{\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureStorageDFSSecPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"},\"type\":\"string\"},\"azureStorageFilePrivateDnsZoneId\":{\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureStorageFilePrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"},\"type\":\"string\"},\"azureStorageQueuePrivateDnsZoneId\":{\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureStorageQueuePrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"},\"type\":\"string\"},\"azureStorageQueueSecPrivateDnsZoneId\":{\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureStorageQueueSecPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"},\"type\":\"string\"},\"azureStorageStaticWebPrivateDnsZoneId\":{\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureStorageStaticWebPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"},\"type\":\"string\"},\"azureStorageStaticWebSecPrivateDnsZoneId\":{\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureStorageStaticWebSecPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"},\"type\":\"string\"},\"azureStorageTablePrivateDnsZoneId\":{\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureStorageTablePrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"},\"type\":\"string\"},\"azureStorageTableSecondaryPrivateDnsZoneId\":{\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureStorageTableSecondaryPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"},\"type\":\"string\"},\"azureSynapseDevPrivateDnsZoneId\":{\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureSynapseDevPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"},\"type\":\"string\"},\"azureSynapseSQLODPrivateDnsZoneId\":{\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureSynapseSQLODPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"},\"type\":\"string\"},\"azureSynapseSQLPrivateDnsZoneId\":{\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureSynapseSQLPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"},\"type\":\"string\"},\"azureVirtualDesktopHostpoolPrivateDnsZoneId\":{\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureVirtualDesktopHostpoolPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"},\"type\":\"string\"},\"azureVirtualDesktopWorkspacePrivateDnsZoneId\":{\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureVirtualDesktopWorkspacePrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"},\"type\":\"string\"},\"azureWebPrivateDnsZoneId\":{\"defaultValue\":\"\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureWebPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"},\"type\":\"string\"},\"effect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"string\"},\"effect1\":{\"allowedValues\":[\"deployIfNotExists\",\"Disabled\"],\"defaultValue\":\"deployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"string\"}}",
              "policy_definition_group": [],
              "policy_definition_reference": [
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureFilePrivateDnsZoneId')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/06695360-db88-47f6-b976-7500d4297475",
                  "policy_group_names": null,
                  "reference_id": "DINE-Private-DNS-Azure-File-Sync"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureAutomationWebhookPrivateDnsZoneId')]\"},\"privateEndpointGroupId\":{\"value\":\"Webhook\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/6dd01e4f-1be1-4e80-9d0b-d109e04cb064",
                  "policy_group_names": null,
                  "reference_id": "DINE-Private-DNS-Azure-Automation-Webhook"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureAutomationDSCHybridPrivateDnsZoneId')]\"},\"privateEndpointGroupId\":{\"value\":\"DSCAndHybridWorker\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/6dd01e4f-1be1-4e80-9d0b-d109e04cb064",
                  "policy_group_names": null,
                  "reference_id": "DINE-Private-DNS-Azure-Automation-DSCHybrid"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureCosmosSQLPrivateDnsZoneId')]\"},\"privateEndpointGroupId\":{\"value\":\"SQL\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/a63cc0bd-cda4-4178-b705-37dc439d3e0f",
                  "policy_group_names": null,
                  "reference_id": "DINE-Private-DNS-Azure-Cosmos-SQL"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureCosmosMongoPrivateDnsZoneId')]\"},\"privateEndpointGroupId\":{\"value\":\"MongoDB\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/a63cc0bd-cda4-4178-b705-37dc439d3e0f",
                  "policy_group_names": null,
                  "reference_id": "DINE-Private-DNS-Azure-Cosmos-MongoDB"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureCosmosCassandraPrivateDnsZoneId')]\"},\"privateEndpointGroupId\":{\"value\":\"Cassandra\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/a63cc0bd-cda4-4178-b705-37dc439d3e0f",
                  "policy_group_names": null,
                  "reference_id": "DINE-Private-DNS-Azure-Cosmos-Cassandra"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureCosmosGremlinPrivateDnsZoneId')]\"},\"privateEndpointGroupId\":{\"value\":\"Gremlin\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/a63cc0bd-cda4-4178-b705-37dc439d3e0f",
                  "policy_group_names": null,
                  "reference_id": "DINE-Private-DNS-Azure-Cosmos-Gremlin"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureCosmosTablePrivateDnsZoneId')]\"},\"privateEndpointGroupId\":{\"value\":\"Table\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/a63cc0bd-cda4-4178-b705-37dc439d3e0f",
                  "policy_group_names": null,
                  "reference_id": "DINE-Private-DNS-Azure-Cosmos-Table"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"listOfGroupIds\":{\"value\":[\"dataFactory\"]},\"privateDnsZoneId\":{\"value\":\"[parameters('azureDataFactoryPrivateDnsZoneId')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/86cd96e1-1745-420d-94d4-d3f2fe415aa4",
                  "policy_group_names": null,
                  "reference_id": "DINE-Private-DNS-Azure-DataFactory"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"listOfGroupIds\":{\"value\":[\"portal\"]},\"privateDnsZoneId\":{\"value\":\"[parameters('azureDataFactoryPortalPrivateDnsZoneId')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/86cd96e1-1745-420d-94d4-d3f2fe415aa4",
                  "policy_group_names": null,
                  "reference_id": "DINE-Private-DNS-Azure-DataFactory-Portal"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"groupId\":{\"value\":\"databricks_ui_api\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureDatabricksPrivateDnsZoneId')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/0eddd7f3-3d9b-4927-a07a-806e8ac9486c",
                  "policy_group_names": null,
                  "reference_id": "DINE-Private-DNS-Azure-Databricks-UI-Api"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"groupId\":{\"value\":\"browser_authentication\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureDatabricksPrivateDnsZoneId')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/0eddd7f3-3d9b-4927-a07a-806e8ac9486c",
                  "policy_group_names": null,
                  "reference_id": "DINE-Private-DNS-Azure-Databricks-Browser-AuthN"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"groupId\":{\"value\":\"cluster\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureHDInsightPrivateDnsZoneId')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/43d6e3bd-fc6a-4b44-8b4d-2151d8736a11",
                  "policy_group_names": null,
                  "reference_id": "DINE-Private-DNS-Azure-HDInsight"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureMigratePrivateDnsZoneId')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/7590a335-57cf-4c95-babd-ecbc8fafeb1f",
                  "policy_group_names": null,
                  "reference_id": "DINE-Private-DNS-Azure-Migrate"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureStorageBlobPrivateDnsZoneId')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/75973700-529f-4de2-b794-fb9b6781b6b0",
                  "policy_group_names": null,
                  "reference_id": "DINE-Private-DNS-Azure-Storage-Blob"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureStorageBlobSecPrivateDnsZoneId')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/d847d34b-9337-4e2d-99a5-767e5ac9c582",
                  "policy_group_names": null,
                  "reference_id": "DINE-Private-DNS-Azure-Storage-Blob-Sec"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureStorageQueuePrivateDnsZoneId')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/bcff79fb-2b0d-47c9-97e5-3023479b00d1",
                  "policy_group_names": null,
                  "reference_id": "DINE-Private-DNS-Azure-Storage-Queue"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureStorageQueueSecPrivateDnsZoneId')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/da9b4ae8-5ddc-48c5-b9c0-25f8abf7a3d6",
                  "policy_group_names": null,
                  "reference_id": "DINE-Private-DNS-Azure-Storage-Queue-Sec"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureStorageFilePrivateDnsZoneId')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/6df98d03-368a-4438-8730-a93c4d7693d6",
                  "policy_group_names": null,
                  "reference_id": "DINE-Private-DNS-Azure-Storage-File"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureStorageStaticWebPrivateDnsZoneId')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/9adab2a5-05ba-4fbd-831a-5bf958d04218",
                  "policy_group_names": null,
                  "reference_id": "DINE-Private-DNS-Azure-Storage-StaticWeb"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureStorageStaticWebSecPrivateDnsZoneId')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/d19ae5f1-b303-4b82-9ca8-7682749faf0c",
                  "policy_group_names": null,
                  "reference_id": "DINE-Private-DNS-Azure-Storage-StaticWeb-Sec"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureStorageDFSPrivateDnsZoneId')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/83c6fe0f-2316-444a-99a1-1ecd8a7872ca",
                  "policy_group_names": null,
                  "reference_id": "DINE-Private-DNS-Azure-Storage-DFS"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureStorageDFSSecPrivateDnsZoneId')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/90bd4cb3-9f59-45f7-a6ca-f69db2726671",
                  "policy_group_names": null,
                  "reference_id": "DINE-Private-DNS-Azure-Storage-DFS-Sec"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureSynapseSQLPrivateDnsZoneId')]\"},\"targetSubResource\":{\"value\":\"Sql\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/1e5ed725-f16c-478b-bd4b-7bfa2f7940b9",
                  "policy_group_names": null,
                  "reference_id": "DINE-Private-DNS-Azure-Synapse-SQL"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureSynapseSQLODPrivateDnsZoneId')]\"},\"targetSubResource\":{\"value\":\"SqlOnDemand\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/1e5ed725-f16c-478b-bd4b-7bfa2f7940b9",
                  "policy_group_names": null,
                  "reference_id": "DINE-Private-DNS-Azure-Synapse-SQL-OnDemand"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureSynapseDevPrivateDnsZoneId')]\"},\"targetSubResource\":{\"value\":\"Dev\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/1e5ed725-f16c-478b-bd4b-7bfa2f7940b9",
                  "policy_group_names": null,
                  "reference_id": "DINE-Private-DNS-Azure-Synapse-Dev"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"groupId\":{\"value\":\"keydelivery\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureMediaServicesKeyPrivateDnsZoneId')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/b4a7f6c1-585e-4177-ad5b-c2c93f4bb991",
                  "policy_group_names": null,
                  "reference_id": "DINE-Private-DNS-Azure-MediaServices-Key"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"groupId\":{\"value\":\"liveevent\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureMediaServicesLivePrivateDnsZoneId')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/b4a7f6c1-585e-4177-ad5b-c2c93f4bb991",
                  "policy_group_names": null,
                  "reference_id": "DINE-Private-DNS-Azure-MediaServices-Live"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"groupId\":{\"value\":\"streamingendpoint\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureMediaServicesStreamPrivateDnsZoneId')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/b4a7f6c1-585e-4177-ad5b-c2c93f4bb991",
                  "policy_group_names": null,
                  "reference_id": "DINE-Private-DNS-Azure-MediaServices-Stream"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId1\":{\"value\":\"[parameters('azureMonitorPrivateDnsZoneId1')]\"},\"privateDnsZoneId2\":{\"value\":\"[parameters('azureMonitorPrivateDnsZoneId2')]\"},\"privateDnsZoneId3\":{\"value\":\"[parameters('azureMonitorPrivateDnsZoneId3')]\"},\"privateDnsZoneId4\":{\"value\":\"[parameters('azureMonitorPrivateDnsZoneId4')]\"},\"privateDnsZoneId5\":{\"value\":\"[parameters('azureMonitorPrivateDnsZoneId5')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/437914ee-c176-4fff-8986-7e05eb971365",
                  "policy_group_names": null,
                  "reference_id": "DINE-Private-DNS-Azure-Monitor"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureWebPrivateDnsZoneId')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/0b026355-49cb-467b-8ac4-f777874e175a",
                  "policy_group_names": null,
                  "reference_id": "DINE-Private-DNS-Azure-Web"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureBatchPrivateDnsZoneId')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/4ec38ebc-381f-45ee-81a4-acbc4be878f8",
                  "policy_group_names": null,
                  "reference_id": "DINE-Private-DNS-Azure-Batch"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureAppPrivateDnsZoneId')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/7a860e27-9ca2-4fc6-822d-c2d248c300df",
                  "policy_group_names": null,
                  "reference_id": "DINE-Private-DNS-Azure-App"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureAsrPrivateDnsZoneId')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/942bd215-1a66-44be-af65-6a1c0318dbe2",
                  "policy_group_names": null,
                  "reference_id": "DINE-Private-DNS-Azure-Site-Recovery"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureIotPrivateDnsZoneId')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/aaa64d2d-2fa3-45e5-b332-0b031b9b30e8",
                  "policy_group_names": null,
                  "reference_id": "DINE-Private-DNS-Azure-IoT"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureKeyVaultPrivateDnsZoneId')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/ac673a9a-f77d-4846-b2d8-a57f8e1c01d4",
                  "policy_group_names": null,
                  "reference_id": "DINE-Private-DNS-Azure-KeyVault"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureSignalRPrivateDnsZoneId')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/b0e86710-7fb7-4a6c-a064-32e9b829509e",
                  "policy_group_names": null,
                  "reference_id": "DINE-Private-DNS-Azure-SignalR"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureAppServicesPrivateDnsZoneId')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/b318f84a-b872-429b-ac6d-a01b96814452",
                  "policy_group_names": null,
                  "reference_id": "DINE-Private-DNS-Azure-AppServices"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect1')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureEventGridTopicsPrivateDnsZoneId')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/baf19753-7502-405f-8745-370519b20483",
                  "policy_group_names": null,
                  "reference_id": "DINE-Private-DNS-Azure-EventGridTopics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureDiskAccessPrivateDnsZoneId')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/bc05b96c-0b36-4ca9-82f0-5c53f96ce05a",
                  "policy_group_names": null,
                  "reference_id": "DINE-Private-DNS-Azure-DiskAccess"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureCognitiveServicesPrivateDnsZoneId')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/c4bc6f10-cb41-49eb-b000-d5ab82e2a091",
                  "policy_group_names": null,
                  "reference_id": "DINE-Private-DNS-Azure-CognitiveServices"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect1')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureIotHubsPrivateDnsZoneId')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/c99ce9c1-ced7-4c3e-aca0-10e69ce0cb02",
                  "policy_group_names": null,
                  "reference_id": "DINE-Private-DNS-Azure-IoTHubs"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect1')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureEventGridDomainsPrivateDnsZoneId')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/d389df0a-e0d7-4607-833c-75a6fdac2c2d",
                  "policy_group_names": null,
                  "reference_id": "DINE-Private-DNS-Azure-EventGridDomains"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureRedisCachePrivateDnsZoneId')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/e016b22b-e0eb-436d-8fd7-160c4eaed6e2",
                  "policy_group_names": null,
                  "reference_id": "DINE-Private-DNS-Azure-RedisCache"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureAcrPrivateDnsZoneId')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/e9585a95-5b8c-4d03-b193-dc7eb5ac4c32",
                  "policy_group_names": null,
                  "reference_id": "DINE-Private-DNS-Azure-ACR"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureEventHubNamespacePrivateDnsZoneId')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/ed66d4f5-8220-45dc-ab4a-20d1749c74e6",
                  "policy_group_names": null,
                  "reference_id": "DINE-Private-DNS-Azure-EventHubNamespace"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureMachineLearningWorkspacePrivateDnsZoneId')]\"},\"secondPrivateDnsZoneId\":{\"value\":\"[parameters('azureMachineLearningWorkspaceSecondPrivateDnsZoneId')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/ee40564d-486e-4f68-a5ca-7a621edae0fb",
                  "policy_group_names": null,
                  "reference_id": "DINE-Private-DNS-Azure-MachineLearningWorkspace"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureServiceBusNamespacePrivateDnsZoneId')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/f0fcf93c-c063-4071-9668-c47474bd3564",
                  "policy_group_names": null,
                  "reference_id": "DINE-Private-DNS-Azure-ServiceBusNamespace"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureCognitiveSearchPrivateDnsZoneId')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/fbc14a67-53e4-4932-abcc-2049c6706009",
                  "policy_group_names": null,
                  "reference_id": "DINE-Private-DNS-Azure-CognitiveSearch"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureBotServicePrivateDnsZoneId')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/6a4e6f44-f2af-4082-9702-033c9e88b9f8",
                  "policy_group_names": null,
                  "reference_id": "DINE-Private-DNS-Azure-BotService"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureManagedGrafanaWorkspacePrivateDnsZoneId')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/4c8537f8-cd1b-49ec-b704-18e82a42fd58",
                  "policy_group_names": null,
                  "reference_id": "DINE-Private-DNS-Azure-ManagedGrafanaWorkspace"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureVirtualDesktopHostpoolPrivateDnsZoneId')]\"},\"privateEndpointGroupId\":{\"value\":\"connection\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/9427df23-0f42-4e1e-bf99-a6133d841c4a",
                  "policy_group_names": null,
                  "reference_id": "DINE-Private-DNS-Azure-VirtualDesktopHostpool"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureVirtualDesktopWorkspacePrivateDnsZoneId')]\"},\"privateEndpointGroupId\":{\"value\":\"feed\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/34804460-d88b-4922-a7ca-537165e060ed",
                  "policy_group_names": null,
                  "reference_id": "DINE-Private-DNS-Azure-VirtualDesktopWorkspace"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureIotDeviceupdatePrivateDnsZoneId')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/a222b93a-e6c2-4c01-817f-21e092455b2a",
                  "policy_group_names": null,
                  "reference_id": "DINE-Private-DNS-Azure-IoTDeviceupdate"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneIdForGuestConfiguration\":{\"value\":\"[parameters('azureArcGuestconfigurationPrivateDnsZoneId')]\"},\"privateDnsZoneIdForHybridResourceProvider\":{\"value\":\"[parameters('azureArcHybridResourceProviderPrivateDnsZoneId')]\"},\"privateDnsZoneIdForKubernetesConfiguration\":{\"value\":\"[parameters('azureArcKubernetesConfigurationPrivateDnsZoneId')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/55c4db33-97b0-437b-8469-c4f4498f5df9",
                  "policy_group_names": null,
                  "reference_id": "DINE-Private-DNS-Azure-Arc"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureIotCentralPrivateDnsZoneId')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/d627d7c6-ded5-481a-8f2e-7e16b1e6faf6",
                  "policy_group_names": null,
                  "reference_id": "DINE-Private-DNS-Azure-IoTCentral"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureStorageTablePrivateDnsZoneId')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/028bbd88-e9b5-461f-9424-a1b63a7bee1a",
                  "policy_group_names": null,
                  "reference_id": "DINE-Private-DNS-Azure-Storage-Table"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureStorageTableSecondaryPrivateDnsZoneId')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/c1d634a5-f73d-4cdd-889f-2cc7006eb47f",
                  "policy_group_names": null,
                  "reference_id": "DINE-Private-DNS-Azure-Storage-Table-Secondary"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZone-Backup\":{\"value\":\"[parameters('azureSiteRecoveryBackupPrivateDnsZoneID')]\"},\"privateDnsZone-Blob\":{\"value\":\"[parameters('azureSiteRecoveryBlobPrivateDnsZoneID')]\"},\"privateDnsZone-Queue\":{\"value\":\"[parameters('azureSiteRecoveryQueuePrivateDnsZoneID')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/af783da1-4ad1-42be-800d-d19c70038820",
                  "policy_group_names": null,
                  "reference_id": "DINE-Private-DNS-Azure-Site-Recovery-Backup"
                }
              ],
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "policy_definition_group": [],
              "policy_definition_reference": [
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {}
              ]
            }
          },
          {
            "address": "module.test_core.azurerm_policy_set_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Deploy-Sql-Security\"]",
            "mode": "managed",
            "type": "azurerm_policy_set_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Deploy-Sql-Security",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Deploy auditing, Alert, TDE and SQL vulnerability to SQL Databases when it not exist in the deployment. Superseded by https://www.azadvertizer.net/azpolicyinitiativesadvertizer/Deploy-Sql-Security_20240529.html",
              "display_name": "[Deprecated]: Deploy SQL Database built-in SQL security configuration",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"SQL\",\"deprecated\":true,\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"supersededBy\":\"Deploy-Sql-Security_20240529\",\"version\":\"1.0.0-deprecated\"}",
              "name": "Deploy-Sql-Security",
              "parameters": "{\"SqlDbAuditingSettingsDeploySqlSecurityEffect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploy auditing settings to SQL Database when it not exist in the deployment\",\"displayName\":\"Deploy SQL database auditing settings\"},\"type\":\"String\"},\"SqlDbSecurityAlertPoliciesDeploySqlSecurityEffect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploy the security Alert Policies configuration with email admin accounts when it not exist in current configuration\",\"displayName\":\"Deploy SQL Database security Alert Policies configuration with email admin accounts\"},\"type\":\"String\"},\"SqlDbTdeDeploySqlSecurityEffect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploy the Transparent Data Encryption when it is not enabled in the deployment\",\"displayName\":\"Deploy SQL Database Transparent Data Encryption \"},\"type\":\"String\"},\"SqlDbVulnerabilityAssessmentsDeploySqlSecurityEffect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploy SQL Database vulnerability Assessments when it not exist in the deployment. To the specific  storage account in the parameters\",\"displayName\":\"Deploy SQL Database vulnerability Assessments\"},\"type\":\"String\"},\"vulnerabilityAssessmentsEmail\":{\"metadata\":{\"description\":\"The email address to send alerts\",\"displayName\":\"The email address to send alerts\"},\"type\":\"String\"},\"vulnerabilityAssessmentsStorageID\":{\"metadata\":{\"description\":\"The storage account ID to store assessments\",\"displayName\":\"The storage account ID to store assessments\"},\"type\":\"String\"}}",
              "policy_definition_group": [],
              "policy_definition_reference": [
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('SqlDbTdeDeploySqlSecurityEffect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/86a912f6-9a06-4e26-b447-11b16ba8659f",
                  "policy_group_names": null,
                  "reference_id": "SqlDbTdeDeploySqlSecurity"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('SqlDbSecurityAlertPoliciesDeploySqlSecurityEffect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Sql-SecurityAlertPolicies",
                  "policy_group_names": null,
                  "reference_id": "SqlDbSecurityAlertPoliciesDeploySqlSecurity"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('SqlDbAuditingSettingsDeploySqlSecurityEffect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Sql-AuditingSettings",
                  "policy_group_names": null,
                  "reference_id": "SqlDbAuditingSettingsDeploySqlSecurity"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('SqlDbVulnerabilityAssessmentsDeploySqlSecurityEffect')]\"},\"vulnerabilityAssessmentsEmail\":{\"value\":\"[parameters('vulnerabilityAssessmentsEmail')]\"},\"vulnerabilityAssessmentsStorageID\":{\"value\":\"[parameters('vulnerabilityAssessmentsStorageID')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Sql-vulnerabilityAssessments",
                  "policy_group_names": null,
                  "reference_id": "SqlDbVulnerabilityAssessmentsDeploySqlSecurity"
                }
              ],
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "policy_definition_group": [],
              "policy_definition_reference": [
                {},
                {},
                {},
                {}
              ]
            }
          },
          {
            "address": "module.test_core.azurerm_policy_set_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Deploy-Sql-Security_20240529\"]",
            "mode": "managed",
            "type": "azurerm_policy_set_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Deploy-Sql-Security_20240529",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Deploy auditing, Alert, TDE and SQL vulnerability to SQL Databases when it not exist in the deployment",
              "display_name": "Deploy SQL Database built-in SQL security configuration",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"SQL\",\"replacesPolicy\":\"Deploy-Sql-Security\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.0\"}",
              "name": "Deploy-Sql-Security_20240529",
              "parameters": "{\"SqlDbAuditingSettingsDeploySqlSecurityEffect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploy auditing settings to SQL Database when it not exist in the deployment\",\"displayName\":\"Deploy SQL database auditing settings\"},\"type\":\"String\"},\"SqlDbSecurityAlertPoliciesDeploySqlSecurityEffect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploy the security Alert Policies configuration with email admin accounts when it not exist in current configuration\",\"displayName\":\"Deploy SQL Database security Alert Policies configuration with email admin accounts\"},\"type\":\"String\"},\"SqlDbTdeDeploySqlSecurityEffect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploy the Transparent Data Encryption when it is not enabled in the deployment\",\"displayName\":\"Deploy SQL Database Transparent Data Encryption \"},\"type\":\"String\"},\"SqlDbVulnerabilityAssessmentsDeploySqlSecurityEffect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploy SQL Database vulnerability Assessments when it not exist in the deployment. To the specific  storage account in the parameters\",\"displayName\":\"Deploy SQL Database vulnerability Assessments\"},\"type\":\"String\"},\"vulnerabilityAssessmentsEmail\":{\"metadata\":{\"description\":\"The email address to send alerts\",\"displayName\":\"The email address to send alerts\"},\"type\":\"Array\"},\"vulnerabilityAssessmentsStorageID\":{\"metadata\":{\"description\":\"The storage account ID to store assessments\",\"displayName\":\"The storage account ID to store assessments\"},\"type\":\"String\"}}",
              "policy_definition_group": [],
              "policy_definition_reference": [
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('SqlDbTdeDeploySqlSecurityEffect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/86a912f6-9a06-4e26-b447-11b16ba8659f",
                  "policy_group_names": null,
                  "reference_id": "SqlDbTdeDeploySqlSecurity"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('SqlDbSecurityAlertPoliciesDeploySqlSecurityEffect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Sql-SecurityAlertPolicies",
                  "policy_group_names": null,
                  "reference_id": "SqlDbSecurityAlertPoliciesDeploySqlSecurity"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('SqlDbAuditingSettingsDeploySqlSecurityEffect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Sql-AuditingSettings",
                  "policy_group_names": null,
                  "reference_id": "SqlDbAuditingSettingsDeploySqlSecurity"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('SqlDbVulnerabilityAssessmentsDeploySqlSecurityEffect')]\"},\"vulnerabilityAssessmentsEmail\":{\"value\":\"[parameters('vulnerabilityAssessmentsEmail')]\"},\"vulnerabilityAssessmentsStorageID\":{\"value\":\"[parameters('vulnerabilityAssessmentsStorageID')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Sql-vulnerabilityAssessments_20230706",
                  "policy_group_names": null,
                  "reference_id": "SqlDbVulnerabilityAssessmentsDeploySqlSecurity"
                }
              ],
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "policy_definition_group": [],
              "policy_definition_reference": [
                {},
                {},
                {},
                {}
              ]
            }
          },
          {
            "address": "module.test_core.azurerm_policy_set_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Enforce-ACSB\"]",
            "mode": "managed",
            "type": "azurerm_policy_set_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Enforce-ACSB",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Enforce Azure Compute Security Benchmark compliance auditing for Windows and Linux virtual machines.",
              "display_name": "Enforce Azure Compute Security Benchmark compliance auditing",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\"],\"category\":\"Guest Configuration\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.0\"}",
              "name": "Enforce-ACSB",
              "parameters": "{\"effect\":{\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"includeArcMachines\":{\"allowedValues\":[\"true\",\"false\"],\"defaultValue\":\"true\",\"metadata\":{\"description\":\"By selecting this option, you agree to be charged monthly per Arc connected machine.\",\"displayName\":\"Include Arc connected servers\"},\"type\":\"String\"}}",
              "policy_definition_group": [],
              "policy_definition_reference": [
                {
                  "parameter_values": "{}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/3cf2ab00-13f1-4d0c-8971-2ac904541a7e",
                  "policy_group_names": null,
                  "reference_id": "GcIdentity"
                },
                {
                  "parameter_values": "{}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/331e8ea8-378a-410f-a2e5-ae22f38bb0da",
                  "policy_group_names": null,
                  "reference_id": "GcLinux"
                },
                {
                  "parameter_values": "{}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/385f5831-96d4-41db-9a3c-cd3af78aaae6",
                  "policy_group_names": null,
                  "reference_id": "GcWindows"
                },
                {
                  "parameter_values": "{\"IncludeArcMachines\":{\"value\":\"[parameters('includeArcMachines')]\"},\"effect\":{\"value\":\"[parameters('effect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/72650e9f-97bc-4b2a-ab5f-9781a9fcecbc",
                  "policy_group_names": null,
                  "reference_id": "WinAcsb"
                },
                {
                  "parameter_values": "{\"IncludeArcMachines\":{\"value\":\"[parameters('includeArcMachines')]\"},\"effect\":{\"value\":\"[parameters('effect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/fc9b3da7-8347-4380-8e70-0a0361d8dedd",
                  "policy_group_names": null,
                  "reference_id": "LinAcsb"
                }
              ],
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "policy_definition_group": [],
              "policy_definition_reference": [
                {},
                {},
                {},
                {},
                {}
              ]
            }
          },
          {
            "address": "module.test_core.azurerm_policy_set_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Enforce-ALZ-Decomm\"]",
            "mode": "managed",
            "type": "azurerm_policy_set_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Enforce-ALZ-Decomm",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Enforce policies in the Decommissioned Landing Zone.",
              "display_name": "Enforce policies in the Decommissioned Landing Zone",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Decommissioned\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.0\"}",
              "name": "Enforce-ALZ-Decomm",
              "parameters": "{\"listOfResourceTypesAllowed\":{\"defaultValue\":[],\"metadata\":{\"description\":\"Allowed resource types in the Decommissioned landing zone, default is none.\",\"displayName\":\"Allowed resource types in the Decommissioned landing zone\",\"strongType\":\"resourceTypes\"},\"type\":\"Array\"}}",
              "policy_definition_group": [],
              "policy_definition_reference": [
                {
                  "parameter_values": "{\"listOfResourceTypesAllowed\":{\"value\":\"[parameters('listOfResourceTypesAllowed')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/a08ec900-254a-4555-9bf5-e42af04b5c5c",
                  "policy_group_names": null,
                  "reference_id": "DecomDenyResources"
                },
                {
                  "parameter_values": "{}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Vm-autoShutdown",
                  "policy_group_names": null,
                  "reference_id": "DecomShutdownMachines"
                }
              ],
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "policy_definition_group": [],
              "policy_definition_reference": [
                {},
                {}
              ]
            }
          },
          {
            "address": "module.test_core.azurerm_policy_set_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Enforce-ALZ-Sandbox\"]",
            "mode": "managed",
            "type": "azurerm_policy_set_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Enforce-ALZ-Sandbox",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Enforce policies in the Sandbox Landing Zone.",
              "display_name": "Enforce policies in the Sandbox Landing Zone",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Sandbox\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.0\"}",
              "name": "Enforce-ALZ-Sandbox",
              "parameters": "{\"effectDenyVnetPeering\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"effectNotAllowedResources\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"listOfResourceTypesNotAllowed\":{\"defaultValue\":[],\"metadata\":{\"description\":\"Not allowed resource types in the Sandbox landing zone, default is none.\",\"displayName\":\"Not allowed resource types in the Sandbox landing zone\",\"strongType\":\"resourceTypes\"},\"type\":\"Array\"}}",
              "policy_definition_group": [],
              "policy_definition_reference": [
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('effectNotAllowedResources')]\"},\"listOfResourceTypesNotAllowed\":{\"value\":\"[parameters('listOfResourceTypesNotAllowed')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/6c112d4e-5bc7-47ae-a041-ea2d9dccd749",
                  "policy_group_names": null,
                  "reference_id": "SandboxNotAllowed"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('effectDenyVnetPeering')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-VNET-Peer-Cross-Sub",
                  "policy_group_names": null,
                  "reference_id": "SandboxDenyVnetPeering"
                }
              ],
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "policy_definition_group": [],
              "policy_definition_reference": [
                {},
                {}
              ]
            }
          },
          {
            "address": "module.test_core.azurerm_policy_set_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Backup\"]",
            "mode": "managed",
            "type": "azurerm_policy_set_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Backup",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Enforce enhanced recovery and backup policies on assigned scopes.",
              "display_name": "Enforce enhanced recovery and backup policies",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Backup\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.0\"}",
              "name": "Enforce-Backup",
              "parameters": "{\"checkAlwaysOnSoftDeleteOnly\":{\"allowedValues\":[true,false],\"defaultValue\":false,\"metadata\":{\"description\":\"This parameter checks if Soft Delete is 'Locked' for Backup Vaults in scope. Selecting 'true' will mark only vaults with Soft Delete 'AlwaysOn' as compliant. Selecting 'false' will mark vaults that have Soft Delete either 'On' or 'AlwaysOn' as compliant.\",\"displayName\":\"CheckAlwaysOnSoftDeleteOnly\"},\"type\":\"Boolean\"},\"checkLockedImmutabilityOnly\":{\"allowedValues\":[true,false],\"defaultValue\":false,\"metadata\":{\"description\":\"This parameter checks if Immutability is locked for Backup Vaults in scope. Selecting 'true' will mark only vaults with Immutability 'Locked' as compliant. Selecting 'false' will mark vaults that have Immutability either 'Enabled' or 'Locked' as compliant.\",\"displayName\":\"checkLockedImmutabilityOnly\"},\"type\":\"Boolean\"},\"effect\":{\"allowedValues\":[\"Audit\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy.\",\"displayName\":\"Effect\"},\"type\":\"String\"}}",
              "policy_definition_group": [],
              "policy_definition_reference": [
                {
                  "parameter_values": "{\"CheckLockedImmutabiltyOnly\":{\"value\":\"[parameters('checkLockedImmutabilityOnly')]\"},\"effect\":{\"value\":\"[parameters('effect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/2514263b-bc0d-4b06-ac3e-f262c0979018",
                  "policy_group_names": null,
                  "reference_id": "BackupBVault-Immutability"
                },
                {
                  "parameter_values": "{\"checkLockedImmutabilityOnly\":{\"value\":\"[parameters('checkLockedImmutabilityOnly')]\"},\"effect\":{\"value\":\"[parameters('effect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/d6f6f560-14b7-49a4-9fc8-d2c3a9807868",
                  "policy_group_names": null,
                  "reference_id": "BackupRVault-Immutability"
                },
                {
                  "parameter_values": "{\"checkAlwaysOnSoftDeleteOnly\":{\"value\":\"[parameters('checkAlwaysOnSoftDeleteOnly')]\"},\"effect\":{\"value\":\"[parameters('effect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/9798d31d-6028-4dee-8643-46102185c016",
                  "policy_group_names": null,
                  "reference_id": "BackupBVault-SoftDelete"
                },
                {
                  "parameter_values": "{\"checkAlwaysOnSoftDeleteOnly\":{\"value\":\"[parameters('checkAlwaysOnSoftDeleteOnly')]\"},\"effect\":{\"value\":\"[parameters('effect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/31b8092a-36b8-434b-9af7-5ec844364148",
                  "policy_group_names": null,
                  "reference_id": "BackupRVault-SoftDelete"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/c58e083e-7982-4e24-afdc-be14d312389e",
                  "policy_group_names": null,
                  "reference_id": "BackupBVault-MUA"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/c7031eab-0fc0-4cd9-acd0-4497bd66d91a",
                  "policy_group_names": null,
                  "reference_id": "BackupRVault-MUA"
                }
              ],
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "policy_definition_group": [],
              "policy_definition_reference": [
                {},
                {},
                {},
                {},
                {},
                {}
              ]
            }
          },
          {
            "address": "module.test_core.azurerm_policy_set_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Enforce-EncryptTransit\"]",
            "mode": "managed",
            "type": "azurerm_policy_set_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Enforce-EncryptTransit",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Choose either Deploy if not exist and append in combination with audit or Select Deny in the Policy effect. Superseded by https://www.azadvertizer.net/azpolicyinitiativesadvertizer/Enforce-EncryptTransit_20240509.html",
              "display_name": "[Deprecated]: Deny or Deploy and append TLS requirements and SSL enforcement on resources without Encryption in transit",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Encryption\",\"deprecated\":true,\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"supersededBy\":\"Enforce-EncryptTransit_20240509\",\"version\":\"2.1.0-deprecated\"}",
              "name": "Enforce-EncryptTransit",
              "parameters": "{\"AKSIngressHttpsOnlyEffect\":{\"allowedValues\":[\"audit\",\"deny\",\"disabled\"],\"defaultValue\":\"deny\",\"metadata\":{\"description\":\"This policy enforces HTTPS ingress in a Kubernetes cluster. This policy is generally available for Kubernetes Service (AKS), and preview for AKS Engine and Azure Arc enabled Kubernetes. For instructions on using this policy, visit https://aka.ms/kubepolicydoc.\",\"displayName\":\"AKS Service. Enforce HTTPS ingress in Kubernetes cluster\"},\"type\":\"String\"},\"APIAppServiceHttpsEffect\":{\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Choose Deny or Audit in combination with Append policy. Use of HTTPS ensures server/service authentication and protects data in transit from network layer eavesdropping attacks.\",\"displayName\":\"App Service API App. API App should only be accessible over HTTPS. Choose Deny or Audit in combination with Append policy.\"},\"type\":\"String\"},\"AppServiceHttpEffect\":{\"allowedValues\":[\"Append\",\"Disabled\"],\"defaultValue\":\"Append\",\"metadata\":{\"description\":\"Append the AppService sites object to ensure that min Tls version is set to required TLS version. Please note Append does not enforce compliance use then deny.\",\"displayName\":\"App Service. Appends the AppService sites config WebApp, APIApp, Function App with TLS version selected below\"},\"type\":\"String\"},\"AppServiceTlsVersionEffect\":{\"allowedValues\":[\"Append\",\"Disabled\"],\"defaultValue\":\"Append\",\"metadata\":{\"description\":\"App Service. Appends the AppService sites object to ensure that  HTTPS only is enabled for  server/service authentication and protects data in transit from network layer eavesdropping attacks. Please note Append does not enforce compliance use then deny.\",\"displayName\":\"App Service. Appends the AppService WebApp, APIApp, Function App to enable https only\"},\"type\":\"String\"},\"AppServiceminTlsVersion\":{\"allowedValues\":[\"1.2\",\"1.0\",\"1.1\"],\"defaultValue\":\"1.2\",\"metadata\":{\"description\":\"App Service. Select version  minimum TLS version for a  Web App config to enforce\",\"displayName\":\"App Service. Select version minimum TLS Web App config\"},\"type\":\"String\"},\"ContainerAppsHttpsOnlyEffect\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Use of HTTPS ensures server/service authentication and protects data in transit from network layer eavesdropping attacks. Disabling 'allowInsecure' will result in the automatic redirection of requests from HTTP to HTTPS connections for container apps.\",\"displayName\":\"Container Apps should only be accessible over HTTPS\"},\"type\":\"String\"},\"FunctionLatestTlsEffect\":{\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Only Audit, deny not possible as it is a related resource. Upgrade to the latest TLS version.\",\"displayName\":\"App Service Function App. Latest TLS version should be used in your Function App\"},\"type\":\"String\"},\"FunctionServiceHttpsEffect\":{\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"App Service Function App. Choose Deny or Audit in combination with Append policy. Use of HTTPS ensures server/service authentication and protects data in transit from network layer eavesdropping attacks.\",\"displayName\":\"App Service Function App. Function App should only be accessible over HTTPS. Choose Deny or Audit in combination with Append policy.\"},\"type\":\"String\"},\"MySQLEnableSSLDeployEffect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploy a specific min TLS version requirement and enforce SSL on Azure Database for MySQL server. Enforce the Server to client applications using minimum version of Tls to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.\",\"displayName\":\"MySQL database servers. Deploy if not exist set minimum TLS version Azure Database for MySQL server\"},\"type\":\"String\"},\"MySQLEnableSSLEffect\":{\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Azure Database for MySQL supports connecting your Azure Database for MySQL server to client applications using Secure Sockets Layer (SSL). Enforcing SSL connections between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.\",\"displayName\":\"MySQL database servers. Enforce SSL connection should be enabled for MySQL database servers\"},\"type\":\"String\"},\"MySQLminimalTlsVersion\":{\"allowedValues\":[\"TLS1_2\",\"TLS1_0\",\"TLS1_1\",\"TLSEnforcementDisabled\"],\"defaultValue\":\"TLS1_2\",\"metadata\":{\"description\":\"Select version  minimum TLS version Azure Database for MySQL server to enforce\",\"displayName\":\"MySQL database servers. Select version minimum TLS for MySQL server\"},\"type\":\"String\"},\"PostgreSQLEnableSSLDeployEffect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploy a specific min TLS version requirement and enforce SSL on Azure Database for PostgreSQL server. Enforce the Server to client applications using minimum version of Tls to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.\",\"displayName\":\"PostgreSQL database servers. Deploy if not exist set minimum TLS version Azure Database for PostgreSQL server\"},\"type\":\"String\"},\"PostgreSQLEnableSSLEffect\":{\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Azure Database for PostgreSQL supports connecting your Azure Database for PostgreSQL server to client applications using Secure Sockets Layer (SSL). Enforcing SSL connections between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.\",\"displayName\":\"PostgreSQL database servers. Enforce SSL connection should be enabled for PostgreSQL database servers\"},\"type\":\"String\"},\"PostgreSQLminimalTlsVersion\":{\"allowedValues\":[\"TLS1_2\",\"TLS1_0\",\"TLS1_1\",\"TLSEnforcementDisabled\"],\"defaultValue\":\"TLS1_2\",\"metadata\":{\"description\":\"PostgreSQL database servers. Select version  minimum TLS version Azure Database for MySQL server to enforce\",\"displayName\":\"PostgreSQL database servers. Select version minimum TLS for MySQL server\"},\"type\":\"String\"},\"RedisMinTlsVersion\":{\"allowedValues\":[\"1.2\",\"1.0\",\"1.1\"],\"defaultValue\":\"1.2\",\"metadata\":{\"description\":\"Select version  minimum TLS version for a Azure Cache for Redis to enforce\",\"displayName\":\"Azure Cache for Redis.Select version minimum TLS for Azure Cache for Redis\"},\"type\":\"String\"},\"RedisTLSDeployEffect\":{\"allowedValues\":[\"Append\",\"Disabled\"],\"defaultValue\":\"Append\",\"metadata\":{\"description\":\"Deploy a specific min TLS version requirement and enforce SSL on Azure Cache for Redis. Enables secure server to client by enforce  minimal Tls Version to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.\",\"displayName\":\"Azure Cache for Redis. Deploy a specific min TLS version requirement and enforce SSL Azure Cache for Redis\"},\"type\":\"String\"},\"RedisTLSEffect\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Azure Cache for Redis. Audit enabling of only connections via SSL to Azure Cache for Redis. Use of secure connections ensures authentication between the server and the service and protects data in transit from network layer attacks such as man-in-the-middle, eavesdropping, and session-hijacking.\",\"displayName\":\"Azure Cache for Redis. Only secure connections to your Azure Cache for Redis should be enabled\"},\"type\":\"String\"},\"SQLManagedInstanceMinTlsVersion\":{\"allowedValues\":[\"1.2\",\"1.0\",\"1.1\"],\"defaultValue\":\"1.2\",\"metadata\":{\"description\":\"Select version  minimum TLS version for Azure Managed Instanceto to  enforce\",\"displayName\":\"Azure Managed Instance.Select version minimum TLS for Azure Managed Instance\"},\"type\":\"String\"},\"SQLManagedInstanceTLSDeployEffect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploy a specific min TLS version requirement and enforce SSL on SQL servers. Enables secure server to client by enforce  minimal Tls Version to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.\",\"displayName\":\"Azure Managed Instance. Deploy a specific min TLS version requirement and enforce SSL on SQL servers\"},\"type\":\"String\"},\"SQLManagedInstanceTLSEffect\":{\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Setting minimal TLS version to 1.2 improves security by ensuring your SQL Managed Instance can only be accessed from clients using TLS 1.2. Using versions of TLS less than 1.2 is not recommended since they have well documented security vulnerabilities.\",\"displayName\":\"SQL Managed Instance should have the minimal TLS version of 1.2\"},\"type\":\"String\"},\"SQLServerTLSDeployEffect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploy a specific min TLS version requirement and enforce SSL on SQL servers. Enables secure server to client by enforce  minimal Tls Version to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.\",\"displayName\":\"Azure SQL Database. Deploy a specific min TLS version requirement and enforce SSL on SQL servers\"},\"type\":\"String\"},\"SQLServerTLSEffect\":{\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Setting minimal TLS version to 1.2 improves security by ensuring your Azure SQL Database can only be accessed from clients using TLS 1.2. Using versions of TLS less than 1.2 is not recommended since they have well documented security vulnerabilities.\",\"displayName\":\"Azure SQL Database should have the minimal TLS version of 1.2\"},\"type\":\"String\"},\"SQLServerminTlsVersion\":{\"allowedValues\":[\"1.2\",\"1.0\",\"1.1\"],\"defaultValue\":\"1.2\",\"metadata\":{\"description\":\"Select version  minimum TLS version for Azure SQL Database to enforce\",\"displayName\":\"Azure SQL Database.Select version minimum TLS for Azure SQL Database\"},\"type\":\"String\"},\"StorageDeployHttpsEnabledEffect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Audit requirement of Secure transfer in your storage account. Secure transfer is an option that forces your storage account to accept requests only from secure connections (HTTPS). Use of HTTPS ensures authentication between the server and the service and protects data in transit from network layer attacks such as man-in-the-middle, eavesdropping, and session-hijacking\",\"displayName\":\"Azure Storage Account. Deploy Secure transfer to storage accounts should be enabled\"},\"type\":\"String\"},\"StorageHttpsEnabledEffect\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Audit requirement of Secure transfer in your storage account. Secure transfer is an option that forces your storage account to accept requests only from secure connections (HTTPS). Use of HTTPS ensures authentication between the server and the service and protects data in transit from network layer attacks such as man-in-the-middle, eavesdropping, and session-hijacking\",\"displayName\":\"Azure Storage Account. Secure transfer to storage accounts should be enabled\"},\"type\":\"String\"},\"StorageminimumTlsVersion\":{\"allowedValues\":[\"TLS1_2\",\"TLS1_1\",\"TLS1_0\"],\"defaultValue\":\"TLS1_2\",\"metadata\":{\"description\":\"Select version  minimum TLS version on Azure Storage Account to enforce\",\"displayName\":\"Storage Account select minimum TLS version\"},\"type\":\"String\"},\"WebAppServiceHttpsEffect\":{\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Choose Deny or Audit in combination with Append policy. Use of HTTPS ensures server/service authentication and protects data in transit from network layer eavesdropping attacks.\",\"displayName\":\"App Service Web App. Web Application should only be accessible over HTTPS. Choose Deny or Audit in combination with Append policy.\"},\"type\":\"String\"},\"WebAppServiceLatestTlsEffect\":{\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Only Audit, deny not possible as it is a related resource. Upgrade to the latest TLS version.\",\"displayName\":\"App Service Web App. Latest TLS version should be used in your Web App\"},\"type\":\"String\"}}",
              "policy_definition_group": [],
              "policy_definition_reference": [
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('AppServiceHttpEffect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Append-AppService-httpsonly",
                  "policy_group_names": null,
                  "reference_id": "AppServiceHttpEffect"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('AppServiceTlsVersionEffect')]\"},\"minTlsVersion\":{\"value\":\"[parameters('AppServiceminTlsVersion')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Append-AppService-latestTLS",
                  "policy_group_names": null,
                  "reference_id": "AppServiceminTlsVersion"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('FunctionLatestTlsEffect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/f9d614c5-c173-4d56-95a7-b4437057d193",
                  "policy_group_names": null,
                  "reference_id": "FunctionLatestTlsEffect"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('WebAppServiceLatestTlsEffect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/f0e6e85b-9b9f-4a4b-b67b-f730d42f1b0b",
                  "policy_group_names": null,
                  "reference_id": "WebAppServiceLatestTlsEffect"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('APIAppServiceHttpsEffect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-AppServiceApiApp-http",
                  "policy_group_names": null,
                  "reference_id": "APIAppServiceHttpsEffect"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('FunctionServiceHttpsEffect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-AppServiceFunctionApp-http",
                  "policy_group_names": null,
                  "reference_id": "FunctionServiceHttpsEffect"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('WebAppServiceHttpsEffect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-AppServiceWebApp-http",
                  "policy_group_names": null,
                  "reference_id": "WebAppServiceHttpsEffect"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('AKSIngressHttpsOnlyEffect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/1a5b4dca-0b6f-4cf5-907c-56316bc1bf3d",
                  "policy_group_names": null,
                  "reference_id": "AKSIngressHttpsOnlyEffect"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('MySQLEnableSSLDeployEffect')]\"},\"minimalTlsVersion\":{\"value\":\"[parameters('MySQLminimalTlsVersion')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-MySQL-sslEnforcement",
                  "policy_group_names": null,
                  "reference_id": "MySQLEnableSSLDeployEffect"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('MySQLEnableSSLEffect')]\"},\"minimalTlsVersion\":{\"value\":\"[parameters('MySQLminimalTlsVersion')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-MySql-http",
                  "policy_group_names": null,
                  "reference_id": "MySQLEnableSSLEffect"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('PostgreSQLEnableSSLDeployEffect')]\"},\"minimalTlsVersion\":{\"value\":\"[parameters('PostgreSQLminimalTlsVersion')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-PostgreSQL-sslEnforcement",
                  "policy_group_names": null,
                  "reference_id": "PostgreSQLEnableSSLDeployEffect"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('PostgreSQLEnableSSLEffect')]\"},\"minimalTlsVersion\":{\"value\":\"[parameters('PostgreSQLminimalTlsVersion')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-PostgreSql-http",
                  "policy_group_names": null,
                  "reference_id": "PostgreSQLEnableSSLEffect"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('RedisTLSDeployEffect')]\"},\"minimumTlsVersion\":{\"value\":\"[parameters('RedisMinTlsVersion')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Append-Redis-sslEnforcement",
                  "policy_group_names": null,
                  "reference_id": "RedisTLSDeployEffect"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('RedisTLSDeployEffect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Append-Redis-disableNonSslPort",
                  "policy_group_names": null,
                  "reference_id": "RedisdisableNonSslPort"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('RedisTLSEffect')]\"},\"minimumTlsVersion\":{\"value\":\"[parameters('RedisMinTlsVersion')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-Redis-http",
                  "policy_group_names": null,
                  "reference_id": "RedisDenyhttps"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('SQLManagedInstanceTLSDeployEffect')]\"},\"minimalTlsVersion\":{\"value\":\"[parameters('SQLManagedInstanceMinTlsVersion')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-SqlMi-minTLS",
                  "policy_group_names": null,
                  "reference_id": "SQLManagedInstanceTLSDeployEffect"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('SQLManagedInstanceTLSEffect')]\"},\"minimalTlsVersion\":{\"value\":\"[parameters('SQLManagedInstanceMinTlsVersion')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-SqlMi-minTLS",
                  "policy_group_names": null,
                  "reference_id": "SQLManagedInstanceTLSEffect"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('SQLServerTLSDeployEffect')]\"},\"minimalTlsVersion\":{\"value\":\"[parameters('SQLServerminTlsVersion')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-SQL-minTLS",
                  "policy_group_names": null,
                  "reference_id": "SQLServerTLSDeployEffect"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('SQLServerTLSEffect')]\"},\"minimalTlsVersion\":{\"value\":\"[parameters('SQLServerminTlsVersion')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-Sql-minTLS",
                  "policy_group_names": null,
                  "reference_id": "SQLServerTLSEffect"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('StorageHttpsEnabledEffect')]\"},\"minimumTlsVersion\":{\"value\":\"[parameters('StorageMinimumTlsVersion')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-Storage-minTLS",
                  "policy_group_names": null,
                  "reference_id": "StorageHttpsEnabledEffect"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('StorageDeployHttpsEnabledEffect')]\"},\"minimumTlsVersion\":{\"value\":\"[parameters('StorageMinimumTlsVersion')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Storage-sslEnforcement",
                  "policy_group_names": null,
                  "reference_id": "StorageDeployHttpsEnabledEffect"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('ContainerAppsHttpsOnlyEffect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/0e80e269-43a4-4ae9-b5bc-178126b8a5cb",
                  "policy_group_names": null,
                  "reference_id": "ContainerAppsHttpsOnlyEffect"
                }
              ],
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "policy_definition_group": [],
              "policy_definition_reference": [
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {}
              ]
            }
          },
          {
            "address": "module.test_core.azurerm_policy_set_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Enforce-EncryptTransit_20240509\"]",
            "mode": "managed",
            "type": "azurerm_policy_set_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Enforce-EncryptTransit_20240509",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Choose either Deploy if not exist and append in combination with audit or Select Deny in the Policy effect. Deny polices shift left. Deploy if not exist and append enforce but can be changed, and because missing existence condition require then the combination of Audit. ",
              "display_name": "Deny or Deploy and append TLS requirements and SSL enforcement on resources without Encryption in transit",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Encryption\",\"replacesPolicy\":\"Enforce-EncryptTransit\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.0\"}",
              "name": "Enforce-EncryptTransit_20240509",
              "parameters": "{\"AKSIngressHttpsOnlyEffect\":{\"allowedValues\":[\"audit\",\"deny\",\"disabled\"],\"defaultValue\":\"deny\",\"metadata\":{\"description\":\"This policy enforces HTTPS ingress in a Kubernetes cluster. This policy is generally available for Kubernetes Service (AKS), and preview for AKS Engine and Azure Arc enabled Kubernetes. For instructions on using this policy, visit https://aka.ms/kubepolicydoc.\",\"displayName\":\"AKS Service. Enforce HTTPS ingress in Kubernetes cluster\"},\"type\":\"String\"},\"APIAppServiceHttpsEffect\":{\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Choose Deny or Audit in combination with Append policy. Use of HTTPS ensures server/service authentication and protects data in transit from network layer eavesdropping attacks.\",\"displayName\":\"App Service API App. API App should only be accessible over HTTPS. Choose Deny or Audit in combination with Append policy.\"},\"type\":\"String\"},\"AppServiceHttpEffect\":{\"allowedValues\":[\"Append\",\"Disabled\"],\"defaultValue\":\"Append\",\"metadata\":{\"description\":\"Append the AppService sites object to ensure that min Tls version is set to required TLS version. Please note Append does not enforce compliance use then deny.\",\"displayName\":\"App Service. Appends the AppService sites config WebApp, APIApp, Function App with TLS version selected below\"},\"type\":\"String\"},\"AppServiceTlsVersionEffect\":{\"allowedValues\":[\"Append\",\"Disabled\"],\"defaultValue\":\"Append\",\"metadata\":{\"description\":\"App Service. Appends the AppService sites object to ensure that  HTTPS only is enabled for  server/service authentication and protects data in transit from network layer eavesdropping attacks. Please note Append does not enforce compliance use then deny.\",\"displayName\":\"App Service. Appends the AppService WebApp, APIApp, Function App to enable https only\"},\"type\":\"String\"},\"AppServiceminTlsVersion\":{\"allowedValues\":[\"1.2\",\"1.0\",\"1.1\"],\"defaultValue\":\"1.2\",\"metadata\":{\"description\":\"App Service. Select version  minimum TLS version for a  Web App config to enforce\",\"displayName\":\"App Service. Select version minimum TLS Web App config\"},\"type\":\"String\"},\"ContainerAppsHttpsOnlyEffect\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Use of HTTPS ensures server/service authentication and protects data in transit from network layer eavesdropping attacks. Disabling 'allowInsecure' will result in the automatic redirection of requests from HTTP to HTTPS connections for container apps.\",\"displayName\":\"Container Apps should only be accessible over HTTPS\"},\"type\":\"String\"},\"FunctionAppTlsEffect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"App Service Function App. Periodically, newer versions are released for TLS either due to security flaws, include additional functionality, and enhance speed. Upgrade to the latest TLS version for Function apps to take advantage of security fixes, if any, and/or new functionalities of the latest version.\",\"displayName\":\"App Service Function App. Configure Function apps to use the latest TLS version.\"},\"type\":\"string\"},\"FunctionLatestTlsEffect\":{\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Only Audit, deny not possible as it is a related resource. Upgrade to the latest TLS version.\",\"displayName\":\"App Service Function App. Latest TLS version should be used in your Function App\"},\"type\":\"String\"},\"FunctionServiceHttpsEffect\":{\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"App Service Function App. Choose Deny or Audit in combination with Append policy. Use of HTTPS ensures server/service authentication and protects data in transit from network layer eavesdropping attacks.\",\"displayName\":\"App Service Function App. Function App should only be accessible over HTTPS. Choose Deny or Audit in combination with Append policy.\"},\"type\":\"String\"},\"LogicAppTlsEffect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"type\":\"string\"},\"MySQLEnableSSLDeployEffect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploy a specific min TLS version requirement and enforce SSL on Azure Database for MySQL server. Enforce the Server to client applications using minimum version of Tls to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.\",\"displayName\":\"MySQL database servers. Deploy if not exist set minimum TLS version Azure Database for MySQL server\"},\"type\":\"String\"},\"MySQLEnableSSLEffect\":{\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Azure Database for MySQL supports connecting your Azure Database for MySQL server to client applications using Secure Sockets Layer (SSL). Enforcing SSL connections between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.\",\"displayName\":\"MySQL database servers. Enforce SSL connection should be enabled for MySQL database servers\"},\"type\":\"String\"},\"MySQLminimalTlsVersion\":{\"allowedValues\":[\"TLS1_2\",\"TLS1_0\",\"TLS1_1\",\"TLSEnforcementDisabled\"],\"defaultValue\":\"TLS1_2\",\"metadata\":{\"description\":\"Select version  minimum TLS version Azure Database for MySQL server to enforce\",\"displayName\":\"MySQL database servers. Select version minimum TLS for MySQL server\"},\"type\":\"String\"},\"PostgreSQLEnableSSLDeployEffect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploy a specific min TLS version requirement and enforce SSL on Azure Database for PostgreSQL server. Enforce the Server to client applications using minimum version of Tls to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.\",\"displayName\":\"PostgreSQL database servers. Deploy if not exist set minimum TLS version Azure Database for PostgreSQL server\"},\"type\":\"String\"},\"PostgreSQLEnableSSLEffect\":{\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Azure Database for PostgreSQL supports connecting your Azure Database for PostgreSQL server to client applications using Secure Sockets Layer (SSL). Enforcing SSL connections between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.\",\"displayName\":\"PostgreSQL database servers. Enforce SSL connection should be enabled for PostgreSQL database servers\"},\"type\":\"String\"},\"PostgreSQLminimalTlsVersion\":{\"allowedValues\":[\"TLS1_2\",\"TLS1_0\",\"TLS1_1\",\"TLSEnforcementDisabled\"],\"defaultValue\":\"TLS1_2\",\"metadata\":{\"description\":\"PostgreSQL database servers. Select version  minimum TLS version Azure Database for MySQL server to enforce\",\"displayName\":\"PostgreSQL database servers. Select version minimum TLS for MySQL server\"},\"type\":\"String\"},\"RedisMinTlsVersion\":{\"allowedValues\":[\"1.2\",\"1.0\",\"1.1\"],\"defaultValue\":\"1.2\",\"metadata\":{\"description\":\"Select version  minimum TLS version for a Azure Cache for Redis to enforce\",\"displayName\":\"Azure Cache for Redis.Select version minimum TLS for Azure Cache for Redis\"},\"type\":\"String\"},\"RedisTLSDeployEffect\":{\"allowedValues\":[\"Append\",\"Disabled\"],\"defaultValue\":\"Append\",\"metadata\":{\"description\":\"Deploy a specific min TLS version requirement and enforce SSL on Azure Cache for Redis. Enables secure server to client by enforce  minimal Tls Version to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.\",\"displayName\":\"Azure Cache for Redis. Deploy a specific min TLS version requirement and enforce SSL Azure Cache for Redis\"},\"type\":\"String\"},\"RedisTLSEffect\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Azure Cache for Redis. Audit enabling of only connections via SSL to Azure Cache for Redis. Use of secure connections ensures authentication between the server and the service and protects data in transit from network layer attacks such as man-in-the-middle, eavesdropping, and session-hijacking.\",\"displayName\":\"Azure Cache for Redis. Only secure connections to your Azure Cache for Redis should be enabled\"},\"type\":\"String\"},\"SQLManagedInstanceMinTlsVersion\":{\"allowedValues\":[\"1.2\",\"1.0\",\"1.1\"],\"defaultValue\":\"1.2\",\"metadata\":{\"description\":\"Select version  minimum TLS version for Azure Managed Instanceto to  enforce\",\"displayName\":\"Azure Managed Instance.Select version minimum TLS for Azure Managed Instance\"},\"type\":\"String\"},\"SQLManagedInstanceTLSDeployEffect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploy a specific min TLS version requirement and enforce SSL on SQL servers. Enables secure server to client by enforce  minimal Tls Version to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.\",\"displayName\":\"Azure Managed Instance. Deploy a specific min TLS version requirement and enforce SSL on SQL servers\"},\"type\":\"String\"},\"SQLManagedInstanceTLSEffect\":{\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Setting minimal TLS version to 1.2 improves security by ensuring your SQL Managed Instance can only be accessed from clients using TLS 1.2. Using versions of TLS less than 1.2 is not recommended since they have well documented security vulnerabilities.\",\"displayName\":\"SQL Managed Instance should have the minimal TLS version of 1.2\"},\"type\":\"String\"},\"SQLServerTLSDeployEffect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploy a specific min TLS version requirement and enforce SSL on SQL servers. Enables secure server to client by enforce  minimal Tls Version to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.\",\"displayName\":\"Azure SQL Database. Deploy a specific min TLS version requirement and enforce SSL on SQL servers\"},\"type\":\"String\"},\"SQLServerTLSEffect\":{\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Setting minimal TLS version to 1.2 improves security by ensuring your Azure SQL Database can only be accessed from clients using TLS 1.2. Using versions of TLS less than 1.2 is not recommended since they have well documented security vulnerabilities.\",\"displayName\":\"Azure SQL Database should have the minimal TLS version of 1.2\"},\"type\":\"String\"},\"SQLServerminTlsVersion\":{\"allowedValues\":[\"1.2\",\"1.0\",\"1.1\"],\"defaultValue\":\"1.2\",\"metadata\":{\"description\":\"Select version  minimum TLS version for Azure SQL Database to enforce\",\"displayName\":\"Azure SQL Database.Select version minimum TLS for Azure SQL Database\"},\"type\":\"String\"},\"StorageDeployHttpsEnabledEffect\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Audit requirement of Secure transfer in your storage account. Secure transfer is an option that forces your storage account to accept requests only from secure connections (HTTPS). Use of HTTPS ensures authentication between the server and the service and protects data in transit from network layer attacks such as man-in-the-middle, eavesdropping, and session-hijacking\",\"displayName\":\"Azure Storage Account. Deploy Secure transfer to storage accounts should be enabled\"},\"type\":\"String\"},\"StorageminimumTlsVersion\":{\"allowedValues\":[\"TLS1_2\",\"TLS1_1\",\"TLS1_0\"],\"defaultValue\":\"TLS1_2\",\"metadata\":{\"description\":\"Select version  minimum TLS version on Azure Storage Account to enforce\",\"displayName\":\"Storage Account select minimum TLS version\"},\"type\":\"String\"},\"WebAppServiceHttpsEffect\":{\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Choose Deny or Audit in combination with Append policy. Use of HTTPS ensures server/service authentication and protects data in transit from network layer eavesdropping attacks.\",\"displayName\":\"App Service Web App. Web Application should only be accessible over HTTPS. Choose Deny or Audit in combination with Append policy.\"},\"type\":\"String\"},\"WebAppServiceLatestTlsEffect\":{\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Only Audit, deny not possible as it is a related resource. Upgrade to the latest TLS version.\",\"displayName\":\"App Service Web App. Latest TLS version should be used in your Web App\"},\"type\":\"String\"},\"appServiceAppSlotTls\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"type\":\"string\"},\"appServiceAppSlotsHttps\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"appServiceAppsHttps\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"appServiceAppsTls\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"type\":\"string\"},\"appServiceTls\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"containerAppsHttps\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"eventHubMinTls\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"functionAppHttps\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"functionAppSlotsHttps\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"functionAppSlotsTls\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"type\":\"string\"},\"logicAppHttpsEffect\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"sqlDbTls\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"sqlManagedTlsVersion\":{\"allowedValues\":[\"Audit\",\"Disabled\"],\"defaultValue\":\"Audit\",\"type\":\"string\"},\"storageAccountsTls\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"synapseTlsVersion\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"}}",
              "policy_definition_group": [],
              "policy_definition_reference": [
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('AppServiceHttpEffect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Append-AppService-httpsonly",
                  "policy_group_names": null,
                  "reference_id": "AppServiceHttpEffect"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('AppServiceTlsVersionEffect')]\"},\"minTlsVersion\":{\"value\":\"[parameters('AppServiceminTlsVersion')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Append-AppService-latestTLS",
                  "policy_group_names": null,
                  "reference_id": "AppServiceminTlsVersion"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('FunctionLatestTlsEffect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/f9d614c5-c173-4d56-95a7-b4437057d193",
                  "policy_group_names": null,
                  "reference_id": "FunctionLatestTlsEffect"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('WebAppServiceLatestTlsEffect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/f0e6e85b-9b9f-4a4b-b67b-f730d42f1b0b",
                  "policy_group_names": null,
                  "reference_id": "WebAppServiceLatestTlsEffect"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('APIAppServiceHttpsEffect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-AppServiceApiApp-http",
                  "policy_group_names": null,
                  "reference_id": "APIAppServiceHttpsEffect"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('FunctionServiceHttpsEffect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-AppServiceFunctionApp-http",
                  "policy_group_names": null,
                  "reference_id": "FunctionServiceHttpsEffect"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('WebAppServiceHttpsEffect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-AppServiceWebApp-http",
                  "policy_group_names": null,
                  "reference_id": "WebAppServiceHttpsEffect"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('AKSIngressHttpsOnlyEffect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/1a5b4dca-0b6f-4cf5-907c-56316bc1bf3d",
                  "policy_group_names": null,
                  "reference_id": "AKSIngressHttpsOnlyEffect"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('MySQLEnableSSLDeployEffect')]\"},\"minimalTlsVersion\":{\"value\":\"[parameters('MySQLminimalTlsVersion')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-MySQL-sslEnforcement",
                  "policy_group_names": null,
                  "reference_id": "MySQLEnableSSLDeployEffect"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('MySQLEnableSSLEffect')]\"},\"minimalTlsVersion\":{\"value\":\"[parameters('MySQLminimalTlsVersion')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-MySql-http",
                  "policy_group_names": null,
                  "reference_id": "MySQLEnableSSLEffect"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('PostgreSQLEnableSSLDeployEffect')]\"},\"minimalTlsVersion\":{\"value\":\"[parameters('PostgreSQLminimalTlsVersion')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-PostgreSQL-sslEnforcement",
                  "policy_group_names": null,
                  "reference_id": "PostgreSQLEnableSSLDeployEffect"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('PostgreSQLEnableSSLEffect')]\"},\"minimalTlsVersion\":{\"value\":\"[parameters('PostgreSQLminimalTlsVersion')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-PostgreSql-http",
                  "policy_group_names": null,
                  "reference_id": "PostgreSQLEnableSSLEffect"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('RedisTLSDeployEffect')]\"},\"minimumTlsVersion\":{\"value\":\"[parameters('RedisMinTlsVersion')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Append-Redis-sslEnforcement",
                  "policy_group_names": null,
                  "reference_id": "RedisTLSDeployEffect"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('RedisTLSDeployEffect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Append-Redis-disableNonSslPort",
                  "policy_group_names": null,
                  "reference_id": "RedisdisableNonSslPort"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('RedisTLSEffect')]\"},\"minimumTlsVersion\":{\"value\":\"[parameters('RedisMinTlsVersion')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-Redis-http",
                  "policy_group_names": null,
                  "reference_id": "RedisDenyhttps"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('SQLManagedInstanceTLSDeployEffect')]\"},\"minimalTlsVersion\":{\"value\":\"[parameters('SQLManagedInstanceMinTlsVersion')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-SqlMi-minTLS",
                  "policy_group_names": null,
                  "reference_id": "SQLManagedInstanceTLSDeployEffect"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('SQLManagedInstanceTLSEffect')]\"},\"minimalTlsVersion\":{\"value\":\"[parameters('SQLManagedInstanceMinTlsVersion')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-SqlMi-minTLS",
                  "policy_group_names": null,
                  "reference_id": "SQLManagedInstanceTLSEffect"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('SQLServerTLSDeployEffect')]\"},\"minimalTlsVersion\":{\"value\":\"[parameters('SQLServerminTlsVersion')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-SQL-minTLS",
                  "policy_group_names": null,
                  "reference_id": "SQLServerTLSDeployEffect"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('SQLServerTLSEffect')]\"},\"minimalTlsVersion\":{\"value\":\"[parameters('SQLServerminTlsVersion')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-Sql-minTLS",
                  "policy_group_names": null,
                  "reference_id": "SQLServerTLSEffect"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('StorageDeployHttpsEnabledEffect')]\"},\"minimumTlsVersion\":{\"value\":\"[parameters('StorageMinimumTlsVersion')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Storage-sslEnforcement",
                  "policy_group_names": null,
                  "reference_id": "StorageDeployHttpsEnabledEffect"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('ContainerAppsHttpsOnlyEffect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/0e80e269-43a4-4ae9-b5bc-178126b8a5cb",
                  "policy_group_names": null,
                  "reference_id": "ContainerAppsHttpsOnlyEffect"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('FunctionAppTlsEffect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/1f01f1c7-539c-49b5-9ef4-d4ffa37d22e0",
                  "policy_group_names": null,
                  "reference_id": "Dine-FunctionApp-Tls"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('LogicAppTlsEffect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-LogicApp-TLS",
                  "policy_group_names": null,
                  "reference_id": "Deploy-LogicApp-TLS"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('logicAppHttpsEffect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-LogicApps-Without-Https",
                  "policy_group_names": null,
                  "reference_id": "Deny-LogicApp-Without-Https"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('functionAppSlotsTls')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/fa3a6357-c6d6-4120-8429-855577ec0063",
                  "policy_group_names": null,
                  "reference_id": "Dine-Function-Apps-Slots-Tls"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('appServiceAppsTls')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/ae44c1d1-0df2-4ca9-98fa-a3d3ae5b409d",
                  "policy_group_names": null,
                  "reference_id": "Dine-AppService-Apps-Tls"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('appServiceAppsHttps')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/a4af4a39-4135-47fb-b175-47fbdf85311d",
                  "policy_group_names": null,
                  "reference_id": "Deny-AppService-Apps-Https"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('appServiceTls')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/d6545c6b-dd9d-4265-91e6-0b451e2f1c50",
                  "policy_group_names": null,
                  "reference_id": "Deny-AppService-Tls"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('appServiceAppSlotTls')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/014664e7-e348-41a3-aeb9-566e4ff6a9df",
                  "policy_group_names": null,
                  "reference_id": "DINE-AppService-AppSlotTls"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('functionAppSlotsHttps')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/5e5dbe3f-2702-4ffc-8b1e-0cae008a5c71",
                  "policy_group_names": null,
                  "reference_id": "Deny-FuncAppSlots-Https"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('functionAppHttps')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/6d555dd1-86f2-4f1c-8ed7-5abae7c6cbab",
                  "policy_group_names": null,
                  "reference_id": "Deny-FunctionApp-Https"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('appServiceAppSlotsHttps')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/ae1b9a8c-dfce-4605-bd91-69213b4a26fc",
                  "policy_group_names": null,
                  "reference_id": "Deny-AppService-Slots-Https"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('containerAppsHttps')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/0e80e269-43a4-4ae9-b5bc-178126b8a5cb",
                  "policy_group_names": null,
                  "reference_id": "Deny-ContainerApps-Https"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('eventHubMinTls')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-EH-minTLS",
                  "policy_group_names": null,
                  "reference_id": "Deny-EH-minTLS"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('sqlManagedTlsVersion')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/a8793640-60f7-487c-b5c3-1d37215905c4",
                  "policy_group_names": null,
                  "reference_id": "Deny-Sql-Managed-Tls-Version"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('sqlDbTls')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/32e6bbec-16b6-44c2-be37-c5b672d103cf",
                  "policy_group_names": null,
                  "reference_id": "Deny-Sql-Db-Tls"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('storageAccountsTls')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/fe83a0eb-a853-422d-aac2-1bffd182c5d0",
                  "policy_group_names": null,
                  "reference_id": "Deny-Storage-Tls"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('synapseTlsVersion')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/cb3738a6-82a2-4a18-b87b-15217b9deff4",
                  "policy_group_names": null,
                  "reference_id": "Deny-Synapse-Tls-Version"
                }
              ],
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "policy_definition_group": [],
              "policy_definition_reference": [
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {}
              ]
            }
          },
          {
            "address": "module.test_core.azurerm_policy_set_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Encryption-CMK\"]",
            "mode": "managed",
            "type": "azurerm_policy_set_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Encryption-CMK",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Deny or Audit resources without Encryption with a customer-managed key (CMK)",
              "display_name": "Deny or Audit resources without Encryption with a customer-managed key (CMK)",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\"],\"category\":\"Encryption\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"3.0.0\"}",
              "name": "Enforce-Encryption-CMK",
              "parameters": "{\"ACRCmkEffect\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Use customer-managed keys to manage the encryption at rest of the contents of your registries. By default, the data is encrypted at rest with service-managed keys, but customer-managed keys (CMK) are commonly required to meet regulatory compliance standards. CMKs enable the data to be encrypted with an Azure Key Vault key created and owned by you. You have full control and responsibility for the key lifecycle, including rotation and management. Learn more about CMK encryption at https://aka.ms/acr/CMK.\",\"displayName\":\"Container registries should be encrypted with a customer-managed key (CMK)\"},\"type\":\"String\"},\"AksCmkEffect\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Encrypting OS and data disks using customer-managed keys provides more control and greater flexibility in key management. This is a common requirement in many regulatory and industry compliance standards.\",\"displayName\":\"Azure Kubernetes Service clusters both operating systems and data disks should be encrypted by customer-managed keys\"},\"type\":\"String\"},\"AutomationAccountCmkEffect\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"AzureBatchCMKEffect\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Use customer-managed keys (CMKs) to manage the encryption at rest of your Batch account's data. By default, customer data is encrypted with service-managed keys, but CMKs are commonly required to meet regulatory compliance standards. CMKs enable the data to be encrypted with an Azure Key Vault key created and owned by you. You have full control and responsibility for the key lifecycle, including rotation and management. Learn more about CMK encryption at https://aka.ms/Batch-CMK.\",\"displayName\":\"Azure Batch account should use customer-managed keys to encrypt data\"},\"type\":\"String\"},\"BackupCmkEffect\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"CognitiveServicesCMKEffect\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Customer-managed keys (CMK) are commonly required to meet regulatory compliance standards. CMKs enable the data stored in Cognitive Services to be encrypted with an Azure Key Vault key created and owned by you. You have full control and responsibility for the key lifecycle, including rotation and management. Learn more about CMK encryption at https://aka.ms/cosmosdb-cmk.\",\"displayName\":\"Cognitive Services accounts should enable data encryption with a customer-managed key (CMK)\"},\"type\":\"String\"},\"CosmosCMKEffect\":{\"allowedValues\":[\"audit\",\"deny\",\"disabled\"],\"defaultValue\":\"deny\",\"metadata\":{\"description\":\"Use customer-managed keys to manage the encryption at rest of your Azure Cosmos DB. By default, the data is encrypted at rest with service-managed keys, but customer-managed keys (CMK) are commonly required to meet regulatory compliance standards. CMKs enable the data to be encrypted with an Azure Key Vault key created and owned by you. You have full control and responsibility for the key lifecycle, including rotation and management. Learn more about CMK encryption at https://aka.ms/cosmosdb-cmk.\",\"displayName\":\"Azure Cosmos DB accounts should use customer-managed keys to encrypt data at rest\"},\"type\":\"String\"},\"DataBoxCMKEffect\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Use a customer-managed key to control the encryption of the device unlock password for Azure Data Box. Customer-managed keys also help manage access to the device unlock password by the Data Box service in order to prepare the device and copy data in an automated manner. The data on the device itself is already encrypted at rest with Advanced Encryption Standard 256-bit encryption, and the device unlock password is encrypted by default with a Microsoft managed key.\",\"displayName\":\"Azure Data Box jobs should use a customer-managed key to encrypt the device unlock password\"},\"type\":\"String\"},\"EncryptedVMDisksEffect\":{\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Virtual machines without an enabled disk encryption will be monitored by Azure Security Center as recommendations.\",\"displayName\":\"Disk encryption should be applied on virtual machines\"},\"type\":\"String\"},\"HealthcareAPIsCMKEffect\":{\"allowedValues\":[\"audit\",\"disabled\"],\"defaultValue\":\"audit\",\"metadata\":{\"description\":\"Use a customer-managed key to control the encryption at rest of the data stored in Azure API for FHIR when this is a regulatory or compliance requirement. Customer-managed keys also deliver double encryption by adding a second layer of encryption on top of the default one done with service-managed keys.\",\"displayName\":\"Azure API for FHIR should use a customer-managed key (CMK) to encrypt data at rest\"},\"type\":\"String\"},\"MySQLCMKEffect\":{\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Use customer-managed keys to manage the encryption at rest of your MySQL servers. By default, the data is encrypted at rest with service-managed keys, but customer-managed keys (CMK) are commonly required to meet regulatory compliance standards. CMKs enable the data to be encrypted with an Azure Key Vault key created and owned by you. You have full control and responsibility for the key lifecycle, including rotation and management.\",\"displayName\":\"Azure MySQL servers bring your own key data protection should be enabled\"},\"type\":\"String\"},\"PostgreSQLCMKEffect\":{\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Use customer-managed keys to manage the encryption at rest of your PostgreSQL servers. By default, the data is encrypted at rest with service-managed keys, but customer-managed keys (CMK) are commonly required to meet regulatory compliance standards. CMKs enable the data to be encrypted with an Azure Key Vault key created and owned by you. You have full control and responsibility for the key lifecycle, including rotation and management.\",\"displayName\":\"Azure PostgreSQL servers bring your own key data protection should be enabled\"},\"type\":\"String\"},\"SqlServerTDECMKEffect\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Implementing Transparent Data Encryption (TDE) with your own key provides increased transparency and control over the TDE Protector, increased security with an HSM-backed external service, and promotion of separation of duties. This recommendation applies to organizations with a related compliance requirement.\",\"displayName\":\"SQL servers should use customer-managed keys to encrypt data at rest\"},\"type\":\"String\"},\"StorageCMKEffect\":{\"allowedValues\":[\"Audit\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Secure your storage account with greater flexibility using customer-managed keys (CMKs). When you specify a CMK, that key is used to protect and control access to the key that encrypts your data. Using CMKs provides additional capabilities to control rotation of the key encryption key or cryptographically erase data.\",\"displayName\":\"Storage accounts should use customer-managed key (CMK) for encryption, no deny as this would result in not able to create storage account because the first need of MSI for encryption\"},\"type\":\"String\"},\"StreamAnalyticsCMKEffect\":{\"allowedValues\":[\"audit\",\"deny\",\"disabled\"],\"defaultValue\":\"deny\",\"metadata\":{\"description\":\"Use customer-managed keys when you want to securely store any metadata and private data assets of your Stream Analytics jobs in your storage account. This gives you total control over how your Stream Analytics data is encrypted.\",\"displayName\":\"Azure Stream Analytics jobs should use customer-managed keys to encrypt data\"},\"type\":\"String\"},\"SynapseWorkspaceCMKEffect\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Use customer-managed keys to control the encryption at rest of the data stored in Azure Synapse workspaces. Customer-managed keys deliver double encryption by adding a second layer of encryption on top of the default encryption with service-managed keys.\",\"displayName\":\"Azure Synapse workspaces should use customer-managed keys to encrypt data at rest\"},\"type\":\"String\"},\"WorkspaceCMKEffect\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Manage encryption at rest of your Azure Machine Learning workspace data with customer-managed keys (CMK). By default, customer data is encrypted with service-managed keys, but CMKs are commonly required to meet regulatory compliance standards. CMKs enable the data to be encrypted with an Azure Key Vault key created and owned by you. You have full control and responsibility for the key lifecycle, including rotation and management. Learn more about CMK encryption at https://aka.ms/azureml-workspaces-cmk.\",\"displayName\":\"Azure Machine Learning workspaces should be encrypted with a customer-managed key (CMK)\"},\"type\":\"String\"},\"adfCmk\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"adxCmk\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"cognitiveSearchCmk\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"containerInstanceCmk\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"eventHubNamespacesCmk\":{\"allowedValues\":[\"Audit\",\"Disabled\"],\"defaultValue\":\"Audit\",\"type\":\"string\"},\"eventHubPremiumCmk\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"osAndDataDiskCmk\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"serviceBusDenyCmk\":{\"allowedValues\":[\"Audit\",\"Disabled\"],\"defaultValue\":\"Audit\",\"type\":\"string\"},\"sqlManagedCmk\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"storageAccountsEncryptionCmk\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"storageQueueCmk\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"storageTableCmk\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"}}",
              "policy_definition_group": [],
              "policy_definition_reference": [
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('ACRCmkEffect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/5b9159ae-1701-4a6f-9a7a-aa9c8ddd0580",
                  "policy_group_names": null,
                  "reference_id": "ACRCmkDeny"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('AksCmkEffect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/7d7be79c-23ba-4033-84dd-45e2a5ccdd67",
                  "policy_group_names": null,
                  "reference_id": "AksCmkDeny"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('WorkspaceCMKEffect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/ba769a63-b8cc-4b2d-abf6-ac33c7204be8",
                  "policy_group_names": null,
                  "reference_id": "WorkspaceCMK"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('CognitiveServicesCMKEffect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/67121cc7-ff39-4ab8-b7e3-95b84dab487d",
                  "policy_group_names": null,
                  "reference_id": "CognitiveServicesCMK"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('CosmosCMKEffect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/1f905d99-2ab7-462c-a6b0-f709acca6c8f",
                  "policy_group_names": null,
                  "reference_id": "CosmosCMKEffect"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('DataBoxCMKEffect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/86efb160-8de7-451d-bc08-5d475b0aadae",
                  "policy_group_names": null,
                  "reference_id": "DataBoxCMKEffect"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('StreamAnalyticsCMKEffect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/87ba29ef-1ab3-4d82-b763-87fcd4f531f7",
                  "policy_group_names": null,
                  "reference_id": "StreamAnalyticsCMKEffect"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('SynapseWorkspaceCMKEffect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/f7d52b2d-e161-4dfa-a82b-55e564167385",
                  "policy_group_names": null,
                  "reference_id": "SynapseWorkspaceCMKEffect"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('StorageCMKEffect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/6fac406b-40ca-413b-bf8e-0bf964659c25",
                  "policy_group_names": null,
                  "reference_id": "StorageCMKEffect"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('MySQLCMKEffect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/83cef61d-dbd1-4b20-a4fc-5fbc7da10833",
                  "policy_group_names": null,
                  "reference_id": "MySQLCMKEffect"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('PostgreSQLCMKEffect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/18adea5e-f416-4d0f-8aa8-d24321e3e274",
                  "policy_group_names": null,
                  "reference_id": "PostgreSQLCMKEffect"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('SqlServerTDECMKEffect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/0a370ff3-6cab-4e85-8995-295fd854c5b8",
                  "policy_group_names": null,
                  "reference_id": "SqlServerTDECMKEffect"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('HealthcareAPIsCMKEffect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/051cba44-2429-45b9-9649-46cec11c7119",
                  "policy_group_names": null,
                  "reference_id": "HealthcareAPIsCMKEffect"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('AzureBatchCMKEffect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/99e9ccd8-3db9-4592-b0d1-14b1715a4d8a",
                  "policy_group_names": null,
                  "reference_id": "AzureBatchCMKEffect"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('EncryptedVMDisksEffect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/0961003e-5a0a-4549-abde-af6a37f2724d",
                  "policy_group_names": null,
                  "reference_id": "EncryptedVMDisksEffect"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('AutomationAccountCmkEffect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/56a5ee18-2ae6-4810-86f7-18e39ce5629b",
                  "policy_group_names": null,
                  "reference_id": "Deny-Aa-Cmk"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('BackupCmkEffect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/2e94d99a-8a36-4563-bc77-810d8893b671",
                  "policy_group_names": null,
                  "reference_id": "Deny-Backup-Cmk"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('cognitiveSearchCmk')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/76a56461-9dc0-40f0-82f5-2453283afa2f",
                  "policy_group_names": null,
                  "reference_id": "Deny-CognitiveSearch-Cmk"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('osAndDataDiskCmk')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/702dd420-7fcc-42c5-afe8-4026edd20fe0",
                  "policy_group_names": null,
                  "reference_id": "Deny-OsAndDataDisk-Cmk"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('containerInstanceCmk')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/0aa61e00-0a01-4a3c-9945-e93cffedf0e6",
                  "policy_group_names": null,
                  "reference_id": "Deny-ContainerInstance-Cmk"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('adxCmk')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/81e74cea-30fd-40d5-802f-d72103c2aaaa",
                  "policy_group_names": null,
                  "reference_id": "Deny-ADX-Cmk"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('adfCmk')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/4ec52d6d-beb7-40c4-9a9e-fe753254690e",
                  "policy_group_names": null,
                  "reference_id": "Deny-Adf-Cmk"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('eventHubNamespacesCmk')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/a1ad735a-e96f-45d2-a7b2-9a4932cab7ec",
                  "policy_group_names": null,
                  "reference_id": "Deny-EH-Cmk"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('eventHubPremiumCmk')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-EH-Premium-CMK",
                  "policy_group_names": null,
                  "reference_id": "Deny-EH-Premium-CMK"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('serviceBusDenyCmk')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/295fc8b1-dc9f-4f53-9c61-3f313ceab40a",
                  "policy_group_names": null,
                  "reference_id": "Deny-Sb-Cmk"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('sqlManagedCmk')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/ac01ad65-10e5-46df-bdd9-6b0cad13e1d2",
                  "policy_group_names": null,
                  "reference_id": "Deny-Sql-Managed-Cmk"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('storageTableCmk')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/7c322315-e26d-4174-a99e-f49d351b4688",
                  "policy_group_names": null,
                  "reference_id": "Deny-Storage-Table-Cmk"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('storageAccountsEncryptionCmk')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/b5ec538c-daa0-4006-8596-35468b9148e8",
                  "policy_group_names": null,
                  "reference_id": "Deny-Storage-Encryption-Cmk"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('storageQueueCmk')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/f0e5abd0-2554-4736-b7c0-4ffef23475ef",
                  "policy_group_names": null,
                  "reference_id": "Deny-Storage-Queue-Cmk"
                }
              ],
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "policy_definition_group": [],
              "policy_definition_reference": [
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {}
              ]
            }
          },
          {
            "address": "module.test_core.azurerm_policy_set_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-APIM\"]",
            "mode": "managed",
            "type": "azurerm_policy_set_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-APIM",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "This policy initiative is a group of policies that ensures API Management is compliant per regulated Landing Zones.",
              "display_name": "Enforce recommended guardrails for API Management",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"API Management\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.0\"}",
              "name": "Enforce-Guardrails-APIM",
              "parameters": "{\"apiSubscriptionScope\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"apimApiBackendCertValidation\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"apimCallApiAuthn\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"apimDirectApiEndpoint\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"apimDisablePublicNetworkAccess\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"type\":\"string\"},\"apimEncryptedProtocols\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"apimSecrets\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"apimSkuVnet\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"apimTls\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"apimVnetUsage\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"minimumApiVersion\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"}}",
              "policy_definition_group": [],
              "policy_definition_reference": [
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('apimSecrets')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/f1cc7827-022c-473e-836e-5a51cae0b249",
                  "policy_group_names": null,
                  "reference_id": "Deny-Apim-without-Kv"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('apimVnetUsage')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/ef619a2c-cc4d-4d03-b2ba-8c94a834d85b",
                  "policy_group_names": null,
                  "reference_id": "Deny-Apim-without-Vnet"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('apimTls')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-APIM-TLS",
                  "policy_group_names": null,
                  "reference_id": "Deny-APIM-TLS"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('apimEncryptedProtocols')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/ee7495e7-3ba7-40b6-bfee-c29e22cc75d4",
                  "policy_group_names": null,
                  "reference_id": "Deny-Apim-Protocols"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('apimCallApiAuthn')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/c15dcc82-b93c-4dcb-9332-fbf121685b54",
                  "policy_group_names": null,
                  "reference_id": "Deny-Apim-Authn"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('apimDirectApiEndpoint')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/b741306c-968e-4b67-b916-5675e5c709f4",
                  "policy_group_names": null,
                  "reference_id": "Deny-Apim-Direct-Endpoint"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('apimApiBackendCertValidation')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/92bb331d-ac71-416a-8c91-02f2cb734ce4",
                  "policy_group_names": null,
                  "reference_id": "Deny-Apim-Cert-Validation"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('apimDisablePublicNetworkAccess')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/7ca8c8ac-3a6e-493d-99ba-c5fa35347ff2",
                  "policy_group_names": null,
                  "reference_id": "Dine-Apim-Public-NetworkAccess"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('apimSkuVnet')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/73ef9241-5d81-4cd4-b483-8443d1730fe5",
                  "policy_group_names": null,
                  "reference_id": "Deny-Apim-Sku-Vnet"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('minimumApiVersion')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/549814b6-3212-4203-bdc8-1548d342fb67",
                  "policy_group_names": null,
                  "reference_id": "Deny-Apim-Version"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('apiSubscriptionScope')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/3aa03346-d8c5-4994-a5bc-7652c2a2aef1",
                  "policy_group_names": null,
                  "reference_id": "Deny-Api-subscription-scope"
                }
              ],
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "policy_definition_group": [],
              "policy_definition_reference": [
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {}
              ]
            }
          },
          {
            "address": "module.test_core.azurerm_policy_set_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-AppServices\"]",
            "mode": "managed",
            "type": "azurerm_policy_set_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-AppServices",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "This policy initiative is a group of policies that ensures App Service is compliant per regulated Landing Zones.",
              "display_name": "Enforce recommended guardrails for App Service",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"App Service\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.0\"}",
              "name": "Enforce-Guardrails-AppServices",
              "parameters": "{\"appServiceAppHttps\":{\"allowedValues\":[\"Modify\",\"Disabled\"],\"defaultValue\":\"Modify\",\"type\":\"string\"},\"appServiceAppModifyPublicNetworkAccess\":{\"allowedValues\":[\"Modify\",\"Disabled\"],\"defaultValue\":\"Modify\",\"type\":\"string\"},\"appServiceAppSlotsRemoteDebugging\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"type\":\"string\"},\"appServiceAppsModifyPublicNetworkAccess\":{\"allowedValues\":[\"Modify\",\"Disabled\"],\"defaultValue\":\"Modify\",\"type\":\"string\"},\"appServiceAppsRemoteDebugging\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"type\":\"string\"},\"appServiceAppsRfc\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"appServiceAppsVnetRouting\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"appServiceByoc\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"appServiceDisableLocalAuth\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"type\":\"string\"},\"appServiceDisableLocalAuthFtp\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"type\":\"string\"},\"appServiceEnvLatestVersion\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"appServiceRfc\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"appServiceRouting\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"appServiceScmAuth\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"type\":\"string\"},\"appServiceSkuPl\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"functionAppDebugging\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"type\":\"string\"},\"functionAppSlotsModifyHttps\":{\"allowedValues\":[\"Modify\",\"Disabled\"],\"defaultValue\":\"Modify\",\"type\":\"string\"},\"functionAppSlotsModifyPublicNetworkAccess\":{\"allowedValues\":[\"Modify\",\"Disabled\"],\"defaultValue\":\"Modify\",\"type\":\"string\"}}",
              "policy_definition_group": [],
              "policy_definition_reference": [
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('appServiceByoc')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-AppService-without-BYOC",
                  "policy_group_names": null,
                  "reference_id": "Deny-AppService-Byoc"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('appServiceAppsRemoteDebugging')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/a5e3fe8f-f6cd-4f1d-bbf6-c749754a724b",
                  "policy_group_names": null,
                  "reference_id": "Dine-AppService-Apps-Remote-Debugging"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('appServiceAppSlotsRemoteDebugging')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/cca5adfe-626b-4cc6-8522-f5b6ed2391bd",
                  "policy_group_names": null,
                  "reference_id": "Deny-AppService-Slots-Remote-Debugging"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('appServiceEnvLatestVersion')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/eb4d34ab-0929-491c-bbf3-61e13da19f9a",
                  "policy_group_names": null,
                  "reference_id": "Deny-AppService-Latest-Version"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('appServiceAppsVnetRouting')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/801543d1-1953-4a90-b8b0-8cf6d41473a5",
                  "policy_group_names": null,
                  "reference_id": "Deny-AppService-Vnet-Routing"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('appServiceRfc')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/f5c0bfb3-acea-47b1-b477-b0edcdf6edc1",
                  "policy_group_names": null,
                  "reference_id": "Deny-AppService-Rfc"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('appServiceAppsRfc')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/a691eacb-474d-47e4-b287-b4813ca44222",
                  "policy_group_names": null,
                  "reference_id": "Deny-AppServiceApps-Rfc"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('functionAppDebugging')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/70adbb40-e092-42d5-a6f8-71c540a5efdb",
                  "policy_group_names": null,
                  "reference_id": "DINE-FuncApp-Debugging"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('appServiceScmAuth')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/5e97b776-f380-4722-a9a3-e7f0be029e79",
                  "policy_group_names": null,
                  "reference_id": "DINE-AppService-ScmAuth"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('appServiceRouting')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/5747353b-1ca9-42c1-a4dd-b874b894f3d4",
                  "policy_group_names": null,
                  "reference_id": "Deny-AppServ-Routing"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('appServiceDisableLocalAuthFtp')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/572e342c-c920-4ef5-be2e-1ed3c6a51dc5",
                  "policy_group_names": null,
                  "reference_id": "Deny-AppServ-FtpAuth"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('appServiceSkuPl')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/546fe8d2-368d-4029-a418-6af48a7f61e5",
                  "policy_group_names": null,
                  "reference_id": "Deny-AppServ-SkuPl"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('appServiceDisableLocalAuth')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/2c034a29-2a5f-4857-b120-f800fe5549ae",
                  "policy_group_names": null,
                  "reference_id": "DINE-AppService-LocalAuth"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('functionAppDebugging')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/25a5046c-c423-4805-9235-e844ae9ef49b",
                  "policy_group_names": null,
                  "reference_id": "DINE-AppService-Debugging"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('functionAppSlotsModifyHttps')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/08cf2974-d178-48a0-b26d-f6b8e555748b",
                  "policy_group_names": null,
                  "reference_id": "Modify-Function-Apps-Slots-Https"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('appServiceAppHttps')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/0f98368e-36bc-4716-8ac2-8f8067203b63",
                  "policy_group_names": null,
                  "reference_id": "Modify-AppService-Https"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('functionAppSlotsModifyPublicNetworkAccess')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/242222f3-4985-4e99-b5ef-086d6a6cb01c",
                  "policy_group_names": null,
                  "reference_id": "Modify-Function-Apps-Slots-Public-Network-Access"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('appServiceAppsModifyPublicNetworkAccess')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/2374605e-3e0b-492b-9046-229af202562c",
                  "policy_group_names": null,
                  "reference_id": "Modify-AppService-Apps-Public-Network-Access"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('appServiceAppModifyPublicNetworkAccess')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/c6c3e00e-d414-4ca4-914f-406699bb8eee",
                  "policy_group_names": null,
                  "reference_id": "Modify-AppService-App-Public-Network-Access"
                }
              ],
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "policy_definition_group": [],
              "policy_definition_reference": [
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {}
              ]
            }
          },
          {
            "address": "module.test_core.azurerm_policy_set_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-Automation\"]",
            "mode": "managed",
            "type": "azurerm_policy_set_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-Automation",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "This policy initiative is a group of policies that ensures Automation Account is compliant per regulated Landing Zones.",
              "display_name": "Enforce recommended guardrails for Automation Account",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Automation\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.0\"}",
              "name": "Enforce-Guardrails-Automation",
              "parameters": "{\"aaLocalAuth\":{\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"aaManagedIdentity\":{\"allowedValues\":[\"Audit\",\"Disabled\"],\"defaultValue\":\"Audit\",\"type\":\"string\"},\"aaModifyLocalAuth\":{\"allowedValues\":[\"Modify\",\"Disabled\"],\"defaultValue\":\"Modify\",\"type\":\"string\"},\"aaModifyPublicNetworkAccess\":{\"allowedValues\":[\"Modify\",\"Disabled\"],\"defaultValue\":\"Modify\",\"type\":\"string\"},\"aaVariablesEncryption\":{\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"autoHotPatch\":{\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Deny\",\"type\":\"string\"}}",
              "policy_definition_group": [],
              "policy_definition_reference": [
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('autoHotPatch')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/6d02d2f7-e38b-4bdc-96f3-adc0a8726abc",
                  "policy_group_names": null,
                  "reference_id": "Deny-Windows-Vm-HotPatch"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('aaManagedIdentity')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/dea83a72-443c-4292-83d5-54a2f98749c0",
                  "policy_group_names": null,
                  "reference_id": "Deny-Aa-Managed-Identity"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('aaLocalAuth')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/48c5f1cb-14ad-4797-8e3b-f78ab3f8d700",
                  "policy_group_names": null,
                  "reference_id": "Deny-Aa-Local-Auth"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('aaVariablesEncryption')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/3657f5a0-770e-44a3-b44e-9431ba1e9735",
                  "policy_group_names": null,
                  "reference_id": "Deny-Aa-Variables-Encrypt"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('aaModifyLocalAUth')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/30d1d58e-8f96-47a5-8564-499a3f3cca81",
                  "policy_group_names": null,
                  "reference_id": "Modify-Aa-Local-Auth"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('aaModifyPublicNetworkAccess')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/23b36a7c-9d26-4288-a8fd-c1d2fa284d8c",
                  "policy_group_names": null,
                  "reference_id": "Modify-Aa-Public-Network-Access"
                }
              ],
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "policy_definition_group": [],
              "policy_definition_reference": [
                {},
                {},
                {},
                {},
                {},
                {}
              ]
            }
          },
          {
            "address": "module.test_core.azurerm_policy_set_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-CognitiveServices\"]",
            "mode": "managed",
            "type": "azurerm_policy_set_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-CognitiveServices",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "This policy initiative is a group of policies that ensures Cognitive Services is compliant per regulated Landing Zones.",
              "display_name": "Enforce recommended guardrails for Cognitive Services",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Cognitive Services\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.0\"}",
              "name": "Enforce-Guardrails-CognitiveServices",
              "parameters": "{\"cognitiveSearchLocalAuth\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"cognitiveSearchSku\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"cognitiveServicesModifyPublicNetworkAccess\":{\"allowedValues\":[\"Modify\",\"Disabled\"],\"defaultValue\":\"Modify\",\"type\":\"string\"},\"modifyCognitiveSearchLocalAuth\":{\"allowedValues\":[\"Modify\",\"Disabled\"],\"defaultValue\":\"Modify\",\"type\":\"string\"},\"modifyCognitiveSearchPublicEndpoint\":{\"allowedValues\":[\"Modify\",\"Disabled\"],\"defaultValue\":\"Modify\",\"type\":\"string\"}}",
              "policy_definition_group": [],
              "policy_definition_reference": [
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('cognitiveSearchSku')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/a049bf77-880b-470f-ba6d-9f21c530cf83",
                  "policy_group_names": null,
                  "reference_id": "Deny-CognitiveSearch-SKU"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('cognitiveSearchLocalAuth')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/6300012e-e9a4-4649-b41f-a85f5c43be91",
                  "policy_group_names": null,
                  "reference_id": "Deny-CongitiveSearch-LocalAuth"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('modifyCognitiveSearchLocalAuth')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/4eb216f2-9dba-4979-86e6-5d7e63ce3b75",
                  "policy_group_names": null,
                  "reference_id": "Modify-CogntiveSearch-LocalAuth"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('modifyCognitiveSearchPublicEndpoint')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/9cee519f-d9c1-4fd9-9f79-24ec3449ed30",
                  "policy_group_names": null,
                  "reference_id": "Modify-CogntiveSearch-PublicEndpoint"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('cognitiveServicesModifyPublicNetworkAccess')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/47ba1dd7-28d9-4b07-a8d5-9813bed64e0c",
                  "policy_group_names": null,
                  "reference_id": "Modify-Cognitive-Services-Public-Network-Access"
                }
              ],
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "policy_definition_group": [],
              "policy_definition_reference": [
                {},
                {},
                {},
                {},
                {}
              ]
            }
          },
          {
            "address": "module.test_core.azurerm_policy_set_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-Compute\"]",
            "mode": "managed",
            "type": "azurerm_policy_set_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-Compute",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "This policy initiative is a group of policies that ensures Compute is compliant per regulated Landing Zones.",
              "display_name": "Enforce recommended guardrails for Compute",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Compute\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.0\"}",
              "name": "Enforce-Guardrails-Compute",
              "parameters": "{\"diskDoubleEncryption\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"vmAndVmssEncryptionHost\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"}}",
              "policy_definition_group": [],
              "policy_definition_reference": [
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('vmAndVmssEncryptionHost')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/fc4d8e41-e223-45ea-9bf5-eada37891d87",
                  "policy_group_names": null,
                  "reference_id": "Deny-VmAndVmss-Encryption-Host"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('diskDoubleEncryption')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/ca91455f-eace-4f96-be59-e6e2c35b4816",
                  "policy_group_names": null,
                  "reference_id": "Deny-Disk-Double-Encryption"
                }
              ],
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "policy_definition_group": [],
              "policy_definition_reference": [
                {},
                {}
              ]
            }
          },
          {
            "address": "module.test_core.azurerm_policy_set_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-ContainerApps\"]",
            "mode": "managed",
            "type": "azurerm_policy_set_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-ContainerApps",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "This policy initiative is a group of policies that ensures Container Apps is compliant per regulated Landing Zones.",
              "display_name": "Enforce recommended guardrails for Container Apps",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Container Apps\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.0\"}",
              "name": "Enforce-Guardrails-ContainerApps",
              "parameters": "{\"containerAppsManagedIdentity\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"containerAppsVnetInjection\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"}}",
              "policy_definition_group": [],
              "policy_definition_reference": [
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('containerAppsVnetInjection')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/8b346db6-85af-419b-8557-92cee2c0f9bb",
                  "policy_group_names": null,
                  "reference_id": "Deny-ContainerApp-Vnet-Injection"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('containerAppsManagedIdentity')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/b874ab2d-72dd-47f1-8cb5-4a306478a4e7",
                  "policy_group_names": null,
                  "reference_id": "Deny-ContainerApps-Managed-Identity"
                }
              ],
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "policy_definition_group": [],
              "policy_definition_reference": [
                {},
                {}
              ]
            }
          },
          {
            "address": "module.test_core.azurerm_policy_set_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-ContainerInstance\"]",
            "mode": "managed",
            "type": "azurerm_policy_set_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-ContainerInstance",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "This policy initiative is a group of policies that ensures Container Apps is compliant per regulated Landing Zones.",
              "display_name": "Enforce recommended guardrails for Container Instance",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Container Instances\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.0\"}",
              "name": "Enforce-Guardrails-ContainerInstance",
              "parameters": "{\"containerInstanceVnet\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"}}",
              "policy_definition_group": [],
              "policy_definition_reference": [
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('containerInstanceVnet')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/8af8f826-edcb-4178-b35f-851ea6fea615",
                  "policy_group_names": null,
                  "reference_id": "Deny-ContainerInstance-Vnet"
                }
              ],
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "policy_definition_group": [],
              "policy_definition_reference": [
                {}
              ]
            }
          },
          {
            "address": "module.test_core.azurerm_policy_set_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-ContainerRegistry\"]",
            "mode": "managed",
            "type": "azurerm_policy_set_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-ContainerRegistry",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "This policy initiative is a group of policies that ensures Container Apps is compliant per regulated Landing Zones.",
              "display_name": "Enforce recommended guardrails for Container Registry",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Container Registry\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.0\"}",
              "name": "Enforce-Guardrails-ContainerRegistry",
              "parameters": "{\"containerRegistryAnAuth\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"containerRegistryArmAudience\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"containerRegistryExports\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"containerRegistryLocalAuth\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"containerRegistryModifyAnAuth\":{\"allowedValues\":[\"Modify\",\"Disabled\"],\"defaultValue\":\"Modify\",\"type\":\"string\"},\"containerRegistryModifyArmAudience\":{\"allowedValues\":[\"Modify\",\"Disabled\"],\"defaultValue\":\"Modify\",\"type\":\"string\"},\"containerRegistryModifyLocalAuth\":{\"allowedValues\":[\"Modify\",\"Disabled\"],\"defaultValue\":\"Modify\",\"type\":\"string\"},\"containerRegistryModifyPublicNetworkAccess\":{\"allowedValues\":[\"Modify\",\"Disabled\"],\"defaultValue\":\"Modify\",\"type\":\"string\"},\"containerRegistryModifyRepositoryToken\":{\"allowedValues\":[\"Modify\",\"Disabled\"],\"defaultValue\":\"Modify\",\"type\":\"string\"},\"containerRegistryRepositoryToken\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"containerRegistrySkuPrivateLink\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"containerRegistryUnrestrictedNetworkAccess\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"}}",
              "policy_definition_group": [],
              "policy_definition_reference": [
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('containerRegistryModifyLocalAuth')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/79fdfe03-ffcb-4e55-b4d0-b925b8241759",
                  "policy_group_names": null,
                  "reference_id": "Modify-ContainerRegistry-Local-Auth"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('containerRegistryModifyRepositoryToken')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/a9b426fe-8856-4945-8600-18c5dd1cca2a",
                  "policy_group_names": null,
                  "reference_id": "Modify-ContainerRegistry-Repo-Token"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('containerRegistryArmAudience')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/42781ec6-6127-4c30-bdfa-fb423a0047d3",
                  "policy_group_names": null,
                  "reference_id": "Deny-ContainerRegistry-Arm-Audience"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('containerRegistryModifyArmAudience')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/785596ed-054f-41bc-aaec-7f3d0ba05725",
                  "policy_group_names": null,
                  "reference_id": "Modify-ContainerRegistry-Arm-Audience"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('containerRegistrySkuPrivateLink')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/bd560fc0-3c69-498a-ae9f-aa8eb7de0e13",
                  "policy_group_names": null,
                  "reference_id": "Deny-ContainerRegistry-Sku-PrivateLink"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('containerRegistryModifyAnAuth')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/cced2946-b08a-44fe-9fd9-e4ed8a779897",
                  "policy_group_names": null,
                  "reference_id": "Modify-ContainerRegistry-Anonymous-Auth"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('containerRegistryAnAuth')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/9f2dea28-e834-476c-99c5-3507b4728395",
                  "policy_group_names": null,
                  "reference_id": "Deny-ContainerRegistry-Anonymous-Auth"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('containerRegistryExports')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/524b0254-c285-4903-bee6-bb8126cde579",
                  "policy_group_names": null,
                  "reference_id": "Deny-ContainerRegistry-Exports"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('containerRegistryLocalAuth')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/dc921057-6b28-4fbe-9b83-f7bec05db6c2",
                  "policy_group_names": null,
                  "reference_id": "Deny-ContainerRegistry-Local-Auth"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('containerRegistryRepositoryToken')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/ff05e24e-195c-447e-b322-5e90c9f9f366",
                  "policy_group_names": null,
                  "reference_id": "Deny-ContainerRegistry-Repo-Token"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('containerRegistryUnrestrictedNetworkAccess')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/d0793b48-0edc-4296-a390-4c75d1bdfd71",
                  "policy_group_names": null,
                  "reference_id": "Deny-ContainerRegistry-Unrestricted-Network-Access"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('containerRegistryModifyPublicNetworkAccess')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/a3701552-92ea-433e-9d17-33b7f1208fc9",
                  "policy_group_names": null,
                  "reference_id": "Modify-ContainerRegistry-Public-Network-Access"
                }
              ],
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "policy_definition_group": [],
              "policy_definition_reference": [
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {}
              ]
            }
          },
          {
            "address": "module.test_core.azurerm_policy_set_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-CosmosDb\"]",
            "mode": "managed",
            "type": "azurerm_policy_set_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-CosmosDb",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "This policy initiative is a group of policies that ensures Cosmos DB is compliant per regulated Landing Zones.",
              "display_name": "Enforce recommended guardrails for Cosmos DB",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Cosmos DB\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.0\"}",
              "name": "Enforce-Guardrails-CosmosDb",
              "parameters": "{\"cosmosDbAtp\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"type\":\"string\"},\"cosmosDbFwRules\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"cosmosDbLocalAuth\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"cosmosDbModifyLocalAuth\":{\"allowedValues\":[\"Modify\",\"Disabled\"],\"defaultValue\":\"Modify\",\"type\":\"string\"},\"cosmosDbModifyPublicAccess\":{\"allowedValues\":[\"Modify\",\"Disabled\"],\"defaultValue\":\"Modify\",\"type\":\"string\"}}",
              "policy_definition_group": [],
              "policy_definition_reference": [
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('cosmosDbModifyLocalAuth')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/dc2d41d1-4ab1-4666-a3e1-3d51c43e0049",
                  "policy_group_names": null,
                  "reference_id": "Modify-CosmosDb-Local-Auth"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('cosmosDbAtp')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/b5f04e03-92a3-4b09-9410-2cc5e5047656",
                  "policy_group_names": null,
                  "reference_id": "Dine-CosmosDb-Atp"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('cosmosDbFwRules')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/862e97cf-49fc-4a5c-9de4-40d4e2e7c8eb",
                  "policy_group_names": null,
                  "reference_id": "Deny-CosmosDb-Fw-Rules"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('cosmosDbLocalAuth')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/5450f5bd-9c72-4390-a9c4-a7aba4edfdd2",
                  "policy_group_names": null,
                  "reference_id": "Deny-CosmosDb-Local-Auth"
                },
                {
                  "parameter_values": "{}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/4750c32b-89c0-46af-bfcb-2e4541a818d5",
                  "policy_group_names": null,
                  "reference_id": "Append-CosmosDb-Metadata"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('cosmosDbModifyPublicAccess')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/da69ba51-aaf1-41e5-8651-607cd0b37088",
                  "policy_group_names": null,
                  "reference_id": "Modify-CosmosDb-Public-Network-Access"
                }
              ],
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "policy_definition_group": [],
              "policy_definition_reference": [
                {},
                {},
                {},
                {},
                {},
                {}
              ]
            }
          },
          {
            "address": "module.test_core.azurerm_policy_set_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-DataExplorer\"]",
            "mode": "managed",
            "type": "azurerm_policy_set_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-DataExplorer",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "This policy initiative is a group of policies that ensures Data Explorer is compliant per regulated Landing Zones.",
              "display_name": "Enforce recommended guardrails for Data Explorer",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Azure Data Explorer\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.0\"}",
              "name": "Enforce-Guardrails-DataExplorer",
              "parameters": "{\"adxDoubleEncryption\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"adxEncryption\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"adxModifyPublicNetworkAccess\":{\"allowedValues\":[\"Modify\",\"Disabled\"],\"defaultValue\":\"Modify\",\"type\":\"string\"},\"adxSku\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"}}",
              "policy_definition_group": [],
              "policy_definition_reference": [
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('adxSku')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/1fec9658-933f-4b3e-bc95-913ed22d012b",
                  "policy_group_names": null,
                  "reference_id": "Deny-ADX-Sku-without-PL-Support"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('adxDoubleEncryption')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/ec068d99-e9c7-401f-8cef-5bdde4e6ccf1",
                  "policy_group_names": null,
                  "reference_id": "Deny-ADX-Double-Encryption"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('adxEncryption')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/f4b53539-8df9-40e4-86c6-6b607703bd4e",
                  "policy_group_names": null,
                  "reference_id": "Deny-ADX-Encryption"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('adxModifyPublicNetworkAccess')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/7b32f193-cb28-4e15-9a98-b9556db0bafa",
                  "policy_group_names": null,
                  "reference_id": "Modify-ADX-Public-Network-Access"
                }
              ],
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "policy_definition_group": [],
              "policy_definition_reference": [
                {},
                {},
                {},
                {}
              ]
            }
          },
          {
            "address": "module.test_core.azurerm_policy_set_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-DataFactory\"]",
            "mode": "managed",
            "type": "azurerm_policy_set_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-DataFactory",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "This policy initiative is a group of policies that ensures Data Factory is compliant per regulated Landing Zones.",
              "display_name": "Enforce recommended guardrails for Data Factory",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Data Factory\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.0\"}",
              "name": "Enforce-Guardrails-DataFactory",
              "parameters": "{\"adfGit\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"adfLinkedServiceKeyVault\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"adfManagedIdentity\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"adfModifyPublicNetworkAccess\":{\"allowedValues\":[\"Modify\",\"Disabled\"],\"defaultValue\":\"Modify\",\"type\":\"string\"},\"adfSqlIntegration\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"}}",
              "policy_definition_group": [],
              "policy_definition_reference": [
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('adfManagedIdentity')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/f78ccdb4-7bf4-4106-8647-270491d2978a",
                  "policy_group_names": null,
                  "reference_id": "Deny-Adf-Managed-Identity"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('adfGit')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/77d40665-3120-4348-b539-3192ec808307",
                  "policy_group_names": null,
                  "reference_id": "Deny-Adf-Git"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('adfLinkedServiceKeyVault')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/127ef6d7-242f-43b3-9eef-947faf1725d0",
                  "policy_group_names": null,
                  "reference_id": "Deny-Adf-Linked-Service-Key-Vault"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('adfSqlIntegration')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/0088bc63-6dee-4a9c-9d29-91cfdc848952",
                  "policy_group_names": null,
                  "reference_id": "Deny-Adf-Sql-Integration"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('adfModifyPublicNetworkAccess')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/08b1442b-7789-4130-8506-4f99a97226a7",
                  "policy_group_names": null,
                  "reference_id": "Modify-Adf-Public-Network-Access"
                }
              ],
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "policy_definition_group": [],
              "policy_definition_reference": [
                {},
                {},
                {},
                {},
                {}
              ]
            }
          },
          {
            "address": "module.test_core.azurerm_policy_set_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-EventGrid\"]",
            "mode": "managed",
            "type": "azurerm_policy_set_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-EventGrid",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "This policy initiative is a group of policies that ensures Event Grid is compliant per regulated Landing Zones.",
              "display_name": "Enforce recommended guardrails for Event Grid",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Event Grid\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.0\"}",
              "name": "Enforce-Guardrails-EventGrid",
              "parameters": "{\"eventGridDomainModifyLocalAuth\":{\"allowedValues\":[\"Modify\",\"Disabled\"],\"defaultValue\":\"Modify\",\"type\":\"string\"},\"eventGridDomainModifyPublicNetworkAccess\":{\"allowedValues\":[\"Modify\",\"Disabled\"],\"defaultValue\":\"Modify\",\"type\":\"string\"},\"eventGridLocalAuth\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"eventGridPartnerNamespaceLocalAuth\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"eventGridPartnerNamespaceModifyLocalAuth\":{\"allowedValues\":[\"Modify\",\"Disabled\"],\"defaultValue\":\"Modify\",\"type\":\"string\"},\"eventGridTopicLocalAuth\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"eventGridTopicModifyLocalAuth\":{\"allowedValues\":[\"Modify\",\"Disabled\"],\"defaultValue\":\"Modify\",\"type\":\"string\"},\"eventGridTopicModifyPublicNetworkAccess\":{\"allowedValues\":[\"Modify\",\"Disabled\"],\"defaultValue\":\"Modify\",\"type\":\"string\"}}",
              "policy_definition_group": [],
              "policy_definition_reference": [
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('eventGridPartnerNamespaceModifyLocalAuth')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/2dd0e8b9-4289-4bb0-b813-1883298e9924",
                  "policy_group_names": null,
                  "reference_id": "Modify-EventGrid-Partner-Namespace-Local-Auth"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('eventGridDomainModifyLocalAuth')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/8ac2748f-3bf1-4c02-a3b6-92ae68cf75b1",
                  "policy_group_names": null,
                  "reference_id": "Modify-EventGrid-Domain-Local-Auth"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('eventGridTopicLocalAuth')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/ae9fb87f-8a17-4428-94a4-8135d431055c",
                  "policy_group_names": null,
                  "reference_id": "Deny-EventGrid-Topic-Local-Auth"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('eventGridTopicModifyLocalAuth')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/1c8144d9-746a-4501-b08c-093c8d29ad04",
                  "policy_group_names": null,
                  "reference_id": "Modify-EventGrid-Topic-Local-Auth"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('eventGridPartnerNamespaceLocalAuth')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/8632b003-3545-4b29-85e6-b2b96773df1e",
                  "policy_group_names": null,
                  "reference_id": "Deny-EventGrid-Partner-Namespace-Local-Auth"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('eventGridLocalAuth')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/8bfadddb-ee1c-4639-8911-a38cb8e0b3bd",
                  "policy_group_names": null,
                  "reference_id": "Deny-EventGrid-Local-Auth"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('eventGridDomainModifyPublicNetworkAccess')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/898e9824-104c-4965-8e0e-5197588fa5d4",
                  "policy_group_names": null,
                  "reference_id": "Modify-EventGrid-Domain-Public-Network-Access"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('eventGridTopicModifyPublicNetworkAccess')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/36ea4b4b-0f7f-4a54-89fa-ab18f555a172",
                  "policy_group_names": null,
                  "reference_id": "Modify-EventGrid-Topic-Public-Network-Access"
                }
              ],
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "policy_definition_group": [],
              "policy_definition_reference": [
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {}
              ]
            }
          },
          {
            "address": "module.test_core.azurerm_policy_set_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-EventHub\"]",
            "mode": "managed",
            "type": "azurerm_policy_set_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-EventHub",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "This policy initiative is a group of policies that ensures Event Hub is compliant per regulated Landing Zones.",
              "display_name": "Enforce recommended guardrails for Event Hub",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Event Hub\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.0\"}",
              "name": "Enforce-Guardrails-EventHub",
              "parameters": "{\"eventHubAuthRules\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"eventHubNamespacesDoubleEncryption\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"eventHubNamespacesLocalAuth\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"eventHubNamespacesModifyLocalAuth\":{\"allowedValues\":[\"Modify\",\"Disabled\"],\"defaultValue\":\"Modify\",\"type\":\"string\"}}",
              "policy_definition_group": [],
              "policy_definition_reference": [
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('eventHubNamespacesDoubleEncryption')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/836cd60e-87f3-4e6a-a27c-29d687f01a4c",
                  "policy_group_names": null,
                  "reference_id": "Deny-EH-Double-Encryption"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('eventHubNamespacesModifyLocalAuth')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/57f35901-8389-40bb-ac49-3ba4f86d889d",
                  "policy_group_names": null,
                  "reference_id": "Modify-EH-Local-Auth"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('eventHubNamespacesLocalAuth')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/5d4e3c65-4873-47be-94f3-6f8b953a3598",
                  "policy_group_names": null,
                  "reference_id": "Deny-EH-Local-Auth"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('eventHubAuthRules')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/b278e460-7cfc-4451-8294-cccc40a940d7",
                  "policy_group_names": null,
                  "reference_id": "Deny-EH-Auth-Rules"
                }
              ],
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "policy_definition_group": [],
              "policy_definition_reference": [
                {},
                {},
                {},
                {}
              ]
            }
          },
          {
            "address": "module.test_core.azurerm_policy_set_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-KeyVault\"]",
            "mode": "managed",
            "type": "azurerm_policy_set_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-KeyVault",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "Enforce recommended guardrails for Azure Key Vault.",
              "display_name": "Enforce recommended guardrails for Azure Key Vault",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Key Vault\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"2.0.0\"}",
              "name": "Enforce-Guardrails-KeyVault",
              "parameters": "{\"effectKvCertLifetime\":{\"allowedValues\":[\"audit\",\"Audit\",\"deny\",\"Deny\",\"disabled\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"effectKvFirewallEnabled\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"effectKvKeysExpire\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"effectKvKeysLifetime\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"effectKvPurgeProtection\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"effectKvSecretsExpire\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"effectKvSecretsLifetime\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"effectKvSoftDelete\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"},\"type\":\"String\"},\"keyVaultArmRbac\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"keyVaultCertKeyTypes\":{\"allowedValues\":[\"audit\",\"Audit\",\"deny\",\"Deny\",\"disabled\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"keyVaultCertValidPeriod\":{\"defaultValue\":12,\"type\":\"integer\"},\"keyVaultCertificateNotExpireWithinSpecifiedNumberOfDays\":{\"allowedValues\":[\"audit\",\"Audit\",\"deny\",\"Deny\",\"disabled\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"keyVaultCertificateNotExpireWithinSpecifiedNumberOfDaysValue\":{\"defaultValue\":90,\"type\":\"integer\"},\"keyVaultCertificatesPeriod\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"type\":\"string\"},\"keyVaultCheckMinimumRSACertificateSize\":{\"allowedValues\":[\"audit\",\"Audit\",\"deny\",\"Deny\",\"disabled\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"keyVaultCheckMinimumRSAKeySize\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"keyVaultCryptographicType\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"keyVaultEllipticCurve\":{\"allowedValues\":[\"audit\",\"Audit\",\"deny\",\"Deny\",\"disabled\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"keyVaultHmsCurveNames\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"keyVaultHmsCurveNamesValue\":{\"defaultValue\":[\"P-256\",\"P-256K\",\"P-384\",\"P-521\"],\"type\":\"array\"},\"keyVaultHmsKeysExpiration\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"keyVaultHmsPurgeProtection\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"keyVaultHsmMinimumDaysBeforeExpiration\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"keyVaultHsmMinimumDaysBeforeExpirationValue\":{\"defaultValue\":90,\"type\":\"integer\"},\"keyVaultIntegratedCa\":{\"allowedValues\":[\"audit\",\"Audit\",\"deny\",\"Deny\",\"disabled\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"keyVaultIntegratedCaValue\":{\"defaultValue\":[\"DigiCert\",\"GlobalSign\"],\"type\":\"array\"},\"keyVaultManagedHsmCheckMinimumRSAKeySize\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"keyVaultManagedHsmMinimumRSAKeySizeValue\":{\"allowedValues\":[2048,3072,4096],\"defaultValue\":2048,\"type\":\"integer\"},\"keyVaultMinimumRSACertificateSizeValue\":{\"allowedValues\":[2048,3072,4096],\"defaultValue\":2048,\"type\":\"integer\"},\"keyVaultMinimumRSAKeySizeValue\":{\"allowedValues\":[2048,3072,4096],\"defaultValue\":2048,\"type\":\"integer\"},\"keyVaultNonIntegratedCa\":{\"allowedValues\":[\"audit\",\"Audit\",\"deny\",\"Deny\",\"disabled\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"type\":\"string\"},\"keyVaultNonIntegratedCaValue\":{\"defaultValue\":\"\",\"metadata\":{\"description\":\"The common name (CN) of the Certificate Authority (CA) provider. For example, for an issuer CN = Contoso, OU = .., DC = .., you can specify Contoso\",\"displayName\":\"The common name of the certificate authority\"},\"type\":\"string\"},\"keyVaultSecretContentType\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"keysActive\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"type\":\"string\"},\"keysActiveInDays\":{\"defaultValue\":90,\"type\":\"integer\"},\"keysCurveNames\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"keysValidPeriod\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"type\":\"string\"},\"keysValidityInDays\":{\"defaultValue\":90,\"type\":\"integer\"},\"maximumCertLifePercentageLife\":{\"defaultValue\":80,\"metadata\":{\"description\":\"Enter the percentage of lifetime of the certificate when you want to trigger the policy action. For example, to trigger a policy action at 80% of the certificate's valid life, enter '80'.\",\"displayName\":\"The maximum lifetime percentage\"},\"type\":\"Integer\"},\"minimumCertLifeDaysBeforeExpiry\":{\"defaultValue\":90,\"metadata\":{\"description\":\"Enter the days before expiration of the certificate when you want to trigger the policy action. For example, to trigger a policy action 90 days before the certificate's expiration, enter '90'.\",\"displayName\":\"The minimum days before expiry\"},\"type\":\"Integer\"},\"minimumKeysLifeDaysBeforeExpiry\":{\"defaultValue\":90,\"metadata\":{\"description\":\"Enter the days before expiration of the certificate when you want to trigger the policy action. For example, to trigger a policy action 90 days before the certificate's expiration, enter '90'.\",\"displayName\":\"The minimum days before expiry\"},\"type\":\"Integer\"},\"minimumSecretsLifeDaysBeforeExpiry\":{\"defaultValue\":90,\"metadata\":{\"description\":\"Enter the days before expiration of the certificate when you want to trigger the policy action. For example, to trigger a policy action 90 days before the certificate's expiration, enter '90'.\",\"displayName\":\"The minimum days before expiry\"},\"type\":\"Integer\"},\"secretsActive\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"type\":\"string\"},\"secretsActiveInDays\":{\"defaultValue\":90,\"type\":\"integer\"},\"secretsValidPeriod\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"secretsValidityInDays\":{\"defaultValue\":90,\"type\":\"integer\"}}",
              "policy_definition_group": [],
              "policy_definition_reference": [
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('effectKvSoftDelete')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/1e66c121-a66a-4b1f-9b83-0fd99bf0fc2d",
                  "policy_group_names": null,
                  "reference_id": "KvSoftDelete"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('effectKvPurgeProtection')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/0b60c0b2-2dc2-4e1c-b5c9-abbed971de53",
                  "policy_group_names": null,
                  "reference_id": "KvPurgeProtection"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('effectKvSecretsExpire')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/98728c90-32c7-4049-8429-847dc0f4fe37",
                  "policy_group_names": null,
                  "reference_id": "KvSecretsExpire"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('effectKvKeysExpire')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/152b15f7-8e1f-4c1f-ab71-8c010ba5dbc0",
                  "policy_group_names": null,
                  "reference_id": "KvKeysExpire"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('effectKvFirewallEnabled')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/55615ac9-af46-4a59-874e-391cc3dfb490",
                  "policy_group_names": null,
                  "reference_id": "KvFirewallEnabled"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('effectKvCertLifetime')]\"},\"maximumPercentageLife\":{\"value\":\"[parameters('maximumCertLifePercentageLife')]\"},\"minimumDaysBeforeExpiry\":{\"value\":\"[parameters('minimumCertLifeDaysBeforeExpiry')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/12ef42cb-9903-4e39-9c26-422d29570417",
                  "policy_group_names": null,
                  "reference_id": "KvCertLifetime"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('effectKvKeysLifetime')]\"},\"minimumDaysBeforeExpiration\":{\"value\":\"[parameters('minimumKeysLifeDaysBeforeExpiry')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/5ff38825-c5d8-47c5-b70e-069a21955146",
                  "policy_group_names": null,
                  "reference_id": "KvKeysLifetime"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('effectKvSecretsLifetime')]\"},\"minimumDaysBeforeExpiration\":{\"value\":\"[parameters('minimumSecretsLifeDaysBeforeExpiry')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/b0eb591a-5e70-4534-a8bf-04b9c489584a",
                  "policy_group_names": null,
                  "reference_id": "KvSecretsLifetime"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('keyVaultCheckMinimumRSACertificateSize')]\"},\"minimumRSAKeySize\":{\"value\":\"[parameters('keyVaultMinimumRSACertificateSizeValue')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/cee51871-e572-4576-855c-047c820360f0",
                  "policy_group_names": null,
                  "reference_id": "Deny-KV-RSA-Keys-without-MinCertSize"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('keyVaultManagedHsmCheckMinimumRSAKeySize')]\"},\"minimumRSAKeySize\":{\"value\":\"[parameters('keyVaultManagedHsmMinimumRSAKeySizeValue')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/86810a98-8e91-4a44-8386-ec66d0de5d57",
                  "policy_group_names": null,
                  "reference_id": "Deny-keyVaultManagedHsm-RSA-Keys-without-MinKeySize"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('keyVaultCheckMinimumRSAKeySize')]\"},\"minimumRSAKeySize\":{\"value\":\"[parameters('keyVaultMinimumRSAKeySizeValue')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/82067dbb-e53b-4e06-b631-546d197452d9",
                  "policy_group_names": null,
                  "reference_id": "Deny-KV-RSA-Keys-without-MinKeySize"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('keyVaultArmRbac')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/12d4fa5e-1f9f-4c21-97a9-b99b3c6611b5",
                  "policy_group_names": null,
                  "reference_id": "Deny-KV-without-ArmRbac"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('keyVaultHmsPurgeProtection')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/c39ba22d-4428-4149-b981-70acb31fc383",
                  "policy_group_names": null,
                  "reference_id": "Deny-KV-Hms-PurgeProtection"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('keyVaultCertificatesPeriod')]\"},\"maximumValidityInMonths\":{\"value\":\"[parameters('keyVaultCertValidPeriod')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/0a075868-4c26-42ef-914c-5bc007359560",
                  "policy_group_names": null,
                  "reference_id": "Deny-KV-Cert-Period"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('keyVaultHmsKeysExpiration')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/1d478a74-21ba-4b9f-9d8f-8e6fced0eec5",
                  "policy_group_names": null,
                  "reference_id": "Deny-KV-Hms-Key-Expire"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('keysValidPeriod')]\"},\"maximumValidityInDays\":{\"value\":\"[parameters('keysValidityInDays')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/49a22571-d204-4c91-a7b6-09b1a586fbc9",
                  "policy_group_names": null,
                  "reference_id": "Deny-KV-Keys-Expire"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('secretsValidPeriod')]\"},\"maximumValidityInDays\":{\"value\":\"[parameters('secretsValidityInDays')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/342e8053-e12e-4c44-be01-c3c2f318400f",
                  "policy_group_names": null,
                  "reference_id": "Deny-KV-Secrets-ValidityDays"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('keyVaultCertKeyTypes')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/1151cede-290b-4ba0-8b38-0ad145ac888f",
                  "policy_group_names": null,
                  "reference_id": "Deny-KV-Key-Types"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('keyVaultEllipticCurve')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/bd78111f-4953-4367-9fd5-7e08808b54bf",
                  "policy_group_names": null,
                  "reference_id": "Deny-KV-Elliptic-Curve"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('keyVaultCryptographicType')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/75c4f823-d65c-4f29-a733-01d0077fdbcb",
                  "policy_group_names": null,
                  "reference_id": "Deny-KV-Cryptographic-Type"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('keysActive')]\"},\"maximumValidityInDays\":{\"value\":\"[parameters('keysActiveInDays')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/c26e4b24-cf98-4c67-b48b-5a25c4c69eb9",
                  "policy_group_names": null,
                  "reference_id": "Deny-KV-Key-Active"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('keysCurveNames')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/ff25f3c8-b739-4538-9d07-3d6d25cfb255",
                  "policy_group_names": null,
                  "reference_id": "Deny-KV-Curve-Names"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('secretsActive')]\"},\"maximumValidityInDays\":{\"value\":\"[parameters('secretsActiveInDays')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/e8d99835-8a06-45ae-a8e0-87a91941ccfe",
                  "policy_group_names": null,
                  "reference_id": "Deny-KV-Secret-ActiveDays"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('keyVaultSecretContentType')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/75262d3e-ba4a-4f43-85f8-9f72c090e5e3",
                  "policy_group_names": null,
                  "reference_id": "Deny-Kv-Secret-Content-Type"
                },
                {
                  "parameter_values": "{\"caCommonName\":{\"value\":\"[parameters('keyVaultNonIntegratedCaValue')]\"},\"effect\":{\"value\":\"[parameters('keyVaultNonIntegratedCa')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/a22f4a40-01d3-4c7d-8071-da157eeff341",
                  "policy_group_names": null,
                  "reference_id": "Deny-Kv-Non-Integrated-Ca"
                },
                {
                  "parameter_values": "{\"allowedCAs\":{\"value\":\"[parameters('keyVaultIntegratedCaValue')]\"},\"effect\":{\"value\":\"[parameters('keyVaultIntegratedCa')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/8e826246-c976-48f6-b03e-619bb92b3d82",
                  "policy_group_names": null,
                  "reference_id": "Deny-Kv-Integrated-Ca"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('keyVaultHsmMinimumDaysBeforeExpiration')]\"},\"minimumDaysBeforeExpiration\":{\"value\":\"[parameters('keyVaultHsmMinimumDaysBeforeExpirationValue')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/ad27588c-0198-4c84-81ef-08efd0274653",
                  "policy_group_names": null,
                  "reference_id": "Deny-Kv-Hsm-MinimumDays-Before-Expiration"
                },
                {
                  "parameter_values": "{\"allowedECNames\":{\"value\":\"[parameters('keyVaultHmsCurveNamesValue')]\"},\"effect\":{\"value\":\"[parameters('keyVaultHmsCurveNames')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/e58fd0c1-feac-4d12-92db-0a7e9421f53e",
                  "policy_group_names": null,
                  "reference_id": "Deny-Kv-Hsm-Curve-Names"
                },
                {
                  "parameter_values": "{\"daysToExpire\":{\"value\":\"[parameters('keyVaultCertificateNotExpireWithinSpecifiedNumberOfDaysValue')]\"},\"effect\":{\"value\":\"[parameters('keyVaultCertificateNotExpireWithinSpecifiedNumberOfDays')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/f772fb64-8e40-40ad-87bc-7706e1949427",
                  "policy_group_names": null,
                  "reference_id": "Deny-Kv-Cert-Expiration-Within-Specific-Number-Days"
                }
              ],
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "policy_definition_group": [],
              "policy_definition_reference": [
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {}
              ]
            }
          },
          {
            "address": "module.test_core.azurerm_policy_set_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-KeyVault-Sup\"]",
            "mode": "managed",
            "type": "azurerm_policy_set_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-KeyVault-Sup",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "This policy initiative is a group of policies that ensures Key Vault is compliant per regulated Landing Zones.",
              "display_name": "Enforce additional recommended guardrails for Key Vault",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Key Vault\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.0\"}",
              "name": "Enforce-Guardrails-KeyVault-Sup",
              "parameters": "{\"keyVaultManagedHsmDisablePublicNetworkModify\":{\"allowedValues\":[\"Modify\",\"Disabled\"],\"defaultValue\":\"Modify\",\"type\":\"string\"},\"keyVaultModifyFw\":{\"allowedValues\":[\"Modify\",\"Disabled\"],\"defaultValue\":\"Modify\",\"type\":\"string\"}}",
              "policy_definition_group": [],
              "policy_definition_reference": [
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('keyVaultManagedHsmDisablePublicNetworkModify')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/84d327c3-164a-4685-b453-900478614456",
                  "policy_group_names": null,
                  "reference_id": "Modify-KV-PublicNetworkAccess"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('keyVaultModifyFw')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/ac673a9a-f77d-4846-b2d8-a57f8e1c01dc",
                  "policy_group_names": null,
                  "reference_id": "Modify-KV-Fw"
                }
              ],
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "policy_definition_group": [],
              "policy_definition_reference": [
                {},
                {}
              ]
            }
          },
          {
            "address": "module.test_core.azurerm_policy_set_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-Kubernetes\"]",
            "mode": "managed",
            "type": "azurerm_policy_set_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-Kubernetes",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "This policy initiative is a group of policies that ensures Kubernetes is compliant per regulated Landing Zones.",
              "display_name": "Enforce recommended guardrails for Kubernetes",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Kubernetes\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.0\"}",
              "name": "Enforce-Guardrails-Kubernetes",
              "parameters": "{\"aksAllowedCapabilities\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"aksCni\":{\"allowedValues\":[\"Audit\",\"Disabled\"],\"defaultValue\":\"Audit\",\"type\":\"string\"},\"aksCommandInvoke\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"type\":\"string\"},\"aksDefaultNamespace\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"aksInternalLb\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"aksKms\":{\"allowedValues\":[\"Audit\",\"Disabled\"],\"defaultValue\":\"Audit\",\"type\":\"string\"},\"aksLocalAuth\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"aksNakedPods\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"aksPolicy\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"type\":\"string\"},\"aksPrivContainers\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"aksPrivEscalation\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"aksPrivateCluster\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"aksReadinessOrLivenessProbes\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"aksShareHostProcessAndNamespace\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"aksTempDisk\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"aksWindowsContainerAdministrator\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"}}",
              "policy_definition_group": [],
              "policy_definition_reference": [
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('aksWindowsContainerAdministrator')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/5485eac0-7e8f-4964-998b-a44f4f0c1e75",
                  "policy_group_names": null,
                  "reference_id": "Deny-Aks-Windows-Container-Administrator"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('aksShareHostProcessAndNamespace')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/47a1ee2f-2a2a-4576-bf2a-e0e36709c2b8",
                  "policy_group_names": null,
                  "reference_id": "Deny-Aks-Shared-Host-Process-Namespace"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('aksNakedPods')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/65280eef-c8b4-425e-9aec-af55e55bf581",
                  "policy_group_names": null,
                  "reference_id": "Deny-Aks-Naked-Pods"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('aksDefaultNamespace')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/9f061a12-e40d-4183-a00e-171812443373",
                  "policy_group_names": null,
                  "reference_id": "Deny-Aks-Default-Namespace"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('aksInternalLb')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/3fc4dc25-5baf-40d8-9b05-7fe74c1bc64e",
                  "policy_group_names": null,
                  "reference_id": "Deny-Aks-Internal-Lb"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('aksTempDisk')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/41425d9f-d1a5-499a-9932-f8ed8453932c",
                  "policy_group_names": null,
                  "reference_id": "Deny-Aks-Temp-Disk-Encryption"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('aksAllowedCapabilities')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/c26596ff-4d70-4e6a-9a30-c2506bd2f80c",
                  "policy_group_names": null,
                  "reference_id": "Deny-Aks-Allowed-Capabilities"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('aksPrivEscalation')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/1c6e92c9-99f0-4e55-9cf2-0c234dc48f99",
                  "policy_group_names": null,
                  "reference_id": "Deny-Aks-Priv-Escalation"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('aksPrivContainers')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/95edb821-ddaf-4404-9732-666045e056b4",
                  "policy_group_names": null,
                  "reference_id": "Deny-Aks-Priv-Containers"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('aksReadinessOrLivenessProbes')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/b1a9997f-2883-4f12-bdff-2280f99b5915",
                  "policy_group_names": null,
                  "reference_id": "Deny-Aks-ReadinessOrLiveness-Probes"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('aksCommandInvoke')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/1b708b0a-3380-40e9-8b79-821f9fa224cc",
                  "policy_group_names": null,
                  "reference_id": "Dine-Aks-Command-Invoke"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('aksPolicy')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/a8eff44f-8c92-45c3-a3fb-9880802d67a7",
                  "policy_group_names": null,
                  "reference_id": "Dine-Aks-Policy"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('aksPrivateCluster')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/040732e8-d947-40b8-95d6-854c95024bf8",
                  "policy_group_names": null,
                  "reference_id": "Deny-Aks-Private-Cluster"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('aksLocalAuth')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/993c2fcd-2b29-49d2-9eb0-df2c3a730c32",
                  "policy_group_names": null,
                  "reference_id": "Deny-Aks-Local-Auth"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('aksKms')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/dbbdc317-9734-4dd8-9074-993b29c69008",
                  "policy_group_names": null,
                  "reference_id": "Deny-Aks-Kms"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('aksCni')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/46238e2f-3f6f-4589-9f3f-77bed4116e67",
                  "policy_group_names": null,
                  "reference_id": "Deny-Aks-Cni"
                }
              ],
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "policy_definition_group": [],
              "policy_definition_reference": [
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {}
              ]
            }
          },
          {
            "address": "module.test_core.azurerm_policy_set_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-MachineLearning\"]",
            "mode": "managed",
            "type": "azurerm_policy_set_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-MachineLearning",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "This policy initiative is a group of policies that ensures Machine Learning is compliant per regulated Landing Zones.",
              "display_name": "Enforce recommended guardrails for Machine Learning",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Machine Learning\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.0\"}",
              "name": "Enforce-Guardrails-MachineLearning",
              "parameters": "{\"mlLocalAuth\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"mlModifyLocalAuth\":{\"allowedValues\":[\"Modify\",\"Disabled\"],\"defaultValue\":\"Modify\",\"type\":\"string\"},\"mlModifyPublicNetworkAccess\":{\"allowedValues\":[\"Modify\",\"Disabled\"],\"defaultValue\":\"Modify\",\"type\":\"string\"},\"mlOutdatedOS\":{\"allowedValues\":[\"Audit\",\"Disabled\"],\"defaultValue\":\"Audit\",\"type\":\"string\"},\"mlUserAssignedIdentity\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"}}",
              "policy_definition_group": [],
              "policy_definition_reference": [
                {
                  "parameter_values": "{\"effects\":{\"value\":\"[parameters('mlOutdatedOS')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/f110a506-2dcb-422e-bcea-d533fc8c35e2",
                  "policy_group_names": null,
                  "reference_id": "Deny-ML-Outdated-Os"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('mlLocalAuth')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/e96a9a5f-07ca-471b-9bc5-6a0f33cbd68f",
                  "policy_group_names": null,
                  "reference_id": "Deny-ML-Local-Auth"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('mlModifyLocalAuth')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/a6f9a2d0-cff7-4855-83ad-4cd750666512",
                  "policy_group_names": null,
                  "reference_id": "Modify-ML-Local-Auth"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('mlUserAssignedIdentity')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/5f0c7d88-c7de-45b8-ac49-db49e72eaa78",
                  "policy_group_names": null,
                  "reference_id": "Deny-ML-User-Assigned-Identity"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('mlModifyPublicNetworkAccess')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/a10ee784-7409-4941-b091-663697637c0f",
                  "policy_group_names": null,
                  "reference_id": "Modify-ML-Public-Network-Access"
                }
              ],
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "policy_definition_group": [],
              "policy_definition_reference": [
                {},
                {},
                {},
                {},
                {}
              ]
            }
          },
          {
            "address": "module.test_core.azurerm_policy_set_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-MySQL\"]",
            "mode": "managed",
            "type": "azurerm_policy_set_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-MySQL",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "This policy initiative is a group of policies that ensures MySQL is compliant per regulated Landing Zones.",
              "display_name": "Enforce recommended guardrails for MySQL",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"MySQL\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.0\"}",
              "name": "Enforce-Guardrails-MySQL",
              "parameters": "{\"mySqlAdvThreatProtection\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"type\":\"string\"},\"mySqlInfraEncryption\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"}}",
              "policy_definition_group": [],
              "policy_definition_reference": [
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('mySqlAdvThreatProtection')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/80ed5239-4122-41ed-b54a-6f1fa7552816",
                  "policy_group_names": null,
                  "reference_id": "Dine-MySql-Adv-Threat-Protection"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('mySqlInfraEncryption')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/3a58212a-c829-4f13-9872-6371df2fd0b4",
                  "policy_group_names": null,
                  "reference_id": "Deny-MySql-Infra-Encryption"
                }
              ],
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "policy_definition_group": [],
              "policy_definition_reference": [
                {},
                {}
              ]
            }
          },
          {
            "address": "module.test_core.azurerm_policy_set_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-Network\"]",
            "mode": "managed",
            "type": "azurerm_policy_set_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-Network",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "This policy initiative is a group of policies that ensures Network and Networking services are compliant per regulated Landing Zones.",
              "display_name": "Enforce recommended guardrails for Network and Networking services",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Network\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.0\"}",
              "name": "Enforce-Guardrails-Network",
              "parameters": "{\"afwEmptyIDPSBypassList\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"afwEnableAllIDPSSignatureRules\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"afwEnableIDPS\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"afwEnableTlsInspection\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"afwEnbaleTlsForAllAppRules\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"appGwTlsVersion\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"appGwWaf\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"ddosPlanResourceId\":{\"defaultValue\":\"\",\"type\":\"string\"},\"denyMgmtFromInternet\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"denyMgmtFromInternetPorts\":{\"defaultValue\":[\"22\",\"3389\"],\"metadata\":{\"description\":\"Ports to be blocked\",\"displayName\":\"Ports\"},\"type\":\"Array\"},\"modifyNsg\":{\"allowedValues\":[\"Modify\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"type\":\"string\"},\"modifyNsgRuleAccess\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"modifyNsgRuleDescription\":{\"defaultValue\":\"Deny any outbound traffic to the Internet\",\"type\":\"string\"},\"modifyNsgRuleDestinationAddressPrefix\":{\"defaultValue\":\"Internet\",\"type\":\"string\"},\"modifyNsgRuleDestinationPortRange\":{\"defaultValue\":\"*\",\"type\":\"string\"},\"modifyNsgRuleDirection\":{\"defaultValue\":\"Outbound\",\"type\":\"string\"},\"modifyNsgRuleName\":{\"defaultValue\":\"DenyAnyInternetOutbound\",\"type\":\"string\"},\"modifyNsgRulePriority\":{\"defaultValue\":1000,\"type\":\"integer\"},\"modifyNsgRuleProtocol\":{\"defaultValue\":\"*\",\"type\":\"string\"},\"modifyNsgRuleSourceAddressPrefix\":{\"defaultValue\":\"*\",\"type\":\"string\"},\"modifyNsgRuleSourcePortRange\":{\"defaultValue\":\"*\",\"type\":\"string\"},\"modifyUdr\":{\"defaultValue\":\"Disabled\",\"type\":\"string\"},\"modifyUdrAddressPrefix\":{\"defaultValue\":\"0.0.0.0/0\",\"type\":\"string\"},\"modifyUdrNextHopIpAddress\":{\"defaultValue\":\"\",\"type\":\"string\"},\"modifyUdrNextHopType\":{\"defaultValue\":\"None\",\"type\":\"string\"},\"subnetNsg\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"subnetServiceEndpoint\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"subnetUdr\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"vnetModifyDdos\":{\"defaultValue\":\"Modify\",\"type\":\"string\"},\"vpnAzureAD\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"wafAfdEnabled\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"wafFwRules\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"wafMode\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"wafModeAppGw\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"wafModeAppGwRequirement\":{\"defaultValue\":\"Prevention\",\"type\":\"string\"},\"wafModeRequirement\":{\"defaultValue\":\"Prevention\",\"type\":\"string\"}}",
              "policy_definition_group": [],
              "policy_definition_reference": [
                {
                  "parameter_values": "{}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/35f9c03a-cc27-418e-9c0c-539ff999d010",
                  "policy_group_names": null,
                  "reference_id": "Deny-Nsg-GW-subnet"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('vpnAzureAD')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/21a6bc25-125e-4d13-b82d-2e19b7208ab7",
                  "policy_group_names": null,
                  "reference_id": "Deny-VPN-AzureAD"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('wafAfdEnabled')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/055aa869-bc98-4af8-bafc-23f1ab6ffe2c",
                  "policy_group_names": null,
                  "reference_id": "Deny-Waf-Afd-Enabled"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('afwEnableIDPS')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/6484db87-a62d-4327-9f07-80a2cbdf333a",
                  "policy_group_names": null,
                  "reference_id": "Deny-Waf-IDPS"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('afwEnableAllIDPSSignatureRules')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/610b6183-5f00-4d68-86d2-4ab4cb3a67a5",
                  "policy_group_names": null,
                  "reference_id": "Deny-FW-AllIDPSS"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('afwEmptyIDPSBypassList')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/f516dc7a-4543-4d40-aad6-98f76a706b50",
                  "policy_group_names": null,
                  "reference_id": "Deny-FW-EmpIDPSBypass"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('afwEnableTlsInspection')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/711c24bb-7f18-4578-b192-81a6161e1f17",
                  "policy_group_names": null,
                  "reference_id": "Deny-FW-TLS-Inspection"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('afwEnbaleTlsForAllAppRules')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/a58ac66d-92cb-409c-94b8-8e48d7a96596",
                  "policy_group_names": null,
                  "reference_id": "Deny-FW-TLS-AllApp"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('wafModeAppGw')]\"},\"modeRequirement\":{\"value\":\"[parameters('wafModeAppGwRequirement')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/12430be1-6cc8-4527-a9a8-e3d38f250096",
                  "policy_group_names": null,
                  "reference_id": "Deny-Waf-AppGw-mode"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('wafFwRules')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/632d3993-e2c0-44ea-a7db-2eca131f356d",
                  "policy_group_names": null,
                  "reference_id": "Deny-Waf-Fw-rules"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('wafMode')]\"},\"modeRequirement\":{\"value\":\"[parameters('wafModeRequirement')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/425bea59-a659-4cbb-8d31-34499bd030b8",
                  "policy_group_names": null,
                  "reference_id": "Deny-Waf-mode"
                },
                {
                  "parameter_values": "{\"ddosPlan\":{\"value\":\"[parameters('ddosPlanResourceId')]\"},\"effect\":{\"value\":\"[parameters('vnetModifyDdos')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/94de2ad3-e0c1-4caf-ad78-5d47bbc83d3d",
                  "policy_group_names": null,
                  "reference_id": "Modify-vNet-DDoS"
                },
                {
                  "parameter_values": "{}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/88c0b9da-ce96-4b03-9635-f29a937e2900",
                  "policy_group_names": null,
                  "reference_id": "Deny-Ip-Forwarding"
                },
                {
                  "parameter_values": "{}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/83a86a26-fd1f-447c-b59d-e51f44264114",
                  "policy_group_names": null,
                  "reference_id": "Deny-vNic-Pip"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('appGwWaf')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/564feb30-bf6a-4854-b4bb-0d2d2d1e6c66",
                  "policy_group_names": null,
                  "reference_id": "Deny-AppGw-Without-Waf"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('subnetUdr')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-Subnet-Without-Udr",
                  "policy_group_names": null,
                  "reference_id": "Deny-Subnet-Without-Udr"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('subnetNsg')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-Subnet-Without-Nsg",
                  "policy_group_names": null,
                  "reference_id": "Deny-Subnet-Without-NSG"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('subnetServiceEndpoint')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-Service-Endpoints",
                  "policy_group_names": null,
                  "reference_id": "Deny-Subnet-with-Service-Endpoints"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('denyMgmtFromInternet')]\"},\"ports\":{\"value\":\"[parameters('denyMgmtFromInternetPorts')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-MgmtPorts-From-Internet",
                  "policy_group_names": null,
                  "reference_id": "Deny-Mgmt-From-Internet"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('appGwTlsVersion')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-AppGw-Without-Tls",
                  "policy_group_names": null,
                  "reference_id": "Deny-AppGw-Without-Tls"
                },
                {
                  "parameter_values": "{\"addressPrefix\":{\"value\":\"[parameters('modifyUdrAddressPrefix')]\"},\"effect\":{\"value\":\"[parameters('modifyUdr')]\"},\"nextHopIpAddress\":{\"value\":\"[parameters('modifyUdrNextHopIpAddress')]\"},\"nextHopType\":{\"value\":\"[parameters('modifyUdrNextHopType')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Modify-UDR",
                  "policy_group_names": null,
                  "reference_id": "Modify-Udr"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('modifyNsg')]\"},\"nsgRuleAccess\":{\"value\":\"[parameters('modifyNsgRuleAccess')]\"},\"nsgRuleDescription\":{\"value\":\"[parameters('modifyNsgRuleDescription')]\"},\"nsgRuleDestinationAddressPrefix\":{\"value\":\"[parameters('modifyNsgRuleDestinationAddressPrefix')]\"},\"nsgRuleDestinationPortRange\":{\"value\":\"[parameters('modifyNsgRuleDestinationPortRange')]\"},\"nsgRuleDirection\":{\"value\":\"[parameters('modifyNsgRuleDirection')]\"},\"nsgRuleName\":{\"value\":\"[parameters('modifyNsgRuleName')]\"},\"nsgRulePriority\":{\"value\":\"[parameters('modifyNsgRulePriority')]\"},\"nsgRuleProtocol\":{\"value\":\"[parameters('modifyNsgRuleProtocol')]\"},\"nsgRuleSourceAddressPrefix\":{\"value\":\"[parameters('modifyNsgRuleSourceAddressPrefix')]\"},\"nsgRuleSourcePortRange\":{\"value\":\"[parameters('modifyNsgRuleSourcePortRange')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Modify-NSG",
                  "policy_group_names": null,
                  "reference_id": "Modify-Nsg"
                }
              ],
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "policy_definition_group": [],
              "policy_definition_reference": [
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {}
              ]
            }
          },
          {
            "address": "module.test_core.azurerm_policy_set_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-OpenAI\"]",
            "mode": "managed",
            "type": "azurerm_policy_set_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-OpenAI",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "This policy initiative is a group of policies that ensures Open AI (Cognitive Service) is compliant per regulated Landing Zones.",
              "display_name": "Enforce recommended guardrails for Open AI (Cognitive Service)",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Cognitive Services\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.0\"}",
              "name": "Enforce-Guardrails-OpenAI",
              "parameters": "{\"cognitiveServicesCustomerStorage\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"cognitiveServicesDisableLocalAuth\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"cognitiveServicesManagedIdentity\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"cognitiveServicesModifyDisableLocalAuth\":{\"allowedValues\":[\"Modify\",\"Disabled\"],\"defaultValue\":\"Modify\",\"type\":\"string\"},\"cognitiveServicesNetworkAcls\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"cognitiveServicesOutboundNetworkAccess\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"}}",
              "policy_definition_group": [],
              "policy_definition_reference": [
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('cognitiveServicesOutboundNetworkAccess')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-CognitiveServices-RestrictOutboundNetworkAccess",
                  "policy_group_names": null,
                  "reference_id": "Deny-OpenAi-OutboundNetworkAccess"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('cognitiveServicesNetworkAcls')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-CognitiveServices-NetworkAcls",
                  "policy_group_names": null,
                  "reference_id": "Deny-OpenAi-NetworkAcls"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('cognitiveServicesManagedIdentity')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/fe3fd216-4f83-4fc1-8984-2bbec80a3418",
                  "policy_group_names": null,
                  "reference_id": "Deny-Cognitive-Services-Managed-Identity"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('cognitiveServicesDisableLocalAuth')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/71ef260a-8f18-47b7-abcb-62d0673d94dc",
                  "policy_group_names": null,
                  "reference_id": "Deny-Cognitive-Services-Local-Auth"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('cognitiveServicesCustomerStorage')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/46aa9b05-0e60-4eae-a88b-1e9d374fa515",
                  "policy_group_names": null,
                  "reference_id": "Deny-Cognitive-Services-Cust-Storage"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('cognitiveServicesModifyDisableLocalAuth')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/14de9e63-1b31-492e-a5a3-c3f7fd57f555",
                  "policy_group_names": null,
                  "reference_id": "Modify-Cognitive-Services-Local-Auth"
                }
              ],
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "policy_definition_group": [],
              "policy_definition_reference": [
                {},
                {},
                {},
                {},
                {},
                {}
              ]
            }
          },
          {
            "address": "module.test_core.azurerm_policy_set_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-PostgreSQL\"]",
            "mode": "managed",
            "type": "azurerm_policy_set_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-PostgreSQL",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "This policy initiative is a group of policies that ensures PostgreSQL is compliant per regulated Landing Zones.",
              "display_name": "Enforce recommended guardrails for PostgreSQL",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"PostgreSQL\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.0\"}",
              "name": "Enforce-Guardrails-PostgreSQL",
              "parameters": "{\"postgreSqlAdvThreatProtection\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"type\":\"string\"}}",
              "policy_definition_group": [],
              "policy_definition_reference": [
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('postgreSqlAdvThreatProtection')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/db048e65-913c-49f9-bb5f-1084184671d3",
                  "policy_group_names": null,
                  "reference_id": "Dine-PostgreSql-Adv-Threat-Protection"
                }
              ],
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "policy_definition_group": [],
              "policy_definition_reference": [
                {}
              ]
            }
          },
          {
            "address": "module.test_core.azurerm_policy_set_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-SQL\"]",
            "mode": "managed",
            "type": "azurerm_policy_set_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-SQL",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "This policy initiative is a group of policies that ensures SQL and SQL Managed Instance is compliant per regulated Landing Zones.",
              "display_name": "Enforce recommended guardrails for SQL and SQL Managed Instance",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"SQL\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.0\"}",
              "name": "Enforce-Guardrails-SQL",
              "parameters": "{\"modifySqlPublicNetworkAccess\":{\"allowedValues\":[\"Modify\",\"Disabled\"],\"defaultValue\":\"Modify\",\"type\":\"string\"},\"sqlAadOnly\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"sqlManagedAadOnly\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"sqlManagedDefender\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"type\":\"string\"}}",
              "policy_definition_group": [],
              "policy_definition_reference": [
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('sqlManagedDefender')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/c5a62eb0-c65a-4220-8a4d-f70dd4ca95dd",
                  "policy_group_names": null,
                  "reference_id": "Dine-Sql-Managed-Defender"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('sqlAadOnly')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/abda6d70-9778-44e7-84a8-06713e6db027",
                  "policy_group_names": null,
                  "reference_id": "Deny-Sql-Aad-Only"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('sqlManagedAadOnly')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/78215662-041e-49ed-a9dd-5385911b3a1f",
                  "policy_group_names": null,
                  "reference_id": "Deny-Sql-Managed-Aad-Only"
                },
                {
                  "parameter_values": "{}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/6134c3db-786f-471e-87bc-8f479dc890f6",
                  "policy_group_names": null,
                  "reference_id": "Dine-Sql-Adv-Data"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('modifySqlPublicNetworkAccess')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/28b0b1e5-17ba-4963-a7a4-5a1ab4400a0b",
                  "policy_group_names": null,
                  "reference_id": "Modify-Sql-PublicNetworkAccess"
                }
              ],
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "policy_definition_group": [],
              "policy_definition_reference": [
                {},
                {},
                {},
                {},
                {}
              ]
            }
          },
          {
            "address": "module.test_core.azurerm_policy_set_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-ServiceBus\"]",
            "mode": "managed",
            "type": "azurerm_policy_set_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-ServiceBus",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "This policy initiative is a group of policies that ensures Service Bus is compliant per regulated Landing Zones.",
              "display_name": "Enforce recommended guardrails for Service Bus",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Service Bus\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.0\"}",
              "name": "Enforce-Guardrails-ServiceBus",
              "parameters": "{\"serviceBusAuthzRules\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"serviceBusDenyDisabledLocalAuth\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"serviceBusDoubleEncryption\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"serviceBusModifyDisableLocalAuth\":{\"allowedValues\":[\"Modify\",\"Disabled\"],\"defaultValue\":\"Modify\",\"type\":\"string\"}}",
              "policy_definition_group": [],
              "policy_definition_reference": [
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('serviceBusAuthzRules')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/a1817ec0-a368-432a-8057-8371e17ac6ee",
                  "policy_group_names": null,
                  "reference_id": "Deny-Sb-Authz-Rules"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('serviceBusDoubleEncryption')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/ebaf4f25-a4e8-415f-86a8-42d9155bef0b",
                  "policy_group_names": null,
                  "reference_id": "Deny-Sb-Encryption"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('serviceBusDenyDisabledLocalAuth')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/cfb11c26-f069-4c14-8e36-56c394dae5af",
                  "policy_group_names": null,
                  "reference_id": "Deny-Sb-LocalAuth"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('serviceBusModifyDisableLocalAuth')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/910711a6-8aa2-4f15-ae62-1e5b2ed3ef9e",
                  "policy_group_names": null,
                  "reference_id": "Modify-Sb-LocalAuth"
                }
              ],
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "policy_definition_group": [],
              "policy_definition_reference": [
                {},
                {},
                {},
                {}
              ]
            }
          },
          {
            "address": "module.test_core.azurerm_policy_set_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-Storage\"]",
            "mode": "managed",
            "type": "azurerm_policy_set_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-Storage",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "This policy initiative is a group of policies that ensures Storage is compliant per regulated Landing Zones.",
              "display_name": "Enforce recommended guardrails for Storage Account",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Storage\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.0\"}",
              "name": "Enforce-Guardrails-Storage",
              "parameters": "{\"modifyStorageAccountPublicEndpoint\":{\"allowedValues\":[\"Modify\",\"Disabled\"],\"defaultValue\":\"Modify\",\"type\":\"string\"},\"modifyStorageFileSyncPublicEndpoint\":{\"allowedValues\":[\"Modify\",\"Disabled\"],\"defaultValue\":\"Modify\",\"type\":\"string\"},\"storageAccountNetworkRules\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"storageAccountRestrictNetworkRules\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"storageAccountSharedKey\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"storageAccountsAllowedCopyScope\":{\"defaultValue\":\"AAD\",\"type\":\"string\"},\"storageAccountsCopyScope\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"storageAccountsCrossTenant\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"storageAccountsDoubleEncryption\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"storageAccountsInfraEncryption\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"storageAccountsModifyDisablePublicNetworkAccess\":{\"allowedValues\":[\"Modify\",\"Disabled\"],\"defaultValue\":\"Modify\",\"type\":\"string\"},\"storageAllowedNetworkAclsBypass\":{\"defaultValue\":[\"None\"],\"type\":\"array\"},\"storageClassicToArm\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"storageContainerDeleteRetentionPolicy\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"storageCorsRules\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"storageKeysExpiration\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"storageLocalUser\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Disabled\",\"type\":\"string\"},\"storageMinContainerDeleteRetentionInDays\":{\"defaultValue\":7,\"type\":\"Integer\"},\"storageNetworkAclsBypass\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"storageNetworkAclsVirtualNetworkRules\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"storageResourceAccessRulesResourceId\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"storageResourceAccessRulesTenantId\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"storageServicesEncryption\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"storageSftp\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"storageThreatProtection\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"type\":\"string\"}}",
              "policy_definition_group": [],
              "policy_definition_reference": [
                {
                  "parameter_values": "{\"allowedCopyScope\":{\"value\":\"[parameters('storageAccountsAllowedCopyScope')]\"},\"effect\":{\"value\":\"[parameters('storageAccountsCopyScope')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-Storage-CopyScope",
                  "policy_group_names": null,
                  "reference_id": "Deny-Storage-CopyScope"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('storageServicesEncryption')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-Storage-ServicesEncryption",
                  "policy_group_names": null,
                  "reference_id": "Deny-Storage-ServicesEncryption"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('storageLocalUser')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-Storage-LocalUser",
                  "policy_group_names": null,
                  "reference_id": "Deny-Storage-LocalUser"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('storageSftp')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-Storage-SFTP",
                  "policy_group_names": null,
                  "reference_id": "Deny-Storage-SFTP"
                },
                {
                  "parameter_values": "{\"allowedBypassOptions\":{\"value\":\"[parameters('storageAllowedNetworkAclsBypass')]\"},\"effect\":{\"value\":\"[parameters('storageNetworkAclsBypass')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-Storage-NetworkAclsBypass",
                  "policy_group_names": null,
                  "reference_id": "Deny-Storage-NetworkAclsBypass"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('storageResourceAccessRulesTenantId')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-Storage-ResourceAccessRulesTenantId",
                  "policy_group_names": null,
                  "reference_id": "Deny-Storage-ResourceAccessRulesTenantId"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('storageResourceAccessRulesResourceId')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-Storage-ResourceAccessRulesResourceId",
                  "policy_group_names": null,
                  "reference_id": "Deny-Storage-ResourceAccessRulesResourceId"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('storageNetworkAclsVirtualNetworkRules')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-Storage-NetworkAclsVirtualNetworkRules",
                  "policy_group_names": null,
                  "reference_id": "Deny-Storage-NetworkAclsVirtualNetworkRules"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('storageContainerDeleteRetentionPolicy')]\"},\"minContainerDeleteRetentionInDays\":{\"value\":\"[parameters('storageMinContainerDeleteRetentionInDays')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-Storage-ContainerDeleteRetentionPolicy",
                  "policy_group_names": null,
                  "reference_id": "Deny-Storage-ContainerDeleteRetentionPolicy"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('storageCorsRules')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-Storage-CorsRules",
                  "policy_group_names": null,
                  "reference_id": "Deny-Storage-CorsRules"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('storageAccountsDoubleEncryption')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/bfecdea6-31c4-4045-ad42-71b9dc87247d",
                  "policy_group_names": null,
                  "reference_id": "Deny-Storage-Account-Encryption"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('storageAccountsCrossTenant')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/92a89a79-6c52-4a7e-a03f-61306fc49312",
                  "policy_group_names": null,
                  "reference_id": "Deny-Storage-Cross-Tenant"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('storageAccountSharedKey')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/8c6a50c6-9ffd-4ae7-986f-5fa6111f9a54",
                  "policy_group_names": null,
                  "reference_id": "Deny-Storage-Shared-Key"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('storageAccountsInfraEncryption')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/4733ea7b-a883-42fe-8cac-97454c2a9e4a",
                  "policy_group_names": null,
                  "reference_id": "Deny-Storage-Infra-Encryption"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('storageClassicToArm')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/37e0d2fe-28a5-43d6-a273-67d37d1f5606",
                  "policy_group_names": null,
                  "reference_id": "Deny-Storage-Classic"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('storageThreatProtection')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/361c2074-3595-4e5d-8cab-4f21dffc835c",
                  "policy_group_names": null,
                  "reference_id": "Dine-Storage-Threat-Protection"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('storageAccountRestrictNetworkRules')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/34c877ad-507e-4c82-993e-3452a6e0ad3c",
                  "policy_group_names": null,
                  "reference_id": "Deny-Storage-Restrict-NetworkRules"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('storageAccountNetworkRules')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/2a1a9cdf-e04d-429a-8416-3bfb72a1b26f",
                  "policy_group_names": null,
                  "reference_id": "Deny-Storage-NetworkRules"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('storageKeysExpiration')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/044985bb-afe1-42cd-8a36-9d5d42424537",
                  "policy_group_names": null,
                  "reference_id": "Deny-Storage-Account-Keys-Expire"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('modifyStorageFileSyncPublicEndpoint')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/0e07b2e9-6cd9-4c40-9ccb-52817b95133b",
                  "policy_group_names": null,
                  "reference_id": "Modify-Storage-FileSync-PublicEndpoint"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('modifyStorageAccountPublicEndpoint')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/13502221-8df0-4414-9937-de9c5c4e396b",
                  "policy_group_names": null,
                  "reference_id": "Modify-Blob-Storage-Account-PublicEndpoint"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('storageAccountsModifyDisablePublicNetworkAccess')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/a06d0189-92e8-4dba-b0c4-08d7669fce7d",
                  "policy_group_names": null,
                  "reference_id": "Modify-Storage-Account-PublicEndpoint"
                }
              ],
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "policy_definition_group": [],
              "policy_definition_reference": [
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {}
              ]
            }
          },
          {
            "address": "module.test_core.azurerm_policy_set_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-Synapse\"]",
            "mode": "managed",
            "type": "azurerm_policy_set_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-Synapse",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "This policy initiative is a group of policies that ensures Synapse workspaces is compliant per regulated Landing Zones.",
              "display_name": "Enforce recommended guardrails for Synapse workspaces",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Synapse\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.0\"}",
              "name": "Enforce-Guardrails-Synapse",
              "parameters": "{\"synapseAllowedTenantIds\":{\"defaultValue\":[\"[subscription().tenantId]\"],\"type\":\"array\"},\"synapseDataTraffic\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"synapseDefender\":{\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"type\":\"string\"},\"synapseFwRules\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"type\":\"string\"},\"synapseLocalAuth\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"synapseManagedVnet\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"},\"synapseModifyLocalAuth\":{\"allowedValues\":[\"Modify\",\"Disabled\"],\"defaultValue\":\"Modify\",\"type\":\"string\"},\"synapseModifyPublicNetworkAccess\":{\"allowedValues\":[\"Modify\",\"Disabled\"],\"defaultValue\":\"Modify\",\"type\":\"string\"},\"synapseModifyTlsVersion\":{\"allowedValues\":[\"Modify\",\"Disabled\"],\"defaultValue\":\"Modify\",\"type\":\"string\"},\"synapseTenants\":{\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"type\":\"string\"}}",
              "policy_definition_group": [],
              "policy_definition_reference": [
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('synapseDefender')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/951c1558-50a5-4ca3-abb6-a93e3e2367a6",
                  "policy_group_names": null,
                  "reference_id": "Dine-Synapse-Defender"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('synapseModifyLocalAuth')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/c3624673-d2ff-48e0-b28c-5de1c6767c3c",
                  "policy_group_names": null,
                  "reference_id": "Modify-Synapse-Local-Auth"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('synapseFwRules')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/56fd377d-098c-4f02-8406-81eb055902b8",
                  "policy_group_names": null,
                  "reference_id": "Deny-Synapse-Fw-Rules"
                },
                {
                  "parameter_values": "{\"allowedTenantIds\":{\"value\":\"[parameters('synapseAllowedTenantIds')]\"},\"effect\":{\"value\":\"[parameters('synapseTenants')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/3a003702-13d2-4679-941b-937e58c443f0",
                  "policy_group_names": null,
                  "reference_id": "Deny-Synapse-Tenant-Access"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('synapseDataTraffic')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/3484ce98-c0c5-4c83-994b-c5ac24785218",
                  "policy_group_names": null,
                  "reference_id": "Deny-Synapse-Data-Traffic"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('synapseManagedVnet')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/2d9dbfa3-927b-4cf0-9d0f-08747f971650",
                  "policy_group_names": null,
                  "reference_id": "Deny-Synapse-Managed-Vnet"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('synapseLocalAuth')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/2158ddbe-fefa-408e-b43f-d4faef8ff3b8",
                  "policy_group_names": null,
                  "reference_id": "Deny-Synapse-Local-Auth"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('synapseModifyTlsVersion')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/8b5c654c-fb07-471b-aa8f-15fea733f140",
                  "policy_group_names": null,
                  "reference_id": "Modify-Synapse-Tls-Version"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('synapseModifyPublicNetworkAccess')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/5c8cad01-ef30-4891-b230-652dadb4876a",
                  "policy_group_names": null,
                  "reference_id": "Modify-Synapse-Public-Network-Access"
                }
              ],
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "policy_definition_group": [],
              "policy_definition_reference": [
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {},
                {}
              ]
            }
          },
          {
            "address": "module.test_core.azurerm_policy_set_definition.enterprise_scale[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-VirtualDesktop\"]",
            "mode": "managed",
            "type": "azurerm_policy_set_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-VirtualDesktop",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 0,
            "values": {
              "description": "This policy initiative is a group of policies that ensures Virtual Desktop is compliant per regulated Landing Zones.",
              "display_name": "Enforce recommended guardrails for Virtual Desktop",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "metadata": "{\"alzCloudEnvironments\":[\"AzureCloud\",\"AzureChinaCloud\",\"AzureUSGovernment\"],\"category\":\"Desktop Virtualization\",\"source\":\"https://github.com/Azure/Enterprise-Scale/\",\"version\":\"1.0.0\"}",
              "name": "Enforce-Guardrails-VirtualDesktop",
              "parameters": "{\"avdHostPoolModifyPublicNetworkAccess\":{\"allowedValues\":[\"Modify\",\"Disabled\"],\"defaultValue\":\"Modify\",\"type\":\"string\"},\"avdWorkspaceModifyPublicNetworkAccess\":{\"allowedValues\":[\"Modify\",\"Disabled\"],\"defaultValue\":\"Modify\",\"type\":\"string\"}}",
              "policy_definition_group": [],
              "policy_definition_reference": [
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('avdWorkspaceModifyPublicNetworkAccess')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/ce6ebf1d-0b94-4df9-9257-d8cacc238b4f",
                  "policy_group_names": null,
                  "reference_id": "Modify-Workspace-PublicNetworkAccess"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('avdHostPoolModifyPublicNetworkAccess')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/2a0913ff-51e7-47b8-97bb-ea17127f7c8d",
                  "policy_group_names": null,
                  "reference_id": "Modify-Hostpool-PublicNetworkAccess"
                }
              ],
              "policy_type": "Custom",
              "timeouts": null
            },
            "sensitive_values": {
              "policy_definition_group": [],
              "policy_definition_reference": [
                {},
                {}
              ]
            }
          },
          {
            "address": "module.test_core.azurerm_role_definition.enterprise_scale[\"/providers/Microsoft.Authorization/roleDefinitions/07824e45-af54-586f-a5f0-4bb8676cb3a2\"]",
            "mode": "managed",
            "type": "azurerm_role_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Authorization/roleDefinitions/07824e45-af54-586f-a5f0-4bb8676cb3a2",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 1,
            "values": {
              "assignable_scopes": [
                "/providers/Microsoft.Management/managementGroups/root-id-1"
              ],
              "description": "Delegated role for subscription owner generated from subscription Owner role",
              "name": "[ROOT-ID-1] Subscription-Owner",
              "permissions": [
                {
                  "actions": [
                    "*"
                  ],
                  "data_actions": null,
                  "not_actions": [
                    "Microsoft.Authorization/*/write",
                    "Microsoft.Network/vpnGateways/*",
                    "Microsoft.Network/expressRouteCircuits/*",
                    "Microsoft.Network/routeTables/write",
                    "Microsoft.Network/vpnSites/*"
                  ],
                  "not_data_actions": null
                }
              ],
              "role_definition_id": "07824e45-af54-586f-a5f0-4bb8676cb3a2",
              "scope": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "timeouts": null
            },
            "sensitive_values": {
              "assignable_scopes": [
                false
              ],
              "permissions": [
                {
                  "actions": [
                    false
                  ],
                  "not_actions": [
                    false,
                    false,
                    false,
                    false,
                    false
                  ]
                }
              ]
            }
          },
          {
            "address": "module.test_core.azurerm_role_definition.enterprise_scale[\"/providers/Microsoft.Authorization/roleDefinitions/3b569e18-4af0-5c97-932c-0447cae64922\"]",
            "mode": "managed",
            "type": "azurerm_role_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Authorization/roleDefinitions/3b569e18-4af0-5c97-932c-0447cae64922",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 1,
            "values": {
              "assignable_scopes": [
                "/providers/Microsoft.Management/managementGroups/root-id-1"
              ],
              "description": "Security Administrator role with a horizontal view across the entire Azure estate and the Azure Key Vault purge policy.",
              "name": "[ROOT-ID-1] Security-Operations",
              "permissions": [
                {
                  "actions": [
                    "*/read",
                    "*/register/action",
                    "Microsoft.KeyVault/locations/deletedVaults/purge/action",
                    "Microsoft.PolicyInsights/*",
                    "Microsoft.Authorization/policyAssignments/*",
                    "Microsoft.Authorization/policyDefinitions/*",
                    "Microsoft.Authorization/policyExemptions/*",
                    "Microsoft.Authorization/policySetDefinitions/*",
                    "Microsoft.Insights/alertRules/*",
                    "Microsoft.Resources/deployments/*",
                    "Microsoft.Security/*",
                    "Microsoft.Support/*"
                  ],
                  "data_actions": null,
                  "not_actions": [],
                  "not_data_actions": null
                }
              ],
              "role_definition_id": "3b569e18-4af0-5c97-932c-0447cae64922",
              "scope": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "timeouts": null
            },
            "sensitive_values": {
              "assignable_scopes": [
                false
              ],
              "permissions": [
                {
                  "actions": [
                    false,
                    false,
                    false,
                    false,
                    false,
                    false,
                    false,
                    false,
                    false,
                    false,
                    false,
                    false
                  ],
                  "not_actions": []
                }
              ]
            }
          },
          {
            "address": "module.test_core.azurerm_role_definition.enterprise_scale[\"/providers/Microsoft.Authorization/roleDefinitions/61e44ab2-d16b-5ea5-8692-f9b97be416fa\"]",
            "mode": "managed",
            "type": "azurerm_role_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Authorization/roleDefinitions/61e44ab2-d16b-5ea5-8692-f9b97be416fa",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 1,
            "values": {
              "assignable_scopes": [
                "/providers/Microsoft.Management/managementGroups/root-id-1"
              ],
              "description": "Platform-wide global connectivity management: virtual networks, UDRs, NSGs, NVAs, VPN, Azure ExpressRoute, and others",
              "name": "[ROOT-ID-1] Network-Management",
              "permissions": [
                {
                  "actions": [
                    "*/read",
                    "Microsoft.Network/*",
                    "Microsoft.Resources/deployments/*",
                    "Microsoft.Support/*"
                  ],
                  "data_actions": null,
                  "not_actions": [],
                  "not_data_actions": null
                }
              ],
              "role_definition_id": "61e44ab2-d16b-5ea5-8692-f9b97be416fa",
              "scope": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "timeouts": null
            },
            "sensitive_values": {
              "assignable_scopes": [
                false
              ],
              "permissions": [
                {
                  "actions": [
                    false,
                    false,
                    false,
                    false
                  ],
                  "not_actions": []
                }
              ]
            }
          },
          {
            "address": "module.test_core.azurerm_role_definition.enterprise_scale[\"/providers/Microsoft.Authorization/roleDefinitions/6a8ddaca-120a-579a-a375-1abe30d29f6d\"]",
            "mode": "managed",
            "type": "azurerm_role_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Authorization/roleDefinitions/6a8ddaca-120a-579a-a375-1abe30d29f6d",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 1,
            "values": {
              "assignable_scopes": [
                "/providers/Microsoft.Management/managementGroups/root-id-1"
              ],
              "description": "Enterprise-scale custom Role Definition. Grants full access to manage Virtual Network subnets, but no other network resources.",
              "name": "[ROOT-ID-1] Network-Subnet-Contributor",
              "permissions": [
                {
                  "actions": [
                    "Microsoft.Authorization/*/read",
                    "Microsoft.Insights/alertRules/*",
                    "Microsoft.ResourceHealth/availabilityStatuses/read",
                    "Microsoft.Resources/deployments/*",
                    "Microsoft.Resources/subscriptions/resourceGroups/read",
                    "Microsoft.Support/*",
                    "Microsoft.Network/*/read",
                    "Microsoft.Network/virtualNetworks/subnets/*"
                  ],
                  "data_actions": null,
                  "not_actions": [],
                  "not_data_actions": null
                }
              ],
              "role_definition_id": "6a8ddaca-120a-579a-a375-1abe30d29f6d",
              "scope": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "timeouts": null
            },
            "sensitive_values": {
              "assignable_scopes": [
                false
              ],
              "permissions": [
                {
                  "actions": [
                    false,
                    false,
                    false,
                    false,
                    false,
                    false,
                    false,
                    false
                  ],
                  "not_actions": []
                }
              ]
            }
          },
          {
            "address": "module.test_core.azurerm_role_definition.enterprise_scale[\"/providers/Microsoft.Authorization/roleDefinitions/8fed4ea0-34b3-55af-93e0-fbaa8f3ed158\"]",
            "mode": "managed",
            "type": "azurerm_role_definition",
            "name": "enterprise_scale",
            "index": "/providers/Microsoft.Authorization/roleDefinitions/8fed4ea0-34b3-55af-93e0-fbaa8f3ed158",
            "provider_name": "registry.terraform.io/hashicorp/azurerm",
            "schema_version": 1,
            "values": {
              "assignable_scopes": [
                "/providers/Microsoft.Management/managementGroups/root-id-1"
              ],
              "description": "Contributor role granted for application/operations team at resource group level",
              "name": "[ROOT-ID-1] Application-Owners",
              "permissions": [
                {
                  "actions": [
                    "*"
                  ],
                  "data_actions": null,
                  "not_actions": [
                    "Microsoft.Authorization/*/write",
                    "Microsoft.Network/publicIPAddresses/write",
                    "Microsoft.Network/virtualNetworks/write",
                    "Microsoft.KeyVault/locations/deletedVaults/purge/action"
                  ],
                  "not_data_actions": null
                }
              ],
              "role_definition_id": "8fed4ea0-34b3-55af-93e0-fbaa8f3ed158",
              "scope": "/providers/Microsoft.Management/managementGroups/root-id-1",
              "timeouts": null
            },
            "sensitive_values": {
              "assignable_scopes": [
                false
              ],
              "permissions": [
                {
                  "actions": [
                    false
                  ],
                  "not_actions": [
                    false,
                    false,
                    false,
                    false
                  ]
                }
              ]
            }
          },
          {
            "address": "module.test_core.time_sleep.after_azurerm_management_group",
            "mode": "managed",
            "type": "time_sleep",
            "name": "after_azurerm_management_group",
            "provider_name": "registry.terraform.io/hashicorp/time",
            "schema_version": 0,
            "values": {
              "create_duration": "120s",
              "destroy_duration": "0s",
              "triggers": {
                "azurerm_management_group_level_1": "[\"/providers/Microsoft.Management/managementGroups/root-id-1\"]",
                "azurerm_management_group_level_2": "[\"/providers/Microsoft.Management/managementGroups/root-id-1-decommissioned\",\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones\",\"/providers/Microsoft.Management/managementGroups/root-id-1-platform\",\"/providers/Microsoft.Management/managementGroups/root-id-1-sandboxes\"]",
                "azurerm_management_group_level_3": "[\"/providers/Microsoft.Management/managementGroups/root-id-1-connectivity\",\"/providers/Microsoft.Management/managementGroups/root-id-1-identity\",\"/providers/Microsoft.Management/managementGroups/root-id-1-management\"]",
                "azurerm_management_group_level_4": "[]",
                "azurerm_management_group_level_5": "[]",
                "azurerm_management_group_level_6": "[]"
              }
            },
            "sensitive_values": {
              "triggers": {}
            }
          },
          {
            "address": "module.test_core.time_sleep.after_azurerm_policy_assignment",
            "mode": "managed",
            "type": "time_sleep",
            "name": "after_azurerm_policy_assignment",
            "provider_name": "registry.terraform.io/hashicorp/time",
            "schema_version": 0,
            "values": {
              "create_duration": "30s",
              "destroy_duration": "0s",
              "triggers": {
                "azurerm_management_group_policy_assignment_enterprise_scale": "[\"/providers/Microsoft.Management/managementGroups/root-id-1-connectivity/providers/Microsoft.Authorization/policyAssignments/Enable-DDoS-VNET\",\"/providers/Microsoft.Management/managementGroups/root-id-1-decommissioned/providers/Microsoft.Authorization/policyAssignments/Enforce-ALZ-Decomm\",\"/providers/Microsoft.Management/managementGroups/root-id-1-identity/providers/Microsoft.Authorization/policyAssignments/Deny-MgmtPorts-Internet\",\"/providers/Microsoft.Management/managementGroups/root-id-1-identity/providers/Microsoft.Authorization/policyAssignments/Deny-Public-IP\",\"/providers/Microsoft.Management/managementGroups/root-id-1-identity/providers/Microsoft.Authorization/policyAssignments/Deny-Subnet-Without-Nsg\",\"/providers/Microsoft.Management/managementGroups/root-id-1-identity/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-Backup\",\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Audit-AppGW-WAF\",\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deny-IP-forwarding\",\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deny-MgmtPorts-Internet\",\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deny-Priv-Esc-AKS\",\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deny-Privileged-AKS\",\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deny-Storage-http\",\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deny-Subnet-Without-Nsg\",\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-AKS-Policy\",\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-AzSqlDb-Auditing\",\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-MDFC-DefSQL-AMA\",\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-SQL-TDE\",\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-SQL-Threat\",\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-Backup\",\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-ChangeTrack\",\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-Monitoring\",\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-VMSS-ChangeTrack\",\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-VMSS-Monitoring\",\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-vmArc-ChangeTrack\",\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Enable-AUM-CheckUpdates\",\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Enable-DDoS-VNET\",\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Enforce-AKS-HTTPS\",\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-KeyVault\",\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Enforce-TLS-SSL-H224\",\"/providers/Microsoft.Management/managementGroups/root-id-1-management/providers/Microsoft.Authorization/policyAssignments/Deploy-Log-Analytics\",\"/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/policyAssignments/DenyAction-DeleteUAMIAMA\",\"/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/policyAssignments/Deploy-MDFC-DefSQL-AMA\",\"/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-ChangeTrack\",\"/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-Monitoring\",\"/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/policyAssignments/Deploy-VMSS-ChangeTrack\",\"/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/policyAssignments/Deploy-VMSS-Monitoring\",\"/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/policyAssignments/Deploy-vmArc-ChangeTrack\",\"/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/policyAssignments/Enable-AUM-CheckUpdates\",\"/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/policyAssignments/Enforce-GR-KeyVault\",\"/providers/Microsoft.Management/managementGroups/root-id-1-sandboxes/providers/Microsoft.Authorization/policyAssignments/Enforce-ALZ-Sandbox\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyAssignments/Audit-ResourceRGLocation\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyAssignments/Audit-TrustedLaunch\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyAssignments/Audit-UnusedResources\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyAssignments/Audit-ZoneResiliency\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyAssignments/Deny-Classic-Resources\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyAssignments/Deny-UnmanagedDisk\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyAssignments/Deploy-ASC-Monitoring\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyAssignments/Deploy-AzActivity-Log\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyAssignments/Deploy-Diag-Logs\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyAssignments/Deploy-MDEndpoints\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyAssignments/Deploy-MDEndpointsAMA\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyAssignments/Deploy-MDFC-Config-H224\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyAssignments/Deploy-MDFC-OssDb\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyAssignments/Deploy-MDFC-SqlAtp\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyAssignments/Enforce-ACSB\"]"
              }
            },
            "sensitive_values": {
              "triggers": {}
            }
          },
          {
            "address": "module.test_core.time_sleep.after_azurerm_policy_definition",
            "mode": "managed",
            "type": "time_sleep",
            "name": "after_azurerm_policy_definition",
            "provider_name": "registry.terraform.io/hashicorp/time",
            "schema_version": 0,
            "values": {
              "create_duration": "30s",
              "destroy_duration": "0s",
              "triggers": {
                "azurerm_policy_definition_enterprise_scale": "[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Append-AppService-httpsonly\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Append-AppService-latestTLS\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Append-KV-SoftDelete\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Append-Redis-disableNonSslPort\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Append-Redis-sslEnforcement\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Audit-AzureHybridBenefit\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Audit-Disks-UnusedResourcesCostOptimization\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Audit-MachineLearning-PrivateEndpointId\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Audit-PrivateLinkDnsZones\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Audit-PublicIpAddresses-UnusedResourcesCostOptimization\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Audit-ServerFarms-UnusedResourcesCostOptimization\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-AA-child-resources\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-APIM-TLS\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-AppGW-Without-WAF\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-AppGw-Without-Tls\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-AppService-without-BYOC\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-AppServiceApiApp-http\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-AppServiceFunctionApp-http\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-AppServiceWebApp-http\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-AzFw-Without-Policy\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-CognitiveServices-NetworkAcls\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-CognitiveServices-Resource-Kinds\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-CognitiveServices-RestrictOutboundNetworkAccess\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-Databricks-NoPublicIp\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-Databricks-Sku\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-Databricks-VirtualNetwork\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-EH-Premium-CMK\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-EH-minTLS\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-FileServices-InsecureAuth\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-FileServices-InsecureKerberos\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-FileServices-InsecureSmbChannel\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-FileServices-InsecureSmbVersions\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-LogicApp-Public-Network\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-LogicApps-Without-Https\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-Aks\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-Compute-SubnetId\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-Compute-VmSize\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-ComputeCluster-RemoteLoginPortPublicAccess\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-ComputeCluster-Scale\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-HbiWorkspace\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-PublicAccessWhenBehindVnet\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-PublicNetworkAccess\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-MgmtPorts-From-Internet\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-MySql-http\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-PostgreSql-http\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-Private-DNS-Zones\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-PublicEndpoint-MariaDB\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-PublicIP\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-RDP-From-Internet\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-Redis-http\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-Service-Endpoints\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-Sql-minTLS\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-SqlMi-minTLS\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-Storage-ContainerDeleteRetentionPolicy\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-Storage-CopyScope\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-Storage-CorsRules\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-Storage-LocalUser\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-Storage-NetworkAclsBypass\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-Storage-NetworkAclsVirtualNetworkRules\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-Storage-ResourceAccessRulesResourceId\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-Storage-ResourceAccessRulesTenantId\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-Storage-SFTP\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-Storage-ServicesEncryption\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-Storage-minTLS\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-StorageAccount-CustomDomain\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-Subnet-Without-Nsg\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-Subnet-Without-Penp\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-Subnet-Without-Udr\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-UDR-With-Specific-NextHop\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-VNET-Peer-Cross-Sub\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-VNET-Peering-To-Non-Approved-VNETs\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deny-VNet-Peering\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/DenyAction-ActivityLogs\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/DenyAction-DeleteResources\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/DenyAction-DiagnosticLogs\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-ASC-SecurityContacts\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Budget\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Custom-Route-Table\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-DDoSProtection\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-AA\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ACI\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ACR\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-APIMgmt\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-AVDScalingPlans\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-AnalysisService\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ApiForFHIR\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ApplicationGateway\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Bastion\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-CDNEndpoints\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-CognitiveServices\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-CosmosDB\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-DLAnalytics\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-DataExplorerCluster\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-DataFactory\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Databricks\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-EventGridSub\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-EventGridSystemTopic\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-EventGridTopic\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ExpressRoute\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Firewall\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-FrontDoor\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Function\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-HDInsight\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-LoadBalancer\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-LogAnalytics\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-LogicAppsISE\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-MariaDB\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-MediaService\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-MlWorkspace\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-MySQL\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-NIC\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-NetworkSecurityGroups\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-PostgreSQL\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-PowerBIEmbedded\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-RedisCache\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Relay\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-SQLElasticPools\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-SQLMI\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-SignalR\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-TimeSeriesInsights\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-TrafficManager\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-VM\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-VMSS\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-VNetGW\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-VWanS2SVPNGW\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-VirtualNetwork\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-WVDAppGroup\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-WVDHostPools\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-WVDWorkspace\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-WebServerFarm\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Website\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-iotHub\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-FirewallPolicy\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-LogicApp-TLS\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-MDFC-Arc-SQL-DCR-Association\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-MDFC-Arc-Sql-DefenderSQL-DCR\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-MDFC-SQL-AMA\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-MDFC-SQL-DefenderSQL\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-MDFC-SQL-DefenderSQL-DCR\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-MySQL-sslEnforcement\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Nsg-FlowLogs\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Nsg-FlowLogs-to-LA\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-PostgreSQL-sslEnforcement\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Private-DNS-Generic\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-SQL-minTLS\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Sql-AuditingSettings\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Sql-SecurityAlertPolicies\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Sql-Tde\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Sql-vulnerabilityAssessments\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Sql-vulnerabilityAssessments_20230706\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-SqlMi-minTLS\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Storage-sslEnforcement\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-UserAssignedManagedIdentity-VMInsights\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-VNET-HubSpoke\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Vm-autoShutdown\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Deploy-Windows-DomainJoin\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Modify-NSG\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyDefinitions/Modify-UDR\"]"
              }
            },
            "sensitive_values": {
              "triggers": {}
            }
          },
          {
            "address": "module.test_core.time_sleep.after_azurerm_policy_set_definition",
            "mode": "managed",
            "type": "time_sleep",
            "name": "after_azurerm_policy_set_definition",
            "provider_name": "registry.terraform.io/hashicorp/time",
            "schema_version": 0,
            "values": {
              "create_duration": "30s",
              "destroy_duration": "0s",
              "triggers": {
                "azurerm_policy_set_definition_enterprise_scale": "[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Audit-TrustedLaunch\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Audit-UnusedResourcesCostOptimization\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Deny-PublicPaaSEndpoints\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/DenyAction-DeleteProtection\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Deploy-AUM-CheckUpdates\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Deploy-Diagnostics-LogAnalytics\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Deploy-MDFC-Config\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Deploy-MDFC-Config_20240319\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Deploy-MDFC-DefenderSQL-AMA\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Deploy-Private-DNS-Zones\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Deploy-Sql-Security\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Deploy-Sql-Security_20240529\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Enforce-ACSB\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Enforce-ALZ-Decomm\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Enforce-ALZ-Sandbox\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Backup\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Enforce-EncryptTransit\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Enforce-EncryptTransit_20240509\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Encryption-CMK\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-APIM\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-AppServices\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-Automation\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-CognitiveServices\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-Compute\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-ContainerApps\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-ContainerInstance\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-ContainerRegistry\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-CosmosDb\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-DataExplorer\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-DataFactory\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-EventGrid\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-EventHub\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-KeyVault\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-KeyVault-Sup\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-Kubernetes\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-MachineLearning\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-MySQL\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-Network\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-OpenAI\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-PostgreSQL\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-SQL\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-ServiceBus\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-Storage\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-Synapse\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Guardrails-VirtualDesktop\"]"
              }
            },
            "sensitive_values": {
              "triggers": {}
            }
          },
          {
            "address": "module.test_core.time_sleep.after_azurerm_role_assignment",
            "mode": "managed",
            "type": "time_sleep",
            "name": "after_azurerm_role_assignment",
            "provider_name": "registry.terraform.io/hashicorp/time",
            "schema_version": 0,
            "values": {
              "create_duration": "0s",
              "destroy_duration": "0s",
              "triggers": {
                "azurerm_role_assignment_enterprise_scale": "[]",
                "module_role_assignments_for_policy": "[\"/providers/Microsoft.Management/managementGroups/root-id-1-connectivity/providers/Microsoft.Authorization/policyAssignments/Enable-DDoS-VNET\",\"/providers/Microsoft.Management/managementGroups/root-id-1-decommissioned/providers/Microsoft.Authorization/policyAssignments/Enforce-ALZ-Decomm\",\"/providers/Microsoft.Management/managementGroups/root-id-1-identity/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-Backup\",\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-AKS-Policy\",\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-AzSqlDb-Auditing\",\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-MDFC-DefSQL-AMA\",\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-SQL-TDE\",\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-SQL-Threat\",\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-Backup\",\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-ChangeTrack\",\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-Monitoring\",\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-VMSS-ChangeTrack\",\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-VMSS-Monitoring\",\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-vmArc-ChangeTrack\",\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Enable-AUM-CheckUpdates\",\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Enable-DDoS-VNET\",\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Enforce-TLS-SSL-H224\",\"/providers/Microsoft.Management/managementGroups/root-id-1-management/providers/Microsoft.Authorization/policyAssignments/Deploy-Log-Analytics\",\"/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/policyAssignments/Deploy-MDFC-DefSQL-AMA\",\"/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-ChangeTrack\",\"/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-Monitoring\",\"/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/policyAssignments/Deploy-VMSS-ChangeTrack\",\"/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/policyAssignments/Deploy-VMSS-Monitoring\",\"/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/policyAssignments/Deploy-vmArc-ChangeTrack\",\"/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/policyAssignments/Enable-AUM-CheckUpdates\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyAssignments/Deploy-ASC-Monitoring\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyAssignments/Deploy-AzActivity-Log\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyAssignments/Deploy-Diag-Logs\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyAssignments/Deploy-MDEndpoints\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyAssignments/Deploy-MDEndpointsAMA\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyAssignments/Deploy-MDFC-Config-H224\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyAssignments/Deploy-MDFC-OssDb\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyAssignments/Deploy-MDFC-SqlAtp\",\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyAssignments/Enforce-ACSB\"]"
              }
            },
            "sensitive_values": {
              "triggers": {}
            }
          },
          {
            "address": "module.test_core.time_sleep.after_azurerm_role_definition",
            "mode": "managed",
            "type": "time_sleep",
            "name": "after_azurerm_role_definition",
            "provider_name": "registry.terraform.io/hashicorp/time",
            "schema_version": 0,
            "values": {
              "create_duration": "60s",
              "destroy_duration": "0s",
              "triggers": {
                "azurerm_role_definition_enterprise_scale": "[\"/providers/Microsoft.Authorization/roleDefinitions/07824e45-af54-586f-a5f0-4bb8676cb3a2\",\"/providers/Microsoft.Authorization/roleDefinitions/3b569e18-4af0-5c97-932c-0447cae64922\",\"/providers/Microsoft.Authorization/roleDefinitions/61e44ab2-d16b-5ea5-8692-f9b97be416fa\",\"/providers/Microsoft.Authorization/roleDefinitions/6a8ddaca-120a-579a-a375-1abe30d29f6d\",\"/providers/Microsoft.Authorization/roleDefinitions/8fed4ea0-34b3-55af-93e0-fbaa8f3ed158\"]"
              }
            },
            "sensitive_values": {
              "triggers": {}
            }
          }
        ],
        "address": "module.test_core",
        "child_modules": [
          {
            "resources": [
              {
                "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-connectivity/providers/Microsoft.Authorization/policyAssignments/Enable-DDoS-VNET\"].azurerm_role_assignment.for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-connectivity/providers/Microsoft.Authorization/roleAssignments/bfe36639-f89e-5737-81df-f575c532b31a\"]",
                "mode": "managed",
                "type": "azurerm_role_assignment",
                "name": "for_policy",
                "index": "/providers/Microsoft.Management/managementGroups/root-id-1-connectivity/providers/Microsoft.Authorization/roleAssignments/bfe36639-f89e-5737-81df-f575c532b31a",
                "provider_name": "registry.terraform.io/hashicorp/azurerm",
                "schema_version": 0,
                "values": {
                  "condition": null,
                  "condition_version": null,
                  "delegated_managed_identity_resource_id": null,
                  "description": null,
                  "name": "bfe36639-f89e-5737-81df-f575c532b31a",
                  "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7",
                  "scope": "/providers/Microsoft.Management/managementGroups/root-id-1-connectivity",
                  "timeouts": null
                },
                "sensitive_values": {}
              }
            ],
            "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-connectivity/providers/Microsoft.Authorization/policyAssignments/Enable-DDoS-VNET\"]"
          },
          {
            "resources": [
              {
                "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-decommissioned/providers/Microsoft.Authorization/policyAssignments/Enforce-ALZ-Decomm\"].azurerm_role_assignment.for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-decommissioned/providers/Microsoft.Authorization/roleAssignments/aabcf781-5c4c-5952-863f-e51732fcdf1b\"]",
                "mode": "managed",
                "type": "azurerm_role_assignment",
                "name": "for_policy",
                "index": "/providers/Microsoft.Management/managementGroups/root-id-1-decommissioned/providers/Microsoft.Authorization/roleAssignments/aabcf781-5c4c-5952-863f-e51732fcdf1b",
                "provider_name": "registry.terraform.io/hashicorp/azurerm",
                "schema_version": 0,
                "values": {
                  "condition": null,
                  "condition_version": null,
                  "delegated_managed_identity_resource_id": null,
                  "description": null,
                  "name": "aabcf781-5c4c-5952-863f-e51732fcdf1b",
                  "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c",
                  "scope": "/providers/Microsoft.Management/managementGroups/root-id-1-decommissioned",
                  "timeouts": null
                },
                "sensitive_values": {}
              }
            ],
            "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-decommissioned/providers/Microsoft.Authorization/policyAssignments/Enforce-ALZ-Decomm\"]"
          },
          {
            "resources": [
              {
                "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-identity/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-Backup\"].azurerm_role_assignment.for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-identity/providers/Microsoft.Authorization/roleAssignments/10acbd2f-bfdd-5c38-bf46-3a67cafdeaf3\"]",
                "mode": "managed",
                "type": "azurerm_role_assignment",
                "name": "for_policy",
                "index": "/providers/Microsoft.Management/managementGroups/root-id-1-identity/providers/Microsoft.Authorization/roleAssignments/10acbd2f-bfdd-5c38-bf46-3a67cafdeaf3",
                "provider_name": "registry.terraform.io/hashicorp/azurerm",
                "schema_version": 0,
                "values": {
                  "condition": null,
                  "condition_version": null,
                  "delegated_managed_identity_resource_id": null,
                  "description": null,
                  "name": "10acbd2f-bfdd-5c38-bf46-3a67cafdeaf3",
                  "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/5e467623-bb1f-42f4-a55d-6e525e11384b",
                  "scope": "/providers/Microsoft.Management/managementGroups/root-id-1-identity",
                  "timeouts": null
                },
                "sensitive_values": {}
              },
              {
                "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-identity/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-Backup\"].azurerm_role_assignment.for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-identity/providers/Microsoft.Authorization/roleAssignments/1358ccb0-1ad3-5974-ae44-7f5728c09678\"]",
                "mode": "managed",
                "type": "azurerm_role_assignment",
                "name": "for_policy",
                "index": "/providers/Microsoft.Management/managementGroups/root-id-1-identity/providers/Microsoft.Authorization/roleAssignments/1358ccb0-1ad3-5974-ae44-7f5728c09678",
                "provider_name": "registry.terraform.io/hashicorp/azurerm",
                "schema_version": 0,
                "values": {
                  "condition": null,
                  "condition_version": null,
                  "delegated_managed_identity_resource_id": null,
                  "description": null,
                  "name": "1358ccb0-1ad3-5974-ae44-7f5728c09678",
                  "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c",
                  "scope": "/providers/Microsoft.Management/managementGroups/root-id-1-identity",
                  "timeouts": null
                },
                "sensitive_values": {}
              }
            ],
            "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-identity/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-Backup\"]"
          },
          {
            "resources": [
              {
                "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-AKS-Policy\"].azurerm_role_assignment.for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/roleAssignments/e3bad489-c3ed-57c4-9802-e4c4a84ed145\"]",
                "mode": "managed",
                "type": "azurerm_role_assignment",
                "name": "for_policy",
                "index": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/roleAssignments/e3bad489-c3ed-57c4-9802-e4c4a84ed145",
                "provider_name": "registry.terraform.io/hashicorp/azurerm",
                "schema_version": 0,
                "values": {
                  "condition": null,
                  "condition_version": null,
                  "delegated_managed_identity_resource_id": null,
                  "description": null,
                  "name": "e3bad489-c3ed-57c4-9802-e4c4a84ed145",
                  "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/ed7f3fbd-7b88-4dd4-9017-9adb7ce333f8",
                  "scope": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones",
                  "timeouts": null
                },
                "sensitive_values": {}
              },
              {
                "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-AKS-Policy\"].azurerm_role_assignment.for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/roleAssignments/ef4aaac1-624f-57fb-8444-3d2fdd091a35\"]",
                "mode": "managed",
                "type": "azurerm_role_assignment",
                "name": "for_policy",
                "index": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/roleAssignments/ef4aaac1-624f-57fb-8444-3d2fdd091a35",
                "provider_name": "registry.terraform.io/hashicorp/azurerm",
                "schema_version": 0,
                "values": {
                  "condition": null,
                  "condition_version": null,
                  "delegated_managed_identity_resource_id": null,
                  "description": null,
                  "name": "ef4aaac1-624f-57fb-8444-3d2fdd091a35",
                  "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/18ed5180-3e48-46fd-8541-4ea054d57064",
                  "scope": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones",
                  "timeouts": null
                },
                "sensitive_values": {}
              }
            ],
            "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-AKS-Policy\"]"
          },
          {
            "resources": [
              {
                "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-AzSqlDb-Auditing\"].azurerm_role_assignment.for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/roleAssignments/62d19ca1-fb31-5489-859f-f43578c5e409\"]",
                "mode": "managed",
                "type": "azurerm_role_assignment",
                "name": "for_policy",
                "index": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/roleAssignments/62d19ca1-fb31-5489-859f-f43578c5e409",
                "provider_name": "registry.terraform.io/hashicorp/azurerm",
                "schema_version": 0,
                "values": {
                  "condition": null,
                  "condition_version": null,
                  "delegated_managed_identity_resource_id": null,
                  "description": null,
                  "name": "62d19ca1-fb31-5489-859f-f43578c5e409",
                  "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/056cd41c-7e88-42e1-933e-88ba6a50c9c3",
                  "scope": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones",
                  "timeouts": null
                },
                "sensitive_values": {}
              },
              {
                "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-AzSqlDb-Auditing\"].azurerm_role_assignment.for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/roleAssignments/dedede29-96ae-5d67-84a4-70b555716715\"]",
                "mode": "managed",
                "type": "azurerm_role_assignment",
                "name": "for_policy",
                "index": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/roleAssignments/dedede29-96ae-5d67-84a4-70b555716715",
                "provider_name": "registry.terraform.io/hashicorp/azurerm",
                "schema_version": 0,
                "values": {
                  "condition": null,
                  "condition_version": null,
                  "delegated_managed_identity_resource_id": null,
                  "description": null,
                  "name": "dedede29-96ae-5d67-84a4-70b555716715",
                  "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293",
                  "scope": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones",
                  "timeouts": null
                },
                "sensitive_values": {}
              }
            ],
            "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-AzSqlDb-Auditing\"]"
          },
          {
            "resources": [
              {
                "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-MDFC-DefSQL-AMA\"].azurerm_role_assignment.for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/roleAssignments/1c1fc66b-d77f-534c-bc74-1800acc52447\"]",
                "mode": "managed",
                "type": "azurerm_role_assignment",
                "name": "for_policy",
                "index": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/roleAssignments/1c1fc66b-d77f-534c-bc74-1800acc52447",
                "provider_name": "registry.terraform.io/hashicorp/azurerm",
                "schema_version": 0,
                "values": {
                  "condition": null,
                  "condition_version": null,
                  "delegated_managed_identity_resource_id": null,
                  "description": null,
                  "name": "1c1fc66b-d77f-534c-bc74-1800acc52447",
                  "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/cd570a14-e51a-42ad-bac8-bafd67325302",
                  "scope": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones",
                  "timeouts": null
                },
                "sensitive_values": {}
              },
              {
                "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-MDFC-DefSQL-AMA\"].azurerm_role_assignment.for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/roleAssignments/2627cdeb-069c-51dd-97f2-b6515572fda4\"]",
                "mode": "managed",
                "type": "azurerm_role_assignment",
                "name": "for_policy",
                "index": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/roleAssignments/2627cdeb-069c-51dd-97f2-b6515572fda4",
                "provider_name": "registry.terraform.io/hashicorp/azurerm",
                "schema_version": 0,
                "values": {
                  "condition": null,
                  "condition_version": null,
                  "delegated_managed_identity_resource_id": null,
                  "description": null,
                  "name": "2627cdeb-069c-51dd-97f2-b6515572fda4",
                  "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                  "scope": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones",
                  "timeouts": null
                },
                "sensitive_values": {}
              },
              {
                "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-MDFC-DefSQL-AMA\"].azurerm_role_assignment.for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/roleAssignments/5143a803-2c63-5556-bd40-9cda4c762571\"]",
                "mode": "managed",
                "type": "azurerm_role_assignment",
                "name": "for_policy",
                "index": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/roleAssignments/5143a803-2c63-5556-bd40-9cda4c762571",
                "provider_name": "registry.terraform.io/hashicorp/azurerm",
                "schema_version": 0,
                "values": {
                  "condition": null,
                  "condition_version": null,
                  "delegated_managed_identity_resource_id": null,
                  "description": null,
                  "name": "5143a803-2c63-5556-bd40-9cda4c762571",
                  "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c",
                  "scope": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones",
                  "timeouts": null
                },
                "sensitive_values": {}
              },
              {
                "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-MDFC-DefSQL-AMA\"].azurerm_role_assignment.for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/roleAssignments/fadee446-2688-5ae7-a170-6fa168944e3c\"]",
                "mode": "managed",
                "type": "azurerm_role_assignment",
                "name": "for_policy",
                "index": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/roleAssignments/fadee446-2688-5ae7-a170-6fa168944e3c",
                "provider_name": "registry.terraform.io/hashicorp/azurerm",
                "schema_version": 0,
                "values": {
                  "condition": null,
                  "condition_version": null,
                  "delegated_managed_identity_resource_id": null,
                  "description": null,
                  "name": "fadee446-2688-5ae7-a170-6fa168944e3c",
                  "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293",
                  "scope": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones",
                  "timeouts": null
                },
                "sensitive_values": {}
              },
              {
                "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-MDFC-DefSQL-AMA\"].azurerm_role_assignment.for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/roleAssignments/fc3ef05a-169e-5437-be7b-bf0931206038\"]",
                "mode": "managed",
                "type": "azurerm_role_assignment",
                "name": "for_policy",
                "index": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/roleAssignments/fc3ef05a-169e-5437-be7b-bf0931206038",
                "provider_name": "registry.terraform.io/hashicorp/azurerm",
                "schema_version": 0,
                "values": {
                  "condition": null,
                  "condition_version": null,
                  "delegated_managed_identity_resource_id": null,
                  "description": null,
                  "name": "fc3ef05a-169e-5437-be7b-bf0931206038",
                  "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c",
                  "scope": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones",
                  "timeouts": null
                },
                "sensitive_values": {}
              }
            ],
            "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-MDFC-DefSQL-AMA\"]"
          },
          {
            "resources": [
              {
                "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-SQL-TDE\"].azurerm_role_assignment.for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/roleAssignments/3017df2e-5df0-5373-bb0c-c255e0127c77\"]",
                "mode": "managed",
                "type": "azurerm_role_assignment",
                "name": "for_policy",
                "index": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/roleAssignments/3017df2e-5df0-5373-bb0c-c255e0127c77",
                "provider_name": "registry.terraform.io/hashicorp/azurerm",
                "schema_version": 0,
                "values": {
                  "condition": null,
                  "condition_version": null,
                  "delegated_managed_identity_resource_id": null,
                  "description": null,
                  "name": "3017df2e-5df0-5373-bb0c-c255e0127c77",
                  "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/9b7fa17d-e63e-47b0-bb0a-15c516ac86ec",
                  "scope": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones",
                  "timeouts": null
                },
                "sensitive_values": {}
              }
            ],
            "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-SQL-TDE\"]"
          },
          {
            "resources": [
              {
                "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-SQL-Threat\"].azurerm_role_assignment.for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/roleAssignments/533932d3-0f16-59eb-84b8-893805c84e9c\"]",
                "mode": "managed",
                "type": "azurerm_role_assignment",
                "name": "for_policy",
                "index": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/roleAssignments/533932d3-0f16-59eb-84b8-893805c84e9c",
                "provider_name": "registry.terraform.io/hashicorp/azurerm",
                "schema_version": 0,
                "values": {
                  "condition": null,
                  "condition_version": null,
                  "delegated_managed_identity_resource_id": null,
                  "description": null,
                  "name": "533932d3-0f16-59eb-84b8-893805c84e9c",
                  "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/056cd41c-7e88-42e1-933e-88ba6a50c9c3",
                  "scope": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones",
                  "timeouts": null
                },
                "sensitive_values": {}
              }
            ],
            "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-SQL-Threat\"]"
          },
          {
            "resources": [
              {
                "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-Backup\"].azurerm_role_assignment.for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/roleAssignments/8a906dc2-5af6-5c64-a065-e5782483b6b7\"]",
                "mode": "managed",
                "type": "azurerm_role_assignment",
                "name": "for_policy",
                "index": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/roleAssignments/8a906dc2-5af6-5c64-a065-e5782483b6b7",
                "provider_name": "registry.terraform.io/hashicorp/azurerm",
                "schema_version": 0,
                "values": {
                  "condition": null,
                  "condition_version": null,
                  "delegated_managed_identity_resource_id": null,
                  "description": null,
                  "name": "8a906dc2-5af6-5c64-a065-e5782483b6b7",
                  "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c",
                  "scope": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones",
                  "timeouts": null
                },
                "sensitive_values": {}
              },
              {
                "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-Backup\"].azurerm_role_assignment.for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/roleAssignments/ee60d5ba-80b7-58dc-b6c6-1e0ceaaaf879\"]",
                "mode": "managed",
                "type": "azurerm_role_assignment",
                "name": "for_policy",
                "index": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/roleAssignments/ee60d5ba-80b7-58dc-b6c6-1e0ceaaaf879",
                "provider_name": "registry.terraform.io/hashicorp/azurerm",
                "schema_version": 0,
                "values": {
                  "condition": null,
                  "condition_version": null,
                  "delegated_managed_identity_resource_id": null,
                  "description": null,
                  "name": "ee60d5ba-80b7-58dc-b6c6-1e0ceaaaf879",
                  "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/5e467623-bb1f-42f4-a55d-6e525e11384b",
                  "scope": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones",
                  "timeouts": null
                },
                "sensitive_values": {}
              }
            ],
            "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-Backup\"]"
          },
          {
            "resources": [
              {
                "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-ChangeTrack\"].azurerm_role_assignment.for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/roleAssignments/1ddcada5-b988-52c4-bc78-a83ca5e8660c\"]",
                "mode": "managed",
                "type": "azurerm_role_assignment",
                "name": "for_policy",
                "index": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/roleAssignments/1ddcada5-b988-52c4-bc78-a83ca5e8660c",
                "provider_name": "registry.terraform.io/hashicorp/azurerm",
                "schema_version": 0,
                "values": {
                  "condition": null,
                  "condition_version": null,
                  "delegated_managed_identity_resource_id": null,
                  "description": null,
                  "name": "1ddcada5-b988-52c4-bc78-a83ca5e8660c",
                  "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293",
                  "scope": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones",
                  "timeouts": null
                },
                "sensitive_values": {}
              },
              {
                "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-ChangeTrack\"].azurerm_role_assignment.for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/roleAssignments/41ce486e-d98c-5eac-8cea-9016f6f90df4\"]",
                "mode": "managed",
                "type": "azurerm_role_assignment",
                "name": "for_policy",
                "index": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/roleAssignments/41ce486e-d98c-5eac-8cea-9016f6f90df4",
                "provider_name": "registry.terraform.io/hashicorp/azurerm",
                "schema_version": 0,
                "values": {
                  "condition": null,
                  "condition_version": null,
                  "delegated_managed_identity_resource_id": null,
                  "description": null,
                  "name": "41ce486e-d98c-5eac-8cea-9016f6f90df4",
                  "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c",
                  "scope": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones",
                  "timeouts": null
                },
                "sensitive_values": {}
              },
              {
                "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-ChangeTrack\"].azurerm_role_assignment.for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/roleAssignments/75d7e3e3-e9f8-5ca9-a50d-f4225c422fe9\"]",
                "mode": "managed",
                "type": "azurerm_role_assignment",
                "name": "for_policy",
                "index": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/roleAssignments/75d7e3e3-e9f8-5ca9-a50d-f4225c422fe9",
                "provider_name": "registry.terraform.io/hashicorp/azurerm",
                "schema_version": 0,
                "values": {
                  "condition": null,
                  "condition_version": null,
                  "delegated_managed_identity_resource_id": null,
                  "description": null,
                  "name": "75d7e3e3-e9f8-5ca9-a50d-f4225c422fe9",
                  "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                  "scope": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones",
                  "timeouts": null
                },
                "sensitive_values": {}
              },
              {
                "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-ChangeTrack\"].azurerm_role_assignment.for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/roleAssignments/78281a44-c1e5-5700-80fd-3c445583671c\"]",
                "mode": "managed",
                "type": "azurerm_role_assignment",
                "name": "for_policy",
                "index": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/roleAssignments/78281a44-c1e5-5700-80fd-3c445583671c",
                "provider_name": "registry.terraform.io/hashicorp/azurerm",
                "schema_version": 0,
                "values": {
                  "condition": null,
                  "condition_version": null,
                  "delegated_managed_identity_resource_id": null,
                  "description": null,
                  "name": "78281a44-c1e5-5700-80fd-3c445583671c",
                  "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/18d7d88d-d35e-4fb5-a5c3-7773c20a72d9",
                  "scope": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones",
                  "timeouts": null
                },
                "sensitive_values": {}
              },
              {
                "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-ChangeTrack\"].azurerm_role_assignment.for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/roleAssignments/c09d588e-392d-54e0-8c75-4a8f11a224b1\"]",
                "mode": "managed",
                "type": "azurerm_role_assignment",
                "name": "for_policy",
                "index": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/roleAssignments/c09d588e-392d-54e0-8c75-4a8f11a224b1",
                "provider_name": "registry.terraform.io/hashicorp/azurerm",
                "schema_version": 0,
                "values": {
                  "condition": null,
                  "condition_version": null,
                  "delegated_managed_identity_resource_id": null,
                  "description": null,
                  "name": "c09d588e-392d-54e0-8c75-4a8f11a224b1",
                  "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c",
                  "scope": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones",
                  "timeouts": null
                },
                "sensitive_values": {}
              }
            ],
            "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-ChangeTrack\"]"
          },
          {
            "resources": [
              {
                "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-Monitoring\"].azurerm_role_assignment.for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/roleAssignments/53504974-5b88-5e0a-a55d-fa9f5e19b22f\"]",
                "mode": "managed",
                "type": "azurerm_role_assignment",
                "name": "for_policy",
                "index": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/roleAssignments/53504974-5b88-5e0a-a55d-fa9f5e19b22f",
                "provider_name": "registry.terraform.io/hashicorp/azurerm",
                "schema_version": 0,
                "values": {
                  "condition": null,
                  "condition_version": null,
                  "delegated_managed_identity_resource_id": null,
                  "description": null,
                  "name": "53504974-5b88-5e0a-a55d-fa9f5e19b22f",
                  "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                  "scope": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones",
                  "timeouts": null
                },
                "sensitive_values": {}
              },
              {
                "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-Monitoring\"].azurerm_role_assignment.for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/roleAssignments/67659494-cbe2-55a8-80f6-7556e2075217\"]",
                "mode": "managed",
                "type": "azurerm_role_assignment",
                "name": "for_policy",
                "index": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/roleAssignments/67659494-cbe2-55a8-80f6-7556e2075217",
                "provider_name": "registry.terraform.io/hashicorp/azurerm",
                "schema_version": 0,
                "values": {
                  "condition": null,
                  "condition_version": null,
                  "delegated_managed_identity_resource_id": null,
                  "description": null,
                  "name": "67659494-cbe2-55a8-80f6-7556e2075217",
                  "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293",
                  "scope": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones",
                  "timeouts": null
                },
                "sensitive_values": {}
              },
              {
                "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-Monitoring\"].azurerm_role_assignment.for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/roleAssignments/8ceee95c-8844-5589-b4cc-c4a998533019\"]",
                "mode": "managed",
                "type": "azurerm_role_assignment",
                "name": "for_policy",
                "index": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/roleAssignments/8ceee95c-8844-5589-b4cc-c4a998533019",
                "provider_name": "registry.terraform.io/hashicorp/azurerm",
                "schema_version": 0,
                "values": {
                  "condition": null,
                  "condition_version": null,
                  "delegated_managed_identity_resource_id": null,
                  "description": null,
                  "name": "8ceee95c-8844-5589-b4cc-c4a998533019",
                  "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/18d7d88d-d35e-4fb5-a5c3-7773c20a72d9",
                  "scope": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones",
                  "timeouts": null
                },
                "sensitive_values": {}
              },
              {
                "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-Monitoring\"].azurerm_role_assignment.for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/roleAssignments/b2698cea-a061-57b4-815a-5beefb36120e\"]",
                "mode": "managed",
                "type": "azurerm_role_assignment",
                "name": "for_policy",
                "index": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/roleAssignments/b2698cea-a061-57b4-815a-5beefb36120e",
                "provider_name": "registry.terraform.io/hashicorp/azurerm",
                "schema_version": 0,
                "values": {
                  "condition": null,
                  "condition_version": null,
                  "delegated_managed_identity_resource_id": null,
                  "description": null,
                  "name": "b2698cea-a061-57b4-815a-5beefb36120e",
                  "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c",
                  "scope": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones",
                  "timeouts": null
                },
                "sensitive_values": {}
              },
              {
                "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-Monitoring\"].azurerm_role_assignment.for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/roleAssignments/c51567c5-21d2-5749-9628-578ae62a1428\"]",
                "mode": "managed",
                "type": "azurerm_role_assignment",
                "name": "for_policy",
                "index": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/roleAssignments/c51567c5-21d2-5749-9628-578ae62a1428",
                "provider_name": "registry.terraform.io/hashicorp/azurerm",
                "schema_version": 0,
                "values": {
                  "condition": null,
                  "condition_version": null,
                  "delegated_managed_identity_resource_id": null,
                  "description": null,
                  "name": "c51567c5-21d2-5749-9628-578ae62a1428",
                  "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c",
                  "scope": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones",
                  "timeouts": null
                },
                "sensitive_values": {}
              }
            ],
            "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-Monitoring\"]"
          },
          {
            "resources": [
              {
                "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-VMSS-ChangeTrack\"].azurerm_role_assignment.for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/roleAssignments/63616a21-f996-5b5b-8470-df091b42675f\"]",
                "mode": "managed",
                "type": "azurerm_role_assignment",
                "name": "for_policy",
                "index": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/roleAssignments/63616a21-f996-5b5b-8470-df091b42675f",
                "provider_name": "registry.terraform.io/hashicorp/azurerm",
                "schema_version": 0,
                "values": {
                  "condition": null,
                  "condition_version": null,
                  "delegated_managed_identity_resource_id": null,
                  "description": null,
                  "name": "63616a21-f996-5b5b-8470-df091b42675f",
                  "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                  "scope": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones",
                  "timeouts": null
                },
                "sensitive_values": {}
              },
              {
                "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-VMSS-ChangeTrack\"].azurerm_role_assignment.for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/roleAssignments/7cf3b72d-bd58-5b7a-9d75-32dd95a2c0fb\"]",
                "mode": "managed",
                "type": "azurerm_role_assignment",
                "name": "for_policy",
                "index": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/roleAssignments/7cf3b72d-bd58-5b7a-9d75-32dd95a2c0fb",
                "provider_name": "registry.terraform.io/hashicorp/azurerm",
                "schema_version": 0,
                "values": {
                  "condition": null,
                  "condition_version": null,
                  "delegated_managed_identity_resource_id": null,
                  "description": null,
                  "name": "7cf3b72d-bd58-5b7a-9d75-32dd95a2c0fb",
                  "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/18d7d88d-d35e-4fb5-a5c3-7773c20a72d9",
                  "scope": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones",
                  "timeouts": null
                },
                "sensitive_values": {}
              },
              {
                "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-VMSS-ChangeTrack\"].azurerm_role_assignment.for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/roleAssignments/a312d1b5-682c-5147-b7ad-24f413e813ce\"]",
                "mode": "managed",
                "type": "azurerm_role_assignment",
                "name": "for_policy",
                "index": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/roleAssignments/a312d1b5-682c-5147-b7ad-24f413e813ce",
                "provider_name": "registry.terraform.io/hashicorp/azurerm",
                "schema_version": 0,
                "values": {
                  "condition": null,
                  "condition_version": null,
                  "delegated_managed_identity_resource_id": null,
                  "description": null,
                  "name": "a312d1b5-682c-5147-b7ad-24f413e813ce",
                  "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c",
                  "scope": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones",
                  "timeouts": null
                },
                "sensitive_values": {}
              },
              {
                "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-VMSS-ChangeTrack\"].azurerm_role_assignment.for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/roleAssignments/b84302b9-50f6-50e1-b0f8-1dd372be0467\"]",
                "mode": "managed",
                "type": "azurerm_role_assignment",
                "name": "for_policy",
                "index": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/roleAssignments/b84302b9-50f6-50e1-b0f8-1dd372be0467",
                "provider_name": "registry.terraform.io/hashicorp/azurerm",
                "schema_version": 0,
                "values": {
                  "condition": null,
                  "condition_version": null,
                  "delegated_managed_identity_resource_id": null,
                  "description": null,
                  "name": "b84302b9-50f6-50e1-b0f8-1dd372be0467",
                  "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293",
                  "scope": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones",
                  "timeouts": null
                },
                "sensitive_values": {}
              },
              {
                "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-VMSS-ChangeTrack\"].azurerm_role_assignment.for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/roleAssignments/e63b0de2-e8d9-54d8-83c3-d30b6b62a3b5\"]",
                "mode": "managed",
                "type": "azurerm_role_assignment",
                "name": "for_policy",
                "index": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/roleAssignments/e63b0de2-e8d9-54d8-83c3-d30b6b62a3b5",
                "provider_name": "registry.terraform.io/hashicorp/azurerm",
                "schema_version": 0,
                "values": {
                  "condition": null,
                  "condition_version": null,
                  "delegated_managed_identity_resource_id": null,
                  "description": null,
                  "name": "e63b0de2-e8d9-54d8-83c3-d30b6b62a3b5",
                  "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c",
                  "scope": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones",
                  "timeouts": null
                },
                "sensitive_values": {}
              }
            ],
            "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-VMSS-ChangeTrack\"]"
          },
          {
            "resources": [
              {
                "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-VMSS-Monitoring\"].azurerm_role_assignment.for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/roleAssignments/5751f77e-1b33-5a13-98c3-abdb1db72a8f\"]",
                "mode": "managed",
                "type": "azurerm_role_assignment",
                "name": "for_policy",
                "index": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/roleAssignments/5751f77e-1b33-5a13-98c3-abdb1db72a8f",
                "provider_name": "registry.terraform.io/hashicorp/azurerm",
                "schema_version": 0,
                "values": {
                  "condition": null,
                  "condition_version": null,
                  "delegated_managed_identity_resource_id": null,
                  "description": null,
                  "name": "5751f77e-1b33-5a13-98c3-abdb1db72a8f",
                  "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293",
                  "scope": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones",
                  "timeouts": null
                },
                "sensitive_values": {}
              },
              {
                "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-VMSS-Monitoring\"].azurerm_role_assignment.for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/roleAssignments/80fb0ded-a843-5cc9-98fa-90c9c3019345\"]",
                "mode": "managed",
                "type": "azurerm_role_assignment",
                "name": "for_policy",
                "index": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/roleAssignments/80fb0ded-a843-5cc9-98fa-90c9c3019345",
                "provider_name": "registry.terraform.io/hashicorp/azurerm",
                "schema_version": 0,
                "values": {
                  "condition": null,
                  "condition_version": null,
                  "delegated_managed_identity_resource_id": null,
                  "description": null,
                  "name": "80fb0ded-a843-5cc9-98fa-90c9c3019345",
                  "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/18d7d88d-d35e-4fb5-a5c3-7773c20a72d9",
                  "scope": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones",
                  "timeouts": null
                },
                "sensitive_values": {}
              },
              {
                "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-VMSS-Monitoring\"].azurerm_role_assignment.for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/roleAssignments/8f2db3cc-1ad1-55a8-b0a3-b6463194b04e\"]",
                "mode": "managed",
                "type": "azurerm_role_assignment",
                "name": "for_policy",
                "index": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/roleAssignments/8f2db3cc-1ad1-55a8-b0a3-b6463194b04e",
                "provider_name": "registry.terraform.io/hashicorp/azurerm",
                "schema_version": 0,
                "values": {
                  "condition": null,
                  "condition_version": null,
                  "delegated_managed_identity_resource_id": null,
                  "description": null,
                  "name": "8f2db3cc-1ad1-55a8-b0a3-b6463194b04e",
                  "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c",
                  "scope": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones",
                  "timeouts": null
                },
                "sensitive_values": {}
              },
              {
                "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-VMSS-Monitoring\"].azurerm_role_assignment.for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/roleAssignments/a9a33320-72e6-5440-937f-f666e6a5a604\"]",
                "mode": "managed",
                "type": "azurerm_role_assignment",
                "name": "for_policy",
                "index": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/roleAssignments/a9a33320-72e6-5440-937f-f666e6a5a604",
                "provider_name": "registry.terraform.io/hashicorp/azurerm",
                "schema_version": 0,
                "values": {
                  "condition": null,
                  "condition_version": null,
                  "delegated_managed_identity_resource_id": null,
                  "description": null,
                  "name": "a9a33320-72e6-5440-937f-f666e6a5a604",
                  "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                  "scope": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones",
                  "timeouts": null
                },
                "sensitive_values": {}
              },
              {
                "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-VMSS-Monitoring\"].azurerm_role_assignment.for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/roleAssignments/ea11c104-b64e-5b7f-85e3-b44550d7cbf9\"]",
                "mode": "managed",
                "type": "azurerm_role_assignment",
                "name": "for_policy",
                "index": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/roleAssignments/ea11c104-b64e-5b7f-85e3-b44550d7cbf9",
                "provider_name": "registry.terraform.io/hashicorp/azurerm",
                "schema_version": 0,
                "values": {
                  "condition": null,
                  "condition_version": null,
                  "delegated_managed_identity_resource_id": null,
                  "description": null,
                  "name": "ea11c104-b64e-5b7f-85e3-b44550d7cbf9",
                  "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c",
                  "scope": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones",
                  "timeouts": null
                },
                "sensitive_values": {}
              }
            ],
            "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-VMSS-Monitoring\"]"
          },
          {
            "resources": [
              {
                "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-vmArc-ChangeTrack\"].azurerm_role_assignment.for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/roleAssignments/0eac3e03-2d04-5422-9771-dd5bff747174\"]",
                "mode": "managed",
                "type": "azurerm_role_assignment",
                "name": "for_policy",
                "index": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/roleAssignments/0eac3e03-2d04-5422-9771-dd5bff747174",
                "provider_name": "registry.terraform.io/hashicorp/azurerm",
                "schema_version": 0,
                "values": {
                  "condition": null,
                  "condition_version": null,
                  "delegated_managed_identity_resource_id": null,
                  "description": null,
                  "name": "0eac3e03-2d04-5422-9771-dd5bff747174",
                  "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/cd570a14-e51a-42ad-bac8-bafd67325302",
                  "scope": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones",
                  "timeouts": null
                },
                "sensitive_values": {}
              },
              {
                "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-vmArc-ChangeTrack\"].azurerm_role_assignment.for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/roleAssignments/5cc91d71-e1d3-58b7-8c05-be3b37fb3b7a\"]",
                "mode": "managed",
                "type": "azurerm_role_assignment",
                "name": "for_policy",
                "index": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/roleAssignments/5cc91d71-e1d3-58b7-8c05-be3b37fb3b7a",
                "provider_name": "registry.terraform.io/hashicorp/azurerm",
                "schema_version": 0,
                "values": {
                  "condition": null,
                  "condition_version": null,
                  "delegated_managed_identity_resource_id": null,
                  "description": null,
                  "name": "5cc91d71-e1d3-58b7-8c05-be3b37fb3b7a",
                  "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                  "scope": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones",
                  "timeouts": null
                },
                "sensitive_values": {}
              },
              {
                "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-vmArc-ChangeTrack\"].azurerm_role_assignment.for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/roleAssignments/b056593e-197c-52a2-8a1d-dc970e78a8cc\"]",
                "mode": "managed",
                "type": "azurerm_role_assignment",
                "name": "for_policy",
                "index": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/roleAssignments/b056593e-197c-52a2-8a1d-dc970e78a8cc",
                "provider_name": "registry.terraform.io/hashicorp/azurerm",
                "schema_version": 0,
                "values": {
                  "condition": null,
                  "condition_version": null,
                  "delegated_managed_identity_resource_id": null,
                  "description": null,
                  "name": "b056593e-197c-52a2-8a1d-dc970e78a8cc",
                  "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293",
                  "scope": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones",
                  "timeouts": null
                },
                "sensitive_values": {}
              }
            ],
            "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-vmArc-ChangeTrack\"]"
          },
          {
            "resources": [
              {
                "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Enable-AUM-CheckUpdates\"].azurerm_role_assignment.for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/roleAssignments/1cb23a22-c61d-57e4-b1fc-192241f7cd20\"]",
                "mode": "managed",
                "type": "azurerm_role_assignment",
                "name": "for_policy",
                "index": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/roleAssignments/1cb23a22-c61d-57e4-b1fc-192241f7cd20",
                "provider_name": "registry.terraform.io/hashicorp/azurerm",
                "schema_version": 0,
                "values": {
                  "condition": null,
                  "condition_version": null,
                  "delegated_managed_identity_resource_id": null,
                  "description": null,
                  "name": "1cb23a22-c61d-57e4-b1fc-192241f7cd20",
                  "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/cd570a14-e51a-42ad-bac8-bafd67325302",
                  "scope": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones",
                  "timeouts": null
                },
                "sensitive_values": {}
              },
              {
                "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Enable-AUM-CheckUpdates\"].azurerm_role_assignment.for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/roleAssignments/80d7157a-8b76-56e7-9237-28066b10b007\"]",
                "mode": "managed",
                "type": "azurerm_role_assignment",
                "name": "for_policy",
                "index": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/roleAssignments/80d7157a-8b76-56e7-9237-28066b10b007",
                "provider_name": "registry.terraform.io/hashicorp/azurerm",
                "schema_version": 0,
                "values": {
                  "condition": null,
                  "condition_version": null,
                  "delegated_managed_identity_resource_id": null,
                  "description": null,
                  "name": "80d7157a-8b76-56e7-9237-28066b10b007",
                  "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c",
                  "scope": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones",
                  "timeouts": null
                },
                "sensitive_values": {}
              }
            ],
            "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Enable-AUM-CheckUpdates\"]"
          },
          {
            "resources": [
              {
                "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Enable-DDoS-VNET\"].azurerm_role_assignment.for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/roleAssignments/1c659f37-1ad5-5577-bc68-922ba20d7523\"]",
                "mode": "managed",
                "type": "azurerm_role_assignment",
                "name": "for_policy",
                "index": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/roleAssignments/1c659f37-1ad5-5577-bc68-922ba20d7523",
                "provider_name": "registry.terraform.io/hashicorp/azurerm",
                "schema_version": 0,
                "values": {
                  "condition": null,
                  "condition_version": null,
                  "delegated_managed_identity_resource_id": null,
                  "description": null,
                  "name": "1c659f37-1ad5-5577-bc68-922ba20d7523",
                  "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7",
                  "scope": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones",
                  "timeouts": null
                },
                "sensitive_values": {}
              }
            ],
            "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Enable-DDoS-VNET\"]"
          },
          {
            "resources": [
              {
                "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Enforce-TLS-SSL-H224\"].azurerm_role_assignment.for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/roleAssignments/18ca2090-4bbd-59f6-b5c6-968d6fa4d0f9\"]",
                "mode": "managed",
                "type": "azurerm_role_assignment",
                "name": "for_policy",
                "index": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/roleAssignments/18ca2090-4bbd-59f6-b5c6-968d6fa4d0f9",
                "provider_name": "registry.terraform.io/hashicorp/azurerm",
                "schema_version": 0,
                "values": {
                  "condition": null,
                  "condition_version": null,
                  "delegated_managed_identity_resource_id": null,
                  "description": null,
                  "name": "18ca2090-4bbd-59f6-b5c6-968d6fa4d0f9",
                  "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/de139f84-1756-47ae-9be6-808fbbe84772",
                  "scope": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones",
                  "timeouts": null
                },
                "sensitive_values": {}
              },
              {
                "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Enforce-TLS-SSL-H224\"].azurerm_role_assignment.for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/roleAssignments/1f9b3378-38ab-5dc8-964d-cda11813dcf0\"]",
                "mode": "managed",
                "type": "azurerm_role_assignment",
                "name": "for_policy",
                "index": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/roleAssignments/1f9b3378-38ab-5dc8-964d-cda11813dcf0",
                "provider_name": "registry.terraform.io/hashicorp/azurerm",
                "schema_version": 0,
                "values": {
                  "condition": null,
                  "condition_version": null,
                  "delegated_managed_identity_resource_id": null,
                  "description": null,
                  "name": "1f9b3378-38ab-5dc8-964d-cda11813dcf0",
                  "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/17d1049b-9a84-46fb-8f53-869881c3d3ab",
                  "scope": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones",
                  "timeouts": null
                },
                "sensitive_values": {}
              },
              {
                "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Enforce-TLS-SSL-H224\"].azurerm_role_assignment.for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/roleAssignments/9bd066b9-c8cd-53d0-b52e-fe841df6b203\"]",
                "mode": "managed",
                "type": "azurerm_role_assignment",
                "name": "for_policy",
                "index": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/roleAssignments/9bd066b9-c8cd-53d0-b52e-fe841df6b203",
                "provider_name": "registry.terraform.io/hashicorp/azurerm",
                "schema_version": 0,
                "values": {
                  "condition": null,
                  "condition_version": null,
                  "delegated_managed_identity_resource_id": null,
                  "description": null,
                  "name": "9bd066b9-c8cd-53d0-b52e-fe841df6b203",
                  "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/4939a1f6-9ae0-4e48-a1e0-f2cbe897382d",
                  "scope": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones",
                  "timeouts": null
                },
                "sensitive_values": {}
              },
              {
                "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Enforce-TLS-SSL-H224\"].azurerm_role_assignment.for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/roleAssignments/adaa69d8-8c95-5f89-b62d-5ebeb936c927\"]",
                "mode": "managed",
                "type": "azurerm_role_assignment",
                "name": "for_policy",
                "index": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/roleAssignments/adaa69d8-8c95-5f89-b62d-5ebeb936c927",
                "provider_name": "registry.terraform.io/hashicorp/azurerm",
                "schema_version": 0,
                "values": {
                  "condition": null,
                  "condition_version": null,
                  "delegated_managed_identity_resource_id": null,
                  "description": null,
                  "name": "adaa69d8-8c95-5f89-b62d-5ebeb936c927",
                  "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/6d8ee4ec-f05a-4a1d-8b00-a9b17e38b437",
                  "scope": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones",
                  "timeouts": null
                },
                "sensitive_values": {}
              },
              {
                "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Enforce-TLS-SSL-H224\"].azurerm_role_assignment.for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/roleAssignments/c61ef79e-ff03-5e4f-8aec-7c7b7873b579\"]",
                "mode": "managed",
                "type": "azurerm_role_assignment",
                "name": "for_policy",
                "index": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/roleAssignments/c61ef79e-ff03-5e4f-8aec-7c7b7873b579",
                "provider_name": "registry.terraform.io/hashicorp/azurerm",
                "schema_version": 0,
                "values": {
                  "condition": null,
                  "condition_version": null,
                  "delegated_managed_identity_resource_id": null,
                  "description": null,
                  "name": "c61ef79e-ff03-5e4f-8aec-7c7b7873b579",
                  "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c",
                  "scope": "/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones",
                  "timeouts": null
                },
                "sensitive_values": {}
              }
            ],
            "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-landing-zones/providers/Microsoft.Authorization/policyAssignments/Enforce-TLS-SSL-H224\"]"
          },
          {
            "resources": [
              {
                "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-management/providers/Microsoft.Authorization/policyAssignments/Deploy-Log-Analytics\"].azurerm_role_assignment.for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-management/providers/Microsoft.Authorization/roleAssignments/8f7e20b7-7a5d-551d-b4fd-047861c4bc93\"]",
                "mode": "managed",
                "type": "azurerm_role_assignment",
                "name": "for_policy",
                "index": "/providers/Microsoft.Management/managementGroups/root-id-1-management/providers/Microsoft.Authorization/roleAssignments/8f7e20b7-7a5d-551d-b4fd-047861c4bc93",
                "provider_name": "registry.terraform.io/hashicorp/azurerm",
                "schema_version": 0,
                "values": {
                  "condition": null,
                  "condition_version": null,
                  "delegated_managed_identity_resource_id": null,
                  "description": null,
                  "name": "8f7e20b7-7a5d-551d-b4fd-047861c4bc93",
                  "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c",
                  "scope": "/providers/Microsoft.Management/managementGroups/root-id-1-management",
                  "timeouts": null
                },
                "sensitive_values": {}
              }
            ],
            "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-management/providers/Microsoft.Authorization/policyAssignments/Deploy-Log-Analytics\"]"
          },
          {
            "resources": [
              {
                "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/policyAssignments/Deploy-MDFC-DefSQL-AMA\"].azurerm_role_assignment.for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/roleAssignments/1c28b670-bee1-5255-9ec9-5d46c2732b6a\"]",
                "mode": "managed",
                "type": "azurerm_role_assignment",
                "name": "for_policy",
                "index": "/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/roleAssignments/1c28b670-bee1-5255-9ec9-5d46c2732b6a",
                "provider_name": "registry.terraform.io/hashicorp/azurerm",
                "schema_version": 0,
                "values": {
                  "condition": null,
                  "condition_version": null,
                  "delegated_managed_identity_resource_id": null,
                  "description": null,
                  "name": "1c28b670-bee1-5255-9ec9-5d46c2732b6a",
                  "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c",
                  "scope": "/providers/Microsoft.Management/managementGroups/root-id-1-platform",
                  "timeouts": null
                },
                "sensitive_values": {}
              },
              {
                "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/policyAssignments/Deploy-MDFC-DefSQL-AMA\"].azurerm_role_assignment.for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/roleAssignments/31acd4e2-cfff-551e-a1dd-86dc52a865e3\"]",
                "mode": "managed",
                "type": "azurerm_role_assignment",
                "name": "for_policy",
                "index": "/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/roleAssignments/31acd4e2-cfff-551e-a1dd-86dc52a865e3",
                "provider_name": "registry.terraform.io/hashicorp/azurerm",
                "schema_version": 0,
                "values": {
                  "condition": null,
                  "condition_version": null,
                  "delegated_managed_identity_resource_id": null,
                  "description": null,
                  "name": "31acd4e2-cfff-551e-a1dd-86dc52a865e3",
                  "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/cd570a14-e51a-42ad-bac8-bafd67325302",
                  "scope": "/providers/Microsoft.Management/managementGroups/root-id-1-platform",
                  "timeouts": null
                },
                "sensitive_values": {}
              },
              {
                "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/policyAssignments/Deploy-MDFC-DefSQL-AMA\"].azurerm_role_assignment.for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/roleAssignments/7a30a48e-6ce5-5b97-b972-e6379821a0fc\"]",
                "mode": "managed",
                "type": "azurerm_role_assignment",
                "name": "for_policy",
                "index": "/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/roleAssignments/7a30a48e-6ce5-5b97-b972-e6379821a0fc",
                "provider_name": "registry.terraform.io/hashicorp/azurerm",
                "schema_version": 0,
                "values": {
                  "condition": null,
                  "condition_version": null,
                  "delegated_managed_identity_resource_id": null,
                  "description": null,
                  "name": "7a30a48e-6ce5-5b97-b972-e6379821a0fc",
                  "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                  "scope": "/providers/Microsoft.Management/managementGroups/root-id-1-platform",
                  "timeouts": null
                },
                "sensitive_values": {}
              },
              {
                "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/policyAssignments/Deploy-MDFC-DefSQL-AMA\"].azurerm_role_assignment.for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/roleAssignments/8c3df4d1-312e-5606-820a-b479a51190b4\"]",
                "mode": "managed",
                "type": "azurerm_role_assignment",
                "name": "for_policy",
                "index": "/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/roleAssignments/8c3df4d1-312e-5606-820a-b479a51190b4",
                "provider_name": "registry.terraform.io/hashicorp/azurerm",
                "schema_version": 0,
                "values": {
                  "condition": null,
                  "condition_version": null,
                  "delegated_managed_identity_resource_id": null,
                  "description": null,
                  "name": "8c3df4d1-312e-5606-820a-b479a51190b4",
                  "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293",
                  "scope": "/providers/Microsoft.Management/managementGroups/root-id-1-platform",
                  "timeouts": null
                },
                "sensitive_values": {}
              },
              {
                "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/policyAssignments/Deploy-MDFC-DefSQL-AMA\"].azurerm_role_assignment.for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/roleAssignments/dc7168e6-14e1-5e76-b256-9c459be7914a\"]",
                "mode": "managed",
                "type": "azurerm_role_assignment",
                "name": "for_policy",
                "index": "/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/roleAssignments/dc7168e6-14e1-5e76-b256-9c459be7914a",
                "provider_name": "registry.terraform.io/hashicorp/azurerm",
                "schema_version": 0,
                "values": {
                  "condition": null,
                  "condition_version": null,
                  "delegated_managed_identity_resource_id": null,
                  "description": null,
                  "name": "dc7168e6-14e1-5e76-b256-9c459be7914a",
                  "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c",
                  "scope": "/providers/Microsoft.Management/managementGroups/root-id-1-platform",
                  "timeouts": null
                },
                "sensitive_values": {}
              }
            ],
            "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/policyAssignments/Deploy-MDFC-DefSQL-AMA\"]"
          },
          {
            "resources": [
              {
                "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-ChangeTrack\"].azurerm_role_assignment.for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/roleAssignments/136c9199-f1bf-57db-a5ef-96f119cbcc3c\"]",
                "mode": "managed",
                "type": "azurerm_role_assignment",
                "name": "for_policy",
                "index": "/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/roleAssignments/136c9199-f1bf-57db-a5ef-96f119cbcc3c",
                "provider_name": "registry.terraform.io/hashicorp/azurerm",
                "schema_version": 0,
                "values": {
                  "condition": null,
                  "condition_version": null,
                  "delegated_managed_identity_resource_id": null,
                  "description": null,
                  "name": "136c9199-f1bf-57db-a5ef-96f119cbcc3c",
                  "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                  "scope": "/providers/Microsoft.Management/managementGroups/root-id-1-platform",
                  "timeouts": null
                },
                "sensitive_values": {}
              },
              {
                "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-ChangeTrack\"].azurerm_role_assignment.for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/roleAssignments/1cd2c529-fa06-55b4-990f-3fc7b506eba0\"]",
                "mode": "managed",
                "type": "azurerm_role_assignment",
                "name": "for_policy",
                "index": "/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/roleAssignments/1cd2c529-fa06-55b4-990f-3fc7b506eba0",
                "provider_name": "registry.terraform.io/hashicorp/azurerm",
                "schema_version": 0,
                "values": {
                  "condition": null,
                  "condition_version": null,
                  "delegated_managed_identity_resource_id": null,
                  "description": null,
                  "name": "1cd2c529-fa06-55b4-990f-3fc7b506eba0",
                  "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293",
                  "scope": "/providers/Microsoft.Management/managementGroups/root-id-1-platform",
                  "timeouts": null
                },
                "sensitive_values": {}
              },
              {
                "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-ChangeTrack\"].azurerm_role_assignment.for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/roleAssignments/3e90c3fc-2786-537d-9ff6-7ce8750b052e\"]",
                "mode": "managed",
                "type": "azurerm_role_assignment",
                "name": "for_policy",
                "index": "/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/roleAssignments/3e90c3fc-2786-537d-9ff6-7ce8750b052e",
                "provider_name": "registry.terraform.io/hashicorp/azurerm",
                "schema_version": 0,
                "values": {
                  "condition": null,
                  "condition_version": null,
                  "delegated_managed_identity_resource_id": null,
                  "description": null,
                  "name": "3e90c3fc-2786-537d-9ff6-7ce8750b052e",
                  "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/18d7d88d-d35e-4fb5-a5c3-7773c20a72d9",
                  "scope": "/providers/Microsoft.Management/managementGroups/root-id-1-platform",
                  "timeouts": null
                },
                "sensitive_values": {}
              },
              {
                "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-ChangeTrack\"].azurerm_role_assignment.for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/roleAssignments/7eb236f6-3f54-5dfa-9982-36e0c96cfd17\"]",
                "mode": "managed",
                "type": "azurerm_role_assignment",
                "name": "for_policy",
                "index": "/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/roleAssignments/7eb236f6-3f54-5dfa-9982-36e0c96cfd17",
                "provider_name": "registry.terraform.io/hashicorp/azurerm",
                "schema_version": 0,
                "values": {
                  "condition": null,
                  "condition_version": null,
                  "delegated_managed_identity_resource_id": null,
                  "description": null,
                  "name": "7eb236f6-3f54-5dfa-9982-36e0c96cfd17",
                  "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c",
                  "scope": "/providers/Microsoft.Management/managementGroups/root-id-1-platform",
                  "timeouts": null
                },
                "sensitive_values": {}
              },
              {
                "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-ChangeTrack\"].azurerm_role_assignment.for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/roleAssignments/dc9489f0-8b71-55d3-82b1-52f3d366fd08\"]",
                "mode": "managed",
                "type": "azurerm_role_assignment",
                "name": "for_policy",
                "index": "/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/roleAssignments/dc9489f0-8b71-55d3-82b1-52f3d366fd08",
                "provider_name": "registry.terraform.io/hashicorp/azurerm",
                "schema_version": 0,
                "values": {
                  "condition": null,
                  "condition_version": null,
                  "delegated_managed_identity_resource_id": null,
                  "description": null,
                  "name": "dc9489f0-8b71-55d3-82b1-52f3d366fd08",
                  "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c",
                  "scope": "/providers/Microsoft.Management/managementGroups/root-id-1-platform",
                  "timeouts": null
                },
                "sensitive_values": {}
              }
            ],
            "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-ChangeTrack\"]"
          },
          {
            "resources": [
              {
                "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-Monitoring\"].azurerm_role_assignment.for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/roleAssignments/22b24121-9774-5e8a-b5c3-e42a4097d87e\"]",
                "mode": "managed",
                "type": "azurerm_role_assignment",
                "name": "for_policy",
                "index": "/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/roleAssignments/22b24121-9774-5e8a-b5c3-e42a4097d87e",
                "provider_name": "registry.terraform.io/hashicorp/azurerm",
                "schema_version": 0,
                "values": {
                  "condition": null,
                  "condition_version": null,
                  "delegated_managed_identity_resource_id": null,
                  "description": null,
                  "name": "22b24121-9774-5e8a-b5c3-e42a4097d87e",
                  "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                  "scope": "/providers/Microsoft.Management/managementGroups/root-id-1-platform",
                  "timeouts": null
                },
                "sensitive_values": {}
              },
              {
                "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-Monitoring\"].azurerm_role_assignment.for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/roleAssignments/b71591c7-4fbe-5d95-9568-a52612f3f3ce\"]",
                "mode": "managed",
                "type": "azurerm_role_assignment",
                "name": "for_policy",
                "index": "/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/roleAssignments/b71591c7-4fbe-5d95-9568-a52612f3f3ce",
                "provider_name": "registry.terraform.io/hashicorp/azurerm",
                "schema_version": 0,
                "values": {
                  "condition": null,
                  "condition_version": null,
                  "delegated_managed_identity_resource_id": null,
                  "description": null,
                  "name": "b71591c7-4fbe-5d95-9568-a52612f3f3ce",
                  "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293",
                  "scope": "/providers/Microsoft.Management/managementGroups/root-id-1-platform",
                  "timeouts": null
                },
                "sensitive_values": {}
              },
              {
                "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-Monitoring\"].azurerm_role_assignment.for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/roleAssignments/bb922fec-7b07-5f31-97ae-ac1a778a4a5d\"]",
                "mode": "managed",
                "type": "azurerm_role_assignment",
                "name": "for_policy",
                "index": "/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/roleAssignments/bb922fec-7b07-5f31-97ae-ac1a778a4a5d",
                "provider_name": "registry.terraform.io/hashicorp/azurerm",
                "schema_version": 0,
                "values": {
                  "condition": null,
                  "condition_version": null,
                  "delegated_managed_identity_resource_id": null,
                  "description": null,
                  "name": "bb922fec-7b07-5f31-97ae-ac1a778a4a5d",
                  "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c",
                  "scope": "/providers/Microsoft.Management/managementGroups/root-id-1-platform",
                  "timeouts": null
                },
                "sensitive_values": {}
              },
              {
                "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-Monitoring\"].azurerm_role_assignment.for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/roleAssignments/e1ca3764-73cb-53d2-9d65-351c9d2514e4\"]",
                "mode": "managed",
                "type": "azurerm_role_assignment",
                "name": "for_policy",
                "index": "/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/roleAssignments/e1ca3764-73cb-53d2-9d65-351c9d2514e4",
                "provider_name": "registry.terraform.io/hashicorp/azurerm",
                "schema_version": 0,
                "values": {
                  "condition": null,
                  "condition_version": null,
                  "delegated_managed_identity_resource_id": null,
                  "description": null,
                  "name": "e1ca3764-73cb-53d2-9d65-351c9d2514e4",
                  "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c",
                  "scope": "/providers/Microsoft.Management/managementGroups/root-id-1-platform",
                  "timeouts": null
                },
                "sensitive_values": {}
              },
              {
                "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-Monitoring\"].azurerm_role_assignment.for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/roleAssignments/e2d5cfe9-c912-54b9-927a-961f365fad58\"]",
                "mode": "managed",
                "type": "azurerm_role_assignment",
                "name": "for_policy",
                "index": "/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/roleAssignments/e2d5cfe9-c912-54b9-927a-961f365fad58",
                "provider_name": "registry.terraform.io/hashicorp/azurerm",
                "schema_version": 0,
                "values": {
                  "condition": null,
                  "condition_version": null,
                  "delegated_managed_identity_resource_id": null,
                  "description": null,
                  "name": "e2d5cfe9-c912-54b9-927a-961f365fad58",
                  "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/18d7d88d-d35e-4fb5-a5c3-7773c20a72d9",
                  "scope": "/providers/Microsoft.Management/managementGroups/root-id-1-platform",
                  "timeouts": null
                },
                "sensitive_values": {}
              }
            ],
            "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-Monitoring\"]"
          },
          {
            "resources": [
              {
                "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/policyAssignments/Deploy-VMSS-ChangeTrack\"].azurerm_role_assignment.for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/roleAssignments/3cda6e61-2fad-5545-b7c3-1c1476676978\"]",
                "mode": "managed",
                "type": "azurerm_role_assignment",
                "name": "for_policy",
                "index": "/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/roleAssignments/3cda6e61-2fad-5545-b7c3-1c1476676978",
                "provider_name": "registry.terraform.io/hashicorp/azurerm",
                "schema_version": 0,
                "values": {
                  "condition": null,
                  "condition_version": null,
                  "delegated_managed_identity_resource_id": null,
                  "description": null,
                  "name": "3cda6e61-2fad-5545-b7c3-1c1476676978",
                  "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                  "scope": "/providers/Microsoft.Management/managementGroups/root-id-1-platform",
                  "timeouts": null
                },
                "sensitive_values": {}
              },
              {
                "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/policyAssignments/Deploy-VMSS-ChangeTrack\"].azurerm_role_assignment.for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/roleAssignments/511088a2-6f25-596b-b543-1c3dfbab03cb\"]",
                "mode": "managed",
                "type": "azurerm_role_assignment",
                "name": "for_policy",
                "index": "/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/roleAssignments/511088a2-6f25-596b-b543-1c3dfbab03cb",
                "provider_name": "registry.terraform.io/hashicorp/azurerm",
                "schema_version": 0,
                "values": {
                  "condition": null,
                  "condition_version": null,
                  "delegated_managed_identity_resource_id": null,
                  "description": null,
                  "name": "511088a2-6f25-596b-b543-1c3dfbab03cb",
                  "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293",
                  "scope": "/providers/Microsoft.Management/managementGroups/root-id-1-platform",
                  "timeouts": null
                },
                "sensitive_values": {}
              },
              {
                "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/policyAssignments/Deploy-VMSS-ChangeTrack\"].azurerm_role_assignment.for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/roleAssignments/6327ff82-25e9-5daf-9e5c-46b845201cda\"]",
                "mode": "managed",
                "type": "azurerm_role_assignment",
                "name": "for_policy",
                "index": "/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/roleAssignments/6327ff82-25e9-5daf-9e5c-46b845201cda",
                "provider_name": "registry.terraform.io/hashicorp/azurerm",
                "schema_version": 0,
                "values": {
                  "condition": null,
                  "condition_version": null,
                  "delegated_managed_identity_resource_id": null,
                  "description": null,
                  "name": "6327ff82-25e9-5daf-9e5c-46b845201cda",
                  "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/18d7d88d-d35e-4fb5-a5c3-7773c20a72d9",
                  "scope": "/providers/Microsoft.Management/managementGroups/root-id-1-platform",
                  "timeouts": null
                },
                "sensitive_values": {}
              },
              {
                "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/policyAssignments/Deploy-VMSS-ChangeTrack\"].azurerm_role_assignment.for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/roleAssignments/ad60d8b2-7834-543b-9f27-087b54a763e7\"]",
                "mode": "managed",
                "type": "azurerm_role_assignment",
                "name": "for_policy",
                "index": "/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/roleAssignments/ad60d8b2-7834-543b-9f27-087b54a763e7",
                "provider_name": "registry.terraform.io/hashicorp/azurerm",
                "schema_version": 0,
                "values": {
                  "condition": null,
                  "condition_version": null,
                  "delegated_managed_identity_resource_id": null,
                  "description": null,
                  "name": "ad60d8b2-7834-543b-9f27-087b54a763e7",
                  "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c",
                  "scope": "/providers/Microsoft.Management/managementGroups/root-id-1-platform",
                  "timeouts": null
                },
                "sensitive_values": {}
              },
              {
                "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/policyAssignments/Deploy-VMSS-ChangeTrack\"].azurerm_role_assignment.for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/roleAssignments/b645228b-5ac8-5acd-ac98-4c095bb44de5\"]",
                "mode": "managed",
                "type": "azurerm_role_assignment",
                "name": "for_policy",
                "index": "/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/roleAssignments/b645228b-5ac8-5acd-ac98-4c095bb44de5",
                "provider_name": "registry.terraform.io/hashicorp/azurerm",
                "schema_version": 0,
                "values": {
                  "condition": null,
                  "condition_version": null,
                  "delegated_managed_identity_resource_id": null,
                  "description": null,
                  "name": "b645228b-5ac8-5acd-ac98-4c095bb44de5",
                  "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c",
                  "scope": "/providers/Microsoft.Management/managementGroups/root-id-1-platform",
                  "timeouts": null
                },
                "sensitive_values": {}
              }
            ],
            "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/policyAssignments/Deploy-VMSS-ChangeTrack\"]"
          },
          {
            "resources": [
              {
                "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/policyAssignments/Deploy-VMSS-Monitoring\"].azurerm_role_assignment.for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/roleAssignments/48140c25-e25b-5e99-aa5d-308ffe54f453\"]",
                "mode": "managed",
                "type": "azurerm_role_assignment",
                "name": "for_policy",
                "index": "/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/roleAssignments/48140c25-e25b-5e99-aa5d-308ffe54f453",
                "provider_name": "registry.terraform.io/hashicorp/azurerm",
                "schema_version": 0,
                "values": {
                  "condition": null,
                  "condition_version": null,
                  "delegated_managed_identity_resource_id": null,
                  "description": null,
                  "name": "48140c25-e25b-5e99-aa5d-308ffe54f453",
                  "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c",
                  "scope": "/providers/Microsoft.Management/managementGroups/root-id-1-platform",
                  "timeouts": null
                },
                "sensitive_values": {}
              },
              {
                "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/policyAssignments/Deploy-VMSS-Monitoring\"].azurerm_role_assignment.for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/roleAssignments/8a543bbb-4583-59d7-9cc5-e5bb368929fb\"]",
                "mode": "managed",
                "type": "azurerm_role_assignment",
                "name": "for_policy",
                "index": "/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/roleAssignments/8a543bbb-4583-59d7-9cc5-e5bb368929fb",
                "provider_name": "registry.terraform.io/hashicorp/azurerm",
                "schema_version": 0,
                "values": {
                  "condition": null,
                  "condition_version": null,
                  "delegated_managed_identity_resource_id": null,
                  "description": null,
                  "name": "8a543bbb-4583-59d7-9cc5-e5bb368929fb",
                  "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c",
                  "scope": "/providers/Microsoft.Management/managementGroups/root-id-1-platform",
                  "timeouts": null
                },
                "sensitive_values": {}
              },
              {
                "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/policyAssignments/Deploy-VMSS-Monitoring\"].azurerm_role_assignment.for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/roleAssignments/9e8c13c2-e362-5f42-9e68-ad9403daa675\"]",
                "mode": "managed",
                "type": "azurerm_role_assignment",
                "name": "for_policy",
                "index": "/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/roleAssignments/9e8c13c2-e362-5f42-9e68-ad9403daa675",
                "provider_name": "registry.terraform.io/hashicorp/azurerm",
                "schema_version": 0,
                "values": {
                  "condition": null,
                  "condition_version": null,
                  "delegated_managed_identity_resource_id": null,
                  "description": null,
                  "name": "9e8c13c2-e362-5f42-9e68-ad9403daa675",
                  "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293",
                  "scope": "/providers/Microsoft.Management/managementGroups/root-id-1-platform",
                  "timeouts": null
                },
                "sensitive_values": {}
              },
              {
                "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/policyAssignments/Deploy-VMSS-Monitoring\"].azurerm_role_assignment.for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/roleAssignments/f37b8be3-ba19-59da-8ea6-c05d061cebe9\"]",
                "mode": "managed",
                "type": "azurerm_role_assignment",
                "name": "for_policy",
                "index": "/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/roleAssignments/f37b8be3-ba19-59da-8ea6-c05d061cebe9",
                "provider_name": "registry.terraform.io/hashicorp/azurerm",
                "schema_version": 0,
                "values": {
                  "condition": null,
                  "condition_version": null,
                  "delegated_managed_identity_resource_id": null,
                  "description": null,
                  "name": "f37b8be3-ba19-59da-8ea6-c05d061cebe9",
                  "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/18d7d88d-d35e-4fb5-a5c3-7773c20a72d9",
                  "scope": "/providers/Microsoft.Management/managementGroups/root-id-1-platform",
                  "timeouts": null
                },
                "sensitive_values": {}
              },
              {
                "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/policyAssignments/Deploy-VMSS-Monitoring\"].azurerm_role_assignment.for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/roleAssignments/f76e327b-3652-50f9-9509-f010426f71fc\"]",
                "mode": "managed",
                "type": "azurerm_role_assignment",
                "name": "for_policy",
                "index": "/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/roleAssignments/f76e327b-3652-50f9-9509-f010426f71fc",
                "provider_name": "registry.terraform.io/hashicorp/azurerm",
                "schema_version": 0,
                "values": {
                  "condition": null,
                  "condition_version": null,
                  "delegated_managed_identity_resource_id": null,
                  "description": null,
                  "name": "f76e327b-3652-50f9-9509-f010426f71fc",
                  "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                  "scope": "/providers/Microsoft.Management/managementGroups/root-id-1-platform",
                  "timeouts": null
                },
                "sensitive_values": {}
              }
            ],
            "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/policyAssignments/Deploy-VMSS-Monitoring\"]"
          },
          {
            "resources": [
              {
                "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/policyAssignments/Deploy-vmArc-ChangeTrack\"].azurerm_role_assignment.for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/roleAssignments/0c7e27fb-4300-5e12-8c8d-dd55998fa941\"]",
                "mode": "managed",
                "type": "azurerm_role_assignment",
                "name": "for_policy",
                "index": "/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/roleAssignments/0c7e27fb-4300-5e12-8c8d-dd55998fa941",
                "provider_name": "registry.terraform.io/hashicorp/azurerm",
                "schema_version": 0,
                "values": {
                  "condition": null,
                  "condition_version": null,
                  "delegated_managed_identity_resource_id": null,
                  "description": null,
                  "name": "0c7e27fb-4300-5e12-8c8d-dd55998fa941",
                  "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/cd570a14-e51a-42ad-bac8-bafd67325302",
                  "scope": "/providers/Microsoft.Management/managementGroups/root-id-1-platform",
                  "timeouts": null
                },
                "sensitive_values": {}
              },
              {
                "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/policyAssignments/Deploy-vmArc-ChangeTrack\"].azurerm_role_assignment.for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/roleAssignments/7df383fb-ac38-5e8e-86c7-ce93a548d312\"]",
                "mode": "managed",
                "type": "azurerm_role_assignment",
                "name": "for_policy",
                "index": "/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/roleAssignments/7df383fb-ac38-5e8e-86c7-ce93a548d312",
                "provider_name": "registry.terraform.io/hashicorp/azurerm",
                "schema_version": 0,
                "values": {
                  "condition": null,
                  "condition_version": null,
                  "delegated_managed_identity_resource_id": null,
                  "description": null,
                  "name": "7df383fb-ac38-5e8e-86c7-ce93a548d312",
                  "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293",
                  "scope": "/providers/Microsoft.Management/managementGroups/root-id-1-platform",
                  "timeouts": null
                },
                "sensitive_values": {}
              },
              {
                "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/policyAssignments/Deploy-vmArc-ChangeTrack\"].azurerm_role_assignment.for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/roleAssignments/c1459197-d086-58c7-988a-cca2a2e1c805\"]",
                "mode": "managed",
                "type": "azurerm_role_assignment",
                "name": "for_policy",
                "index": "/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/roleAssignments/c1459197-d086-58c7-988a-cca2a2e1c805",
                "provider_name": "registry.terraform.io/hashicorp/azurerm",
                "schema_version": 0,
                "values": {
                  "condition": null,
                  "condition_version": null,
                  "delegated_managed_identity_resource_id": null,
                  "description": null,
                  "name": "c1459197-d086-58c7-988a-cca2a2e1c805",
                  "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                  "scope": "/providers/Microsoft.Management/managementGroups/root-id-1-platform",
                  "timeouts": null
                },
                "sensitive_values": {}
              }
            ],
            "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/policyAssignments/Deploy-vmArc-ChangeTrack\"]"
          },
          {
            "resources": [
              {
                "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/policyAssignments/Enable-AUM-CheckUpdates\"].azurerm_role_assignment.for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/roleAssignments/0e8ba7d2-dfbd-51c4-bcdd-dcb6cce25cf5\"]",
                "mode": "managed",
                "type": "azurerm_role_assignment",
                "name": "for_policy",
                "index": "/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/roleAssignments/0e8ba7d2-dfbd-51c4-bcdd-dcb6cce25cf5",
                "provider_name": "registry.terraform.io/hashicorp/azurerm",
                "schema_version": 0,
                "values": {
                  "condition": null,
                  "condition_version": null,
                  "delegated_managed_identity_resource_id": null,
                  "description": null,
                  "name": "0e8ba7d2-dfbd-51c4-bcdd-dcb6cce25cf5",
                  "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/cd570a14-e51a-42ad-bac8-bafd67325302",
                  "scope": "/providers/Microsoft.Management/managementGroups/root-id-1-platform",
                  "timeouts": null
                },
                "sensitive_values": {}
              },
              {
                "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/policyAssignments/Enable-AUM-CheckUpdates\"].azurerm_role_assignment.for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/roleAssignments/73cc7481-3084-5736-b483-18af114ada9e\"]",
                "mode": "managed",
                "type": "azurerm_role_assignment",
                "name": "for_policy",
                "index": "/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/roleAssignments/73cc7481-3084-5736-b483-18af114ada9e",
                "provider_name": "registry.terraform.io/hashicorp/azurerm",
                "schema_version": 0,
                "values": {
                  "condition": null,
                  "condition_version": null,
                  "delegated_managed_identity_resource_id": null,
                  "description": null,
                  "name": "73cc7481-3084-5736-b483-18af114ada9e",
                  "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c",
                  "scope": "/providers/Microsoft.Management/managementGroups/root-id-1-platform",
                  "timeouts": null
                },
                "sensitive_values": {}
              }
            ],
            "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1-platform/providers/Microsoft.Authorization/policyAssignments/Enable-AUM-CheckUpdates\"]"
          },
          {
            "resources": [
              {
                "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyAssignments/Deploy-AzActivity-Log\"].azurerm_role_assignment.for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/roleAssignments/a82e8238-8bda-508f-84b5-f732aae9ee5e\"]",
                "mode": "managed",
                "type": "azurerm_role_assignment",
                "name": "for_policy",
                "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/roleAssignments/a82e8238-8bda-508f-84b5-f732aae9ee5e",
                "provider_name": "registry.terraform.io/hashicorp/azurerm",
                "schema_version": 0,
                "values": {
                  "condition": null,
                  "condition_version": null,
                  "delegated_managed_identity_resource_id": null,
                  "description": null,
                  "name": "a82e8238-8bda-508f-84b5-f732aae9ee5e",
                  "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                  "scope": "/providers/Microsoft.Management/managementGroups/root-id-1",
                  "timeouts": null
                },
                "sensitive_values": {}
              },
              {
                "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyAssignments/Deploy-AzActivity-Log\"].azurerm_role_assignment.for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/roleAssignments/c7bf76e5-9636-5f92-ad46-22d49ea5c086\"]",
                "mode": "managed",
                "type": "azurerm_role_assignment",
                "name": "for_policy",
                "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/roleAssignments/c7bf76e5-9636-5f92-ad46-22d49ea5c086",
                "provider_name": "registry.terraform.io/hashicorp/azurerm",
                "schema_version": 0,
                "values": {
                  "condition": null,
                  "condition_version": null,
                  "delegated_managed_identity_resource_id": null,
                  "description": null,
                  "name": "c7bf76e5-9636-5f92-ad46-22d49ea5c086",
                  "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293",
                  "scope": "/providers/Microsoft.Management/managementGroups/root-id-1",
                  "timeouts": null
                },
                "sensitive_values": {}
              }
            ],
            "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyAssignments/Deploy-AzActivity-Log\"]"
          },
          {
            "resources": [
              {
                "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyAssignments/Deploy-Diag-Logs\"].azurerm_role_assignment.for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/roleAssignments/345e19c2-461e-59dd-9ae0-932ffdad92b1\"]",
                "mode": "managed",
                "type": "azurerm_role_assignment",
                "name": "for_policy",
                "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/roleAssignments/345e19c2-461e-59dd-9ae0-932ffdad92b1",
                "provider_name": "registry.terraform.io/hashicorp/azurerm",
                "schema_version": 0,
                "values": {
                  "condition": null,
                  "condition_version": null,
                  "delegated_managed_identity_resource_id": null,
                  "description": null,
                  "name": "345e19c2-461e-59dd-9ae0-932ffdad92b1",
                  "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293",
                  "scope": "/providers/Microsoft.Management/managementGroups/root-id-1",
                  "timeouts": null
                },
                "sensitive_values": {}
              }
            ],
            "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyAssignments/Deploy-Diag-Logs\"]"
          },
          {
            "resources": [
              {
                "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyAssignments/Deploy-MDEndpoints\"].azurerm_role_assignment.for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/roleAssignments/e01a72e6-27ce-5ca0-acac-7e07b933740a\"]",
                "mode": "managed",
                "type": "azurerm_role_assignment",
                "name": "for_policy",
                "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/roleAssignments/e01a72e6-27ce-5ca0-acac-7e07b933740a",
                "provider_name": "registry.terraform.io/hashicorp/azurerm",
                "schema_version": 0,
                "values": {
                  "condition": null,
                  "condition_version": null,
                  "delegated_managed_identity_resource_id": null,
                  "description": null,
                  "name": "e01a72e6-27ce-5ca0-acac-7e07b933740a",
                  "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c",
                  "scope": "/providers/Microsoft.Management/managementGroups/root-id-1",
                  "timeouts": null
                },
                "sensitive_values": {}
              }
            ],
            "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyAssignments/Deploy-MDEndpoints\"]"
          },
          {
            "resources": [
              {
                "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyAssignments/Deploy-MDEndpointsAMA\"].azurerm_role_assignment.for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/roleAssignments/16eb39a6-0e64-5e5a-940c-616fd7788d14\"]",
                "mode": "managed",
                "type": "azurerm_role_assignment",
                "name": "for_policy",
                "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/roleAssignments/16eb39a6-0e64-5e5a-940c-616fd7788d14",
                "provider_name": "registry.terraform.io/hashicorp/azurerm",
                "schema_version": 0,
                "values": {
                  "condition": null,
                  "condition_version": null,
                  "delegated_managed_identity_resource_id": null,
                  "description": null,
                  "name": "16eb39a6-0e64-5e5a-940c-616fd7788d14",
                  "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/fb1c8493-542b-48eb-b624-b4c8fea62acd",
                  "scope": "/providers/Microsoft.Management/managementGroups/root-id-1",
                  "timeouts": null
                },
                "sensitive_values": {}
              }
            ],
            "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyAssignments/Deploy-MDEndpointsAMA\"]"
          },
          {
            "resources": [
              {
                "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyAssignments/Deploy-MDFC-Config-H224\"].azurerm_role_assignment.for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/roleAssignments/26cc1008-e2e0-504a-91ae-6f8df64a53f1\"]",
                "mode": "managed",
                "type": "azurerm_role_assignment",
                "name": "for_policy",
                "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/roleAssignments/26cc1008-e2e0-504a-91ae-6f8df64a53f1",
                "provider_name": "registry.terraform.io/hashicorp/azurerm",
                "schema_version": 0,
                "values": {
                  "condition": null,
                  "condition_version": null,
                  "delegated_managed_identity_resource_id": null,
                  "description": null,
                  "name": "26cc1008-e2e0-504a-91ae-6f8df64a53f1",
                  "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/ed7f3fbd-7b88-4dd4-9017-9adb7ce333f8",
                  "scope": "/providers/Microsoft.Management/managementGroups/root-id-1",
                  "timeouts": null
                },
                "sensitive_values": {}
              },
              {
                "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyAssignments/Deploy-MDFC-Config-H224\"].azurerm_role_assignment.for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/roleAssignments/4a122435-13c7-5fa2-a314-7e37fcca8cd8\"]",
                "mode": "managed",
                "type": "azurerm_role_assignment",
                "name": "for_policy",
                "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/roleAssignments/4a122435-13c7-5fa2-a314-7e37fcca8cd8",
                "provider_name": "registry.terraform.io/hashicorp/azurerm",
                "schema_version": 0,
                "values": {
                  "condition": null,
                  "condition_version": null,
                  "delegated_managed_identity_resource_id": null,
                  "description": null,
                  "name": "4a122435-13c7-5fa2-a314-7e37fcca8cd8",
                  "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/fb1c8493-542b-48eb-b624-b4c8fea62acd",
                  "scope": "/providers/Microsoft.Management/managementGroups/root-id-1",
                  "timeouts": null
                },
                "sensitive_values": {}
              },
              {
                "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyAssignments/Deploy-MDFC-Config-H224\"].azurerm_role_assignment.for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/roleAssignments/8c8e6ab9-0ff3-513f-9980-bbb17bdcb656\"]",
                "mode": "managed",
                "type": "azurerm_role_assignment",
                "name": "for_policy",
                "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/roleAssignments/8c8e6ab9-0ff3-513f-9980-bbb17bdcb656",
                "provider_name": "registry.terraform.io/hashicorp/azurerm",
                "schema_version": 0,
                "values": {
                  "condition": null,
                  "condition_version": null,
                  "delegated_managed_identity_resource_id": null,
                  "description": null,
                  "name": "8c8e6ab9-0ff3-513f-9980-bbb17bdcb656",
                  "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293",
                  "scope": "/providers/Microsoft.Management/managementGroups/root-id-1",
                  "timeouts": null
                },
                "sensitive_values": {}
              },
              {
                "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyAssignments/Deploy-MDFC-Config-H224\"].azurerm_role_assignment.for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/roleAssignments/dca28692-9ac7-564d-a049-1038f5553dd3\"]",
                "mode": "managed",
                "type": "azurerm_role_assignment",
                "name": "for_policy",
                "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/roleAssignments/dca28692-9ac7-564d-a049-1038f5553dd3",
                "provider_name": "registry.terraform.io/hashicorp/azurerm",
                "schema_version": 0,
                "values": {
                  "condition": null,
                  "condition_version": null,
                  "delegated_managed_identity_resource_id": null,
                  "description": null,
                  "name": "dca28692-9ac7-564d-a049-1038f5553dd3",
                  "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/18ed5180-3e48-46fd-8541-4ea054d57064",
                  "scope": "/providers/Microsoft.Management/managementGroups/root-id-1",
                  "timeouts": null
                },
                "sensitive_values": {}
              },
              {
                "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyAssignments/Deploy-MDFC-Config-H224\"].azurerm_role_assignment.for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/roleAssignments/dd42d599-5f7e-543d-a2cb-5e4e77f6bc4d\"]",
                "mode": "managed",
                "type": "azurerm_role_assignment",
                "name": "for_policy",
                "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/roleAssignments/dd42d599-5f7e-543d-a2cb-5e4e77f6bc4d",
                "provider_name": "registry.terraform.io/hashicorp/azurerm",
                "schema_version": 0,
                "values": {
                  "condition": null,
                  "condition_version": null,
                  "delegated_managed_identity_resource_id": null,
                  "description": null,
                  "name": "dd42d599-5f7e-543d-a2cb-5e4e77f6bc4d",
                  "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/8e3af657-a8ff-443c-a75c-2fe8c4bcb635",
                  "scope": "/providers/Microsoft.Management/managementGroups/root-id-1",
                  "timeouts": null
                },
                "sensitive_values": {}
              },
              {
                "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyAssignments/Deploy-MDFC-Config-H224\"].azurerm_role_assignment.for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/roleAssignments/f1921fcd-f643-59ba-8796-a7ef6998c724\"]",
                "mode": "managed",
                "type": "azurerm_role_assignment",
                "name": "for_policy",
                "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/roleAssignments/f1921fcd-f643-59ba-8796-a7ef6998c724",
                "provider_name": "registry.terraform.io/hashicorp/azurerm",
                "schema_version": 0,
                "values": {
                  "condition": null,
                  "condition_version": null,
                  "delegated_managed_identity_resource_id": null,
                  "description": null,
                  "name": "f1921fcd-f643-59ba-8796-a7ef6998c724",
                  "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c",
                  "scope": "/providers/Microsoft.Management/managementGroups/root-id-1",
                  "timeouts": null
                },
                "sensitive_values": {}
              }
            ],
            "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyAssignments/Deploy-MDFC-Config-H224\"]"
          },
          {
            "resources": [
              {
                "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyAssignments/Deploy-MDFC-OssDb\"].azurerm_role_assignment.for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/roleAssignments/14538d97-4a28-5d98-889f-4466a399396f\"]",
                "mode": "managed",
                "type": "azurerm_role_assignment",
                "name": "for_policy",
                "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/roleAssignments/14538d97-4a28-5d98-889f-4466a399396f",
                "provider_name": "registry.terraform.io/hashicorp/azurerm",
                "schema_version": 0,
                "values": {
                  "condition": null,
                  "condition_version": null,
                  "delegated_managed_identity_resource_id": null,
                  "description": null,
                  "name": "14538d97-4a28-5d98-889f-4466a399396f",
                  "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c",
                  "scope": "/providers/Microsoft.Management/managementGroups/root-id-1",
                  "timeouts": null
                },
                "sensitive_values": {}
              }
            ],
            "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyAssignments/Deploy-MDFC-OssDb\"]"
          },
          {
            "resources": [
              {
                "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyAssignments/Deploy-MDFC-SqlAtp\"].azurerm_role_assignment.for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/roleAssignments/48b3e1cf-ed37-5c12-b92e-ffe2a7a7e5f7\"]",
                "mode": "managed",
                "type": "azurerm_role_assignment",
                "name": "for_policy",
                "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/roleAssignments/48b3e1cf-ed37-5c12-b92e-ffe2a7a7e5f7",
                "provider_name": "registry.terraform.io/hashicorp/azurerm",
                "schema_version": 0,
                "values": {
                  "condition": null,
                  "condition_version": null,
                  "delegated_managed_identity_resource_id": null,
                  "description": null,
                  "name": "48b3e1cf-ed37-5c12-b92e-ffe2a7a7e5f7",
                  "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/056cd41c-7e88-42e1-933e-88ba6a50c9c3",
                  "scope": "/providers/Microsoft.Management/managementGroups/root-id-1",
                  "timeouts": null
                },
                "sensitive_values": {}
              }
            ],
            "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyAssignments/Deploy-MDFC-SqlAtp\"]"
          },
          {
            "resources": [
              {
                "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyAssignments/Enforce-ACSB\"].azurerm_role_assignment.for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/roleAssignments/3d3e8314-e2b2-5209-a43a-7e53ddabe248\"]",
                "mode": "managed",
                "type": "azurerm_role_assignment",
                "name": "for_policy",
                "index": "/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/roleAssignments/3d3e8314-e2b2-5209-a43a-7e53ddabe248",
                "provider_name": "registry.terraform.io/hashicorp/azurerm",
                "schema_version": 0,
                "values": {
                  "condition": null,
                  "condition_version": null,
                  "delegated_managed_identity_resource_id": null,
                  "description": null,
                  "name": "3d3e8314-e2b2-5209-a43a-7e53ddabe248",
                  "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c",
                  "scope": "/providers/Microsoft.Management/managementGroups/root-id-1",
                  "timeouts": null
                },
                "sensitive_values": {}
              }
            ],
            "address": "module.test_core.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/root-id-1/providers/Microsoft.Authorization/policyAssignments/Enforce-ACSB\"]"
          }
        ]
      }
    ]
  }
}
